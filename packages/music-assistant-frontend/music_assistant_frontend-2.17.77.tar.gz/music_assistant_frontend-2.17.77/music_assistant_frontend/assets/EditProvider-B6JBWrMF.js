import{d as U,o as z,r as p,a0 as O,w as $,b,e as v,I as _,D as k,H as s,u as l,E as o,f as d,a1 as c,$ as m,c as R,N as K}from"./lucide-xmSP9hQT.js";import{u as q}from"./vue-router-DmMABOGf.js";import{d as i,E as F,N as A,_ as Y}from"./index-tCThBqvp.js";import{E as Z}from"./EditConfig-BvyWBOGI.js";import{_ as G}from"./ProviderIcon.vue_vue_type_style_index_0_lang-B2vlszLW.js";import{n as J}from"./index.browser-OxPLOBIU.js";import{n as h,s as Q,a as w,q as E,r as W,m as X,Y as T,Z as ee,p as ae,D as te,l as ne,L as se}from"./vuetify-GaNxHxlC.js";import{u as I}from"./vue-i18n-CJw2bq39.js";import"./qrcode-Be0W47IT.js";import"./marked-C0Rlrcoy.js";import"./color-BTziYnFN.js";import"./vueuse-CVzU65UW.js";/* empty css            */import"./swiper-3t6jdvul.js";import"./index-DQNN_TJ6.js";import"./utils-CDN07tui.js";import"./reka-ui-jpwHxpje.js";import"./index-B_jtOnfb.js";const oe={class:"edit-provider"},ie={key:0},le={class:"disabled-banner"},re={class:"header-content"},de={class:"header-icon"},ue={class:"header-info"},ve={class:"header-title-row"},ce={class:"header-title"},me={class:"header-description"},fe=["innerHTML"],pe=["innerHTML"],_e={id:"auth",href:"",target:"_blank"},he=U({__name:"EditProvider",props:{instanceId:{}},setup(N){const P=q(),e=p(),C=J(11),u=p(!1),g=p(!1),f=p(!1),y=p(null),B=N,H=R(()=>e.value?Object.values(e.value.values):[]);z(()=>{const t=i.subscribe(F.AUTH_SESSION,a=>{if(a.object_id!==C)return;const n=a.data;g.value=!0,window.setTimeout(()=>{const r=document.getElementById("auth");r.setAttribute("href",n),r.click()},100)});O(t)}),$(()=>B.instanceId,async t=>{t&&(e.value=await i.getProviderConfig(t))},{immediate:!0}),$(f,t=>{t&&e.value&&(y.value=e.value.name||null)});const S=async function(t){u.value=!0,t.enabled=e.value.enabled,i.saveProviderConfig(e.value.domain,t,e.value.instance_id).then(()=>{P.push({name:"providersettings"})}).catch(a=>{alert(a)}).finally(()=>{u.value=!1,g.value=!1})},j=async function(t){i.saveProviderConfig(e.value.domain,t,e.value.instance_id)},x=async function(t,a){u.value=!0;for(const n of Object.values(e.value.values))n.value!==void 0&&a[n.key]==null&&(a[n.key]=n.value);a.session_id=C,i.getProviderConfigEntries(e.value.domain,e.value.instance_id,t,a).then(n=>{e.value.values={};for(const r of n)e.value.values[r.key]=r}).catch(n=>{alert(n)}).finally(()=>{u.value=!1,g.value=!1})},L=function(t){const a=[],{t:n}=I();for(const r of t)if(r.includes("@")){let V=r.replace("@","");V=="music-assistant"&&(V="the Music Assistant team"),a.push(`[${V}](https://github.com/${r.replace("@","")})`)}else a.push(r);return`**${n("settings.provider_codeowners")}**: `+a.join(" / ")},D=function(t){const{t:a}=I();return`**${a("settings.provider_credits")}**: `+t.join(" / ")},M=function(){e.value&&(e.value.name=y.value||""),i.saveProviderConfig(e.value.domain,{name:e.value.name||null},e.value.instance_id).then(()=>{u.value=!0}).finally(()=>{u.value=!1,f.value=!1})};return(t,a)=>(v(),b("section",oe,[e.value&&l(i).providerManifests[e.value.domain]?(v(),b("div",ie,[e.value.enabled?_("",!0):(v(),k(Q,{key:0,type:"warning",variant:"tonal",class:"mb-4",closable:""},{default:o(()=>[d("div",le,[d("span",null,c(t.$t("settings.provider_disabled")),1),s(h,{size:"small",color:"warning",variant:"flat",onClick:a[0]||(a[0]=n=>e.value.enabled=!0)},{default:o(()=>[m(c(t.$t("settings.enable_provider")),1)]),_:1})])]),_:1})),s(w,{class:"header-card mb-4",elevation:"0"},{default:o(()=>[d("div",re,[d("div",de,[s(G,{domain:e.value.domain,size:48},null,8,["domain"])]),d("div",ue,[d("div",ve,[d("h2",ce,c(e.value.name||l(i).providers[e.value.instance_id]?.name||l(i).providerManifests[e.value.domain].name),1),s(h,{icon:"mdi-pencil",variant:"text",size:"small",density:"compact",class:"rename-btn",onClick:a[1]||(a[1]=n=>f.value=!0)})]),d("p",me,c(l(i).providerManifests[e.value.domain].description),1),l(i).providerManifests[e.value.domain].codeowners.length?(v(),b("div",{key:0,class:"header-authors",innerHTML:l(A)(L(l(i).providerManifests[e.value.domain].codeowners))},null,8,fe)):_("",!0),l(i).providerManifests[e.value.domain].credits.length?(v(),b("div",{key:1,class:"header-authors",innerHTML:l(A)(D(l(i).providerManifests[e.value.domain].credits))},null,8,pe)):_("",!0)])])]),_:1})])):_("",!0),e.value?(v(),k(Z,{key:1,"config-entries":H.value,disabled:!e.value.enabled,onSubmit:S,onAction:x,onImmediateApply:j},null,8,["config-entries","disabled"])):_("",!0),s(ae,{modelValue:f.value,"onUpdate:modelValue":a[4]||(a[4]=n=>f.value=n),"max-width":"400"},{default:o(()=>[s(w,null,{default:o(()=>[s(E,null,{default:o(()=>[m(c(t.$t("settings.provider_name")),1)]),_:1}),s(W,null,{default:o(()=>[s(X,{modelValue:y.value,"onUpdate:modelValue":a[2]||(a[2]=n=>y.value=n),placeholder:l(i).getProvider(e.value?.instance_id??"")?.name||l(i).providerManifests[e.value?.domain??""]?.name,variant:"outlined",density:"comfortable",autofocus:"",clearable:"",onKeyup:K(M,["enter"])},null,8,["modelValue","placeholder"])]),_:1}),s(T,null,{default:o(()=>[s(ee),s(h,{variant:"text",onClick:a[3]||(a[3]=n=>f.value=!1)},{default:o(()=>[m(c(t.$t("close")),1)]),_:1}),s(h,{color:"primary",variant:"flat",onClick:M},{default:o(()=>[m(c(t.$t("settings.save")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(se,{modelValue:u.value,"onUpdate:modelValue":a[5]||(a[5]=n=>u.value=n),scrim:"true",persistent:"",style:{display:"flex","align-items":"center","justify-content":"center"}},{default:o(()=>[g.value?(v(),k(w,{key:0,style:{"background-color":"white"}},{default:o(()=>[s(E,null,{default:o(()=>[...a[6]||(a[6]=[m("Authenticating...",-1)])]),_:1}),s(te,null,{default:o(()=>[...a[7]||(a[7]=[m("A new tab/popup should be opened where you can authenticate",-1)])]),_:1}),s(T,null,{default:o(()=>[d("a",_e,[s(h,null,{default:o(()=>[...a[8]||(a[8]=[m("Click here if the popup did not open",-1)])]),_:1})])]),_:1})]),_:1})):(v(),k(ne,{key:1,indeterminate:"",size:"64",color:"primary"}))]),_:1},8,["modelValue"])]))}}),je=Y(he,[["__scopeId","data-v-6e62a536"]]);export{je as default};
