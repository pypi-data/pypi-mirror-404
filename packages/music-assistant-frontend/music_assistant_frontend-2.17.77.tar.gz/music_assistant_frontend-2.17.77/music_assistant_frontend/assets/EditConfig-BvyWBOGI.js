import{_ as Ce}from"./index-DQNN_TJ6.js";import{a6 as f,$ as i,aa as M,_ as ae,N as he}from"./index-tCThBqvp.js";import{o as we,u as $e}from"./vue-router-DmMABOGf.js";import{c as U}from"./utils-CDN07tui.js";import{u as Te,a9 as Ne,p as oe,aa as xe,ab as Ie,ac as Se}from"./reka-ui-jpwHxpje.js";import{d as I,D as g,e as c,u as t,A as H,E as r,h as R,J as qe,K as Ae,b as T,ad as se,H as s,aJ as Be,aK as Ue,I as O,$ as V,a1 as E,c as q,f as x,w as De,a0 as Fe,F as z,r as w,M as Z,b7 as Pe}from"./lucide-xmSP9hQT.js";import{v as J}from"./vueuse-CVzU65UW.js";import{e as Le,a7 as X,s as _,n as $,R as Oe,z as Re,m as L,a8 as ze,a9 as Ge,aa as Me,M as He,a as ee,r as G,Y as te,Z as le,p as ne,q as Je,N as je,O as Ke,d as We,P as Qe}from"./vuetify-GaNxHxlC.js";const Ye=I({__name:"NumberField",props:{defaultValue:{},modelValue:{},min:{},max:{},step:{},stepSnapping:{type:Boolean},formatOptions:{},locale:{},disabled:{type:Boolean},readonly:{type:Boolean},disableWheelChange:{type:Boolean},invertWheelChange:{type:Boolean},id:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue"],setup(e,{emit:p}){const v=e,y=p,C=J(v,"class"),h=Te(C,y);return(m,A)=>(c(),g(t(Ne),H(t(h),{class:t(U)("grid gap-1.5",v.class)}),{default:r(b=>[R(m.$slots,"default",qe(Ae(b)))]),_:3},16,["class"]))}}),Ze=I({__name:"NumberFieldContent",props:{class:{}},setup(e){const p=e;return(v,y)=>(c(),T("div",{class:se(t(U)("relative [&>[data-slot=input]]:has-[[data-slot=increment]]:has-[[data-slot=decrement]]:px-10",p.class))},[R(v.$slots,"default")],2))}}),Xe=I({__name:"NumberFieldDecrement",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(e){const p=e,v=J(p,"class"),y=oe(v);return(C,h)=>(c(),g(t(xe),H({"data-slot":"decrement"},t(y),{class:t(U)("absolute top-1/2 -translate-y-1/2 left-0 p-3 disabled:cursor-not-allowed disabled:opacity-20 w-10 h-full flex items-center justify-center",p.class)}),{default:r(()=>[R(C.$slots,"default",{},()=>[s(t(Be),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),_e=I({__name:"NumberFieldIncrement",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(e){const p=e,v=J(p,"class"),y=oe(v);return(C,h)=>(c(),g(t(Ie),H({"data-slot":"increment"},t(y),{class:t(U)("absolute top-1/2 -translate-y-1/2 right-0 disabled:cursor-not-allowed disabled:opacity-20 p-3 w-10 h-full flex items-center justify-center",p.class)}),{default:r(()=>[R(C.$slots,"default",{},()=>[s(t(Ue),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),et=I({__name:"NumberFieldInput",props:{class:{}},setup(e){const p=e;return(v,y)=>(c(),g(t(Se),{"data-slot":"input",class:se(t(U)("flex h-9 w-full rounded-md border border-input bg-transparent py-1 px-0 text-sm text-center shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",p.class))},null,8,["class"]))}}),tt={class:"config-field"},lt={key:0,class:"config-divider"},nt={key:4,class:"dsp-config"},at={class:"dsp-status"},ot={key:6,class:"config-slider-wrapper"},st={class:"config-slider-block"},it={class:"config-slider-input"},rt=I({__name:"ConfigEntryField",props:{confEntry:{},showPasswordValues:{type:Boolean},disabled:{type:Boolean}},emits:["togglePassword","action","openDsp","update:value"],setup(e,{emit:p}){const v=e,y=q(()=>v.disabled||v.confEntry.read_only),C=p,h=b=>{b==null||b===""||Array.isArray(b)&&b.length===0?C("update:value",v.confEntry.default_value):C("update:value",b)},m=()=>{C("update:value",null)},A=q(()=>{if(!v.confEntry.options)return[];const b=[];for(const u of v.confEntry.options){let a=u.value?.toString()||"",k=u.title?.toString()||"";for(const N of["@","$","|"])a.includes(N)&&(a=a.replaceAll(N,"")),k.includes(N)&&(k=k.toString().replaceAll(N,""));const S={title:i(`settings.${v.confEntry.key}.options.${a}`,k),value:u.value};S.value==v.confEntry.default_value&&(S.title+=` [${i("settings.default")}]`),b.push(S)}return b});return(b,u)=>(c(),T("div",tt,[e.confEntry.type==t(f).DIVIDER?(c(),T("div",lt,[s(Le),e.confEntry.label?(c(),g(X,{key:0,class:"divider-label"},{default:r(()=>[V(E(e.confEntry.label),1)]),_:1})):O("",!0)])):e.confEntry.type==t(f).LABEL?(c(),g(_,{key:1,variant:"tonal",type:"info",density:"comfortable",class:"config-alert"},{default:r(()=>[V(E(t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label)),1)]),_:1})):e.confEntry.type==t(f).ALERT?(c(),g(_,{key:2,density:"comfortable",type:"warning",variant:"tonal",class:"config-alert"},{default:r(()=>[V(E(t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label)),1)]),_:1})):e.confEntry.type==t(f).ACTION||e.confEntry.action&&!e.confEntry.value?(c(),g($,{key:3,color:"primary",class:"action-btn",disabled:y.value,onClick:u[0]||(u[0]=a=>b.$emit("action"))},{default:r(()=>[V(E(t(i)(`settings.${e.confEntry.action||e.confEntry.key}.label`,e.confEntry.action_label||e.confEntry.label)),1)]),_:1},8,["disabled"])):e.confEntry.type==t(f).DSP_SETTINGS?(c(),T("div",nt,[x("span",at,E(e.confEntry.value?t(i)("settings.dsp_enabled"):t(i)("settings.dsp_disabled")),1),s($,{variant:"outlined",class:"action-btn",onClick:u[1]||(u[1]=a=>b.$emit("openDsp"))},{default:r(()=>[V(E(t(i)("open_dsp_settings")),1)]),_:1})])):e.confEntry.type==t(f).BOOLEAN?(c(),g(Oe,{key:5,"model-value":e.confEntry.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),color:"primary",disabled:y.value,"hide-details":"",density:"comfortable","onUpdate:modelValue":u[2]||(u[2]=a=>b.$emit("update:value",a))},null,8,["model-value","label","disabled"])):(e.confEntry.type==t(f).INTEGER||e.confEntry.type==t(f).FLOAT)&&e.confEntry.range&&e.confEntry.range.length==2?(c(),T("div",ot,[s(X,{class:"config-slider-label"},{default:r(()=>[V(E(t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label)),1)]),_:1}),x("div",st,[s(Re,{"model-value":e.confEntry.value,disabled:y.value,required:e.confEntry.required,min:e.confEntry.range[0],max:e.confEntry.range[1],step:e.confEntry.type==t(f).FLOAT?.5:1,"hide-details":"",color:"primary",class:"config-slider","onUpdate:modelValue":u[3]||(u[3]=a=>b.$emit("update:value",a))},null,8,["model-value","disabled","required","min","max","step"]),x("div",it,[s(t(Ye),{"model-value":e.confEntry.value,min:e.confEntry.range[0],max:e.confEntry.range[1],step:e.confEntry.type==t(f).FLOAT?.5:1,"format-options":{maximumFractionDigits:e.confEntry.type==t(f).FLOAT?1:0},class:"w-[100px]","onUpdate:modelValue":u[4]||(u[4]=a=>b.$emit("update:value",a))},{default:r(()=>[s(t(Ze),null,{default:r(()=>[s(t(et)),s(t(Xe)),s(t(_e))]),_:1})]),_:1},8,["model-value","min","max","step","format-options"])])])])):e.confEntry.type==t(f).SECURE_STRING?(c(),g(L,{key:7,"model-value":e.confEntry.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),required:e.confEntry.required,disabled:y.value,rules:[a=>!(!a&&e.confEntry.required)||t(i)("settings.invalid_input")],type:e.showPasswordValues?"text":"password","append-inner-icon":e.showPasswordValues?"mdi-eye":typeof e.confEntry.value=="string"&&e.confEntry.value.includes(t(M))?"":"mdi-eye-off",variant:"outlined",density:"comfortable",clearable:"",readonly:!!e.confEntry.action,"onUpdate:modelValue":u[5]||(u[5]=a=>h(a)),"onClick:appendInner":u[6]||(u[6]=a=>C("togglePassword")),"onClick:clear":m},null,8,["model-value","label","required","disabled","rules","type","append-inner-icon","readonly"])):e.confEntry.options&&e.confEntry.options.length>0?(c(),g(ze,{key:8,"model-value":e.confEntry.value,chips:e.confEntry.multi_value,clearable:!0,multiple:e.confEntry.multi_value,items:A.value,disabled:y.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),required:e.confEntry.required,rules:[a=>!(a==null&&e.confEntry.required)||t(i)("settings.invalid_input")],variant:"outlined",density:"comfortable","onUpdate:modelValue":u[7]||(u[7]=a=>h(a)),"onClick:clear":m},null,8,["model-value","chips","multiple","items","disabled","label","required","rules"])):e.confEntry.type==t(f).INTEGER||e.confEntry.type==t(f).FLOAT?(c(),g(L,{key:9,"model-value":e.confEntry.value,placeholder:e.confEntry.default_value?.toString(),disabled:y.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),required:e.confEntry.required,rules:[a=>!(!a&&e.confEntry.required)||t(i)("settings.invalid_input")],variant:"outlined",density:"comfortable",clearable:!e.confEntry.required,type:"number","onUpdate:modelValue":u[8]||(u[8]=a=>h(a)),"onClick:clear":m},null,8,["model-value","placeholder","disabled","label","required","rules","clearable"])):e.confEntry.type==t(f).ICON?(c(),g(L,{key:10,"model-value":e.confEntry.value,placeholder:e.confEntry.default_value?.toString(),clearable:"",disabled:y.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),"prepend-inner-icon":e.confEntry.value,variant:"outlined",density:"comfortable","onUpdate:modelValue":u[9]||(u[9]=a=>h(a)),"onClick:clear":m},null,8,["model-value","placeholder","disabled","label","prepend-inner-icon"])):e.confEntry.type==t(f).STRING&&e.confEntry.multi_value?(c(),g(Ge,{key:11,"model-value":e.confEntry.value,multiple:"",chips:"",clearable:!0,disabled:y.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),required:e.confEntry.required,rules:[a=>!(!a&&e.confEntry.required)||t(i)("settings.invalid_input")],variant:"outlined",density:"comfortable","onUpdate:modelValue":u[10]||(u[10]=a=>h(a)),"onClick:clear":m},null,8,["model-value","disabled","label","required","rules"])):(c(),g(L,{key:12,"model-value":e.confEntry.value,placeholder:e.confEntry.default_value?.toString(),clearable:"",disabled:y.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),required:e.confEntry.required,rules:[a=>!(!a&&e.confEntry.required)||t(i)("settings.invalid_input")],variant:"outlined",density:"comfortable",readonly:!!e.confEntry.action,"onUpdate:modelValue":u[11]||(u[11]=a=>h(a)),"onClick:clear":m},null,8,["model-value","placeholder","disabled","label","required","rules","readonly"]))]))}}),ut=ae(rt,[["__scopeId","data-v-bdf04eab"]]),dt={class:"panel-title-text"},ct={class:"config-panel-content"},ft={class:"config-actions"},yt=I({__name:"EditConfig",props:{configEntries:{},disabled:{type:Boolean}},emits:["submit","action","immediateApply"],setup(e,{emit:p}){const v=$e(),y=w(!1),C=w(!1),h=p,m=w(),A=w(!1),b=w(),u=w([]),a=w(!1),k=w(),D=w({}),S=w(!1),N=e,j=q(()=>["generic",...new Set(m.value.map(n=>n.category).filter(n=>!["generic","advanced"].includes(n))),"advanced"]),ie=q(()=>{if(m.value){for(const l of m.value)if(l.required&&!(!B(l.value)||!B(l.default_value)||l.type==f.DIVIDER||l.type==f.LABEL||l.type==f.ALERT||l.type==f.ACTION))return!1;return!0}return!1}),F=q(()=>{if(!m.value)return!1;for(const l of m.value){if(l.type==f.DIVIDER||l.type==f.LABEL||l.type==f.ALERT||l.type==f.ACTION||l.type==f.SECURE_STRING&&l.value==M)continue;const n=D.value[l.key],o=l.value;if(JSON.stringify(n)!==JSON.stringify(o))return!0}return!1});De(()=>N.configEntries,l=>{m.value=[];const n=!S.value;n&&(D.value={});for(const d of l||[])(d.value==null||d.value==null)&&(d.value=d.default_value),n&&(D.value[d.key]=typeof d.value=="object"&&d.value!==null?JSON.parse(JSON.stringify(d.value)):d.value),m.value.push(d);S.value=!0;const o=j.value.filter(d=>d!=="advanced");u.value=o},{immediate:!0});const re=async function(){const{valid:l}=await b.value.validate();return l},ue=async function(){await re()&&(C.value=!0,h("submit",Y()))},de=async function(l){h("action",l,Y())},ce=function(l,n){l.value=n,l.immediate_apply&&h("immediateApply",{[l.key]:n})},K=function(l){const n=document.createElement("a");n.setAttribute("href",l),n.setAttribute("target","_blank"),n.click()},fe=function(){v.push(`${v.currentRoute.value.path}/dsp`)},ye=function(){if(m.value)for(const l of m.value)l.value=l.default_value},ve=function(){F.value?y.value=!0:v.back()},me=function(){y.value=!1,C.value=!0,v.back()},be=function(){y.value=!1};we((l,n,o)=>{C.value||!F.value?o():(y.value=!0,o(!1))});const W=l=>{F.value&&(l.preventDefault(),l.returnValue="")};Fe(()=>{window.removeEventListener("beforeunload",W)}),window.addEventListener("beforeunload",W);const B=function(l){return l==null},ge=function(l){return!l.hidden},Ee=function(l){if(!B(l.depends_on)){const n=m.value?.find(d=>d.key==l.depends_on);if(!n)return!1;const o=n.value;return B(l.depends_on_value)?B(l.depends_on_value_not)?!o:o==l.depends_on_value_not:o!=l.depends_on_value}return!1},pe=q(()=>{const l={};if(!m.value)return l;for(const n of m.value){if(!ge(n)||n.key==="enabled"||n.key==="name")continue;const o=n.category||"generic";l[o]||(l[o]=[]),l[o].push(n)}return l}),Q=function(l){return pe.value[l]||[]},Y=function(){const l={};for(const n of N.configEntries){let o=n.value;o==null&&(o=null),!(n.type==f.SECURE_STRING&&o==M)&&(l[n.key]=o)}return l},ke=function(l){return{generic:"mdi-cog",audio:"mdi-volume-high",advanced:"mdi-tune",network:"mdi-lan",playback:"mdi-play-circle",announcements:"mdi-bullhorn",airplay:"mdi-apple",chromecast:"mdi-cast",slimproto:"mdi-speaker-wireless",snapcast:"mdi-speaker-multiple",ugp:"mdi-speaker-multiple",authentication:"mdi-lock",sync:"mdi-sync",web_player:"mdi-play-network"}[l]||"mdi-cog-outline"},Ve=function(l){return(i(`settings.${l?.key}.description`,l.description||" ")||l.help_link||" ")?.length>1};return(l,n)=>(c(),T(z,null,[m.value?(c(),g(Me,{key:0,ref_key:"form",ref:b,modelValue:A.value,"onUpdate:modelValue":n[2]||(n[2]=o=>A.value=o),disabled:e.disabled},{default:r(()=>[s(He,{modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=o=>u.value=o),multiple:"",class:"config-panels"},{default:r(()=>[(c(!0),T(z,null,Z(j.value.filter(o=>Q(o).length>0),o=>(c(),g(je,{key:o,value:o,class:"config-panel"},{default:r(()=>[s(Ke,{class:"config-panel-title"},{default:r(()=>[s(We,{icon:ke(o),class:"mr-3",size:"20"},null,8,["icon"]),x("span",dt,E(t(i)("settings.category."+o,o)),1)]),_:2},1024),s(Qe,null,{default:r(()=>[x("div",ct,[(c(!0),T(z,null,Z(Q(o),d=>(c(),T("div",{key:d.key,class:"config-entry"},[s(ut,{"conf-entry":d,"show-password-values":a.value,disabled:Ee(d),onTogglePassword:n[0]||(n[0]=P=>a.value=!a.value),"onUpdate:value":P=>ce(d,P),onAction:P=>{de(d.action||d.key),d.value=d.action?null:d.key},onOpenDsp:fe},null,8,["conf-entry","show-password-values","disabled","onUpdate:value","onAction"]),Ve(d)?(c(),g(t(Ce),{key:0,type:"button",variant:"ghost",size:"icon",class:"help-btn",onClick:P=>t(i)(`settings.${d?.key}.description`,d.description||"")?k.value=d:K(d.help_link)},{default:r(()=>[s(t(Pe),{size:20})]),_:1},8,["onClick"])):O("",!0)]))),128))])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),x("div",ft,[s($,{block:"",color:"primary",size:"large",disabled:!ie.value||!F.value,onClick:ue},{default:r(()=>[V(E(t(i)("settings.save")),1)]),_:1},8,["disabled"]),s($,{block:"",variant:"outlined",size:"large",onClick:ve},{default:r(()=>[V(E(t(i)("close")),1)]),_:1}),s($,{block:"",variant:"text",size:"large",onClick:ye},{default:r(()=>[V(E(t(i)("settings.reset_to_defaults")),1)]),_:1})])]),_:1},8,["modelValue","disabled"])):O("",!0),s(ne,{"model-value":k.value!==void 0,width:"auto","onUpdate:modelValue":n[5]||(n[5]=o=>k.value=void 0)},{default:r(()=>[s(ee,null,{default:r(()=>[s(G,null,{default:r(()=>[x("h2",null,E(t(i)(`settings.${k.value?.key}.label`,k.value?.label||"")),1)]),_:1}),s(G,{innerHTML:t(he)(t(i)(`settings.${k.value?.key}.description`,k.value?.description||""))},null,8,["innerHTML"]),s(te,null,{default:r(()=>[k.value?.help_link?(c(),g($,{key:0,onClick:n[3]||(n[3]=o=>K(k.value.help_link))},{default:r(()=>[V(E(t(i)("read_more")),1)]),_:1})):O("",!0),s(le),s($,{color:"primary",onClick:n[4]||(n[4]=o=>k.value=void 0)},{default:r(()=>[V(E(t(i)("close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]),s(ne,{modelValue:y.value,"onUpdate:modelValue":n[6]||(n[6]=o=>y.value=o),"max-width":"400",persistent:""},{default:r(()=>[s(ee,null,{default:r(()=>[s(Je,null,{default:r(()=>[V(E(t(i)("settings.unsaved_changes")),1)]),_:1}),s(G,null,{default:r(()=>[V(E(t(i)("settings.unsaved_changes_message")),1)]),_:1}),s(te,null,{default:r(()=>[s(le),s($,{variant:"text",onClick:be},{default:r(()=>[V(E(t(i)("settings.stay")),1)]),_:1}),s($,{color:"warning",variant:"flat",onClick:me},{default:r(()=>[V(E(t(i)("settings.discard")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Ct=ae(yt,[["__scopeId","data-v-e52c48b7"]]);export{Ct as E};
