import{d as G,r as _,a0 as q,w as D,b as c,e as p,I as v,D as P,H as s,u as r,E as n,f as u,a1 as d,$ as o,c as w,N as x}from"./lucide-xmSP9hQT.js";import{u as F}from"./vue-router-DmMABOGf.js";import{d as t,E as Y,a3 as j,m as E,a6 as V,f as S,_ as K}from"./index-tCThBqvp.js";import{E as H}from"./EditConfig-BvyWBOGI.js";import{n as Z}from"./index.browser-OxPLOBIU.js";import{n as k,s as T,d as m,a as $,q as J,r as Q,m as W,Y as X,Z as ee,p as ae}from"./vuetify-GaNxHxlC.js";import"./qrcode-Be0W47IT.js";import"./marked-C0Rlrcoy.js";import"./color-BTziYnFN.js";import"./vue-i18n-CJw2bq39.js";import"./vueuse-CVzU65UW.js";/* empty css            */import"./swiper-3t6jdvul.js";import"./index-DQNN_TJ6.js";import"./utils-CDN07tui.js";import"./reka-ui-jpwHxpje.js";import"./index-B_jtOnfb.js";const le={class:"edit-player"},te={key:0},se={class:"disabled-banner"},ne={class:"header-content"},ie={class:"header-icon"},re={class:"header-info"},oe={class:"header-title-row"},de={class:"header-title"},ue={class:"header-meta"},pe={class:"meta-item"},ve={class:"meta-item"},fe={key:0,class:"meta-item"},me={key:1,class:"meta-item"},ye={key:2,class:"meta-item"},ce={class:"disabled-banner"},_e=G({__name:"EditPlayer",props:{playerId:{}},setup(z){const N=F(),a=_(),U=Z(11),g=_(!1),f=_(!1),b=_(null),y=z,C=_(!1);(async()=>{if(y.playerId)try{C.value=(await t.getDSPConfig(y.playerId)).enabled}catch(l){console.error("Error fetching DSP config:",l)}})();const A=t.subscribe(Y.PLAYER_DSP_CONFIG_UPDATED,l=>{C.value=l.data.enabled});q(A);const B=w(()=>{if(!a.value)return[];const l=Object.values(a.value.values),e=t.players[a.value.player_id];return e&&e.type!==E.GROUP?l.push({key:"dsp_settings",type:V.DSP_SETTINGS,label:"",default_value:C.value,required:!1,category:"audio"}):e&&e.type===E.GROUP&&e.supported_features.includes(S.MULTI_DEVICE_DSP)?l.push({key:"dsp_note_multi_device_group",type:V.LABEL,label:"You can configure the DSP for each player individually.",default_value:null,required:!1,category:"audio"}):e&&e.type===E.GROUP&&!e.supported_features.includes(S.MULTI_DEVICE_DSP)&&l.push({key:"dsp_note_multi_device_group_unsupported",type:V.LABEL,label:"This group type does not support DSP when playing to multiple devices.",default_value:null,required:!1,category:"audio"}),l}),L=w(()=>B.value);D(()=>y.playerId,async l=>{l&&(a.value=await t.getPlayerConfig(l))},{immediate:!0}),D(f,l=>{l&&a.value&&(b.value=a.value.name||null)});const I=function(){a.value&&(a.value.name=b.value||void 0),t.savePlayerConfig(y.playerId,{name:a.value.name||null}).then(()=>{g.value=!0}).finally(()=>{g.value=!1,f.value=!1}),f.value=!1},M=async function(l){delete l.dsp_settings,l.enabled=a.value.enabled,t.savePlayerConfig(y.playerId,l),N.push({name:"playersettings"})},R=async function(l){t.savePlayerConfig(y.playerId,l)},O=async function(l,e){g.value=!0;for(const i of Object.values(a.value.values))i.value!==void 0&&e[i.key]==null&&(e[i.key]=i.value);e.session_id=U,t.getPlayerConfigEntries(a.value.player_id,l,e).then(i=>{a.value.values={};for(const h of i)a.value.values[h.key]=h}).catch(i=>{alert(i)}).finally(()=>{g.value=!1})};return(l,e)=>(p(),c("section",le,[a.value&&r(t).getProviderManifest(a.value.provider).domain in r(t).providerManifests?(p(),c("div",te,[a.value?.enabled?v("",!0):(p(),P(T,{key:0,type:"warning",variant:"tonal",class:"mb-4",closable:""},{default:n(()=>[u("div",se,[u("span",null,d(l.$t("settings.player_disabled")),1),s(k,{size:"small",color:"warning",variant:"flat",onClick:e[0]||(e[0]=i=>a.value.enabled=!0)},{default:n(()=>[o(d(l.$t("settings.enable_player")),1)]),_:1})])]),_:1})),a.value?(p(),P($,{key:1,class:"header-card mb-4",elevation:"0"},{default:n(()=>[u("div",ne,[u("div",ie,[s(m,{size:"32",color:"primary"},{default:n(()=>[...e[6]||(e[6]=[o("mdi-speaker",-1)])]),_:1})]),u("div",re,[u("div",oe,[u("h2",de,d(a.value.name||r(t).players[a.value.player_id]?.name||a.value.default_name),1),s(k,{icon:"mdi-pencil",variant:"text",size:"small",density:"compact",class:"rename-btn",onClick:e[1]||(e[1]=i=>f.value=!0)})]),u("div",ue,[u("span",pe,[s(m,{size:"14",class:"mr-1"},{default:n(()=>[...e[7]||(e[7]=[o("mdi-identifier",-1)])]),_:1}),o(" "+d(a.value.player_id),1)]),u("span",ve,[s(m,{size:"14",class:"mr-1"},{default:n(()=>[...e[8]||(e[8]=[o("mdi-puzzle",-1)])]),_:1}),o(" "+d(r(t).getProviderManifest(a.value.provider)?.name)+" ",1),r(t).getProviderManifest(a.value.provider)?.documentation?(p(),c("a",{key:0,class:"docs-link",onClick:e[2]||(e[2]=i=>r(j)(r(t).getProviderManifest(a.value.provider)?.documentation))},[s(m,{size:"12"},{default:n(()=>[...e[9]||(e[9]=[o("mdi-open-in-new",-1)])]),_:1})])):v("",!0)]),r(t).players[a.value.player_id]?(p(),c("span",fe,[s(m,{size:"14",class:"mr-1"},{default:n(()=>[...e[10]||(e[10]=[o("mdi-information",-1)])]),_:1}),o(" "+d(r(t).players[a.value.player_id].device_info.manufacturer)+" / "+d(r(t).players[a.value.player_id].device_info.model),1)])):v("",!0),r(t).players[a.value.player_id]?.device_info.ip_address?(p(),c("span",me,[s(m,{size:"14",class:"mr-1"},{default:n(()=>[...e[11]||(e[11]=[o("mdi-ip-network",-1)])]),_:1}),o(" "+d(r(t).players[a.value.player_id].device_info.ip_address),1)])):v("",!0),r(t).players[a.value.player_id]?(p(),c("span",ye,[s(m,{size:"14",class:"mr-1"},{default:n(()=>[...e[12]||(e[12]=[o("mdi-tag",-1)])]),_:1}),o(" "+d(l.$t(`player_type.${r(t).players[a.value.player_id].type}`)),1)])):v("",!0)])])])]),_:1})):v("",!0)])):v("",!0),a.value&&!r(t).players[a.value.player_id]?.available?(p(),P(T,{key:1,type:"warning",variant:"tonal",class:"mb-4"},{default:n(()=>[u("div",ce,[u("span",null,d(l.$t("settings.player_not_available")),1)])]),_:1})):v("",!0),a.value?(p(),P(H,{key:2,disabled:!a.value?.enabled,"config-entries":L.value,onSubmit:M,onAction:O,onImmediateApply:R},null,8,["disabled","config-entries"])):v("",!0),s(ae,{modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=i=>f.value=i),"max-width":"400"},{default:n(()=>[s($,null,{default:n(()=>[s(J,null,{default:n(()=>[o(d(l.$t("settings.player_name")),1)]),_:1}),s(Q,null,{default:n(()=>[s(W,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=i=>b.value=i),placeholder:r(t).players[a.value?.player_id]?.name||a.value?.default_name,variant:"outlined",density:"comfortable",autofocus:"",clearable:"",onKeyup:x(I,["enter"])},null,8,["modelValue","placeholder"])]),_:1}),s(X,null,{default:n(()=>[s(ee),s(k,{variant:"text",onClick:e[4]||(e[4]=i=>f.value=!1)},{default:n(()=>[o(d(l.$t("close")),1)]),_:1}),s(k,{color:"primary",variant:"flat",onClick:I},{default:n(()=>[o(d(l.$t("settings.save")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),Be=K(_e,[["__scopeId","data-v-53721e06"]]);export{Be as default};
