import{C as W}from"./Container-jslOpOlM.js";import{W as L}from"./WidgetRow-C4TmmY31.js";import{u as N}from"./userPreferences-Crk2VjHn.js";import{s as u,d as $,y as F,i as x,_ as R,E as O,$ as G,x as S}from"./index-tCThBqvp.js";import{a as Y}from"./PlayerCard-emTKABK9.js";import{B as j,n as z,s as q,l as J}from"./vuetify-GaNxHxlC.js";import{d as P,b as w,e as l,ad as K,H as s,E as o,I as v,f as m,a1 as g,al as I,F as U,M as B,c as Q,D as _,o as D,a0 as X,w as Z,r as k,u as e,aF as M,ay as ee,aG as te,aH as se,$ as ae,aI as ne}from"./lucide-xmSP9hQT.js";import{T as oe}from"./Toolbar-BiXTdBsZ.js";import{_ as V,a as A,b as E}from"./AvatarImage.vue_vue_type_script_setup_true_lang-Dn2hTcnY.js";import{_ as re,a as ie,b as le,c as de,d as C}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-D8spmdIu.js";import{u as ue}from"./vue-router-DmMABOGf.js";import"./index-kQIztB-E.js";import"./PanelviewItemCompact-DRLNd_E_.js";import"./NowPlayingBadge.vue_vue_type_style_index_0_lang-B7dDGePA.js";import"./MediaItemThumb-U9Re77C7.js";import"./ProviderIcon.vue_vue_type_style_index_0_lang-B2vlszLW.js";import"./qrcode-Be0W47IT.js";import"./marked-C0Rlrcoy.js";import"./color-BTziYnFN.js";import"./vue-i18n-CJw2bq39.js";import"./vueuse-CVzU65UW.js";/* empty css            */import"./swiper-3t6jdvul.js";import"./index-DQNN_TJ6.js";import"./utils-CDN07tui.js";import"./reka-ui-jpwHxpje.js";import"./index-B_jtOnfb.js";import"./Button-CA4MzAsM.js";const ce={class:"mr-3"},me={key:0},pe=P({__name:"PlayersWidgetRow",props:{settings:{},editMode:{type:Boolean}},emits:["update:settings"],setup(c,{emit:f}){const d=Q(()=>Object.values($.players).filter(a=>F(a)).sort((a,r)=>a.name.toUpperCase()>r.name?.toUpperCase()?1:-1).sort((a,r)=>h(a)-h(r))),y=f;function b(a){u.activePlayerId=a.player_id}function h(a){return a.playback_state==x.PLAYING?0:a.playback_state==x.PAUSED?1:a.current_media&&a.powered?3:a.current_media?4:99}return(a,r)=>{const n=I("swiper-slide"),i=I("swiper");return l(),w("div",{class:K(`widget-row ${c.settings&&!c.settings.enabled?"disabled":""}`)},[s(j,{class:"header",color:"transparent"},{title:o(()=>[m("span",ce,g(a.$t("players")),1)]),append:o(()=>[c.editMode?(l(),w("div",me,[s(z,{icon:c.settings.enabled?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",onClick:r[0]||(r[0]=t=>y("update:settings",{...c.settings,enabled:!c.settings.enabled}))},null,8,["icon"])])):v("",!0)]),_:1}),s(i,{"slides-per-view":"auto","space-between":15,"free-mode":!1,navigation:!1,mousewheel:{forceToAxis:!0,releaseOnEdges:!0}},{default:o(()=>[(l(!0),w(U,null,B(d.value,t=>(l(),_(n,{key:t.player_id},{default:o(()=>[(l(),_(Y,{id:t.player_id,key:t.player_id,player:t,"show-volume-control":!1,"show-menu-button":!1,"show-sub-players":!1,"show-sync-controls":!1,style:{width:"305px"},onClick:p=>b(t)},null,8,["id","player","onClick"]))]),_:2},1024))),128))]),_:1})],2)}}}),fe=R(pe,[["__scopeId","data-v-771a3548"]]),_e=P({__name:"HomeWidgetRows",props:{editMode:{type:Boolean,default:!1}},setup(c){const f=k([]),d=k({}),{getPreference:y,setPreference:b}=N(),h=y("widgetRowSettings",{players:{position:0,enabled:!0}}),a=async function(){u.currentUser?.preferences?d.value=h.value||{players:{position:0,enabled:!0}}:d.value={players:{position:0,enabled:!0}};const n=await $.getRecommendations(),i=[];let t=0;for(const p of n){t++;const H=d.value[p.uri]||{position:t,enabled:!0},T=p.translation_key?G(`recommendations.${p.translation_key}`,p.name):p.name;i.push({...p,settings:H,title:T}),f.value=i}};D(()=>{a();const n=$.subscribe(O.MEDIA_ITEM_PLAYED,async i=>{i.data&&!i.data.is_playing&&a()});X(n)}),Z(()=>u.currentUser?.preferences,n=>{n&&a()},{immediate:!1});const r=function(n,i){for(const t of f.value)if(t.uri===n){t.settings=i;break}d.value[n]=i,b("widgetRowSettings",d.value)};return(n,i)=>(l(),w(U,null,[d.value.players?.enabled||c.editMode?(l(),_(fe,{key:0,settings:d.value.players,"edit-mode":c.editMode,"onUpdate:settings":i[0]||(i[0]=t=>r("players",t))},null,8,["settings","edit-mode"])):v("",!0),(l(!0),w(U,null,B(f.value.filter(t=>t.items.length&&(t.settings.enabled||c.editMode)).sort((t,p)=>t.settings.position-p.settings.position),t=>(l(),w("div",{key:t.uri},[f.value.length?(l(),_(L,{key:0,"widget-row":t,"edit-mode":c.editMode,"onUpdate:settings":p=>r(t.uri,p)},null,8,["widget-row","edit-mode","onUpdate:settings"])):v("",!0)]))),128))],64))}}),ge={class:"avatar-trigger"},ve={class:"user-header-section"},we={class:"flex flex-col"},ye={class:"text-sm font-semibold"},be={class:"text-xs text-muted-foreground"},he={class:"provider-warning-content"},ke=P({__name:"HomeView",setup(c){const f=ue(),d=k(!1),y=k(!1),b=k(!0),h=()=>{S.logout()},a=()=>{f.push("/settings/providers")};return D(async()=>{if(console.log("Home page mounted"),console.log("[HA Debug] window.location.pathname:",window.location.pathname),console.log("[HA Debug] store.isIngressSession:",u.isIngressSession),console.log("[HA Debug] serverInfo.homeassistant_addon:",u.serverInfo?.homeassistant_addon),S.isAdmin())try{const r=await $.getProviderConfigs();y.value=r.some(n=>n.enabled&&n.last_error)}catch{}}),(r,n)=>(l(),w("div",null,[s(oe,{"show-loading":!0,home:!0,color:"background"},{append:o(()=>[s(e(re),null,{default:o(()=>[s(e(ie),{"as-child":""},{default:o(()=>[m("div",ge,[s(e(V),{class:"user-avatar size-10"},{default:o(()=>[e(u).currentUser?.avatar_url?(l(),_(e(A),{key:0,src:e(u).currentUser.avatar_url},null,8,["src"])):v("",!0),s(e(E),{class:"bg-primary"},{default:o(()=>[s(e(M),{size:20,class:"text-white"})]),_:1})]),_:1})])]),_:1}),s(e(le),{align:"end"},{default:o(()=>[m("div",ve,[s(e(V),{class:"user-avatar size-10"},{default:o(()=>[e(u).currentUser?.avatar_url?(l(),_(e(A),{key:0,src:e(u).currentUser.avatar_url},null,8,["src"])):v("",!0),s(e(E),{class:"bg-primary"},{default:o(()=>[s(e(M),{size:20,class:"text-white"})]),_:1})]),_:1}),m("div",we,[m("span",ye,g(e(u).currentUser?.display_name||e(u).currentUser?.username),1),m("span",be,g(e(u).currentUser?.username),1)])]),s(e(de)),s(e(C),{onClick:n[0]||(n[0]=i=>e(f).push({name:"profile"}))},{default:o(()=>[s(e(ee),{size:16}),m("span",null,g(r.$t("auth.profile")),1)]),_:1}),s(e(C),{onClick:n[1]||(n[1]=i=>d.value=!d.value)},{default:o(()=>[s(e(te),{size:16}),m("span",null,g(r.$t(d.value?"homescreen_edit_disable":"homescreen_edit_enable")),1)]),_:1}),e(u).isIngressSession?v("",!0):(l(),_(e(C),{key:0,onClick:h},{default:o(()=>[s(e(se),{size:16}),m("span",null,g(r.$t("auth.logout")),1)]),_:1}))]),_:1})]),_:1})]),_:1}),y.value&&b.value?(l(),_(q,{key:0,variant:"outlined",type:"error",icon:"mdi-alert-circle",prominent:"",class:"mx-5 mt-4",closable:"","onClick:close":n[2]||(n[2]=i=>b.value=!1)},{default:o(()=>[m("div",he,[m("span",null,g(r.$t("settings.provider_requires_attention_detail")),1),s(z,{size:"small",color:"error",variant:"flat",onClick:a},{default:o(()=>[ae(g(r.$t("settings.fix_now")),1)]),_:1})])]),_:1})):v("",!0),s(W,{variant:"comfortable"},{default:o(()=>[(l(),_(ne,null,{fallback:o(()=>[s(J,{indeterminate:""})]),default:o(()=>[m("div",null,[s(_e,{"edit-mode":d.value},null,8,["edit-mode"])])]),_:1}))]),_:1})]))}}),Qe=R(ke,[["__scopeId","data-v-2a4376db"]]);export{Qe as default};
