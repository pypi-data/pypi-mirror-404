# Vulnerability detection rules
# Used by VulnerabilityDetector module

rules:
  debuggable:
    cwe: "CWE-489"
    severity: critical
    category: configuration
    description: "Application is debuggable in production"
    impact: "Allows runtime manipulation and security bypass"
    remediation: "Set android:debuggable='false' for production builds"
  
  allow_backup:
    cwe: "CWE-200"
    severity: medium
    category: configuration
    description: "Application allows backup without encryption"
    impact: "Sensitive data can be extracted via ADB backup"
    remediation: "Set android:allowBackup='false' or implement encrypted backup"
  
  cleartext_traffic:
    cwe: "CWE-319"
    severity: high
    category: configuration
    description: "Application allows cleartext HTTP traffic"
    impact: "Network traffic can be intercepted (MITM)"
    remediation: "Set android:usesCleartextTraffic='false' and use HTTPS only"
  
  exported_provider:
    cwe: "CWE-927"
    severity: high
    category: component_security
    description: "Content provider exported without permission"
    impact: "Unauthorized access to app data"
    remediation: "Add permission or set android:exported='false'"
  
  exported_activity:
    cwe: "CWE-927"
    severity: medium
    category: component_security
    description: "Activity exported without permission"
    impact: "Unauthorized activity launching"
    remediation: "Add permission or set android:exported='false'"
  
  deep_link:
    cwe: "CWE-939"
    severity: medium
    category: deep_linking
    description: "Deep link without validation"
    impact: "Deep link injection attacks"
    remediation: "Implement strict deep link validation"
  
  hardcoded_secret:
    cwe: "CWE-798"
    severity: critical
    category: secret_exposure
    description: "Hardcoded credentials or API keys"
    impact: "Credential theft and unauthorized access"
    remediation: "Use Android Keystore or secure backend"
  
  old_sdk:
    cwe: "CWE-1104"
    severity: medium
    category: configuration
    description: "Outdated target SDK version"
    impact: "Missing modern security features"
    remediation: "Update targetSdkVersion to latest (33+)"

scoring:
  reachability:
    exported_component: 1.0
    deep_link: 0.9
    secret_exposure: 0.8
    api_endpoint: 0.7
    configuration: 0.9
    default: 0.5
  
  control:
    exported_component: 0.9
    deep_link: 1.0
    secret_exposure: 1.0
    api_endpoint: 0.6
    configuration: 0.7
    default: 0.5
  
  impact:
    critical: 1.0
    high: 0.8
    medium: 0.5
    low: 0.3
    info: 0.1
  
  exploitability:
    secret_exposure: 1.0
    configuration: 0.9
    deep_link: 0.8
    exported_component: 0.7
    api_endpoint: 0.6
    default: 0.5
