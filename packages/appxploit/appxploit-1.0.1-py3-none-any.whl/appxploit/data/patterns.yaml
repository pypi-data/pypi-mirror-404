# Secret and API patterns for discovery
# Used by SecretsDiscovery and EndpointExtractor modules

secrets:
  aws_access_key:
    pattern: "AKIA[0-9A-Z]{16}"
    severity: critical
    description: "AWS Access Key ID"
  
  aws_secret_key:
    pattern: "aws_secret_access_key.*=.*[A-Za-z0-9/+=]{40}"
    severity: critical
    description: "AWS Secret Access Key"
  
  google_api_key:
    pattern: "AIza[0-9A-Za-z-_]{35}"
    severity: high
    description: "Google API Key"
  
  firebase_url:
    pattern: "https://[a-z0-9-]+\\.firebaseio\\.com"
    severity: high
    description: "Firebase Database URL"
  
  firebase_api_key:
    pattern: "firebase.*api.*key.*[A-Za-z0-9-_]{39}"
    severity: high
    description: "Firebase API Key"
  
  stripe_key:
    pattern: "(sk|pk)_(test|live)_[0-9a-zA-Z]{24,}"
    severity: critical
    description: "Stripe API Key"
  
  jwt_secret:
    pattern: "jwt.*secret.*[A-Za-z0-9-_]{16,}"
    severity: high
    description: "JWT Secret"
  
  oauth_secret:
    pattern: "(client_secret|oauth_secret).*[A-Za-z0-9-_]{16,}"
    severity: high
    description: "OAuth Client Secret"
  
  api_key_generic:
    pattern: "api.*key.*[A-Za-z0-9-_]{16,64}"
    severity: medium
    description: "Generic API Key"
  
  bearer_token:
    pattern: "Bearer [A-Za-z0-9-_\\.]+"
    severity: high
    description: "Bearer Token"
  
  password:
    pattern: "password.*[=:].*[A-Za-z0-9]{6,}"
    severity: medium
    description: "Hardcoded Password"
  
  private_key:
    pattern: "-----BEGIN (RSA |EC )?PRIVATE KEY-----"
    severity: critical
    description: "Private Key"
  
  slack_token:
    pattern: "xox[baprs]-[0-9]{10,13}-[0-9]{10,13}-[A-Za-z0-9]{24,}"
    severity: high
    description: "Slack Token"
  
  github_token:
    pattern: "ghp_[A-Za-z0-9]{36}"
    severity: high
    description: "GitHub Personal Access Token"
  
  database_url:
    pattern: "(mongodb|mysql|postgresql)://[^\\s]+"
    severity: high
    description: "Database Connection String"

apis:
  rest_endpoint:
    pattern: '"/api/[^"]*"'
    type: rest
  
  versioned_endpoint:
    pattern: '"/v[0-9]+/[^"]*"'
    type: rest
  
  graphql_endpoint:
    pattern: '"/graphql[^"]*"'
    type: graphql
  
  websocket_url:
    pattern: "wss?://[a-zA-Z0-9\\-\\._~:/?#@!$&'()*+,;=%]+"
    type: websocket
