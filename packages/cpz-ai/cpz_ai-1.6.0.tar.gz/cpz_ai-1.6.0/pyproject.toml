[build-system]
requires = ["setuptools>=68", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "cpz-ai"
version = "1.6.0"
description = "CPZAI Python SDK for trading strategies, market data, and multi-broker execution"
readme = "README.md"
requires-python = ">=3.9"
authors = [{ name = "CPZAI", email = "contact@cpz-lab.com" }]
classifiers = [
  "Programming Language :: Python :: 3",
  "Programming Language :: Python :: 3 :: Only",
  "Programming Language :: Python :: 3.9",
  "Programming Language :: Python :: 3.10",
  "Programming Language :: Python :: 3.11",
  "Programming Language :: Python :: 3.12",
  "Typing :: Typed",
  "Development Status :: 3 - Alpha",
  "Intended Audience :: Developers",
  "License :: Other/Proprietary License",
]
dependencies = [
  "pydantic>=2.6,<3",
  "requests>=2.31,<3",
  "httpx>=0.25,<0.28",
  "alpaca-py>=0.21",
  "structlog>=24,<25",
  "click>=8.1,<9",
  "python-dotenv>=1.0,<2",
  "pytz",
]

[project.optional-dependencies]
dev = [
  "pytest",
  "pytest-cov",
  "mypy",
  "ruff",
  "black",
  "isort",
  "types-requests",
  "pre-commit",
]
yfinance = [
  "yfinance>=0.2",
]
databento = [
  "databento>=0.40",
]
all = [
  "databento>=0.40",
  "yfinance>=0.2",
]

[project.urls]
Homepage = "https://www.cpz-lab.com/cpz-ai"
Repository = "https://github.com/CPZ-Lab/cpz-py"

[project.scripts]
cpz-ai = "cpz.cli:main"

[tool.setuptools]
package-data = {"cpz" = ["py.typed"]}

[tool.setuptools.packages.find]
include = ["cpz*"]

[tool.mypy]
python_version = "3.9"
strict = true
warn_unused_configs = true
warn_redundant_casts = true
warn_unused_ignores = true
warn_return_any = true
implicit_optional = false
show_error_codes = true
pretty = true
packages = ["cpz"]
ignore_missing_imports = true

# Support for Python 3.9+ features
enable_unreachable_code = true

[tool.ruff]
line-length = 100
src = ["cpz", "tests"]

[tool.black]
line-length = 100

[tool.isort]
profile = "black"
line_length = 100

[tool.pytest.ini_options]
addopts = "-q --cov=cpz --cov-report=term-missing"
pythonpath = ["."]

[tool.coverage.run]
branch = true
source = ["cpz"]

[tool.coverage.report]
omit = [
  "cpz/__init__.py",
  "cpz/cli.py",
  "cpz/clients/base.py",
  "cpz/common/*",
  "cpz/clients/*",
  "cpz/execution/smoke_test.py",
  "cpz/execution/cpz_native_adapter.py",
  "cpz/strategy_lab/*",
  "cpz/simons/*",
  "cpz/dashboard/*",
  "cpz/data/*",
  "cpz/risk_center/*",
  "cpz/backtesting/*",
  "cpz/admin/*",
  "cpz/execution/alpaca/*",
  "cpz/execution/interfaces.py",
]
# Set a realistic threshold for unit tests that focus on critical paths
# 85% provides excellent coverage while remaining maintainable
fail_under = 85
