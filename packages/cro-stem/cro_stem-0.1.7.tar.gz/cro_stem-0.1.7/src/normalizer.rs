
use phf::phf_map;
use std::borrow::Cow;
use crate::heuristics;

// TOP 500 najčešćih hrvatskih riječi bez dijakritika.
// Izvor: Kombinacija analiza weba i uobičajenih korisničkih unosa.
// Fokus je na nedvosmislenim riječima gdje 'sisana' verzija
// gotovo uvijek implicira 'pravu' verziju.
static DIACRITIC_MAP: phf::Map<&'static str, &'static str> = phf_map! {
    "a" => "a",
    "ak" => "ak",
    "ako" => "ako",
    "ali" => "ali",
    "bi" => "bi",
    "bih" => "bih",
    "bila" => "bila",
    "bili" => "bili",
    "bilo" => "bilo",
    "bio" => "bio",
    "biti" => "biti",
    "blizu" => "blizu",
    "boja" => "boja",
    "bolje" => "bolje",
    "br" => "br",
    "braco" => "braco",
    "brat" => "brat",
    "brze" => "brže",
    "brzo" => "brzo",
    "bud" => "buđ",
    "bude" => "bude",
    "budem" => "budem",
    "budemo" => "budemo",
    "budete" => "budete",
    "budu" => "budu",
    "ces" => "ćeš",
    "cesa" => "česa",
    "cesalj" => "češalj",
    "cesce" => "češće",
    "cesta" => "cesta",
    "cestitam" => "čestitam",
    "cestitke" => "čestitke",
    "cesto" => "često",
    "cet" => "čet",
    "cetiri" => "četiri",
    "cetvrti" => "četvrti",
    "cic" => "čić",
    "cica" => "čiča",
    "cije" => "čije",
    "cijela" => "cijela",
    "cijeli" => "cijeli",
    "cijelo" => "cijelo",
    "cijena" => "cijena",
    "cijenjen" => "cijenjen",
    "cijenjeni" => "cijenjeni",
    "covjek" => "čovjek",
    "covjeka" => "čovjeka",
    "covjeku" => "čovjeku",
    "cr" => "cr",
    "crna" => "crna",
    "crni" => "crni",
    "crno" => "crno",
    "crt" => "crt",
    "crta" => "crta",
    "crtanje" => "crtanje",
    "crtez" => "crtež",
    "crveni" => "crveni",
    "cud" => "ćud",
    "cuda" => "čuda",
    "cudan" => "čudan",
    "cudno" => "čudno",
    "cudo" => "čudo",
    "cuje" => "čuje",
    "cujem" => "čujem",
    "cujes" => "čuješ",
    "cujete" => "čujete",
    "cula" => "čula",
    "culi" => "čuli",
    "culo" => "čulo",
    "cuo" => "čuo",
    "cut" => "čut",
    "cuti" => "čuti",
    "cuva" => "čuva",
    "cuvam" => "čuvam",
    "cuvas" => "čuvaš",
    "cuvati" => "čuvati",
    "da" => "da",
    "danas" => "danas",
    "des" => "deš",
    "deset" => "deset",
    "desiti" => "desiti",
    "desno" => "desno",
    "dijete" => "dijete",
    "dio" => "dio",
    "djel" => "djel",
    "djela" => "djela",
    "djelo" => "djelo",
    "djeluje" => "djeluje",
    "dobar" => "dobar",
    "doci" => "doći",
    "dode" => "dođe",
    "dodes" => "dođeš",
    "dodi" => "dođi",
    "dodu" => "dođu",
    "dog" => "dog",
    "dogada" => "događa",
    "dogadaj" => "događaj",
    "dogadati" => "događati",
    "dogodilo" => "dogodilo",
    "dok" => "dok",
    "dole" => "dole",
    "dolje" => "dolje",
    "dom" => "dom",
    "dosta" => "dosta",
    "dr" => "dr",
    "draga" => "draga",
    "dragi" => "dragi",
    "drago" => "drago",
    "drug" => "drug",
    "druga" => "druga",
    "drugacije" => "drugačije",
    "drugi" => "drugi",
    "drugo" => "drugo",
    "drugom" => "drugom",
    "drustva" => "društva",
    "drustvo" => "društvo",
    "drz" => "drž",
    "drzati" => "držati",
    "drzava" => "država",
    "dusa" => "duša",
    "dusu" => "dušu",
    "dva" => "dva",
    "dvije" => "dvije",
    "dz" => "dž",
    "dzip" => "džip",
    "face" => "face",
    "fakat" => "fakat",
    "fali" => "fali",
    "fino" => "fino",
    "ful" => "ful",
    "funk" => "funk",
    "g" => "g",
    "gdje" => "gdje",
    "gled" => "gled",
    "gleda" => "gleda",
    "gledam" => "gledam",
    "gledas" => "gledaš",
    "gledat" => "gledat",
    "gledati" => "gledati",
    "god" => "god",
    "godina" => "godina",
    "godine" => "godine",
    "godinu" => "godinu",
    "gore" => "gore",
    "gospod" => "gospod",
    "gospoda" => "gospođa",
    "gospodin" => "gospodin",
    "gospon" => "gospon",
    "gov" => "gov",
    "govno" => "govno",
    "govor" => "govor",
    "govori" => "govori",
    "govorim" => "govorim",
    "govoris" => "govoriš",
    "govoriti" => "govoriti",
    "grad" => "grad",
    "grada" => "grada",
    "gradu" => "gradu",
    "greska" => "greška",
    "grupa" => "grupa",
    "h" => "h",
    "hajde" => "hajde",
    "halo" => "halo",
    "hdz" => "hdz",
    "hej" => "hej",
    "hvala" => "hvala",
    "i" => "i",
    "iako" => "iako",
    "ici" => "ići",
    "ide" => "ide",
    "ideja" => "ideja",
    "idem" => "idem",
    "ides" => "ideš",
    "idemo" => "idemo",
    "idete" => "idete",
    "idi" => "idi",
    "idu" => "idu",
    "ih" => "ih",
    "ili" => "ili",
    "im" => "im",
    "ima" => "ima",
    "imaju" => "imaju",
    "imala" => "imala",
    "imali" => "imali",
    "imalo" => "imalo",
    "imam" => "imam",
    "imao" => "imao",
    "imas" => "imaš",
    "imat" => "imat",
    "imati" => "imati",
    "ime" => "ime",
    "ipak" => "ipak",
    "is" => "iš",
    "isao" => "išao",
    "ispod" => "ispod",
    "ispred" => "ispred",
    "ista" => "ista",
    "isti" => "isti",
    "isto" => "isto",
    "iz" => "iz",
    "izgleda" => "izgleda",
    "iznad" => "iznad",
    "ja" => "ja",
    "jaci" => "jači",
    "jako" => "jako",
    "je" => "je",
    "jeb" => "jeb",
    "jebem" => "jebem",
    "jeben" => "jeben",
    "jebeno" => "jebeno",
    "jebiga" => "jebiga",
    "jebo" => "jebo",
    "jebote" => "jebote",
    "jedan" => "jedan",
    "jedna" => "jedna",
    "jedne" => "jedne",
    "jedni" => "jedni",
    "jedno" => "jedno",
    "jednog" => "jednog",
    "jednom" => "jednom",
    "jednostavno" => "jednostavno",
    "jel" => "jel",
    "jer" => "jer",
    "jes" => "ješ",
    "jesam" => "jesam",
    "jesi" => "jesi",
    "jesmo" => "jesmo",
    "jest" => "jest",
    "jeste" => "jeste",
    "jesu" => "jesu",
    "jos" => "još",
    "ju" => "ju",
    "juce" => "juče",
    "jucer" => "jučer",
    "jug" => "jug",
    "jutra" => "jutra",
    "jutro" => "jutro",
    "k" => "k",
    "ka" => "ka",
    "kad" => "kad",
    "kada" => "kada",
    "kak" => "kak",
    "kako" => "kako",
    "kakva" => "kakva",
    "kakve" => "kakve",
    "kakvi" => "kakvi",
    "kakvo" => "kakvo",
    "kao" => "kao",
    "kasnije" => "kasnije",
    "kaz" => "kaž",
    "kaze" => "kaže",
    "kazem" => "kažem",
    "kazes" => "kažeš",
    "kazete" => "kažete",
    "kazu" => "kažu",
    "klinci" => "klinci",
    "kljuc" => "ključ",
    "knjiga" => "knjiga",
    "ko" => "ko",
    "kod" => "kod",
    "koja" => "koja",
    "koje" => "koje",
    "kojeg" => "kojeg",
    "kojem" => "kojem",
    "koji" => "koji",
    "kojima" => "kojima",
    "kojoj" => "kojoj",
    "koju" => "koju",
    "kol" => "kol",
    "koliko" => "koliko",
    "kom" => "kom",
    "kome" => "kome",
    "konj" => "konj",
    "kosta" => "košta",
    "kraj" => "kraj",
    "kratko" => "kratko",
    "kren" => "kren",
    "kroz" => "kroz",
    "kuca" => "kuća",
    "kuce" => "kuće",
    "kuci" => "kući",
    "kucka" => "kučka",
    "kui" => "kuš",
    "kupi" => "kupi",
    "kupit" => "kupit",
    "kuz" => "kuž",
    "kuzim" => "kužim",
    "kuzis" => "kužiš",
    "l" => "l",
    "lakse" => "lakše",
    "lepa" => "lepa",
    "lepi" => "lepi",
    "lijec" => "liječ",
    "lijecnik" => "liječnik",
    "lijecenje" => "liječenje",
    "lijek" => "lijek",
    "lijep" => "lijep",
    "lijepa" => "lijepa",
    "lijepe" => "lijepe",
    "lijepi" => "lijepi",
    "lijepo" => "lijepo",
    "lik" => "lik",
    "lijevo" => "lijevo",
    "ljepse" => "ljepše",
    "ljudi" => "ljudi",
    "ljudima" => "ljudima",
    "m" => "m",
    "ma" => "ma",
    "maj" => "maj",
    "majka" => "majka",
    "majke" => "majke",
    "mak" => "mak",
    "mala" => "mala",
    "male" => "male",
    "mali" => "mali",
    "malo" => "malo",
    "manje" => "manje",
    "me" => "me",
    "medu" => "među",
    "men" => "men",
    "mene" => "mene",
    "meni" => "meni",
    "mi" => "mi",
    "mil" => "mil",
    "milijun" => "milijun",
    "mili" => "mili",
    "mir" => "mir",
    "mis" => "miš",
    "misl" => "misl",
    "misli" => "misli",
    "mislim" => "mislim",
    "mislis" => "misliš",
    "mislit" => "mislit",
    "mj" => "mj",
    "mjesto" => "mjesto",
    "mlad" => "mlad",
    "mn" => "mn",
    "mno" => "mno",
    "mnogo" => "mnogo",
    "moci" => "moći",
    "moc" => "moć",
    "mog" => "mog",
    "moga" => "moga",
    "mogao" => "mogao",
    "mogla" => "mogla",
    "mogli" => "mogli",
    "moglo" => "moglo",
    "mogu" => "mogu",
    "moguc" => "moguć",
    "moguce" => "moguće",
    "moj" => "moj",
    "moja" => "moja",
    "moje" => "moje",
    "mojoj" => "mojoj",
    "mom" => "mom",
    "mor" => "mor",
    "mora" => "mora",
    "moraju" => "moraju",
    "moram" => "moram",
    "moramo" => "moramo",
    "moras" => "moraš",
    "morat" => "morat",
    "mra" => "mra",
    "mrak" => "mrak",
    "mrz" => "mrz",
    "mu" => "mu",
    "muz" => "muž",
    "n" => "n",
    "na" => "na",
    "naci" => "naći",
    "nacin" => "način",
    "nade" => "nađe",
    "nades" => "nađeš",
    "nadi" => "nađi",
    "nadu" => "nađu",
    "nad" => "nad",
    "naj" => "naj",
    "najbolja" => "najbolja",
    "najbolje" => "najbolje",
    "najbolji" => "najbolji",
    "najgore" => "najgore",
    "najmanje" => "najmanje",
    "najvise" => "najviše",
    "nam" => "nam",
    "nama" => "nama",
    "nap" => "nap",
    "naprav" => "naprav",
    "napravio" => "napravio",
    "napravit" => "napravit",
    "napraviti" => "napraviti",
    "nar" => "nar",
    "narod" => "narod",
    "nas" => "nas",
    "nasa" => "naša",
    "nase" => "naše",
    "nasi" => "naši",
    "naslov" => "naslov",
    "nateg" => "nateg",
    "nav" => "nav",
    "naz" => "naz",
    "ne" => "ne",
    "nece" => "neće",
    "neces" => "nećeš",
    "nec" => "neć",
    "necu" => "neću",
    "nega" => "nega",
    "negdje" => "negdje",
    "nego" => "nego",
    "neka" => "neka",
    "nekad" => "nekad",
    "nekak" => "nekak",
    "nekakav" => "nekakav",
    "nekako" => "nekako",
    "neke" => "neke",
    "neki" => "neki",
    "neko" => "neko",
    "nekog" => "nekog",
    "nekoj" => "nekoj",
    "nekom" => "nekom",
    "neku" => "neku",
    "nem" => "nem",
    "nema" => "nema",
    "nemam" => "nemam",
    "nemas" => "nemaš",
    "nemate" => "nemate",
    "nemo" => "nemo",
    "nemoj" => "nemoj",
    "nemre" => "nemre",
    "nes" => "neš",
    "nest" => "nešt",
    "nesta" => "nešta",
    "nesto" => "nešto",
    "net" => "net",
    "ni" => "ni",
    "nije" => "nije",
    "nijedan" => "nijedan",
    "nikad" => "nikad",
    "nikada" => "nikada",
    "nikak" => "nikak",
    "nikakav" => "nikakav",
    "nikako" => "nikako",
    "niko" => "niko",
    "nis" => "niš",
    "nisa" => "niša",
    "nisam" => "nisam",
    "nisi" => "nisi",
    "nismo" => "nismo",
    "nista" => "ništa",
    "niste" => "niste",
    "nisu" => "nisu",
    "nit" => "nit",
    "niti" => "niti",
    "niz" => "niz",
    "nj" => "nj",
    "njih" => "njih",
    "njim" => "njim",
    "njima" => "njima",
    "njoj" => "njoj",
    "nju" => "nju",
    "noc" => "noć",
    "nocas" => "noćas",
    "nov" => "nov",
    "nova" => "nova",
    "novac" => "novac",
    "nove" => "nove",
    "novi" => "novi",
    "novo" => "novo",
    "o" => "o",
    "ob" => "ob",
    "oba" => "oba",
    "obe" => "obe",
    "obi" => "obi",
    "obican" => "običan",
    "obicno" => "obično",
    "obj" => "obj",
    "od" => "od",
    "odj" => "odj",
    "odjeca" => "odjeća",
    "odjel" => "odjel",
    "odmah" => "odmah",
    "odnosno" => "odnosno",
    "oko" => "oko",
    "on" => "on",
    "ona" => "ona",
    "onda" => "onda",
    "ondje" => "ondje",
    "one" => "one",
    "oni" => "oni",
    "ono" => "ono",
    "op" => "op",
    "opet" => "opet",
    "opste" => "opšte",
    "osa" => "oša",
    "osam" => "osam",
    "osec" => "oseć",
    "oseca" => "oseća",
    "osjec" => "osjeć",
    "osjecaj" => "osjećaj",
    "osjecam" => "osjećam",
    "osim" => "osim",
    "osobe" => "osobe",
    "ost" => "ost",
    "ostaje" => "ostaje",
    "ostali" => "ostali",
    "ostalo" => "ostalo",
    "ostat" => "ostat",
    "ostati" => "ostati",
    "ov" => "ov",
    "ova" => "ova",
    "ovaj" => "ovaj",
    "ovak" => "ovak",
    "ovakav" => "ovakav",
    "ovako" => "ovako",
    "ovdje" => "ovdje",
    "ove" => "ove",
    "ovi" => "ovi",
    "ovisi" => "ovisi",
    "ovo" => "ovo",
    "ovog" => "ovog",
    "ovom" => "ovom",
    "p" => "p",
    "pa" => "pa",
    "pazi" => "pazi",
    "peder" => "peder",
    "pet" => "pet",
    "pic" => "pič",
    "picka" => "pička",
    "pice" => "piće",
    "pij" => "pij",
    "pijan" => "pijan",
    "pije" => "pije",
    "pijem" => "pijem",
    "pijes" => "piješ",
    "piju" => "piju",
    "pis" => "piš",
    "pisa" => "piša",
    "pisac" => "pisac",
    "pisati" => "pisati",
    "pise" => "piše",
    "pisem" => "pišem",
    "pises" => "pišeš",
    "pismo" => "pismo",
    "pisu" => "pišu",
    "pit" => "pit",
    "pita" => "pita",
    "pitam" => "pitam",
    "pitanja" => "pitanja",
    "pitanje" => "pitanje",
    "pitas" => "pitaš",
    "piti" => "piti",
    "piv" => "piv",
    "piva" => "piva",
    "pivo" => "pivo",
    "plac" => "plač",
    "placa" => "plaća",
    "plakati" => "plakati",
    "plan" => "plan",
    "plav" => "plav",
    "po" => "po",
    "poc" => "poč",
    "poce" => "poče",
    "poceo" => "počeo",
    "pocet" => "počet",
    "pocetak" => "početak",
    "poceti" => "početi",
    "pocinje" => "počinje",
    "pod" => "pod",
    "pogled" => "pogled",
    "pogledaj" => "pogledaj",
    "pogledati" => "pogledati",
    "poj" => "poj",
    "pola" => "pola",
    "polic" => "polic",
    "pomo" => "pomo",
    "pomoc" => "pomoć",
    "pomoci" => "pomoći",
    "pon" => "pon",
    "ponovo" => "ponovo",
    "por" => "por",
    "poruka" => "poruka",
    "pos" => "pos",
    "posa" => "poša",
    "posao" => "posao",
    "posla" => "posla",
    "poslije" => "poslije",
    "poslo" => "poslo",
    "post" => "pošt",
    "posta" => "pošta",
    "postaje" => "postaje",
    "postoji" => "postoji",
    "pot" => "pot",
    "potpuno" => "potpuno",
    "potre" => "potre",
    "pov" => "pov",
    "poz" => "poz",
    "pozdrav" => "pozdrav",
    "pra" => "pra",
    "prav" => "prav",
    "prava" => "prava",
    "pravi" => "pravi",
    "pravila" => "pravila",
    "pravilo" => "pravilo",
    "pravim" => "pravim",
    "pravo" => "pravo",
    "pre" => "pre",
    "pred" => "pred",
    "preko" => "preko",
    "prema" => "prema",
    "previ" => "previ",
    "previse" => "previše",
    "prica" => "priča",
    "pricati" => "pričati",
    "prije" => "prije",
    "primjer" => "primjer",
    "pris" => "priš",
    "priv" => "priv",
    "prk" => "prk",
    "pro" => "pro",
    "prob" => "prob",
    "problem" => "problem",
    "problema" => "problema",
    "probleme" => "probleme",
    "prof" => "prof",
    "program" => "program",
    "pros" => "proš",
    "prosa" => "proša",
    "prosao" => "prošao",
    "prosla" => "prošla",
    "prosle" => "prošle",
    "prosli" => "prošli",
    "proslo" => "prošlo",
    "prva" => "prva",
    "prve" => "prve",
    "prvi" => "prvi",
    "prvo" => "prvo",
    "prvom" => "prvom",
    "put" => "put",
    "puta" => "puta",
    "r" => "r",
    "rad" => "rad",
    "rada" => "rada",
    "rade" => "rade",
    "radi" => "radi",
    "radim" => "radim",
    "radimo" => "radimo",
    "radis" => "radiš",
    "radit" => "radit",
    "raditi" => "raditi",
    "rado" => "rado",
    "rat" => "rat",
    "raz" => "raz",
    "razlog" => "razlog",
    "razum" => "razum",
    "razumijem" => "razumijem",
    "razumijes" => "razumiješ",
    "re" => "re",
    "rec" => "reć",
    "reci" => "reći",
    "rij" => "rij",
    "rijec" => "riječ",
    "rijeci" => "riječi",
    "rijes" => "riješ",
    "rijesiti" => "riješiti",
    "rs" => "rš",
    "ruc" => "ruč",
    "ruka" => "ruka",
    "ruku" => "ruku",
    "s" => "s",
    "sa" => "sa",
    "sad" => "sad",
    "sada" => "sada",
    "sam" => "sam",
    "sama" => "sama",
    "sami" => "sami",
    "samo" => "samo",
    "sat" => "sat",
    "sati" => "sati",
    "se" => "se",
    "sebe" => "sebe",
    "sebi" => "sebi",
    "selo" => "selo",
    "ser" => "ser",
    "si" => "si",
    "sigurno" => "sigurno",
    "sin" => "sin",
    "sir" => "šir",
    "sira" => "šira",
    "sire" => "šire",
    "sis" => "šiš",
    "sisa" => "sisa",
    "sjec" => "sjeć",
    "sjecam" => "sjećam",
    "sjecas" => "sjećaš",
    "sjedi" => "sjedi",
    "sjedim" => "sjedim",
    "sk" => "šk",
    "skola" => "škola",
    "skole" => "škole",
    "skoli" => "školi",
    "skoro" => "skoro",
    "sl" => "šl",
    "slazem" => "slažem",
    "slazes" => "slažeš",
    "slic" => "slič",
    "slican" => "sličan",
    "slicno" => "slično",
    "slika" => "slika",
    "slike" => "slike",
    "sliku" => "sliku",
    "sluc" => "sluč",
    "slucaj" => "slučaj",
    "slus" => "sluš",
    "slusa" => "sluša",
    "slusaj" => "slušaj",
    "slusam" => "slušam",
    "slusati" => "slušati",
    "sm" => "šm",
    "sme" => "sme",
    "smi" => "smi",
    "smije" => "smije",
    "smo" => "smo",
    "smrt" => "smrt",
    "sn" => "šn",
    "so" => "šo",
    "soba" => "soba",
    "sp" => "šp",
    "spavat" => "spavat",
    "spavati" => "spavati",
    "srb" => "srb",
    "sranje" => "sranje",
    "src" => "srč",
    "srce" => "srce",
    "sre" => "sre",
    "sreca" => "sreća",
    "srece" => "sreće",
    "sretan" => "sretan",
    "st" => "št",
    "sta" => "šta",
    "stari" => "stari",
    "stariji" => "stariji",
    "staroj" => "staroj",
    "stvar" => "stvar",
    "stvari" => "stvari",
    "ste" => "ste",
    "sto" => "što",
    "str" => "str",
    "strana" => "strana",
    "strane" => "strane",
    "strani" => "strani",
    "stvarno" => "stvarno",
    "su" => "su",
    "super" => "super",
    "sutra" => "sutra",
    "sv" => "sv",
    "sva" => "sva",
    "svada" => "svađa",
    "svi" => "svi",
    "svida" => "sviđa",
    "svijet" => "svijet",
    "svim" => "svim",
    "svima" => "svima",
    "svira" => "svira",
    "svo" => "svo",
    "svog" => "svog",
    "svoj" => "svoj",
    "svoja" => "svoja",
    "svoje" => "svoje",
    "svojoj" => "svojoj",
    "svom" => "svom",
    "svu" => "svu",
    "t" => "t",
    "ta" => "ta",
    "tad" => "tad",
    "tada" => "tada",
    "taj" => "taj",
    "tak" => "tak",
    "takav" => "takav",
    "tako" => "tako",
    "takoder" => "također",
    "tamo" => "tamo",
    "tas" => "taš",
    "tata" => "tata",
    "te" => "te",
    "tebe" => "tebe",
    "tebi" => "tebi",
    "tek" => "tek",
    "tes" => "teš",
    "teska" => "teška",
    "tesko" => "teško",
    "ti" => "ti",
    "tih" => "tih",
    "tisu" => "tisu",
    "tisuca" => "tisuća",
    "tko" => "tko",
    "to" => "to",
    "tobom" => "tobom",
    "tog" => "tog",
    "toga" => "toga",
    "tom" => "tom",
    "tome" => "tome",
    "top" => "top",
    "tra" => "tra",
    "traz" => "traž",
    "trazi" => "traži",
    "trazim" => "tražim",
    "trazis" => "tražiš",
    "traziti" => "tražiti",
    "treb" => "treb",
    "treba" => "treba",
    "trebala" => "trebala",
    "trebalo" => "trebalo",
    "trebam" => "trebam",
    "trebas" => "trebaš",
    "trebat" => "trebat",
    "treci" => "treći",
    "tren" => "tren",
    "tri" => "tri",
    "tu" => "tu",
    "tud" => "tuđ",
    "tude" => "tuđe",
    "tvoj" => "tvoj",
    "tvoja" => "tvoja",
    "tvoje" => "tvoje",
    "tvom" => "tvom",
    "u" => "u",
    "ub" => "ub",
    "uci" => "ući",
    "uciniti" => "učiniti",
    "uciti" => "učiti",
    "ud" => "uđ",
    "ugl" => "ugl",
    "uglavnom" => "uglavnom",
    "uh" => "uh",
    "ujutro" => "ujutro",
    "ul" => "ul",
    "um" => "um",
    "umjesto" => "umjesto",
    "un" => "un",
    "unutra" => "unutra",
    "uo" => "uo",
    "up" => "up",
    "upravo" => "upravo",
    "us" => "uš",
    "usao" => "ušao",
    "usp" => "usp",
    "uspio" => "uspio",
    "uv" => "uv",
    "uvijek" => "uvijek",
    "uz" => "uz",
    "v" => "v",
    "vam" => "vam",
    "van" => "van",
    "vas" => "vas",
    "vasa" => "vaša",
    "vase" => "vaše",
    "vasi" => "vaši",
    "vec" => "već",
    "vece" => "veče",
    "vecer" => "večer",
    "vecera" => "večera",
    "veceras" => "večeras",
    "veci" => "veći",
    "vecina" => "većina",
    "vel" => "vel",
    "velik" => "velik",
    "velika" => "velika",
    "velike" => "velike",
    "veliki" => "veliki",
    "vr" => "vr",
    "vrata" => "vrata",
    "vrat" => "vrat",
    "vratit" => "vratit",
    "vratiti" => "vratiti",
    "vrem" => "vrem",
    "vremena" => "vremena",
    "vrijeme" => "vrijeme",
    "vrijedi" => "vrijedi",
    "vrlo" => "vrlo",
    "vrsi" => "vrši",
    "vrsta" => "vrsta",
    "vs" => "vs",
    "vu" => "vu",
    "z" => "z",
    "za" => "za",
    "zad" => "zad",
    "zadnji" => "zadnji",
    "zag" => "zag",
    "zaj" => "zaj",
    "zajedno" => "zajedno",
    "zak" => "zak",
    "zakon" => "zakon",
    "zao" => "žao",
    "zas" => "zaš",
    "zasto" => "zašto",
    "zat" => "zat",
    "zato" => "zato",
    "zb" => "zb",
    "zbog" => "zbog",
    "zbor" => "zbor",
    "zbroj" => "zbroj",
    "zel" => "žel",
    "zelena" => "zelena",
    "zeli" => "želi",
    "zelim" => "želim",
    "zelis" => "želiš",
    "zelja" => "želja",
    "zelje" => "želje",
    "zen" => "žen",
    "zena" => "žena",
    "zene" => "žene",
    "zeno" => "ženo",
    "zens" => "žens",
    "zensk" => "žensk",
    "zenska" => "ženska",
    "zenske" => "ženske",
    "zenski" => "ženski",
    "zensko" => "žensko",
    "zi" => "ži",
    "zin" => "zin",
    "ziv" => "živ",
    "ziva" => "živa",
    "zivc" => "živč",
    "zivcan" => "živčan",
    "zivcani" => "živčani",
    "zive" => "žive",
    "zivi" => "živi",
    "zivim" => "živim",
    "zivis" => "živiš",
    "zivjeti" => "živjeti",
    "zivot" => "život",
    "zivota" => "života",
    "zivotu" => "životu",
    "zna" => "zna",
    "znac" => "znač",
    "znaci" => "znači",
    "znacilo" => "značilo",
    "znacit" => "značit",
    "znaciti" => "značiti",
    "znak" => "znak",
    "znam" => "znam",
    "znas" => "znaš",
    "znat" => "znat",
    "znati" => "znati",
    "zove" => "zove",
    "zovem" => "zovem",
    "zoves" => "zoveš",
    "zov" => "zov",
    "zra" => "zra",
    "zrak" => "zrak",
};

// Mapa za preslikavanje ekavskih/ikavskih varijanti u ijekavicu.
// Fokus je na korijenima riječi koji se često mijenjaju.
static DIALECT_MAP: phf::Map<&'static str, &'static str> = phf_map! {
    // Ekavica -> Ijekavica
    "lepo" => "lijepo",
    "lepa" => "lijepa",
    "lepi" => "lijepi",
    "lep" => "lijep",
    "mleko" => "mlijeko",
    "mesec" => "mjesec",
    "beo" => "bijel",
    "belo" => "bijelo",
    "bela" => "bijela",
    "beli" => "bijeli",
    "pesma" => "pjesma",
    "dete" => "dijete",
    "covek" => "čovjek",
    "devojka" => "djevojka",
    "sneg" => "snijeg",
    "vreme" => "vrijeme",
    "breg" => "brijeg",
    "svet" => "svijet",
    "svetski" => "svjetski",
    "reka" => "rijeka",
    "reč" => "riječ",
    "već" => "već", // Ovo je više homonim, ali u kontekstu ekavice može biti korisno
    "gde" => "gdje",
    "ovde" => "ovdje",
    "onde" => "ondje",
    "nigde" => "nigdje",
    "svugde" => "svugdje",
    "deca" => "djeca",
    "decak" => "dječak",
    "sesti" => "sjesti",
    "cediti" => "cijediti",
    "zeleti" => "željeti",
    "goreti" => "gorjeti",
    "videti" => "vidjeti",
    "leteti" => "letjeti",
    "živeti" => "živjeti",
    "hteti" => "htjeti",
    "smeti" => "smjeti",
    "voleti" => "voljeti",

    // Ikavica -> Ijekavica
    "dite" => "dijete",
    "lik" => "lijek", // Dvosmisleno, ali često
    "lip" => "lijep",
    "lipa" => "lijepa",
    "lipo" => "lijepo",
    "mliko" => "mlijeko",
    "sin" => "sin", // Dvosmisleno, ali često
    "snig" => "snijeg",
    "svit" => "svijet",
    "vridan" => "vrijedan",
    "vridnost" => "vrijednost",
    "cviće" => "cvijeće",
    "cvi" => "cvijet",
    "isto" => "isto", // neutralno
    "misto" => "mjesto",
    "siditi" => "sjediti",
    "viditi" => "vidjeti",
    "tilo" => "tijelo",
    "cilo" => "cijelo",
    "pivati" => "pjevati",
    "divojka" => "djevojka",
    "did" => "djed",
    "ljep" => "lijep",
};


/// Prima riječ i pokušava je normalizirati koristeći tri strategije:
/// 1. Ispravljanje 'šišane' latinice (vraćanje dijakritika) pomoću mape.
/// 2. Preslikavanje dijalektalnih varijanti (ekavica/ikavica) u standardnu ijekavicu.
/// 3. Primjena heurističkih pravila ako riječ nije pronađena u mapama.
///
/// Funkcija vraća `Cow<'a, str>`, što je ili posuđeni `&str` ako nije bilo promjene,
/// ili vlasnički `String` ako je riječ modificirana.
///
/// # Primjeri
///
/// ```
/// use cro_stem::normalizer::normalize;
///
/// // Ispravljanje dijakritika
/// assert_eq!(normalize("cesalj"), "češalj");
/// assert_eq!(normalize("zivot"), "život");
///
/// // Preslikavanje dijalekta
/// assert_eq!(normalize("lepo"), "lijepo");
/// assert_eq!(normalize("mleko"), "mlijeko");
/// assert_eq!(normalize("dite"), "dijete");
///
/// // Nema promjene
/// assert_eq!(normalize("kuća"), "kuća");
/// assert_eq!(normalize("pas"), "pas");
/// ```
pub fn normalize<'a>(word: &'a str) -> Cow<'a, str> {
    if let Some(mapped_word) = DIACRITIC_MAP.get(word).copied().or_else(|| DIALECT_MAP.get(word).copied()) {
        Cow::from(mapped_word)
    } else if let Some(heuristic_word) = heuristics::apply_heuristics(word) {
        Cow::from(heuristic_word)
    } else {
        Cow::from(word)
    }
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_diacritic_normalization() {
        assert_eq!(normalize("cesalj"), "češalj");
        assert_eq!(normalize("covjek"), "čovjek");
        assert_eq!(normalize("zivot"), "život");
        assert_eq!(normalize("sisa"), "sisa"); // Nije u mapi, vraća original
        assert_eq!(normalize("jos"), "još");
        assert_eq!(normalize("sira"), "šira");
    }

    #[test]
    fn test_dialect_normalization() {
        // Ekavica
        assert_eq!(normalize("lepo"), "lijepo");
        assert_eq!(normalize("mleko"), "mlijeko");
        assert_eq!(normalize("vreme"), "vrijeme");
        assert_eq!(normalize("gde"), "gdje");

        // Ikavica
        assert_eq!(normalize("dite"), "dijete");
        assert_eq!(normalize("lipo"), "lijepo");
        assert_eq!(normalize("snig"), "snijeg");
        assert_eq!(normalize("misto"), "mjesto");
    }

    #[test]
    fn test_no_normalization_needed() {
        assert_eq!(normalize("kuća"), "kuća");
        assert_eq!(normalize("rijeka"), "rijeka");
        assert_eq!(normalize("more"), "more");
        assert_eq!(normalize("zagreb"), "zagreb"); // Nije u mapi
    }

    #[test]
    fn test_case_sensitivity() {
        // PHF je osjetljiv na velika/mala slova, naš unos je malim slovima.
        assert_eq!(normalize("Cesalj"), "Cesalj"); // Neće se normalizirati
        assert_eq!(normalize("ZIVOT"), "ZIVOT");
    }
}
