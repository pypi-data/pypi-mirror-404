"""
Report templates and constants for consistent formatting.

Provides standardized templates used across all data pipeline report generators.
"""

from datetime import datetime


# Report header template
REPORT_HEADER_TEMPLATE = """# {title}

**Generated:** {timestamp}  
**Report Type:** {report_type}  
"""


# Section divider for visual separation
SECTION_DIVIDER = "\n" + "=" * 80 + "\n\n"


# Footer template
FOOTER_TEMPLATE = """
---

**Report generated by NFL Data Pipeline**  
**Timestamp:** {timestamp}  
"""


def create_report_header(title, report_type, additional_metadata=None):
    """
    Create a formatted report header with metadata.
    
    Args:
        title: Report title
        report_type: Type of report (Pipeline Ingestion, Warehouse Build, etc.)
        additional_metadata: Optional dict of additional metadata to include
        
    Returns:
        str: Formatted header content
    
    Example:
        >>> metadata = {'Season': '2024', 'Sources': 'pbp, rosters'}
        >>> header = create_report_header('Pipeline Report', 'Ingestion', metadata)
    """
    timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    
    header = REPORT_HEADER_TEMPLATE.format(
        title=title,
        timestamp=timestamp,
        report_type=report_type
    )
    
    if additional_metadata:
        for key, value in additional_metadata.items():
            header += f"**{key}:** {value}  \n"
    
    header += "\n"
    return header


def create_report_footer():
    """
    Create a formatted report footer.
    
    Returns:
        str: Formatted footer content
    
    Example:
        >>> footer = create_report_footer()
    """
    timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    return FOOTER_TEMPLATE.format(timestamp=timestamp)


# Common section templates
SUMMARY_SECTION_TEMPLATE = """
## {title}

{content}
"""


METRICS_TABLE_TEMPLATE = """
### {title}

{table}

{notes}
"""


def create_summary_section(title, content):
    """
    Create a formatted summary section.
    
    Args:
        title: Section title
        content: Section content (pre-formatted string)
        
    Returns:
        str: Formatted section
    
    Example:
        >>> content = "Pipeline processed 50,000 rows successfully."
        >>> section = create_summary_section("Executive Summary", content)
    """
    return SUMMARY_SECTION_TEMPLATE.format(title=title, content=content)


def create_metrics_table_section(title, table, notes=""):
    """
    Create a formatted metrics table section.
    
    Args:
        title: Table title
        table: Pre-formatted markdown table string
        notes: Optional notes to append after the table
        
    Returns:
        str: Formatted section
    
    Example:
        >>> table = "| Metric | Value |\\n|--------|-------|\\n| Success | 98% |"
        >>> section = create_metrics_table_section("Performance Metrics", table)
    """
    return METRICS_TABLE_TEMPLATE.format(title=title, table=table, notes=notes)


# Status badge templates
STATUS_BADGE_TEMPLATE = "{emoji} **{status}**"


def create_status_badge(status, emoji):
    """
    Create a status badge with emoji.
    
    Args:
        status: Status text (e.g., "Success", "Warning", "Error")
        emoji: Emoji indicator (e.g., "âœ…", "âš ï¸", "âŒ")
        
    Returns:
        str: Formatted status badge
    
    Example:
        >>> badge = create_status_badge("Success", "âœ…")
        >>> print(badge)
        âœ… **Success**
    """
    return STATUS_BADGE_TEMPLATE.format(emoji=emoji, status=status)


# Recommendation section template
RECOMMENDATION_TEMPLATE = """
## ðŸŽ¯ Recommendations

{recommendations}
"""


def create_recommendations_section(recommendations):
    """
    Create a formatted recommendations section.
    
    Args:
        recommendations: List of recommendation strings or pre-formatted string
        
    Returns:
        str: Formatted recommendations section
    
    Example:
        >>> recs = ["Review data quality rules", "Optimize memory usage"]
        >>> section = create_recommendations_section(recs)
    """
    if isinstance(recommendations, list):
        rec_content = "\n".join(f"- {rec}" for rec in recommendations)
    else:
        rec_content = recommendations
    
    return RECOMMENDATION_TEMPLATE.format(recommendations=rec_content)


__all__ = [
    'REPORT_HEADER_TEMPLATE',
    'SECTION_DIVIDER',
    'FOOTER_TEMPLATE',
    'create_report_header',
    'create_report_footer',
    'SUMMARY_SECTION_TEMPLATE',
    'METRICS_TABLE_TEMPLATE',
    'create_summary_section',
    'create_metrics_table_section',
    'STATUS_BADGE_TEMPLATE',
    'create_status_badge',
    'RECOMMENDATION_TEMPLATE',
    'create_recommendations_section',
]
