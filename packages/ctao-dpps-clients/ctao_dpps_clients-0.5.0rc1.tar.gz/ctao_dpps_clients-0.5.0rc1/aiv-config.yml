# This is the configuration used both in CI and local Makefile

variables:
  AIV_SYSTEM: DPPS
  APPLICATION_NAME: DPPS
  APPLICATION_FULL_NAME: Data Processing and Preservation System (DPPS)
  APPLICATION_AUTHOR: DPPS Team
  APPLICATION_AUTHOR_ORGANIZATION: CTAO

  # used to select UCs and Requirements from release plan
  # DPPS_UC_GROUPS: ALL
  RELEASE:

  AIV_DOCKER_IMAGE_CONTEXT: .
  AIV_DOCKERFILE: docker/Dockerfile

  # used to select requirements from Jama
  RELEASE_PLAN_FROM_JAMA: true
  UC_SUBTREE_NAME: Process and Preserve Data

  RELEASE_PLAN_FN:

  CHART_LOCATION: chart
  CHART_NAME: dpps

  EXTRA_CONFIG_FILES: aiv-config-dependencies.yml
  AIV_DEPLOY_HELM_TEST_FILTER: name=dpps-pytest
  AIV_DEPLOY_HELM_DEV_TEST_POD: dpps-pytest
  # disable for now, subcharts do not support it (WMS, simpipe at least)
  RANDOMIZED_RELEASE_NAME: false


  # these UCs are executed during project deployment and hence verified by the very completion of the pipeline
  # TODO: separate in bdms,wms
  DEPLOYMENT_UCS: DPPS-UC-170-1.2.1,DPPS-UC-170-1.2.2,DPPS-UC-170-1.2.3,DPPS-UC-170-1.2.4,DPPS-UC-170-1.2.5,DPPS-UC-170-1.6


  # used in clients container
  # TODO: reduce number of repeated occurrences of these versions
  DATAPIPE_VERSION: v0.3.1
  CALIBPIPE_VERSION: v0.4.0

  DOCKER_BUILD_ARGS: DATAPIPE_VERSION=$DATAPIPE_VERSION,CALIBPIPE_VERSION=$CALIBPIPE_VERSION

  ALLOWED_IMAGE_PREFIXES: quay.io/jetstack/cert-manager-controller,ghcr.io/diracgrid/diracx,docker.io/curlimages/curl,kiwigrid/k8s-sidecar,prom/memcached-exporter,quay.io/prometheus-operator/prometheus-config-reloader,registry.k8s.io/kube-state-metrics/kube-state-metrics,busybox,cr.fluentbit.io/fluent/fluent-bit,docker.io/grafana/loki-canary,docker.io/grafana/loki,docker.io/nginxinc/nginx-unprivileged,mcr.microsoft.com/playwright:v1.55.0-noble,quay.io/jetstack/cert-manager-cainjector:v1.13.1,quay.io/jetstack/cert-manager-ctl:v1.13.1, quay.io/jetstack/cert-manager-webhook:v1.13.1

  AIV_DEPLOY_GET_INSTANCE_NAME_BASE_NAME: dpps

  WAIT_ATTEMPTS: 90
  WAIT_SLEEP_TIME: 10
