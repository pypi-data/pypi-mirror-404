# TruffleHog Configuration

This directory contains TruffleHog v3 secret scanning configuration.

## Files

- **`.trufflehog-exclude-paths.txt`**: Regex patterns for paths to exclude from scanning

## Important: Why Not Use `git` Mode?

TruffleHog has two scanning modes:

1. **`trufflehog git`** - Scans entire git history (all commits)
   - ❌ Does NOT respect `.gitignore`
   - ❌ Scans deleted/historical files
   - ❌ Much slower (54,850 chunks, 550MB, 10+ seconds in our repo)

2. **`trufflehog filesystem`** - Scans current working directory
   - ✅ Can use `--exclude-paths` to exclude gitignored items
   - ✅ Only scans current files
   - ✅ Much faster (228 chunks, 2.5MB, <1 second in our repo)

## Configuration Approach

Since TruffleHog v3 does not have a built-in flag to respect `.gitignore`, we maintain `.trufflehog-exclude-paths.txt` which mirrors all patterns from `.gitignore`:

### Excluded Patterns (from .gitignore)

- ✅ Git directory (`.git/`)
- ✅ Virtual environments (`.venv/`, `venv/`, `ENV/`, `env/`, `.uv/`)
- ✅ Python build artifacts (`__pycache__/`, `*.pyc`, `dist/`, `build/`, `*.egg-info`)
- ✅ Development folders (`docs_dev/`, `scripts_dev/`, `libs_dev/`, `*_dev/`)
- ✅ Claude files (`.claude/`, `CLAUDE.md`)
- ✅ Logs and temp (`logs/`, `temp/`, `tmp/`, `*.log`, `*.tmp`)
- ✅ Test results (`tests/results/`, `results/`, `htmlcov/`, `.pytest_cache/`)
- ✅ IDE files (`.mypy_cache/`, `.ruff_cache/`, `.vscode/`, `.idea/`)
- ✅ OS files (`.DS_Store`, `Thumbs.db`)
- ✅ Security files (`*.pem`, `*.key`, `.env`, `secrets/`, `credentials/`)
- ✅ Large examples (`examples/`, `tests/input_batches/`)

## Usage

### Pre-commit Hook
```bash
trufflehog filesystem . --exclude-paths .trufflehog-exclude-paths.txt --fail --no-update --only-verified
```

### Manual Scan
```bash
# Scan for verified secrets only
trufflehog filesystem . --exclude-paths .trufflehog-exclude-paths.txt --no-update --only-verified

# Include unverified results
trufflehog filesystem . --exclude-paths .trufflehog-exclude-paths.txt --no-update
```

## Scan Results (Current Repo)

With proper exclusions:
- **Chunks scanned**: 228
- **Bytes scanned**: 2.5MB
- **Verified secrets**: 0
- **Scan time**: ~0.74 seconds

## Maintaining Sync with .gitignore

When adding new patterns to `.gitignore`, also add corresponding regex patterns to `.trufflehog-exclude-paths.txt`.

Example mapping:
```
.gitignore:     *.log
exclude-paths:  .*\.log$

.gitignore:     logs/
exclude-paths:  ^logs/

.gitignore:     **/*_dev/
exclude-paths:  .*_dev/
```
