graph LR
    INPUT["Input SVG Frames<br/>frame001.svg<br/>frame002.svg<br/>frame003.svg<br/>..."]

    LOAD["Load & Parse<br/>Read all SVG files<br/>Parse XML structure"]

    OPTIMIZE["Optimize Elements<br/>Path optimization<br/>Coordinate precision<br/>Remove redundancy"]

    DEDUPE["Deduplication<br/>Hash elements<br/>Identify duplicates<br/>across frames"]

    GRADIENT["Gradient Merge<br/>Detect identical gradients<br/>Merge into shared defs"]

    ORGANIZE["Organize Structure<br/>Shared → SHARED_DEFINITIONS<br/>Unique → frame groups<br/>Static → BACKDROP"]

    ANIMATE["Add Animation<br/>SMIL timing<br/>Frame sequencing<br/>&lt;use&gt; references"]

    OUTPUT["Output FBF SVG<br/>Single optimized file<br/>with embedded frames"]

    INPUT --> LOAD
    LOAD --> OPTIMIZE
    OPTIMIZE --> DEDUPE
    DEDUPE --> GRADIENT
    GRADIENT --> ORGANIZE
    ORGANIZE --> ANIMATE
    ANIMATE --> OUTPUT

    style INPUT fill:#e1f5ff,stroke:#0366d6,stroke-width:2px
    style LOAD fill:#d4edda,stroke:#155724,stroke-width:2px
    style OPTIMIZE fill:#fff3cd,stroke:#856404,stroke-width:2px
    style DEDUPE fill:#cce5ff,stroke:#004085,stroke-width:2px
    style GRADIENT fill:#e7e7ff,stroke:#6610f2,stroke-width:2px
    style ORGANIZE fill:#d1ecf1,stroke:#0c5460,stroke-width:2px
    style ANIMATE fill:#f8d7da,stroke:#721c24,stroke-width:2px
    style OUTPUT fill:#d4edda,stroke:#155724,stroke-width:3px
