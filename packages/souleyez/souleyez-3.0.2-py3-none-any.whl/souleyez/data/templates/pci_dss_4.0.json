{
  "name": "PCI-DSS 4.0 Compliance",
  "description": "Payment Card Industry Data Security Standard v4.0 requirements",
  "framework": "pci-dss",
  "engagement_type": "network",
  "deliverables": [
    {
      "category": "enumeration",
      "title": "Test firewall configurations (Req 1.2)",
      "description": "Verify network segmentation and firewall rules protect cardholder data environment",
      "target_type": "boolean",
      "target_value": 1,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM findings WHERE title LIKE '%firewall%' OR title LIKE '%segmentation%'",
      "priority": "critical"
    },
    {
      "category": "enumeration",
      "title": "Verify network segmentation (Req 1.3)",
      "description": "Map network zones and identify trust boundaries between cardholder data environment and other networks",
      "target_type": "count",
      "target_value": 2,
      "auto_validate": false,
      "priority": "high"
    },
    {
      "category": "enumeration",
      "title": "Test encryption in transit (Req 4.1)",
      "description": "Identify unencrypted sensitive data transmission over open, public networks",
      "target_type": "count",
      "target_value": 5,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM findings WHERE (title LIKE '%SSL%' OR title LIKE '%TLS%' OR title LIKE '%encryption%') AND severity IN ('critical', 'high')",
      "priority": "critical"
    },
    {
      "category": "techniques",
      "title": "Test encryption at rest (Req 4.2)",
      "description": "Check database and storage encryption for stored cardholder data",
      "target_type": "boolean",
      "target_value": 1,
      "auto_validate": false,
      "priority": "critical"
    },
    {
      "category": "exploitation",
      "title": "Test for known vulnerabilities (Req 6.2)",
      "description": "Scan for CVEs and missing security patches that could expose cardholder data",
      "target_type": "count",
      "target_value": 3,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM findings WHERE title LIKE '%CVE%' OR title LIKE '%vulnerability%'",
      "priority": "critical"
    },
    {
      "category": "exploitation",
      "title": "Assess web application security (Req 6.4.3)",
      "description": "Test for OWASP Top 10 vulnerabilities in web applications handling cardholder data",
      "target_type": "count",
      "target_value": 2,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM findings WHERE (title LIKE '%SQL injection%' OR title LIKE '%XSS%' OR title LIKE '%CSRF%') AND severity IN ('critical', 'high')",
      "priority": "high"
    },
    {
      "category": "exploitation",
      "title": "Test access control mechanisms (Req 7.1)",
      "description": "Test for authorization bypasses and privilege escalation",
      "target_type": "boolean",
      "target_value": 1,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM findings WHERE title LIKE '%authorization%' OR title LIKE '%access control%' OR title LIKE '%privilege%'",
      "priority": "critical"
    },
    {
      "category": "exploitation",
      "title": "Test authentication mechanisms (Req 8.2)",
      "description": "Verify strong authentication for all users with access to cardholder data",
      "target_type": "boolean",
      "target_value": 1,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM findings WHERE title LIKE '%authentication%' OR title LIKE '%password%' OR title LIKE '%MFA%'",
      "priority": "critical"
    },
    {
      "category": "post_exploitation",
      "title": "Test logging and monitoring (Req 10.2)",
      "description": "Verify audit trails for all access to cardholder data",
      "target_type": "boolean",
      "target_value": 1,
      "auto_validate": false,
      "priority": "high"
    },
    {
      "category": "reconnaissance",
      "title": "Perform quarterly penetration testing (Req 11.3)",
      "description": "Execute internal and external penetration testing of network and applications",
      "target_type": "boolean",
      "target_value": 1,
      "auto_validate": false,
      "priority": "critical"
    },
    {
      "category": "techniques",
      "title": "Test security awareness (Req 12.6)",
      "description": "Conduct security awareness testing (phishing simulation if applicable)",
      "target_type": "manual",
      "auto_validate": false,
      "priority": "medium"
    },
    {
      "category": "post_exploitation",
      "title": "Validate incident response procedures (Req 12.10)",
      "description": "Test incident response plan and procedures",
      "target_type": "manual",
      "auto_validate": false,
      "priority": "medium"
    }
  ]
}
