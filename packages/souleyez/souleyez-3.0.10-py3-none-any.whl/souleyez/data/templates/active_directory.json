{
  "name": "Active Directory Assessment",
  "description": "Active Directory Security Assessment and Attack Path Analysis",
  "framework": "ad",
  "engagement_type": "network",
  "deliverables": [
    {
      "category": "enumeration",
      "title": "Domain Enumeration",
      "description": "Enumerate domain controllers, trusts, and forest structure",
      "target_type": "count",
      "target_value": 5,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM services WHERE port IN (88, 389, 636, 3268, 3269)",
      "priority": "critical"
    },
    {
      "category": "enumeration",
      "title": "User & Group Enumeration",
      "description": "Enumerate domain users, groups, and organizational units",
      "target_type": "boolean",
      "target_value": 1,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM findings WHERE title LIKE '%user%' OR title LIKE '%group%' OR title LIKE '%LDAP%'",
      "priority": "critical"
    },
    {
      "category": "enumeration",
      "title": "GPO Analysis",
      "description": "Analyze Group Policy Objects for security misconfigurations",
      "target_type": "boolean",
      "target_value": 1,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM findings WHERE title LIKE '%GPO%' OR title LIKE '%Group Policy%'",
      "priority": "high"
    },
    {
      "category": "exploitation",
      "title": "Kerberoasting",
      "description": "Identify and crack service account tickets (SPNs)",
      "target_type": "boolean",
      "target_value": 1,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM findings WHERE title LIKE '%Kerberoast%' OR title LIKE '%SPN%'",
      "priority": "critical"
    },
    {
      "category": "exploitation",
      "title": "AS-REP Roasting",
      "description": "Identify accounts without pre-authentication and crack hashes",
      "target_type": "boolean",
      "target_value": 1,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM findings WHERE title LIKE '%AS-REP%' OR title LIKE '%preauth%'",
      "priority": "high"
    },
    {
      "category": "post_exploitation",
      "title": "Credential Dumping",
      "description": "Extract credentials from memory, SAM, NTDS.dit",
      "target_type": "count",
      "target_value": 5,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM credentials WHERE password_type IN ('ntlm', 'hash')",
      "priority": "critical"
    },
    {
      "category": "post_exploitation",
      "title": "Attack Path Analysis",
      "description": "Map attack paths to Domain Admin using BloodHound or similar",
      "target_type": "boolean",
      "target_value": 1,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM findings WHERE title LIKE '%BloodHound%' OR title LIKE '%attack path%'",
      "priority": "critical"
    },
    {
      "category": "post_exploitation",
      "title": "Domain Admin Compromise",
      "description": "Achieve Domain Admin or equivalent privileges",
      "target_type": "boolean",
      "target_value": 1,
      "auto_validate": true,
      "validation_query": "SELECT COUNT(*) as count FROM credentials WHERE username LIKE '%admin%' AND status = 'valid'",
      "priority": "critical"
    }
  ]
}
