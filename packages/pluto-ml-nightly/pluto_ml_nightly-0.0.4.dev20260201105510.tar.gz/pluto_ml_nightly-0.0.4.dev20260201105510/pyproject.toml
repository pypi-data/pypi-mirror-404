[tool.poetry]
name = "pluto-ml-nightly"
version = "0.0.4.dev20260201105510"
description = "Pluto ML - Machine Learning Operations Framework"
packages = [
    {include = "pluto"},
    {include = "mlop"}
]
authors = [
    "jqssun",
    "lakeesiv",
    "asaiacai"
]
readme = "README.md"

[build-system]
requires = ["poetry-core>=1.7.0"]
build-backend = "poetry.core.masonry.api"

[tool.poetry.dependencies]
python = "^3.10"
GitPython = ">=3.1"
httpx = { extras = ["http2"], version = ">=0.24" }
keyring = ">=24.0"
keyrings-alt = ">=5.0"
numpy = "^2.0"
pillow = ">=10.0"
psutil = ">=5.9"
nvidia-ml-py = ">=11.515.0"
rich = ">=13.0"
soundfile = ">=0.12"

[tool.poetry.group.dev.dependencies]
mypy = "^1.10.0"
ruff = "^0.4.7"
pytest = "^8.2.2"
pytest-xdist = "^3.6.1"
types-colorama = "^0.4.15.20240311"
types-requests = "<2.31.0.7"
types-pyyaml = "^6.0.12.20241230"

# only needed for testing
torch = "*"
matplotlib = "^3.10"
torchvision = "*"
imageio = "^2.37.0"
moviepy = "^1.0.3"
neptune-scale = ">=0.30.0"  # for testing Neptune compatibility layer (tested with 0.30.0)


[tool.poetry.extras]
full = [
  "nvidia-ml-py",
]

[tool.poetry.scripts]
pluto = 'pluto.__main__:main'
mlop = 'mlop.__main__:main'

[tool.ruff]
line-length = 88

[tool.ruff.lint]
# pyflakes, pycodestyle, isort
select = ["F", "E", "W", "I001"]

[tool.ruff.lint.per-file-ignores]
# E402: Module level import not at top of file
# Required in test_neptune_compat.py because logging must be configured
# before importing neptune_scale to prevent I/O errors
"tests/test_neptune_compat.py" = ["E402"]

[tool.ruff.format]
# 5. Use single quotes in `ruff format`.
quote-style = "single"

[tool.mypy]
python_version = "3.10"
ignore_missing_imports = true

[tool.pytest.ini_options]
markers = [
    "distributed: tests that require multi-rank torch.distributed setup",
    "neptune: tests that require real Neptune API credentials",
]
