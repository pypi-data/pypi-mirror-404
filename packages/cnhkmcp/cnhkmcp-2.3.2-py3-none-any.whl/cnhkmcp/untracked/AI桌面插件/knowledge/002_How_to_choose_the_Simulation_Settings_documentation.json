{
  "id": "simulation-settings",
  "title": "How to choose the Simulation Settings",
  "lastModified": "2025-11-05T03:49:33.672757-05:00",
  "content": [
    {
      "type": "TEXT",
      "value": "<p>The settings panel can be found by clicking the Settings button at the top right hand corner of the Simulate page. You can specify parameters like language, instrument type, universe, delay, neutralization, etc., which will be applied to your next simulation after clicking the \"Apply\" button.</p>",
      "id": "7ecd13c6-4ec0-49fb-8c4b-3c3ba3c6210c"
    },
    {
      "type": "HEADING",
      "value": {
        "level": "1",
        "content": "Language"
      },
      "id": "58867acf-578f-4fc9-86c6-16125d497c90"
    },
    {
      "type": "TEXT",
      "value": "<p>Fast Expression is available on BRAIN. To learn more, refer to <a href=\"$reference/operators\">Available Operators</a></p>",
      "id": "8aa3df64-c800-4d61-8af2-dde8c8121a51"
    },
    {
      "type": "HEADING",
      "value": {
        "level": "1",
        "content": "Instrument type"
      },
      "id": "e901215a-3f4a-4dd3-87c0-a41e9eabcaa4"
    },
    {
      "type": "TEXT",
      "value": "<p>Only Equity instrument type can be used at the moment</p>",
      "id": "3fffe201-f023-49b4-9e1f-8fb3195dd058"
    },
    {
      "type": "HEADING",
      "value": {
        "level": "1",
        "content": "Region and Universe"
      },
      "id": "c09d88c7-4670-4089-a869-a1c473861c8a"
    },
    {
      "type": "TEXT",
      "value": "<p>The only region currently available to all BRAIN users is the US market. The regions Europe and Asia are currently available only to our research consultants.</p><p>Universe is a set of trading instruments prepared by BRAIN. For example, \"US: TOP3000\" represents the top 3000 most liquid stocks in the US market (determined by highest average daily dollar volume traded).</p>",
      "id": "688ca909-ad03-4990-a943-58c2d3a80877"
    },
    {
      "type": "HEADING",
      "value": {
        "level": "1",
        "content": "Delay"
      },
      "id": "97d18b09-b888-46b7-bedf-960654f2e43e"
    },
    {
      "type": "TEXT",
      "value": "<p>Delay refers to the availability of data, relative to decision time. In other words, delay is the assumption of when we can trade stock once we decide on a position.</p><p>Assume that you are looking at the data today before market close and you decide that you want to buy stock. We can choose an aggressive approach and trade stock in the time left till market close. In this case, the position is based on data available on the same day (today). This is called Delay 0 simulation.</p><p>Alternatively, we could choose a conservative trading strategy and trade stock the next day(tomorrow). Then the position is achieved tomorrow and it is based on today’s data. In this case, there is a lag of 1 day. This is called Delay 1 simulation. In expression language, delay is applied automatically and you do not have to bother about it.</p><p></p>",
      "id": "79ea60ae-3871-41b6-871d-2c0f24f3310c"
    },
    {
      "type": "HEADING",
      "value": {
        "level": "1",
        "content": "Decay"
      },
      "id": "5eaeb8b0-c930-4dd3-96b9-a722afef1268"
    },
    {
      "type": "TEXT",
      "value": "<p>This performs a linear decay function over the past n days by combining today’s value with previous days’ decayed value. It performs the following function:</p>",
      "id": "d5c3c2fa-f51d-4ee3-9f8e-4576b6bcf365"
    },
    {
      "type": "EQUATION",
      "value": "Decay\\_linear(x,n)=\\frac{x[date]*n +x[date-1]*(n-1)+...+x[date-n-1]}{n+(n-1)+...+1}",
      "id": "2e8af62b-e7fd-413b-b540-4b513b6a4346"
    },
    {
      "type": "TEXT",
      "value": "<p></p><p>Legal values for Decay: Integer <i>'n'</i> where <i>n &gt;= 0</i>. <i>NOTE: Using negative or non-integer values for Decay will break simulations.</i></p><p>Tip: Decay can be used to reduce turnover, but decay values that are too large will attenuate the signal.</p><p></p><p></p>",
      "id": "e039f9d5-a935-4886-b6ad-a6191ffe2306"
    },
    {
      "type": "HEADING",
      "value": {
        "level": "1",
        "content": "Truncation"
      },
      "id": "d7082a34-e0c1-4974-9889-c2e60ce86df9"
    },
    {
      "type": "TEXT",
      "value": "<p>The maximum weight for each stock in the overall portfolio. When it is set to 0, there is no restriction.<br/></p><p>Legal values for Truncation: Float <i>'x'</i> where <i>0 &lt;= x &lt;= 1 (NOTE: Any values for Truncation outside this range can impact/break simulations.)</i></p><p>Tip: Truncation aims to guard from being too exposed to movements in individual stocks. The recommended setting is between 0.05 and 0.1 (entailing 5-10%).</p><p></p>",
      "id": "e8383fad-e138-41de-a826-20f366a1c438"
    },
    {
      "type": "HEADING",
      "value": {
        "level": "1",
        "content": "Neutralization"
      },
      "id": "094c4567-1bd4-4bca-9149-0f281ee2748a"
    },
    {
      "type": "TEXT",
      "value": "<p>Neutralization is an operation used to make our strategy market/industry/sub-industry neutral. When Neutralization = “Market” it does the following operation:</p><p>Alpha = Alpha – mean(Alpha)</p><p>where Alpha is the vector of weights.</p><p>Basically, it makes the mean of the Alpha vector zero. Thus no net position is taken with respect to the market. In other words, the long exposure cancels out the short exposure completely, making our strategy market neutral.</p><p>When Neutralization = Industry or Subindustry, all the instruments in the Alpha vector are grouped into smaller buckets corresponding to industry or sub-industry and neutralization is applied separately to each of the buckets. For illustration of industry/subindustry classification, see <a href=\"https://en.wikipedia.org/wiki/Global_Industry_Classification_Standard\">GICS</a> (note: this is not necessarily the same classification standard used by BRAIN platform).</p><p>To learn more about Neutralization, refer the <a href=\"https://support.worldquantbrain.com/hc/en-us/sections/4418582007959-Neutralizing-Alphas\">Neutralization FAQ</a> section.</p>",
      "id": "35ad9408-1727-409f-80d0-17cac6439d65"
    },
    {
      "type": "IMAGE",
      "value": {
        "title": "settings_view",
        "width": 632,
        "height": 471,
        "fileSize": 17439,
        "url": "https://api.worldquantbrain.com/content/images/1C1nl6f3g3jFuu-vDUjkkVADAdA=/24/original/settings_merged.png"
      },
      "id": "b8a5aecd-54f6-4250-9245-51ff3d68d679"
    },
    {
      "type": "HEADING",
      "value": {
        "level": "1",
        "content": "Pasteurize"
      },
      "id": "705ca322-2c90-4262-814c-3122326db330"
    },
    {
      "type": "IMAGE",
      "value": {
        "title": "simulation_settings_pasteurize.png",
        "width": 852,
        "height": 277,
        "fileSize": 25761,
        "url": "https://api.worldquantbrain.com/content/images/AU2Dt8D2W3HWchE9sAKAYJT4l1U=/444/original/simulation_settings_pasteurize.png"
      },
      "id": "92489717-7c68-4f32-8335-23b8768a9f35"
    },
    {
      "type": "TEXT",
      "value": "<p>Pasteurization replaces input values with NaN (pasteurizes) for instruments not in the Alpha universe. When Pasteurize = ‘On’, inputs to will be converted to NaN for instruments not in the universe selected in Simulation Settings. When Pasteurize = ‘Off’, this operation does not happen and all available inputs are used.<br/></p><p>Pasteurized data has non-NaN values only for instruments in the Alpha universe. While pasteurized data contains less information, it may be more appropriate when considering cross-sectional or group operations. The default Pasteurize setting is ‘On’. Researchers can switch it to ‘Off’ and use pasteurize(x) operator for manual pasteurization.<br/></p><p><i>Example</i></p><p>Assume the following settings are used: Universe TOP500, Pasteurize: ‘Off’. The following code calculates the difference between sector rank of sales_growth in Alpha universe and sector rank of sales_growth among all instruments:<br/></p><p></p><p></p>",
      "id": "ad821aee-01b4-444a-841c-ba91faea16f2"
    },
    {
      "type": "SIMULATION_EXAMPLE",
      "value": {
        "settings": {
          "instrumentType": "EQUITY",
          "region": "USA",
          "universe": "TOP3000",
          "delay": 1,
          "decay": 4,
          "neutralization": "MARKET",
          "truncation": 0.01,
          "pasteurization": "ON",
          "unitHandling": "VERIFY",
          "nanHandling": "OFF",
          "language": "FASTEXPR",
          "maxTrade": "OFF"
        },
        "type": "REGULAR",
        "regular": "group_rank(pasteurize(sales_growth),sector) - group_rank(sales_growth,sector)"
      },
      "id": "0de30b04-4baa-476a-9ebf-17dd60768ab6"
    },
    {
      "type": "TEXT",
      "value": "<p>The pasteurize operator in the first group_rank pasteurizes input to the Alpha universe (TOP500), while the second group_rank ranks sales_growth among all instruments.</p>",
      "id": "27a7c638-4730-4d79-8d9c-c6b2534a392d"
    },
    {
      "type": "HEADING",
      "value": {
        "level": "1",
        "content": "Nan Handling"
      },
      "id": "af3dacca-7783-4b6e-9563-9708e52fa076"
    },
    {
      "type": "IMAGE",
      "value": {
        "title": "simulation_settings_nan_handling.png",
        "width": 857,
        "height": 362,
        "fileSize": 26635,
        "url": "https://api.worldquantbrain.com/content/images/tVRsAlPd040erK5r3XAiMgmJNQo=/443/original/simulation_settings_nan_handling.png"
      },
      "id": "f062274c-7bbc-411d-99d5-0ef911f67b1c"
    },
    {
      "type": "TEXT",
      "value": "<p>NaNHandling replaces NaN values with other values. If NaNHandling: ‘On’, NaN values are handled based on operator type. For time series operators, if all inputs are NaN, 0 is returned. For group operators returning one value per group (e.g. groupmedian, groupcount), if the input value for an instrument is NaN, the value for the group is returned.<br/></p><p>If NaNHandling : ‘Off’, NaNs are preserved. For time series operators, if all inputs are NaN, NaN is returned. For group operators, if the input value for an instrument is NaN, NaN is returned. Researchers should handle NaNs manually in this case. The default setting NaNHandling value is ‘Off’. Some ways to manually handle NaN values can replicate “On” behavior.<br/></p><p><i>Example</i></p><p></p>",
      "id": "0a937e60-2ed8-43bd-b3e3-5c2e7e6ab638"
    },
    {
      "type": "SIMULATION_EXAMPLE",
      "value": {
        "settings": {
          "instrumentType": "EQUITY",
          "region": "USA",
          "universe": "TOP3000",
          "delay": 1,
          "decay": 4,
          "neutralization": "MARKET",
          "truncation": 0.01,
          "pasteurization": "ON",
          "unitHandling": "VERIFY",
          "nanHandling": "OFF",
          "language": "FASTEXPR",
          "maxTrade": "OFF"
        },
        "type": "REGULAR",
        "regular": "ts_zscore(etz_eps, 252)"
      },
      "id": "afa8ea64-b5cf-49dc-a76a-67ddf27c3da1"
    },
    {
      "type": "TEXT",
      "value": "<p>Assume NaNHandling = ‘On’. Then for a stock with etz_eps == NaN for all 252 days, 0 is returned. However, ts_zscore(x, d) also returns 0 when x == tsmean(x, d), which is different from x == NaN (“no data is available”). This means that NaNHandling = ‘On’ increases coverage, but may introduce ambiguous information into the Alpha.<br/></p><p>If NaNHandling = ‘Off’, NaNs can be handled other ways:<br/></p><p>is_nan(ts_zscore(etz_eps, 252)) ? ts_zscore(est_eps, 252) : ts_zscore(etz_eps, 252)<br/></p><p>Here, est_eps is used when etz_eps has NaN value for all 252 days.<br/></p><p><i>Example</i></p><p></p>",
      "id": "4abc87dc-0cad-4fa7-999c-a7b79a6436b8"
    },
    {
      "type": "SIMULATION_EXAMPLE",
      "value": {
        "settings": {
          "instrumentType": "EQUITY",
          "region": "USA",
          "universe": "TOP3000",
          "delay": 1,
          "decay": 3,
          "neutralization": "NONE",
          "truncation": 0.01,
          "pasteurization": "ON",
          "unitHandling": "VERIFY",
          "nanHandling": "OFF",
          "language": "FASTEXPR",
          "maxTrade": "OFF"
        },
        "type": "REGULAR",
        "regular": "groupmax(sales, industry)"
      },
      "id": "d5c67e98-563f-4301-a6f6-3c85b69d8e3c"
    },
    {
      "type": "TEXT",
      "value": "<p></p><p>When NaNHandling = ‘Off’ and sales is NaN for a given instrument, the operator’s output is NaN. When NaNHandling = ‘On’ and sales is NaN for a given instrument, the operator’s output is the maximum value of sales in the instrument’s industry.</p>",
      "id": "340965f5-c504-4cc1-ba48-59e727fcd808"
    },
    {
      "type": "HEADING",
      "value": {
        "level": "1",
        "content": "Unit Handling"
      },
      "id": "db02312f-91e3-4743-98d8-ffb4d1d7ee22"
    },
    {
      "type": "TEXT",
      "value": "<p>Unit Handling option allows raising a warning when incompatible units are used in an operator. This warning appears if expression uses data fields that are incompatible, for example, a warning will be shown for an attempt to add price to volume.</p>",
      "id": "a0e539b0-4608-48c2-af0b-e1df868deab4"
    }
  ],
  "sequence": 25,
  "category": "Getting Started"
}