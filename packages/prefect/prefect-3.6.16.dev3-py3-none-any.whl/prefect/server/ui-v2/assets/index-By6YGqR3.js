import{j as e,L as h,r as m,C as v,D,B as N,s as S,t as w}from"./vendor-tanstack-BcZfOOfy.js";import{ap as p,ao as f,bq as T,ag as I,ah as R,br as _,ai as z,aj as E,al as M,ak as P,am as A,an as L,q as j,I as k,U as F,E as Q,t as V,v as q,w as H,x as O,D as $,B as U,h as G,V as J,bs as K,bt as W,bu as g}from"./index-B8vo2Lrg.js";import{u as C,B as X}from"./use-delete-block-document-confirmation-dialog-DnwWEGUY.js";import{D as Y}from"./data-table-CPkppyg6.js";import{D as y}from"./delete-confirmation-dialog-CwDK_2QS.js";import{B as Z}from"./block-type-logo-CyAWq7mC.js";import{u as ee}from"./use-page-title-DEH55Ovu.js";import"./vendor-react-Bce9NwRC.js";import"./vendor-radix-BTiKGWfR.js";import"./vendor-recharts-BvvJP9Po.js";import"./vendor-forms-ClCIacbh.js";import"./vendor-date-wwuDAncJ.js";import"./dropdown-menu-D7Gwbd15.js";import"./use-delete-confirmation-dialog-CUdii6Lo.js";import"./table-BBNGfPra.js";const se=({blockDocument:a})=>{const{id:o,name:s,block_type:t,block_type_name:l}=a;return e.jsxs("div",{className:"flex gap-4 items-center",children:[t&&l&&e.jsx(Z,{size:"sm",logoUrl:t.logo_url,alt:`${l} logo`}),e.jsxs("div",{className:"flex flex-col",children:[s&&e.jsx(h,{to:"/blocks/block/$id",params:{id:o},children:e.jsx(p,{className:"font-semibold",children:s})}),l&&a.block_type?.slug&&e.jsx(h,{to:"/blocks/catalog/$slug",params:{slug:a.block_type.slug},children:e.jsx(p,{variant:"bodySmall",className:"text-muted-foreground",children:l})})]})]})},b=N(),ae=({onDelete:a})=>[b.display({maxSize:10,id:"select",header:({table:o})=>{let s=!1;return o.getIsAllRowsSelected()?s=!0:o.getIsSomePageRowsSelected()&&(s="indeterminate"),e.jsx(f,{checked:s,onCheckedChange:t=>o.toggleAllPageRowsSelected(!!t),"aria-label":"Select all"})},cell:({row:o})=>e.jsx(f,{checked:o.getIsSelected(),onCheckedChange:s=>o.toggleSelected(!!s),"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1}),b.display({id:"block",header:"Block",cell:({row:o})=>e.jsx(se,{blockDocument:o.original})}),b.display({id:"actions",cell:o=>{const s=o.row.original;return e.jsx("div",{className:"flex justify-end",children:e.jsx(X,{blockDocument:s,onDelete:()=>a(s)})})}})],oe=({blockDocuments:a,blockDocumentsCount:o,onPaginationChange:s,pagination:t,rowSelection:l,setRowSelection:i})=>{const[r,d]=C(),u=m.useCallback(c=>{let x=t;typeof c=="function"?x=c(t):x=c,s(x)},[t,s]),n=v({columns:ae({onDelete:d}),data:a,defaultColumn:{maxSize:300},getCoreRowModel:D(),manualPagination:!0,onPaginationChange:u,rowCount:o,getRowId:c=>c.id,onRowSelectionChange:i,state:{pagination:t,rowSelection:l}});return e.jsxs(e.Fragment,{children:[e.jsx(Y,{table:n}),e.jsx(y,{...r})]})};function te({selectedBlockTypesSlugs:a,onToggleBlockTypeSlug:o,onRemoveBlockTypeSlug:s}){return e.jsx(m.Suspense,{children:e.jsx(le,{selectedBlockTypesSlugs:a,onToggleBlockTypeSlug:o,onRemoveBlockTypeSlug:s})})}function le({selectedBlockTypesSlugs:a,onToggleBlockTypeSlug:o,onRemoveBlockTypeSlug:s}){const[t,l]=m.useState(""),i=m.useDeferredValue(t),{data:r}=S(T()),d=m.useMemo(()=>a.map(n=>r.find(c=>c.slug===n)).filter(Boolean),[r,a]),u=m.useMemo(()=>r.filter(n=>n.name.toLowerCase().includes(i.toLowerCase())),[r,i]);return e.jsxs(I,{children:[e.jsx(R,{selected:a.length>0,children:e.jsx("div",{className:"flex gap-1",children:a.length>0?d.map(n=>e.jsx(_,{tag:n.name,onRemove:()=>s(n.slug)},n.id)):"Block type"})}),e.jsxs(z,{children:[e.jsx(E,{value:t,onValueChange:l,placeholder:"Search for a block type..."}),e.jsx(M,{children:"No block type found"}),e.jsx(P,{children:e.jsx(A,{children:u.map(n=>e.jsxs(L,{selected:a.includes(n.slug),onSelect:c=>{o(c),l("")},value:n.slug,closeOnSelect:!1,children:[e.jsx("input",{type:"checkbox",checked:a.includes(n.slug),readOnly:!0,className:"mr-2 pointer-events-none"}),n.name]},n.id))})})]})]})}const ne=({count:a,rowSelection:o,setRowSelection:s})=>{const[t,l]=C(),i=m.useMemo(()=>Object.keys(o),[o]);return i.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(p,{variant:"bodySmall",className:"text-muted-foreground",children:[i.length," selected"]}),e.jsx(j,{"aria-label":"Delete rows",size:"icon",variant:"secondary",onClick:()=>{l(i,{onSuccess:()=>s({})})},children:e.jsx(k,{id:"Trash2",className:"size-4"})})]}),e.jsx(y,{...t})]}):e.jsxs(p,{variant:"bodySmall",className:"text-muted-foreground",children:[a," ",F(a,"Block")]})},ce=()=>e.jsxs(Q,{children:[e.jsx(V,{id:"Box"}),e.jsx(q,{children:"Add a block to get started"}),e.jsx(H,{children:"Blocks securely store credentials and configuration to easily manage connections to external systems."}),e.jsxs(O,{children:[e.jsx(h,{to:"/blocks/catalog",children:e.jsxs(j,{children:["Add Block ",e.jsx(k,{id:"Plus",className:"size-4 ml-2"})]})}),e.jsx($,{id:"blocks-guide"})]})]}),ie=({allCount:a,blockDocuments:o=[],onSearch:s,search:t,blockTypeSlugsFilter:l,onToggleBlockTypeSlug:i,onRemoveBlockTypeSlug:r,pagination:d,onPaginationChange:u})=>{const[n,c]=m.useState({});return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{children:e.jsx(G,{className:"text-xl font-semibold",children:"Blocks"})}),e.jsx(j,{size:"icon",className:"size-7",variant:"outline",children:e.jsx(h,{to:"/blocks/catalog",children:e.jsx(k,{id:"Plus",className:"size-4"})})})]}),a===0?e.jsx(ce,{}):e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ne,{rowSelection:n,setRowSelection:c,count:a}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"min-w-56",children:e.jsx(J,{"aria-label":"search blocks",placeholder:"Search blocks",value:t,onChange:x=>s(x.target.value)})}),e.jsx("div",{className:"min-w-64",children:e.jsx(te,{selectedBlockTypesSlugs:l,onToggleBlockTypeSlug:i,onRemoveBlockTypeSlug:r})})]})]}),e.jsx(oe,{blockDocuments:o,rowSelection:n,setRowSelection:c,blockDocumentsCount:a,pagination:d,onPaginationChange:u})]})]})};function Ne(){ee("Blocks");const[a,o]=re(),[s,t]=me(),[l,i]=de(),{data:r}=S(K()),{data:d}=w(W({sort:"NAME_ASC",include_secrets:!1,block_documents:{name:{like_:a},operator:"and_",is_anonymous:{eq_:!1}},block_types:{slug:{any_:s.length>0?s:void 0}},offset:l.pageIndex*l.pageSize,limit:l.pageSize})),u=c=>{const x=s.filter(B=>B!==c);t(x)},n=c=>{if(s.includes(c))return u(c);t([...s,c])};return e.jsx(ie,{allCount:r,blockDocuments:d,onSearch:o,search:a,blockTypeSlugsFilter:s,onRemoveBlockTypeSlug:u,onToggleBlockTypeSlug:n,pagination:l,onPaginationChange:i})}function re(){const{blockName:a}=g.useSearch(),o=g.useNavigate(),s=m.useCallback(l=>{o({to:".",search:i=>({...i,blockName:l}),replace:!0})},[o]);return[m.useMemo(()=>a??"",[a]),s]}function me(){const{blockTypes:a=[]}=g.useSearch(),o=g.useNavigate(),s=m.useCallback(t=>{o({to:".",search:l=>({...l,blockTypes:t}),replace:!0})},[o]);return[a,s]}function de(){const a=g.useSearch(),o=g.useNavigate(),s=(a.page??1)-1,t=a.limit??10,l=m.useMemo(()=>({pageIndex:s,pageSize:t}),[s,t]),i=m.useCallback(r=>{o({to:".",search:d=>({...d,page:r.pageIndex+1,limit:r.pageSize}),replace:!0})},[o]);return[l,i]}export{Ne as component};
//# sourceMappingURL=index-By6YGqR3.js.map
