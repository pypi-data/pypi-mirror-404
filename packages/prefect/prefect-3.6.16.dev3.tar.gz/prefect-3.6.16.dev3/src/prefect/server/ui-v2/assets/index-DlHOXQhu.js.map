{"version":3,"file":"index-DlHOXQhu.js","sources":["../../src/components/ui/schedule-badge/index.tsx"],"sourcesContent":["import cronstrue from \"cronstrue\";\nimport { format } from \"date-fns\";\nimport humanizeDuration from \"humanize-duration\";\nimport { useRef } from \"react\";\nimport { rrulestr } from \"rrule\";\nimport type { components } from \"@/api/prefect\";\nimport { Badge, type BadgeProps } from \"@/components/ui/badge\";\nimport {\n\tHoverCard,\n\tHoverCardContent,\n\tHoverCardTrigger,\n} from \"@/components/ui/hover-card\";\nimport {\n\tTooltip,\n\tTooltipContent,\n\tTooltipProvider,\n\tTooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { useIsOverflowing } from \"@/hooks/use-is-overflowing\";\nimport { capitalize, cn } from \"@/utils\";\n\ntype DeploymentSchedule = components[\"schemas\"][\"DeploymentSchedule\"];\ntype CronSchedule = components[\"schemas\"][\"CronSchedule\"];\ntype IntervalSchedule = components[\"schemas\"][\"IntervalSchedule\"];\ntype RRuleSchedule = components[\"schemas\"][\"RRuleSchedule\"];\n\ntype ScheduleBadgeProps = BadgeProps & {\n\tschedule: DeploymentSchedule;\n};\n\nexport const ScheduleBadge = ({ schedule, ...props }: ScheduleBadgeProps) => {\n\tconst { schedule: innerSchedule } = schedule;\n\tif (\"cron\" in innerSchedule) {\n\t\treturn (\n\t\t\t<CronScheduleBadge\n\t\t\t\tschedule={innerSchedule}\n\t\t\t\tactive={schedule.active}\n\t\t\t\t{...props}\n\t\t\t/>\n\t\t);\n\t}\n\n\tif (\"interval\" in innerSchedule) {\n\t\treturn (\n\t\t\t<IntervalScheduleBadge\n\t\t\t\tschedule={innerSchedule}\n\t\t\t\tactive={schedule.active}\n\t\t\t\t{...props}\n\t\t\t/>\n\t\t);\n\t}\n\n\tif (\"rrule\" in innerSchedule) {\n\t\treturn (\n\t\t\t<RRuleScheduleBadge\n\t\t\t\tschedule={innerSchedule}\n\t\t\t\tactive={schedule.active}\n\t\t\t\t{...props}\n\t\t\t/>\n\t\t);\n\t}\n};\n\nconst CronScheduleBadge = ({\n\tactive,\n\tschedule,\n\t...props\n}: BadgeProps & {\n\tactive: boolean;\n\tschedule: CronSchedule;\n}) => {\n\tconst scheduleText = cronstrue.toString(schedule.cron);\n\tconst detailedScheduleText = `${active ? \"\" : \"(Paused)\"} ${scheduleText} (${schedule.timezone})`;\n\treturn (\n\t\t<TooltipProvider>\n\t\t\t<Tooltip>\n\t\t\t\t<TooltipTrigger>\n\t\t\t\t\t<Badge\n\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\tclassName={`${!active ? \"opacity-50\" : \"\"}`}\n\t\t\t\t\t\t{...props}\n\t\t\t\t\t>\n\t\t\t\t\t\t<span className=\"truncate\">{scheduleText}</span>\n\t\t\t\t\t</Badge>\n\t\t\t\t</TooltipTrigger>\n\t\t\t\t<TooltipContent>{detailedScheduleText}</TooltipContent>\n\t\t\t</Tooltip>\n\t\t</TooltipProvider>\n\t);\n};\n\nconst IntervalScheduleBadge = ({\n\tactive,\n\tschedule,\n\t...props\n}: BadgeProps & {\n\tactive: boolean;\n\tschedule: IntervalSchedule;\n}) => {\n\tconst scheduleText = `Every ${humanizeDuration(schedule.interval * 1000)}`;\n\tlet detailedScheduleText = `${active ? \"\" : \"(Paused)\"} ${scheduleText}`;\n\tif (schedule.anchor_date) {\n\t\tdetailedScheduleText += ` using ${format(\n\t\t\tnew Date(schedule.anchor_date),\n\t\t\t\"MMM do, yyyy 'at' hh:mm:ss aa\",\n\t\t)} (${schedule.timezone}) as the anchor date`;\n\t}\n\treturn (\n\t\t<TooltipProvider>\n\t\t\t<Tooltip>\n\t\t\t\t<TooltipTrigger>\n\t\t\t\t\t<Badge\n\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\tclassName={`${!active ? \"opacity-50\" : \"\"}`}\n\t\t\t\t\t\t{...props}\n\t\t\t\t\t>\n\t\t\t\t\t\t<span className=\"truncate\">{scheduleText}</span>\n\t\t\t\t\t</Badge>\n\t\t\t\t</TooltipTrigger>\n\t\t\t\t<TooltipContent>{detailedScheduleText}</TooltipContent>\n\t\t\t</Tooltip>\n\t\t</TooltipProvider>\n\t);\n};\n\nconst RRuleScheduleBadge = ({\n\tactive,\n\tschedule,\n\t...props\n}: BadgeProps & {\n\tactive: boolean;\n\tschedule: RRuleSchedule;\n}) => {\n\tconst scheduleText = rrulestr(schedule.rrule).toText();\n\tconst capitalizedScheduleText = capitalize(scheduleText);\n\tconst detailedScheduleText = `${active ? \"\" : \"(Paused)\"} ${capitalizedScheduleText} (${schedule.timezone})`;\n\treturn (\n\t\t<TooltipProvider>\n\t\t\t<Tooltip>\n\t\t\t\t<TooltipTrigger>\n\t\t\t\t\t<Badge\n\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\tclassName={`${!active ? \"opacity-50\" : \"\"}`}\n\t\t\t\t\t\t{...props}\n\t\t\t\t\t>\n\t\t\t\t\t\t<span className=\"truncate\">{capitalizedScheduleText}</span>\n\t\t\t\t\t</Badge>\n\t\t\t\t</TooltipTrigger>\n\t\t\t\t<TooltipContent>{detailedScheduleText}</TooltipContent>\n\t\t\t</Tooltip>\n\t\t</TooltipProvider>\n\t);\n};\n\nexport const ScheduleBadgeGroup = ({\n\tschedules,\n\tclassName,\n}: {\n\tschedules: DeploymentSchedule[];\n\tclassName?: string;\n}) => {\n\tconst containerRef = useRef<HTMLDivElement>(null);\n\tconst isOverflowing = useIsOverflowing(containerRef);\n\tif (!schedules || schedules.length === 0) return null;\n\n\tif (isOverflowing) {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={cn(\"flex flex-row gap-2 items-center no-wrap\", className)}\n\t\t\t>\n\t\t\t\t<HoverCard>\n\t\t\t\t\t<HoverCardTrigger>\n\t\t\t\t\t\t<Badge variant=\"secondary\" className=\"whitespace-nowrap\">\n\t\t\t\t\t\t\t{schedules.length} schedules\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t</HoverCardTrigger>\n\t\t\t\t\t<HoverCardContent className=\"flex flex-col flex-wrap gap-1 w-fit\">\n\t\t\t\t\t\t{schedules.map((schedule) => (\n\t\t\t\t\t\t\t<ScheduleBadge key={schedule.id} schedule={schedule} />\n\t\t\t\t\t\t))}\n\t\t\t\t\t</HoverCardContent>\n\t\t\t\t</HoverCard>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName=\"flex flex-row gap-2 items-center no-wrap\"\n\t\t\tref={containerRef}\n\t\t>\n\t\t\t{schedules.map((schedule) => (\n\t\t\t\t<ScheduleBadge\n\t\t\t\t\tkey={schedule.id}\n\t\t\t\t\tschedule={schedule}\n\t\t\t\t\tclassName=\"max-w-28\"\n\t\t\t\t/>\n\t\t\t))}\n\t\t</div>\n\t);\n};\n"],"names":["ScheduleBadge","schedule","props","innerSchedule","jsx","CronScheduleBadge","IntervalScheduleBadge","RRuleScheduleBadge","active","scheduleText","cronstrue","detailedScheduleText","TooltipProvider","jsxs","Tooltip","TooltipTrigger","Badge","TooltipContent","humanizeDuration","format","rrulestr","capitalizedScheduleText","capitalize","ScheduleBadgeGroup","schedules","className","containerRef","useRef","isOverflowing","useIsOverflowing","cn","HoverCard","HoverCardTrigger","HoverCardContent"],"mappings":"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"}