import{r as c,j as e,t as k,d as I,L as J,C as G,H as Z,D as X,G as pe,n as ge,s as L}from"./vendor-tanstack-BcZfOOfy.js";import{bL as je,a_ as x,q as C,bM as R,y as w,bi as fe,bh as be,af as ee,H as Q,bN as we,bO as ye,M as se,bC as Ne,bP as W,bQ as ve,aI as Ce,aG as ae,V as ke,J as Se,bR as te,bS as _e,bT as De,A as Te,F as We,bU as A,bV as O,G as Fe,bW as B,B as Ee,g as Me,h as z,bw as Pe,bF as Ie,bH as Le,bX as ne,aw as Re,bY as le,bZ as P,p as re,E as q,t as V,v as K,w as Y,x as Qe,b_ as Ae,b$ as Oe,c0 as E,c1 as Be,c2 as $e,c3 as ze,c4 as qe,c5 as Ve,aA as Ke,aB as Ye,aC as Ue,aD as T,b9 as h,c6 as He}from"./index-B8vo2Lrg.js";import{D as Je}from"./index-IBvMMs6S.js";import{S as Ge,a as Ze,F as Xe}from"./flow-runs-pagination-SLbYtvaR.js";import{D as oe,a as ie,b as ce,d as de}from"./dropdown-menu-D7Gwbd15.js";import{D as ue}from"./delete-confirmation-dialog-CwDK_2QS.js";import{S as es,W as ss,a as as,b as ts,c as ns}from"./work-pool-queue-toggle-Dh7B1zMo.js";import{D as me}from"./data-table-CPkppyg6.js";import{o as ls,e as rs}from"./vendor-forms-ClCIacbh.js";import"./vendor-react-Bce9NwRC.js";import"./vendor-radix-BTiKGWfR.js";import"./vendor-recharts-BvvJP9Po.js";import"./vendor-date-wwuDAncJ.js";import"./use-quick-run-B4Xj-YQQ.js";import"./use-delete-confirmation-dialog-CUdii6Lo.js";import"./index-DlHOXQhu.js";import"./cronstrue-Bevg0uGw.js";import"./use-is-overflowing-CpSV4NPP.js";import"./index-CUVvZndW.js";import"./tags-input-DHrnkwjQ.js";import"./zod-Cuos7J7w.js";import"./form-mws4law8.js";import"./textarea-DUhh6-kq.js";import"./table-BBNGfPra.js";const os=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],is=je("circle-question-mark",os),he=({command:s,title:a,subtitle:t,className:n})=>{const[o,l]=c.useState(!1),r=async()=>{if(!o){l(!0);try{await navigator.clipboard.writeText(s),w.success("Command copied to clipboard")}catch{w.error("Failed to copy command")}finally{l(!1)}}};return e.jsxs("div",{className:x("space-y-4",n),children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-1",children:a}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t})]}),e.jsxs("div",{className:"bg-muted border border-border rounded-lg shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"bg-muted/80 border-b border-border px-3 py-2 flex items-center space-x-2",children:[e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"})]}),e.jsx(C,{variant:"ghost",size:"sm",onClick:r,disabled:o,className:"ml-auto text-muted-foreground hover:text-foreground hover:bg-muted h-6 w-6 p-0",children:e.jsx(R,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"bg-gray-800 dark:bg-gray-900 px-4 py-2",children:e.jsxs("p",{className:"py-1",children:[e.jsx("code",{className:"font-mono text-sm text-gray-300 select-all",children:s}),e.jsx("span",{className:"ml-1 -mb-1 inline-block w-[7px] h-[18px] bg-gray-400 terminal-cursor"})]})})]})]})},cs=({workPoolName:s,className:a})=>{const[t,n]=c.useState({pageIndex:0,pageSize:50}),[o,l]=c.useState("CREATED_DESC"),[r,i]=c.useState([]),d=c.useMemo(()=>({page:t.pageIndex+1,limit:t.pageSize,sort:o,work_pools:{operator:"and_",name:{any_:[s]}},deployments:{operator:"and_",flow_or_deployment_name:{like_:r.find(f=>f.id==="flowOrDeploymentName")?.value??""},tags:{operator:"and_",all_:r.find(f=>f.id==="tags")?.value??[]}}}),[s,t,o,r]),b=c.useMemo(()=>({offset:0,sort:"CREATED_DESC",work_pools:{operator:"and_",name:{any_:[s]}}}),[s]),{data:u}=k(fe(d)),{data:g}=k(be(b)),y=c.useMemo(()=>[...new Set((u?.results??[]).map(f=>f.flow_id))],[u?.results]),{data:v}=k(ee({flows:{operator:"and_",id:{any_:y}},offset:0,sort:"NAME_ASC"},{enabled:y.length>0})),j=c.useMemo(()=>{if(!u?.results)return[];const f=new Map(v?.map(S=>[S.id,S])??[]);return u.results.map(S=>({...S,flow:f.get(S.flow_id)}))},[u?.results,v]),N=c.useCallback(f=>{n(f)},[]),D=c.useCallback(f=>{l(f)},[]),F=c.useCallback(f=>{i(f)},[]);return!u||g===void 0?e.jsx("div",{className:a,children:e.jsx("div",{className:"text-muted-foreground text-center py-8",children:"Loading deployments..."})}):e.jsx("div",{className:a,children:e.jsx(Je,{deployments:j,currentDeploymentsCount:g,pageCount:u.pages,pagination:t,sort:o,columnFilters:r,onPaginationChange:N,onSortChange:D,onColumnFiltersChange:F})})},ds=s=>{switch(s){case"READY":return"Ready";case"PAUSED":return"Paused";case"NOT_READY":return"Not Ready"}},us=s=>{switch(s){case"READY":return"bg-green-500";case"PAUSED":return"bg-yellow-500";case"NOT_READY":return"bg-red-500"}},ms=({status:s,className:a})=>{const t=ds(s),n=us(s);return e.jsxs(Q,{variant:"secondary",className:x("flex items-center space-x-1",a),children:[s==="PAUSED"?e.jsx(we,{className:"h-2 w-2 text-muted-foreground"}):e.jsx("div",{className:x("h-2 w-2 rounded-full",n)}),e.jsx("span",{children:t})]})},M=()=>e.jsx("dd",{className:"text-muted-foreground text-sm",children:"None"}),hs=({children:s})=>e.jsx("dt",{className:"text-sm text-muted-foreground",children:s}),_=({children:s,className:a})=>e.jsx("dd",{className:x("text-sm",a),children:s});function xs({workPool:s}){const{data:a=[],isLoading:t}=k(se(s.name)),n=c.useMemo(()=>t||a.length===0?null:a.map(r=>r.last_heartbeat_time).filter(r=>!!r).sort((r,i)=>new Date(i).getTime()-new Date(r).getTime())[0]||null,[a,t]),o=[{field:"Status",ComponentValue:()=>e.jsx("dd",{children:e.jsx(ms,{status:s.status||"NOT_READY"})})},{field:"Description",ComponentValue:()=>s.description?e.jsx(_,{children:s.description}):null},{field:"Type",ComponentValue:()=>s.type?e.jsx(_,{children:Ne(s.type)}):e.jsx(M,{})},{field:"Concurrency Limit",ComponentValue:()=>e.jsx(_,{children:s.concurrency_limit?String(s.concurrency_limit):"Unlimited"})},{field:"Last Polled",ComponentValue:()=>n?e.jsx(_,{children:e.jsx(W,{date:n})}):a.length===0?null:e.jsx(_,{className:"text-muted-foreground",children:"No recent activity"})},{field:"Created",ComponentValue:()=>s.created?e.jsx(_,{children:e.jsx(W,{date:s.created})}):e.jsx(M,{})},{field:"Last Updated",ComponentValue:()=>s.updated?e.jsx(_,{children:e.jsx(W,{date:s.updated})}):e.jsx(M,{})}].filter(({ComponentValue:l})=>l()!==null);return t?e.jsx("div",{className:"text-muted-foreground text-sm",children:"Loading work pool details..."}):e.jsx("div",{children:e.jsx("ul",{className:"flex flex-col gap-3",children:o.map(({field:l,ComponentValue:r})=>e.jsx("li",{children:e.jsxs("dl",{children:[e.jsx(hs,{children:l}),e.jsx(r,{})]})},l))})})}function ps({workPool:s}){const a=s.base_job_template;if(!a?.variables||typeof a.variables!="object"||!("properties"in a.variables)||!a.variables.properties)return null;const t=a.variables.properties,n=(l,r)=>r.title||l.split("_").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" "),o=l=>l==null?"None":typeof l=="boolean"?l.toString():Array.isArray(l)?l.length>0?l.join(", "):"None":typeof l=="object"?JSON.stringify(l):String(l);return e.jsxs("div",{children:[e.jsx("h3",{className:"mb-4 text-md",children:"Base Job Configuration"}),e.jsx("ul",{className:"flex flex-col gap-3",children:Object.entries(t).map(([l,r])=>{const i=r.default??null;return e.jsxs("li",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{className:"text-muted-foreground font-medium",children:n(l,r)}),e.jsx("span",{className:"break-words",children:o(i)})]},l)})})]})}function U({workPool:s,alternate:a=!1,className:t}){const n=a?"space-y-4":"space-y-6";return e.jsxs("div",{className:x(n,t),children:[e.jsx(xs,{workPool:s}),!!(s.base_job_template?.variables&&typeof s.base_job_template.variables=="object"&&"properties"in s.base_job_template.variables&&s.base_job_template.variables.properties&&Object.keys(s.base_job_template.variables.properties).length>0)&&e.jsxs(e.Fragment,{children:[e.jsx(ye,{}),e.jsx(ps,{workPool:s})]})]})}const gs=({workPoolName:s,className:a})=>{const[t,n]=c.useState({limit:10,page:1}),[o,l]=c.useState(""),[r,i]=c.useState(new Set),d=ve(o,500),b=c.useMemo(()=>{const m={page:t.page,limit:t.limit,sort:"START_TIME_DESC",work_pools:{operator:"and_",name:{any_:[s]}}};if(d.trim()&&(m.flow_runs={operator:"and_",name:{like_:d.trim()}}),r.size>0){const p={state:{operator:"and_",name:{any_:Array.from(r)}}};m.flow_runs?m.flow_runs={...m.flow_runs,...p}:m.flow_runs={operator:"and_",...p}}return m},[s,t,d,r]),u=c.useMemo(()=>{const m={work_pools:{operator:"and_",name:{any_:[s]}}};if(d.trim()&&(m.flow_runs={operator:"and_",name:{like_:d.trim()}}),r.size>0){const p={state:{operator:"and_",name:{any_:Array.from(r)}}};m.flow_runs?m.flow_runs={...m.flow_runs,...p}:m.flow_runs={operator:"and_",...p}}return m},[s,d,r]),{data:g}=k(Ce(b)),{data:y}=k(ae(u)),v=c.useMemo(()=>[...new Set((g?.results??[]).map(m=>m.flow_id))],[g?.results]),{data:j}=k(ee({flows:{operator:"and_",id:{any_:v}},offset:0,sort:"NAME_ASC"},{enabled:v.length>0})),N=c.useMemo(()=>{if(!g?.results)return[];const m=new Map(j?.map(p=>[p.id,p])??[]);return g.results.map(p=>{const $=m.get(p.flow_id);return $?{...p,flow:$}:null}).filter(p=>p!==null)},[g?.results,j]),D=c.useCallback(m=>{l(m.target.value),n(p=>({...p,page:1}))},[]),F=c.useCallback(m=>{n(m)},[]),f=c.useCallback(m=>{i(m),n(p=>({...p,page:1}))},[]),S=c.useCallback(()=>{l(""),i(new Set),n(m=>({...m,page:1}))},[]);return!g||y===void 0?e.jsx("div",{className:a,children:e.jsx("div",{className:"text-muted-foreground text-center py-8",children:"Loading flow runs..."})}):e.jsxs("div",{className:a,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(ke,{placeholder:"Search flow runs by name...",value:o,onChange:D,debounceMs:500})}),e.jsx("div",{className:"w-full sm:w-64",children:e.jsx(Ge,{selectedFilters:r,onSelectFilter:f})})]}),e.jsx(Ze,{flowRuns:N,onClearFilters:N.length===0?S:void 0}),g.pages>1&&e.jsx("div",{className:"mt-6",children:e.jsx(Xe,{count:y,pages:g.pages,pagination:t,onChangePagination:F})})]})},js=({workPool:s,open:a,onOpenChange:t,onDeleted:n})=>{const o=I(),{deleteWorkPool:l,isPending:r}=Se(),i=()=>{l(s.name,{onSuccess:()=>{w.success("Work pool deleted successfully"),n?.(),o({to:"/work-pools"})},onError:()=>{w.error("Failed to delete work pool")}})};return e.jsx(ue,{isOpen:a,title:"Delete Work Pool",description:`Are you sure you want to delete the work pool "${s.name}"? This action cannot be undone.`,confirmText:s.name,isLoading:r,loadingText:"Deleting...",onConfirm:i,onClose:()=>t(!1)})},fs=s=>{const a=I(),[t,n]=c.useState(!1);return{menuItems:[{label:"Copy ID",icon:R,action:()=>{navigator.clipboard.writeText(s.id),w.success("ID copied to clipboard")},show:!0},{label:"Edit",icon:es,action:()=>{a({to:"/work-pools/work-pool/$workPoolName/edit",params:{workPoolName:s.name}})},show:!0},{label:"Delete",icon:te,action:()=>n(!0),show:!0,variant:"destructive"},{label:"Automate",icon:_e,action:()=>{a({to:"/automations/create"})},show:!0}].filter(d=>d.show),showDeleteDialog:t,setShowDeleteDialog:n,triggerIcon:De}},bs=({workPool:s,onUpdate:a,className:t})=>{const{menuItems:n,showDeleteDialog:o,setShowDeleteDialog:l,triggerIcon:r}=fs(s);return e.jsxs(e.Fragment,{children:[e.jsxs(oe,{children:[e.jsx(ie,{asChild:!0,children:e.jsxs(C,{variant:"outline",size:"icon",className:x("size-8",t),children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(r,{className:"size-4"})]})}),e.jsx(ce,{align:"end",children:n.map(i=>{const d=i.icon;return e.jsxs(de,{onClick:i.action,className:x(i.variant==="destructive"&&"text-destructive"),children:[e.jsx(d,{className:"mr-2 h-4 w-4"}),i.label]},i.label)})})]}),e.jsx(js,{workPool:s,open:o,onOpenChange:l,onDeleted:a})]})},ws=(s,a)=>{const{pauseWorkPool:t,isPending:n}=Te(),{resumeWorkPool:o,isPending:l}=We();return{handleToggle:c.useCallback(i=>{i?o(s.name,{onSuccess:()=>{w.success("Work pool resumed"),a?.()},onError:()=>{w.error("Failed to resume work pool")}}):t(s.name,{onSuccess:()=>{w.success("Work pool paused"),a?.()},onError:()=>{w.error("Failed to pause work pool")}})},[s.name,t,o,a]),isLoading:n||l}},ys=({workPool:s,onUpdate:a,className:t})=>{const{handleToggle:n,isLoading:o}=ws(s,a),l=s.status==="PAUSED";return e.jsxs(A,{children:[e.jsx(O,{asChild:!0,children:e.jsx("div",{children:e.jsx(Fe,{checked:!l,onCheckedChange:n,disabled:o,"aria-label":l?"Resume work pool":"Pause work pool",className:x(t)})})}),e.jsx(B,{children:e.jsx("p",{children:"Pause or resume this work pool"})})]})},Ns=({workPool:s,onUpdate:a,className:t})=>e.jsxs("header",{className:x("flex mb-4 flex-row items-center justify-between",t),children:[e.jsx(Ee,{className:t,children:e.jsxs(Me,{children:[e.jsx(z,{children:e.jsx(Pe,{to:"/work-pools",className:"text-xl font-semibold",children:"Work pools"})}),e.jsx(Ie,{}),e.jsx(z,{className:"text-xl font-semibold",children:e.jsx(Le,{children:s.name})})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ys,{workPool:s,onUpdate:a}),e.jsx(bs,{workPool:s,onUpdate:a})]})]}),vs=({lateRunsCount:s,className:a})=>s===0?null:e.jsx(ne,{children:e.jsxs(A,{children:[e.jsx(O,{children:e.jsxs(Q,{variant:"warning",className:x("flex items-center space-x-1",a),children:[e.jsx(Re,{className:"h-3 w-3"}),e.jsx("span",{children:s})]})}),e.jsx(B,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-semibold",children:"Late Flow Runs"}),e.jsxs("p",{className:"text-sm",children:[s," flow run",s===1?"":"s"," running late"]})]})})]})}),Cs=({queue:s})=>{const{data:a=0}=k(ae({work_pools:{operator:"and_",name:{any_:[s.work_pool_name||""]}},work_pool_queues:{operator:"and_",name:{any_:[s.name]}},flow_runs:{operator:"and_",state:{operator:"and_",name:{any_:["Late"]}}}},3e4));return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{to:"/work-pools/work-pool/$workPoolName/queue/$workQueueName",params:{workPoolName:s.work_pool_name||"",workQueueName:s.name},className:"font-medium text-blue-600 hover:text-blue-800",children:s.name}),e.jsx(vs,{lateRunsCount:a})]})},xe=({enableLateIndicator:s=!1}={})=>{const a=[];return a.push({accessorKey:"name",header:({column:t})=>e.jsx(C,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),className:"h-auto p-0 font-semibold",children:"Name"}),cell:({row:t})=>{const n=t.original;return s?e.jsx(Cs,{queue:n}):e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(J,{to:"/work-pools/work-pool/$workPoolName/queue/$workQueueName",params:{workPoolName:n.work_pool_name||"",workQueueName:n.name},className:"font-medium text-blue-600 hover:text-blue-800",children:n.name})})}}),a.push({accessorKey:"concurrency_limit",header:({column:t})=>e.jsx(C,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),className:"h-auto p-0 font-semibold",children:"Concurrency Limit"}),cell:({row:t})=>{const n=t.original.concurrency_limit;return n!=null?n.toString():"∞"}}),a.push({accessorKey:"priority",header:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(C,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),className:"h-auto p-0 font-semibold",children:"Priority"}),e.jsx(ne,{children:e.jsxs(A,{children:[e.jsx(O,{children:e.jsx(is,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(B,{children:e.jsx("p",{children:"Lower numbers have higher priority"})})]})})]}),cell:({row:t})=>t.original.priority}),a.push({accessorKey:"status",header:"Status",cell:({row:t})=>e.jsx(ss,{status:t.original.status||"READY"})}),a.push({id:"actions",header:"",cell:({row:t})=>e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(as,{queue:t.original}),e.jsx(ts,{queue:t.original})]}),enableSorting:!1}),a};xe();const ks=({hasSearchQuery:s,workPoolName:a})=>s?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(le,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No queues found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No queues match your search criteria. Try adjusting your search."})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center mb-4",children:e.jsx(P,{className:"h-6 w-6 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No queues yet"}),e.jsx("p",{className:"text-muted-foreground mb-4 max-w-md",children:"This work pool doesn't have any queues yet. Create your first queue to start organizing work."}),e.jsxs(C,{onClick:()=>{console.log("Create queue for pool:",a)},children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Create Queue"]})]}),Ss=({searchQuery:s,onSearchChange:a,resultsCount:t,totalCount:n,workPoolName:o,className:l})=>{const[r,i]=c.useState(!1),d=s.length>0;return e.jsxs("div",{className:x("space-y-4",l),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:s?`${t} of ${n} Work Queue${n!==1?"s":""}`:`${n} Work Queue${n!==1?"s":""}`}),e.jsx(C,{variant:"ghost",size:"sm",onClick:()=>i(!0),children:e.jsx(P,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx(C,{variant:"ghost",size:"sm",onClick:()=>a(""),children:"Clear filters"}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(re,{placeholder:"Search",value:s,onChange:b=>a(b.target.value),className:"pl-8 w-64"})]})]})]}),e.jsx(ns,{workPoolName:o,open:r,onOpenChange:i,onSubmit:()=>i(!1)})]})},_s=({queues:s,searchQuery:a,sortState:t,totalCount:n,workPoolName:o,className:l,onSearchChange:r,onSortingChange:i})=>{const d=c.useCallback(y=>{let v=t;typeof y=="function"?v=y(t):v=y,i(v)},[t,i]),b=xe({enableLateIndicator:!0}),u=G({data:s,columns:b,getCoreRowModel:X(),getSortedRowModel:Z(),state:{sorting:t},onSortingChange:d,initialState:{sorting:[{id:"name",desc:!1}]}}),g=s.length;return e.jsxs("div",{className:x("space-y-4",l),children:[e.jsx(Ss,{searchQuery:a,onSearchChange:r,resultsCount:g,totalCount:n,workPoolName:o}),g===0?e.jsx(ks,{hasSearchQuery:!!a,workPoolName:o}):e.jsx(me,{table:u})]})},Ds={ONLINE:{label:"Online",color:"bg-green-500"},OFFLINE:{label:"Offline",color:"bg-red-500"}},Ts=({status:s,className:a})=>{const t=Ds[s];return e.jsxs(Q,{variant:"secondary",className:x("flex items-center space-x-1",a),children:[e.jsx("div",{className:x("h-2 w-2 rounded-full",t.color)}),e.jsx("span",{children:t.label})]})},Ws=()=>[{accessorKey:"name",header:"Name",cell:({row:s})=>{const a=s.original;return e.jsx("span",{className:"font-medium",children:a.name})}},{accessorKey:"last_heartbeat_time",header:"Last Seen",cell:({row:s})=>{const a=s.original.last_heartbeat_time;return e.jsx(W,{date:a,format:"relative",showTooltip:!0})}},{accessorKey:"status",header:"Status",cell:({row:s})=>e.jsx(Ts,{status:s.original.status})}],Fs=({workPoolName:s,ActionsComponent:a})=>[...Ws(),{id:"actions",header:"",cell:({row:t})=>e.jsx(a,{worker:t.original,workPoolName:s}),enableSorting:!1,size:50,maxSize:50}],Es=({hasSearchQuery:s,workPoolName:a,className:t})=>s?e.jsxs(q,{children:[e.jsx(V,{id:"Search"}),e.jsx(K,{children:"No workers found"}),e.jsx(Y,{children:"No workers match your search criteria."})]}):e.jsx("div",{className:x("space-y-4",t),children:e.jsxs(q,{children:[e.jsx(V,{id:"Bot"}),e.jsx(K,{children:"No workers running"}),e.jsxs(Y,{children:["No workers are currently running for the “",a,"” work pool."]}),e.jsx(Qe,{children:e.jsx(he,{command:`prefect worker start --pool "${a}"`,title:"Start a worker",subtitle:"Run this command to start a worker for this pool"})})]})}),Ms=({worker:s,workPoolName:a,open:t,onOpenChange:n,onDeleted:o})=>{const{deleteWorker:l,isPending:r}=Ae(),i=()=>{l({workPoolName:a,workerName:s.name},{onSuccess:()=>{w.success("Worker deleted successfully"),o?.(),n(!1)},onError:()=>{w.error("Failed to delete worker")}})};return e.jsx(ue,{isOpen:t,title:"Delete Worker",description:`Are you sure you want to delete the worker "${s.name}"? This action cannot be undone.`,confirmText:s.name,isLoading:r,loadingText:"Deleting...",onConfirm:i,onClose:()=>n(!1)})},Ps=s=>{const[a,t]=c.useState(!1);return{menuItems:[{label:"Copy ID",icon:R,action:()=>{navigator.clipboard.writeText(s.id),w.success("ID copied to clipboard")},show:!0},{label:"Delete",icon:te,action:()=>t(!0),show:!0,variant:"destructive"}].filter(l=>l.show),showDeleteDialog:a,setShowDeleteDialog:t,triggerIcon:Oe}},Is=({worker:s,workPoolName:a,onWorkerDeleted:t,className:n})=>{const{menuItems:o,showDeleteDialog:l,setShowDeleteDialog:r,triggerIcon:i}=Ps(s);return e.jsxs(e.Fragment,{children:[e.jsxs(oe,{children:[e.jsx(ie,{asChild:!0,children:e.jsxs(C,{variant:"ghost",size:"icon",className:x("h-8 w-8",n),children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(i,{className:"h-4 w-4"})]})}),e.jsx(ce,{align:"end",children:o.map(d=>{const b=d.icon;return e.jsxs(de,{onClick:d.action,className:x(d.variant==="destructive"&&"text-destructive"),children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),d.label]},d.label)})})]}),e.jsx(Ms,{worker:s,workPoolName:a,open:l,onOpenChange:r,onDeleted:t})]})},Ls=({worker:s,workPoolName:a})=>e.jsx(Is,{worker:s,workPoolName:a}),H=({searchQuery:s,onSearchChange:a,resultsCount:t,totalCount:n,className:o})=>{const l=s.length>0;return e.jsxs("div",{className:x("flex items-center justify-between",o),children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:s?`${t} of ${n} workers`:`${n} workers`}),e.jsxs("div",{className:"flex items-center space-x-2",children:[l&&e.jsx(C,{variant:"ghost",size:"sm",onClick:()=>a(""),children:"Clear filters"}),e.jsx(re,{placeholder:"Search workers...",value:s,onChange:r=>a(r.target.value),className:"w-64"})]})]})},Rs=({workPoolName:s,workers:a,pagination:t,columnFilters:n,onPaginationChange:o,onColumnFiltersChange:l,className:r})=>{const i=n.find(j=>j.id==="name")?.value??"",d=c.useCallback(j=>{const N=n.filter(D=>D.id!=="name");l(j?[...N,{id:"name",value:j}]:N)},[l,n]),b=c.useCallback(j=>{let N=t;typeof j=="function"?N=j(t):N=j,o(N)},[t,o]),u=c.useMemo(()=>i?a.filter(j=>j.name.toLowerCase().includes(i.toLowerCase())):a,[a,i]),g=c.useMemo(()=>Fs({workPoolName:s,ActionsComponent:Ls}),[s]),y=G({data:u,columns:g,getCoreRowModel:X(),getSortedRowModel:Z(),getPaginationRowModel:pe(),manualPagination:!1,state:{pagination:t},onPaginationChange:b,initialState:{sorting:[{id:"name",desc:!1}]}});return a.length===0||i&&u.length===0?e.jsxs("div",{className:x("space-y-4",r),children:[e.jsx(H,{searchQuery:i,onSearchChange:d,resultsCount:u.length,totalCount:a.length}),e.jsx(Es,{hasSearchQuery:i.length>0,workPoolName:s})]}):e.jsxs("div",{className:x("space-y-4",r),children:[e.jsx(H,{searchQuery:i,onSearchChange:d,resultsCount:u.length,totalCount:a.length}),e.jsx(me,{table:y})]})};ls({tab:rs(["Details","Runs","Work Queues","Workers","Deployments"]).default("Runs")});const Qs=({workPoolName:s})=>{const[a,t]=c.useState(""),[n,o]=c.useState([]),{data:l}=L(He(s)),r=c.useMemo(()=>a?l.filter(i=>i.name.toLowerCase().includes(a.toLowerCase())):l,[l,a]);return e.jsx(_s,{queues:r,searchQuery:a,sortState:n,totalCount:l.length,workPoolName:s,onSearchChange:t,onSortingChange:o})},As=({workPoolName:s})=>{const[a,t]=c.useState({pageIndex:0,pageSize:10}),[n,o]=c.useState([]),{data:l}=L(se(s));return e.jsx(Rs,{workPoolName:s,workers:l,pagination:a,columnFilters:n,onPaginationChange:t,onColumnFiltersChange:o})};function da(){const{workPoolName:s}=E.useParams(),{tab:a}=E.useSearch(),t=I({from:E.fullPath}),n=ge(),{data:o}=L(Be(s)),l=o.status!=="READY",r=`prefect worker start --pool "${o.name}"`,i=c.useMemo(()=>[{id:"Details",label:"Details",hidden:!1,hiddenOnDesktop:!0},{id:"Runs",label:"Runs",hidden:!1,hiddenOnDesktop:!1},{id:"Work Queues",label:"Work Queues",hidden:!1,hiddenOnDesktop:!1},{id:"Workers",label:"Workers",hiddenOnDesktop:!1},{id:"Deployments",label:"Deployments",hidden:!1,hiddenOnDesktop:!1}].filter(u=>!u.hidden),[]),d=c.useCallback(u=>{t({search:{tab:u}})},[t]),b=c.useCallback(()=>{n.invalidateQueries({queryKey:$e.detailByName(s)})},[n,s]);return e.jsx(ze,{children:e.jsxs(qe,{children:[e.jsxs(Ve,{children:[e.jsx(Ns,{workPool:o,onUpdate:b}),l&&e.jsx("div",{className:"w-full bg-muted/50 py-6 px-4 rounded-lg mb-6",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(he,{command:r,title:"Your work pool is almost ready!",subtitle:"Run this command to start.",className:"py-0"})})})]}),e.jsxs("div",{className:"flex flex-col xl:flex-row xl:gap-8",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(Ke,{value:a,onValueChange:d,children:[e.jsx(Ye,{className:"flex w-full overflow-x-auto scrollbar-none",children:i.map(u=>e.jsx(Ue,{value:u.id,className:x("whitespace-nowrap flex-shrink-0",u.hiddenOnDesktop?"xl:hidden":""),children:u.label},u.id))}),e.jsx(T,{value:"Details",className:"space-y-0",children:e.jsx(c.Suspense,{fallback:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(h,{className:"h-4 w-48"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"h-3 w-16"}),e.jsx(h,{className:"h-6 w-24"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"h-3 w-20"}),e.jsx(h,{className:"h-6 w-32"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"h-3 w-24"}),e.jsx(h,{className:"h-6 w-28"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"h-3 w-18"}),e.jsx(h,{className:"h-6 w-36"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(h,{className:"h-5 w-40"}),e.jsx("div",{className:"space-y-2",children:e.jsx(h,{className:"h-32 w-full"})})]})]}),children:e.jsx(U,{workPool:o})})}),e.jsx(T,{value:"Runs",children:e.jsx(c.Suspense,{fallback:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(h,{className:"h-24 w-full"}),e.jsx(h,{className:"h-24 w-full"}),e.jsx(h,{className:"h-24 w-full"})]}),children:e.jsx(gs,{workPoolName:s})})}),e.jsx(T,{value:"Work Queues",className:"space-y-0",children:e.jsx(c.Suspense,{fallback:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-6 w-24"}),e.jsx(h,{className:"h-6 w-8"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(h,{className:"h-6 w-64"})})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(h,{className:"h-34 w-full"})})]}),children:e.jsx(Qs,{workPoolName:s})})}),e.jsx(T,{value:"Workers",className:"space-y-0",children:e.jsx(c.Suspense,{fallback:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{className:"h-4 w-20"}),e.jsx(h,{className:"h-9 w-64"})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(h,{className:"h-34 w-full"})})]}),children:e.jsx(As,{workPoolName:s})})}),e.jsx(T,{value:"Deployments",className:"space-y-0",children:e.jsx(c.Suspense,{fallback:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{className:"h-4 w-20"}),e.jsx(h,{className:"h-9 w-64"})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(h,{className:"h-34 w-full"})})]}),children:e.jsx(cs,{workPoolName:s})})})]})}),e.jsx("aside",{className:"w-full xl:w-80 xl:shrink-0 hidden xl:block",children:e.jsx("div",{className:"sticky top-8",children:e.jsx(U,{workPool:o,alternate:!0})})})]})]})})}export{da as component};
//# sourceMappingURL=work-pool._workPoolName-B_NFWXKS.js.map
