{"version":3,"file":"login-D5uepl9L.js","sources":["../../src/components/ui/prefect-logo.tsx","../../src/components/auth/login-page.tsx","../../src/routes/login.tsx?tsr-split=component"],"sourcesContent":["interface PrefectLogoProps {\n\tclassName?: string;\n}\n\nexport function PrefectLogo({ className = \"size-11\" }: PrefectLogoProps) {\n\treturn (\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\tfill=\"none\"\n\t\t\tviewBox=\"0 0 76 76\"\n\t\t\tclassName={className}\n\t\t\taria-label=\"Prefect Logo\"\n\t\t>\n\t\t\t<title>Prefect Logo</title>\n\t\t\t<path\n\t\t\t\tfill=\"currentColor\"\n\t\t\t\tfillRule=\"evenodd\"\n\t\t\t\td=\"M15.89 15.07 38 26.543v22.935l22.104-11.47.007.004V15.068l-.003.001L38 3.598z\"\n\t\t\t\tclipRule=\"evenodd\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\tfill=\"currentColor\"\n\t\t\t\tfillRule=\"evenodd\"\n\t\t\t\td=\"M15.89 15.07 38 26.543v22.935l22.104-11.47.007.004V15.068l-.003.001L38 3.598z\"\n\t\t\t\tclipRule=\"evenodd\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\tfill=\"currentColor\"\n\t\t\t\tfillRule=\"evenodd\"\n\t\t\t\td=\"M37.987 49.464 15.89 38v22.944l.013-.006L38 72.402V49.457z\"\n\t\t\t\tclipRule=\"evenodd\"\n\t\t\t/>\n\t\t</svg>\n\t);\n}\n","import { useNavigate } from \"@tanstack/react-router\";\nimport { type FormEvent, useState } from \"react\";\nimport { useAuth } from \"@/auth\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { PrefectLogo } from \"@/components/ui/prefect-logo\";\n\ninterface LoginPageProps {\n\tredirectTo?: string;\n}\n\nexport function LoginPage({ redirectTo = \"/dashboard\" }: LoginPageProps) {\n\tconst [password, setPassword] = useState(\"\");\n\tconst [error, setError] = useState(\"\");\n\tconst [isSubmitting, setIsSubmitting] = useState(false);\n\tconst { login } = useAuth();\n\tconst navigate = useNavigate();\n\n\tconst handleSubmit = (e: FormEvent) => {\n\t\te.preventDefault();\n\t\tif (isSubmitting || !password.trim()) return;\n\n\t\tsetIsSubmitting(true);\n\t\tsetError(\"\");\n\n\t\tvoid login(password).then((result) => {\n\t\t\tif (result.success) {\n\t\t\t\tvoid navigate({ to: redirectTo });\n\t\t\t} else {\n\t\t\t\tsetError(result.error ?? \"Authentication failed\");\n\t\t\t\tsetIsSubmitting(false);\n\t\t\t}\n\t\t});\n\t};\n\n\treturn (\n\t\t<div className=\"flex items-center justify-center min-h-screen\">\n\t\t\t<Card className=\"w-full max-w-[400px]\">\n\t\t\t\t<CardHeader className=\"flex flex-col items-center gap-4\">\n\t\t\t\t\t<PrefectLogo className=\"size-16\" />\n\t\t\t\t\t<CardTitle>Login</CardTitle>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent>\n\t\t\t\t\t<form onSubmit={handleSubmit} className=\"flex flex-col gap-4\">\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\tplaceholder=\"admin:pass\"\n\t\t\t\t\t\t\tvalue={password}\n\t\t\t\t\t\t\tonChange={(e) => setPassword(e.target.value)}\n\t\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\t\tdisabled={isSubmitting}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{error && <p className=\"text-sm text-destructive\">{error}</p>}\n\t\t\t\t\t\t<Button type=\"submit\" disabled={isSubmitting} className=\"w-full\">\n\t\t\t\t\t\t\t{isSubmitting ? \"Logging in...\" : \"Login\"}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</form>\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\t\t</div>\n\t);\n}\n","import { createFileRoute, Navigate, redirect } from \"@tanstack/react-router\";\nimport { zodValidator } from \"@tanstack/zod-adapter\";\nimport { z } from \"zod\";\nimport { useAuthSafe } from \"@/auth\";\nimport { LoginPage } from \"@/components/auth/login-page\";\nimport { PrefectLoading } from \"@/components/ui/loading\";\n\nconst loginSearchSchema = z.object({\n\tredirectTo: z.string().optional(),\n});\n\nexport const Route = createFileRoute(\"/login\")({\n\tvalidateSearch: zodValidator(loginSearchSchema),\n\tbeforeLoad: ({ context, search }) => {\n\t\t// If already authenticated, redirect away from login page\n\t\tif (!context.auth.isLoading && context.auth.isAuthenticated) {\n\t\t\tredirect({ to: search.redirectTo ?? \"/dashboard\", throw: true });\n\t\t}\n\t},\n\tcomponent: LoginRouteComponent,\n});\n\nfunction LoginRouteComponent() {\n\tconst { redirectTo } = Route.useSearch();\n\tconst auth = useAuthSafe();\n\n\t// If auth context is not available (e.g., in tests), just render the login page\n\tif (!auth) {\n\t\treturn <LoginPage redirectTo={redirectTo} />;\n\t}\n\n\t// Show loading state while auth is initializing\n\tif (auth.isLoading) {\n\t\treturn <PrefectLoading />;\n\t}\n\n\t// Redirect to dashboard if already authenticated\n\t// (This handles the case where beforeLoad didn't catch it due to loading state)\n\tif (auth.isAuthenticated) {\n\t\treturn <Navigate to={redirectTo ?? \"/dashboard\"} replace={true} />;\n\t}\n\n\treturn <LoginPage redirectTo={redirectTo} />;\n}\n"],"names":["PrefectLogo","className","jsxs","jsx","LoginPage","redirectTo","password","setPassword","useState","error","setError","isSubmitting","setIsSubmitting","login","useAuth","navigate","useNavigate","handleSubmit","e","result","Card","CardHeader","CardTitle","CardContent","Input","Button","LoginRouteComponent","Route","useSearch","auth","useAuthSafe","isLoading","PrefectLoading","isAuthenticated","Navigate"],"mappings":"+VAIO,SAASA,EAAY,CAAE,UAAAC,EAAY,WAA+B,CACxE,OACCC,EAAAA,KAAC,MAAA,CACA,MAAM,6BACN,KAAK,OACL,QAAQ,YACR,UAAAD,EACA,aAAW,eAEX,SAAA,CAAAE,EAAAA,IAAC,SAAM,SAAA,cAAA,CAAY,EACnBA,EAAAA,IAAC,OAAA,CACA,KAAK,eACL,SAAS,UACT,EAAE,gFACF,SAAS,SAAA,CAAA,EAEVA,EAAAA,IAAC,OAAA,CACA,KAAK,eACL,SAAS,UACT,EAAE,gFACF,SAAS,SAAA,CAAA,EAEVA,EAAAA,IAAC,OAAA,CACA,KAAK,eACL,SAAS,UACT,EAAE,6DACF,SAAS,SAAA,CAAA,CACV,CAAA,CAAA,CAGH,CCtBO,SAASC,EAAU,CAAE,WAAAC,EAAa,cAAgC,CACxE,KAAM,CAACC,EAAUC,CAAW,EAAIC,EAAAA,SAAS,EAAE,EACrC,CAACC,EAAOC,CAAQ,EAAIF,EAAAA,SAAS,EAAE,EAC/B,CAACG,EAAcC,CAAe,EAAIJ,EAAAA,SAAS,EAAK,EAChD,CAAE,MAAAK,CAAA,EAAUC,EAAA,EACZC,EAAWC,EAAA,EAEXC,EAAgBC,GAAiB,CACtCA,EAAE,eAAA,EACE,EAAAP,GAAgB,CAACL,EAAS,UAE9BM,EAAgB,EAAI,EACpBF,EAAS,EAAE,EAENG,EAAMP,CAAQ,EAAE,KAAMa,GAAW,CACjCA,EAAO,QACLJ,EAAS,CAAE,GAAIV,EAAY,GAEhCK,EAASS,EAAO,OAAS,uBAAuB,EAChDP,EAAgB,EAAK,EAEvB,CAAC,EACF,EAEA,aACE,MAAA,CAAI,UAAU,gDACd,SAAAV,EAAAA,KAACkB,EAAA,CAAK,UAAU,uBACf,SAAA,CAAAlB,EAAAA,KAACmB,EAAA,CAAW,UAAU,mCACrB,SAAA,CAAAlB,EAAAA,IAACH,EAAA,CAAY,UAAU,SAAA,CAAU,EACjCG,EAAAA,IAACmB,GAAU,SAAA,OAAA,CAAK,CAAA,EACjB,QACCC,EAAA,CACA,SAAArB,OAAC,QAAK,SAAUe,EAAc,UAAU,sBACvC,SAAA,CAAAd,EAAAA,IAACqB,EAAA,CACA,KAAK,WACL,YAAY,aACZ,MAAOlB,EACP,SAAWY,GAAMX,EAAYW,EAAE,OAAO,KAAK,EAC3C,UAAS,GACT,SAAUP,CAAA,CAAA,EAEVF,GAASN,EAAAA,IAAC,IAAA,CAAE,UAAU,2BAA4B,SAAAM,EAAM,EACzDN,EAAAA,IAACsB,EAAA,CAAO,KAAK,SAAS,SAAUd,EAAc,UAAU,SACtD,SAAAA,EAAe,gBAAkB,OAAA,CACnC,CAAA,CAAA,CACD,CAAA,CACD,CAAA,CAAA,CACD,CAAA,CACD,CAEF,CCxCA,SAASe,GAAsB,CAC9B,KAAM,CAAErB,WAAAA,CAAAA,EAAesB,EAAMC,UAAAA,EACvBC,EAAOC,EAAAA,EAGb,OAAKD,EAKDA,EAAKE,gBACAC,EAAA,EAAc,EAKnBH,EAAKI,sBACAC,EAAA,CAAS,GAAI7B,GAAc,aAAc,QAAS,GAAK,EAGzDF,MAACC,GAAU,WAAAC,EAAuB,EAdjCF,MAACC,GAAU,WAAAC,EAAuB,CAe3C"}