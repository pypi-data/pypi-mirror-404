{"version":3,"file":"deployment._id-CWgTYmTG.js","sources":["../../src/routes/deployments/deployment.$id.tsx?tsr-split=errorComponent"],"sourcesContent":["import type { ErrorComponentProps } from \"@tanstack/react-router\";\nimport { createFileRoute } from \"@tanstack/react-router\";\nimport { zodValidator } from \"@tanstack/zod-adapter\";\nimport { z } from \"zod\";\nimport { buildListAutomationsRelatedQuery } from \"@/api/automations/automations\";\nimport { buildDeploymentDetailsQuery } from \"@/api/deployments\";\nimport { categorizeError } from \"@/api/error-utils\";\nimport { buildFLowDetailsQuery } from \"@/api/flows\";\nimport { buildWorkQueueDetailsQuery } from \"@/api/work-queues\";\nimport { DeploymentDetailsPage } from \"@/components/deployments/deployment-details-page\";\nimport {\n\tFLOW_RUN_STATES,\n\tFLOW_RUN_STATES_NO_SCHEDULED,\n\tSORT_FILTERS,\n} from \"@/components/flow-runs/flow-runs-list\";\nimport { RouteErrorState } from \"@/components/ui/route-error-state\";\n\n/**\n * Schema for validating URL search parameters for the Deployment Details page\n * @property {\"Runs\" | \"Upcoming\" | \"Parameters\" | \"Configuration\" | \"Description\"} tab used designate which tab view to display\n */\nconst searchParams = z.object({\n\ttab: z\n\t\t.enum([\"Runs\", \"Upcoming\", \"Parameters\", \"Configuration\", \"Description\"])\n\t\t.default(\"Runs\"),\n\truns: z\n\t\t.object({\n\t\t\tflowRuns: z\n\t\t\t\t.object({\n\t\t\t\t\tname: z.string().optional(),\n\t\t\t\t\tstate: z\n\t\t\t\t\t\t.array(z.enum(FLOW_RUN_STATES))\n\t\t\t\t\t\t.optional()\n\t\t\t\t\t\t.default(FLOW_RUN_STATES_NO_SCHEDULED)\n\t\t\t\t\t\t.catch(FLOW_RUN_STATES_NO_SCHEDULED),\n\t\t\t\t})\n\t\t\t\t.optional(),\n\t\t\tpage: z.number().int().positive().optional().default(1).catch(1),\n\t\t\tlimit: z.number().int().positive().optional().default(10).catch(10),\n\t\t\tsort: z\n\t\t\t\t.enum(SORT_FILTERS)\n\t\t\t\t.optional()\n\t\t\t\t.default(\"START_TIME_DESC\")\n\t\t\t\t.catch(\"START_TIME_DESC\"),\n\t\t})\n\t\t.optional(),\n\tupcoming: z\n\t\t.object({\n\t\t\tflowRuns: z\n\t\t\t\t.object({\n\t\t\t\t\tname: z.string().optional(),\n\t\t\t\t\tstate: z\n\t\t\t\t\t\t.array(z.enum(FLOW_RUN_STATES))\n\t\t\t\t\t\t.optional()\n\t\t\t\t\t\t.default([\"Scheduled\"])\n\t\t\t\t\t\t.catch([\"Scheduled\"]),\n\t\t\t\t})\n\t\t\t\t.optional(),\n\t\t\tpage: z.number().int().positive().optional().default(1).catch(1),\n\t\t\tlimit: z.number().int().positive().optional().default(5).catch(5),\n\t\t\tsort: z\n\t\t\t\t.enum(SORT_FILTERS)\n\t\t\t\t.optional()\n\t\t\t\t.default(\"START_TIME_ASC\")\n\t\t\t\t.catch(\"START_TIME_ASC\"),\n\t\t})\n\t\t.optional(),\n});\n\nexport type DeploymentDetailsTabOptions = z.infer<typeof searchParams>[\"tab\"];\n\nfunction DeploymentErrorComponent({ error, reset }: ErrorComponentProps) {\n\tconst serverError = categorizeError(error, \"Failed to load deployment\");\n\treturn (\n\t\t<div className=\"flex flex-col gap-4\">\n\t\t\t<div>\n\t\t\t\t<h1 className=\"text-2xl font-semibold\">Deployment</h1>\n\t\t\t</div>\n\t\t\t<RouteErrorState error={serverError} onRetry={reset} />\n\t\t</div>\n\t);\n}\n\nexport const Route = createFileRoute(\"/deployments/deployment/$id\")({\n\tvalidateSearch: zodValidator(searchParams),\n\tcomponent: RouteComponent,\n\tloader: async ({ params, context: { queryClient } }) => {\n\t\t// ----- Critical data\n\t\tconst res = await queryClient.ensureQueryData(\n\t\t\tbuildDeploymentDetailsQuery(params.id),\n\t\t);\n\n\t\t// ----- Deferred data\n\t\tvoid queryClient.prefetchQuery(\n\t\t\tbuildListAutomationsRelatedQuery(`prefect.deployment.${params.id}`),\n\t\t);\n\n\t\tvoid queryClient.prefetchQuery(buildFLowDetailsQuery(res.flow_id));\n\n\t\tif (res.work_pool_name && res.work_queue_name) {\n\t\t\tvoid queryClient.prefetchQuery(\n\t\t\t\tbuildWorkQueueDetailsQuery(res.work_pool_name, res.work_queue_name),\n\t\t\t);\n\t\t}\n\t},\n\twrapInSuspense: true,\n\terrorComponent: DeploymentErrorComponent,\n});\n\nfunction RouteComponent() {\n\tconst { id } = Route.useParams();\n\treturn <DeploymentDetailsPage id={id} />;\n}\n"],"names":["z","tab","default","runs","flowRuns","name","string","optional","state","FLOW_RUN_STATES","FLOW_RUN_STATES_NO_SCHEDULED","catch","page","number","int","positive","limit","sort","SORT_FILTERS","upcoming","DeploymentErrorComponent","error","reset","serverError","categorizeError","jsxs","jsx","RouteErrorState"],"mappings":"+XAqBqBA,EAAS,CAC7BC,IAAKD,EACE,CAAC,OAAQ,WAAY,aAAc,gBAAiB,aAAa,CAAC,EACvEE,QAAQ,MAAM,EAChBC,KAAMH,EACG,CACPI,SAAUJ,EACD,CACPK,KAAML,EAAEM,EAASC,SAAAA,EACjBC,MAAOR,EACCA,EAAOS,CAAe,CAAC,EAC7BF,SAAAA,EACAL,QAAQQ,CAA4B,EACpCC,MAAMD,CAA4B,CAAA,CACpC,EACAH,SAAAA,EACFK,KAAMZ,EAAEa,EAASC,MAAMC,SAAAA,EAAWR,SAAAA,EAAWL,QAAQ,CAAC,EAAES,MAAM,CAAC,EAC/DK,MAAOhB,EAAEa,EAASC,MAAMC,SAAAA,EAAWR,SAAAA,EAAWL,QAAQ,EAAE,EAAES,MAAM,EAAE,EAClEM,KAAMjB,EACCkB,CAAY,EACjBX,SAAAA,EACAL,QAAQ,iBAAiB,EACzBS,MAAM,iBAAiB,CAAA,CACzB,EACAJ,SAAAA,EACFY,SAAUnB,EACD,CACPI,SAAUJ,EACD,CACPK,KAAML,EAAEM,EAASC,SAAAA,EACjBC,MAAOR,EACCA,EAAOS,CAAe,CAAC,EAC7BF,SAAAA,EACAL,QAAQ,CAAC,WAAW,CAAC,EACrBS,MAAM,CAAC,WAAW,CAAC,CAAA,CACrB,EACAJ,SAAAA,EACFK,KAAMZ,EAAEa,EAASC,MAAMC,SAAAA,EAAWR,SAAAA,EAAWL,QAAQ,CAAC,EAAES,MAAM,CAAC,EAC/DK,MAAOhB,EAAEa,EAASC,MAAMC,SAAAA,EAAWR,SAAAA,EAAWL,QAAQ,CAAC,EAAES,MAAM,CAAC,EAChEM,KAAMjB,EACCkB,CAAY,EACjBX,SAAAA,EACAL,QAAQ,gBAAgB,EACxBS,MAAM,gBAAgB,CAAA,CACxB,EACAJ,SAAAA,CACH,CAAC,EAID,SAASa,EAAyB,CAAEC,MAAAA,EAAOC,MAAAA,CAA2B,EAAG,CACxE,MAAMC,EAAcC,EAAgBH,EAAO,2BAA2B,EACtE,OACCI,EAAAA,KAAC,MAAA,CAAI,UAAU,sBACd,SAAA,CAAAC,EAAAA,IAAC,OACA,SAAAA,EAAAA,IAAC,KAAA,CAAG,UAAU,yBAAyB,sBAAU,CAAA,CAClD,EACAA,EAAAA,IAACC,EAAA,CAAgB,MAAOJ,EAAa,QAASD,CAAAA,CAAM,CAAA,EACrD,CAEF"}