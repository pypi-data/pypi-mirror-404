import{bL as y,a_ as k,H as C,cE as N,a2 as S,a3 as w,a4 as I,a5 as D,i as v,au as E,p as R,a7 as L,q as b}from"./index-B8vo2Lrg.js";import{r as n,J as A,j as e}from"./vendor-tanstack-BcZfOOfy.js";import{I as B,Z as j}from"./vendor-date-wwuDAncJ.js";import{S as M}from"./index-D6ynV6U7.js";const O=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 9H3",key:"1338ky"}],["path",{d:"M21 15H3",key:"9uk58r"}]],W=y("rows-3",O),q=({logs:t,taskRun:s,onBottomReached:r,virtualize:o=!0,className:d})=>{const u=n.useRef(null),l=n.useRef(t);l.current=t;const g=n.useCallback(a=>l.current[a]?.id??a,[]),c=A({count:t.length,getScrollElement:()=>u.current,estimateSize:()=>90,overscan:5,getItemKey:g}),h=n.useCallback(a=>{a&&c.measureElement(a)},[c]),f=o?c.getVirtualItems():Array.from({length:t.length},(a,i)=>({index:i,size:90,start:i*90})),m=f.at(-1)?.index;n.useEffect(()=>{m!==void 0&&m>=t.length-1&&r()},[t.length,m,r]);const x=a=>{if(a===0)return!0;const i=t[a-1],p=t[a];return!B(i.timestamp,p.timestamp)};return t.length===0?e.jsx("div",{className:"flex flex-col gap-2 bg-muted p-2 rounded-md font-mono",children:e.jsx("span",{className:"text-muted-foreground",children:"No logs found"})}):e.jsx("div",{ref:u,className:k("bg-muted rounded-md font-mono p-4 overflow-y-auto",d),role:"log",children:e.jsx("ol",{className:"relative",style:{height:`${c.getTotalSize()}px`},children:f.map(a=>{const i=t[a.index],p=x(a.index);return e.jsxs("li",{"data-index":a.index,ref:h,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${a.start}px)`},children:[p&&e.jsx(V,{date:new Date(i.timestamp)}),e.jsx(F,{log:i,taskRunName:s?.name})]},i.id)})})})},F=({log:t,taskRunName:s})=>e.jsxs("div",{className:"grid grid-cols-[84px_minmax(0,1fr)_150px] gap-2 text-sm py-2",children:[e.jsx("div",{children:e.jsx(z,{level:t.level})}),e.jsx("div",{className:"select-auto whitespace-pre-wrap break-words",children:t.message}),e.jsxs("div",{className:"text-xs grid grid-cols-1 gap-1 justify-items-end text-muted-foreground truncate",children:[e.jsx("span",{children:j(t.timestamp,"pp")}),s&&e.jsx("span",{children:s}),e.jsx("span",{className:"font-bold break-all whitespace-normal",children:t.name})]})]}),_=N("gap-1",{variants:{level:{CRITICAL:"bg-red-600 text-red-50 hover:bg-red-600",ERROR:"bg-red-600 text-red-50 hover:bg-red-600",WARNING:"bg-orange-600 text-orange-50 hover:bg-orange-600",INFO:"bg-sky-600 text-blue-50 hover:bg-sky-600",DEBUG:"bg-gray-700 text-gray-50 hover:bg-gray-700",CUSTOM:"bg-gray-700 text-gray-50 hover:bg-gray-700"}}}),z=({level:t})=>{const s=U(t);return e.jsx(C,{className:_({level:s}),children:s})};function U(t){const[s]=t.toString();switch(s){case"5":return"CRITICAL";case"4":return"ERROR";case"3":return"WARNING";case"2":return"INFO";case"1":return"DEBUG";default:return"CUSTOM"}}const V=({date:t})=>e.jsxs("div",{className:"flex flex-row justify-center items-center gap-2",children:[e.jsx("div",{className:"h-[1px] w-full bg-muted-foreground/30"}),e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:j(t,"MMM d, yyyy")}),e.jsx("div",{className:"h-[1px] w-full bg-muted-foreground/30"})]}),J=({open:t,onOpenChange:s,currentState:r,label:o,onConfirm:d,isLoading:u=!1})=>{const[l,g]=n.useState(void 0),[c,h]=n.useState("");n.useEffect(()=>{t||(g(void 0),h(""))},[t]);const f=()=>{l&&d({type:l,message:c||void 0})},m=!l||u;return e.jsx(S,{open:t,onOpenChange:s,children:e.jsxs(w,{"aria-describedby":void 0,children:[e.jsx(I,{children:e.jsxs(D,{children:["Change ",o," State"]})}),e.jsxs("div",{className:"space-y-4",children:[r&&e.jsxs("div",{children:[e.jsx(v,{className:"mb-2 block",children:"Current State"}),e.jsx(E,{type:r.type,name:r.name})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"desired-state",className:"mb-2 block",children:"Desired State"}),e.jsx(M,{value:l,onValueChange:g,terminalOnly:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"message",className:"mb-2 block",children:"Reason (Optional)"}),e.jsx(R,{id:"message",value:c,onChange:x=>h(x.target.value),placeholder:"State changed manually via UI"})]})]}),e.jsxs(L,{children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>s(!1),disabled:u,children:"Close"}),e.jsx(b,{type:"button",onClick:f,disabled:m,loading:u,children:"Change"})]})]})})},K=()=>{const[t,s]=n.useState(!1),r=n.useCallback(()=>s(!0),[]),o=n.useCallback(()=>s(!1),[]);return{open:t,onOpenChange:s,openDialog:r,closeDialog:o}};function G(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":window.matchMedia("(prefers-color-scheme: light)").matches?"light":"no-preference"}function Y(t){n.useEffect(()=>{const s=G(),r=s==="dark"?document.getElementById("favicon-16-dark"):document.getElementById("favicon-16"),o=s==="dark"?document.getElementById("favicon-32-dark"):document.getElementById("favicon-32");if(t){const d=`/${t.toLowerCase()}.svg`;r?.setAttribute("href",d),o?.setAttribute("href",d)}return()=>{s==="dark"?(r?.setAttribute("href","/favicon-16x16-dark.png"),o?.setAttribute("href","/favicon-32x32-dark.png")):(r?.setAttribute("href","/favicon-16x16.png"),o?.setAttribute("href","/favicon-32x32.png"))}},[t])}export{J as C,W as R,q as a,K as b,Y as u};
//# sourceMappingURL=use-state-favicon-au2TZdMV.js.map
