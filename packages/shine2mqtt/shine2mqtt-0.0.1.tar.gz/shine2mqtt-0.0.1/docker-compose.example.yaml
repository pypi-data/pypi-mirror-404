services:
  shine2mqtt:
    build:
      context: .
      dockerfile: Dockerfile
    image: bremme/shine2mqtt:latest
    container_name: shine2mqtt
    ports:
      - "5279"
      - "8000"
    volumes:
      # Mount and use a configuration file for configuration
      # NOTE: use config file or environment variables, not both
      - ./config.yaml:/app/config.yaml:ro
    environment:
      # NOTE: use config file or environment variables, not both
      # All commented variables are optional and show default values
      # SHINE2MQTT_LOG_LEVEL: INFO
      # SHINE2MQTT_LOG_COLOR: "false"
      # SHINE2MQTT_CAPTURE_DATA: "false"
      # SHINE2MQTT_MQTT__BASE_TOPIC: "solar"
      # SHINE2MQTT_MQTT__AVAILABILITY_TOPIC: "solar/status"
      # SHINE2MQTT_MQTT__SERVER__HOST: "mosquitto"
      # SHINE2MQTT_MQTT__SERVER__PORT: "1883"
      SHINE2MQTT_MQTT__SERVER__USERNAME: shine2mqtt
      SHINE2MQTT_MQTT__SERVER__PASSWORD: password
      # SHINE2MQTT_MQTT__SERVER__CLIENT_ID: shine2mqtt
      # SHINE2MQTT_MQTT__DISCOVERY__ENABLED: "true"
      # SHINE2MQTT_MQTT__DISCOVERY__PREFIX_TOPIC: "homeassistant"
      SHINE2MQTT_MQTT__DISCOVERY__INVERTER__MODEL: MIC 3000TL-X
      SHINE2MQTT_MQTT__DISCOVERY__DATALOGGER__MODEL: Shine WiFi-X
      # SHINE2MQTT_SERVER__HOST: "0.0.0.0"
      # SHINE2MQTT_SERVER__PORT: "5279"
      # SHINE2MQTT_API__ENABLED: "true"
      # SHINE2MQTT_API__HOST: "0.0.0.0"
      # SHINE2MQTT_API__PORT: "8000"
      # SHINE2MQTT_SIMULATED_CLIENT__ENABLED: "false"
      # SHINE2MQTT_SIMULATED_CLIENT__SERVER_HOST: "localhost"
      # SHINE2MQTT_SIMULATED_CLIENT__SERVER_PORT: "5279"
    restart: unless-stopped