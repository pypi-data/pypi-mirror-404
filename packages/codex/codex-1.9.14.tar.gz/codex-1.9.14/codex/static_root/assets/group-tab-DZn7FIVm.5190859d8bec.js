import{_ as k,y as G,v as A,c as s,w as a,D as h,N as f,G as b,x as i,b as t,z as m,aq as T}from"./main-GE3uFePF.js";import{G as C,A as v,R as V,a as I,b as D,c as j}from"./relation-chips-tPXj0vjU.js";import{useAdminStore as d}from"./admin-BA9ToWAP.js";import{V as E}from"./VSelectionControl-C8DQf56i.js";import{a as w,V as N}from"./VRadioGroup-BCJFYNjv.js";import"./forwardRefs-RdtHqDjs.js";import"./VForm-BZgaRj-J.js";import"./confirm-footer-CXU8cmV4.js";import"./VSelect-3XsB4Bnk.js";import"./ssrBoot-B0pswZbJ.js";import"./VDivider-Rdtf6zpf.js";import"./VCheckboxBtn-B7AyxNoj.js";import"./VTable-BzHndA6M.js";import"./filter-DawtxvRO.js";import"./confirm-dialog-K-DI-wAR.js";const S=["name","userSet","librarySet","exclude"];Object.freeze(S);const y={name:"",userSet:[],librarySet:[],exclude:!1};Object.freeze(y);const L={name:"AdminGroupCreateUpdateInputs",components:{AdminRelationPicker:v,GroupChip:C},props:{oldRow:{type:[Object,Boolean],default:!1}},emits:["change"],data(){return{rules:{name:[l=>!!l||"Name is required",l=>!!l&&!this.names.has(l.trim())||"Name already used"]},row:{...y,...f(this.oldRow)}}},computed:{...b(d,["normalLibraries"]),...b(d,{groups:l=>l.groups,users:l=>l.users}),names(){return this.nameSet(this.groups,"name",this.oldRow,!0)}},watch:{row:{handler(l){this.$emit("change",l)},deep:!0},oldRow:{handler(l){this.row=f(l)},deep:!0}},methods:{...h(d,["nameSet"])},UPDATE_KEYS:S,EMPTY_ROW:y};function H(l,e,c,x,o,g){const p=i("GroupChip"),u=i("AdminRelationPicker");return G(),A("div",null,[s(E,{modelValue:o.row.name,"onUpdate:modelValue":e[0]||(e[0]=r=>o.row.name=r),label:"Group Name",rules:o.rules.name,clearable:"",autofocus:""},null,8,["modelValue","rules"]),s(N,{inline:"",label:"Type","model-value":o.row.exclude,"hide-details":"auto","onUpdate:modelValue":e[1]||(e[1]=r=>o.row.exclude=r)},{default:a(()=>[s(w,{value:!1},{label:a(()=>[s(p,{item:{name:"Include",exclude:!1},"title-key":"name","group-type":""})]),_:1}),s(w,{value:!0},{label:a(()=>[s(p,{item:{name:"Exclude",exclude:!0},"title-key":"name","group-type":""})]),_:1})]),_:1},8,["model-value"]),s(u,{"model-value":o.row.userSet,label:"Users",objs:l.users,"title-key":"username","onUpdate:modelValue":e[2]||(e[2]=r=>o.row.userSet=r)},null,8,["model-value","objs"]),s(u,{"model-value":o.row.librarySet,label:"Libraries",objs:l.normalLibraries,"title-key":"path","onUpdate:modelValue":e[3]||(e[3]=r=>o.row.librarySet=r)},null,8,["model-value","objs"])])}const P=k(L,[["render",H]]),O=180,z={name:"AdminGroupsTab",components:{AdminTable:j,AdminDeleteRowDialog:D,AdminCreateUpdateDialog:I,RelationChips:V,GroupChip:C},data(){return{lastUpdate:{pk:0,field:void 0},AdminGroupCreateUpdateInputs:T(P),GROUP_HELP_HEIGHT:O,headers:[{title:"Name",key:"name",align:"start"},{title:"Type",key:"exclude",align:"start"},{title:"Users",key:"userSet"},{title:"Libraries",key:"librarySet"},{title:"Actions",key:"actions",sortable:!1}]}},computed:{...b(d,["normalLibraries"]),...b(d,{groups:l=>l.groups,users:l=>l.users})},mounted(){this.loadTables(["User","Library","Group"])},methods:{...h(d,["loadTables"]),groupType(l){const e=l.exclude;return{name:e?"Exclude ":"Include",exclude:e}}}},B={class:"tabHeader"},_={id:"groupHelp"},q={id:"groupTable"};function Y(l,e,c,x,o,g){const p=i("AdminCreateUpdateDialog"),u=i("GroupChip"),r=i("RelationChips"),U=i("AdminDeleteRowDialog"),R=i("AdminTable");return G(),A("div",null,[t("header",B,[s(p,{table:"Group","max-width":"20em",inputs:o.AdminGroupCreateUpdateInputs},null,8,["inputs"])]),s(R,{"item-title":"name",headers:o.headers,items:l.groups},{"no-data":a(()=>[...e[0]||(e[0]=[t("td",{class:"adminNoData",colspan:"100%"},"No groups",-1)])]),"item.exclude":a(({item:n})=>[s(u,{"group-type":"",item:g.groupType(n),"title-key":"name"},null,8,["item"])]),"item.userSet":a(({item:n})=>[s(r,{pks:n.userSet,objs:l.users,"title-key":"username"},null,8,["pks","objs"])]),"item.librarySet":a(({item:n})=>[s(r,{pks:n.librarySet,objs:l.normalLibraries,"title-key":"path"},null,8,["pks","objs"])]),"item.actions":a(({item:n})=>[s(p,{table:"Group","old-row":n,"max-width":"20em",inputs:o.AdminGroupCreateUpdateInputs,size:"small",density:"compact"},null,8,["old-row","inputs"]),s(U,{table:"Group",pk:n.pk,name:n.name,size:"small",density:"compact"},null,8,["pk","name"])]),_:2},1032,["headers","items"]),t("div",_,[e[9]||(e[9]=t("h3",null,"Group Access Logic",-1)),e[10]||(e[10]=t("p",null," A library in no groups is accessible to every user and non-users if those are enabled. ",-1)),e[11]||(e[11]=t("p",null,[m(" A library with "),t("em",null,"any"),m(" Include groups is accessible "),t("em",null,"only"),m(" to users who are in those groups. ")],-1)),e[12]||(e[12]=t("p",null,[m(" A library with "),t("em",null,"any"),m(" Exclude groups is not accessible to Guest users but is acccessable to any logged in users that are not in the Exclude groups. ")],-1)),e[13]||(e[13]=t("p",null," If you have libraries added and you do not see them in your browser, check to see if the library and your user are in the same group. ",-1)),t("table",q,[e[8]||(e[8]=t("thead",null,[t("tr",null,[t("th",null,"Library in Group Type"),t("th",null,"Guest"),t("th",null,"User Out of Group"),t("th",null,"User In Group")])],-1)),t("tbody",null,[e[7]||(e[7]=t("tr",null,[t("td",null,"Not in a Group"),t("td",{class:"see"},"Can See"),t("td",{class:"see"},"Can See"),t("td",{class:"see"},"Can See")],-1)),t("tr",null,[t("td",null,[s(u,{item:{name:"Include",exclude:!1},"title-key":"name","group-type":""})]),e[1]||(e[1]=t("td",{class:"hidden"},"Hidden",-1)),e[2]||(e[2]=t("td",{class:"hidden"},"Hidden",-1)),e[3]||(e[3]=t("td",{class:"see"},"Can See",-1))]),t("tr",null,[t("td",null,[s(u,{item:{name:"Exclude",exclude:!0},"title-key":"name","group-type":""})]),e[4]||(e[4]=t("td",{class:"hidden"},"Hidden",-1)),e[5]||(e[5]=t("td",{class:"see"},"Can See",-1)),e[6]||(e[6]=t("td",{class:"hidden"},"Hidden",-1))])])])])])}const ne=k(z,[["render",Y],["__scopeId","data-v-19cf3953"]]);export{ne as default};
