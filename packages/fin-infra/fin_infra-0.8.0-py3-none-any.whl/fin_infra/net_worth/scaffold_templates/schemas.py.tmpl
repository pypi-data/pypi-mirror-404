"""
${Entity} Pydantic schemas for API request/response validation.

Auto-generated by fin-infra scaffold. Customize as needed.
"""
from datetime import datetime
from decimal import Decimal
from typing import Any, Dict, Optional
from uuid import UUID

from pydantic import BaseModel, ConfigDict, Field, field_validator


class Timestamped(BaseModel):
    """Mixin for models with timestamps."""
    created_at: datetime


class ${Entity}Base(BaseModel):
    """Base net worth snapshot schema with core fields."""
    user_id: Optional[str] = Field(None, max_length=64, description="User who owns this snapshot")
    snapshot_date: datetime = Field(..., description="Date when snapshot was taken (timezone-aware)")
    total_assets: Decimal = Field(..., ge=0, description="Sum of all asset values")
    total_liabilities: Decimal = Field(Decimal("0.00"), ge=0, description="Sum of all liabilities")
    net_worth: Decimal = Field(..., description="Calculated net worth (total_assets - total_liabilities)")
    liquid_net_worth: Optional[Decimal] = Field(None, ge=0, description="Liquid assets only (excluding real estate, retirement)")
    accounts_data: Optional[Dict[str, Any]] = Field(None, description="Raw account balances at snapshot time (JSON)")
    asset_breakdown: Optional[Dict[str, Any]] = Field(None, description="Categorized asset values (JSON)")
    liability_breakdown: Optional[Dict[str, Any]] = Field(None, description="Categorized liability values (JSON)")
    metadata: Optional[Dict[str, Any]] = Field(None, description="Additional snapshot metadata (JSON)", alias="extra")${tenant_field_create}

    model_config = ConfigDict(
        from_attributes=True,
        populate_by_name=True,
        json_schema_extra={
            "example": {
                "user_id": "user_abc123",
                "snapshot_date": "2025-01-31T23:59:59Z",
                "total_assets": 150000.00,
                "total_liabilities": 50000.00,
                "net_worth": 100000.00,
                "liquid_net_worth": 75000.00,
                "asset_breakdown": {
                    "cash": 10000.00,
                    "stocks": 50000.00,
                    "real_estate": 200000.00,
                    "retirement": 40000.00
                },
                "liability_breakdown": {
                    "credit_cards": 2000.00,
                    "student_loans": 15000.00,
                    "mortgage": 180000.00
                }
            }
        }
    )

    @field_validator("net_worth")
    @classmethod
    def validate_net_worth(cls, v: Decimal, info) -> Decimal:
        """Validate net_worth equals total_assets - total_liabilities."""
        if "total_assets" in info.data and "total_liabilities" in info.data:
            expected = info.data["total_assets"] - info.data["total_liabilities"]
            if v != expected:
                raise ValueError(
                    f"net_worth must equal total_assets - total_liabilities. "
                    f"Expected {expected}, got {v}"
                )
        return v


class ${Entity}Create(${Entity}Base):
    """Schema for creating a new net worth snapshot (POST /net-worth-snapshots).
    
    Note: Snapshots are immutable. No update operation exists.
    """
    pass


class ${Entity}Read(${Entity}Base, Timestamped):
    """Schema for reading a net worth snapshot (GET /net-worth-snapshots/{id}).
    
    Includes database-generated fields like id and created_at.
    Snapshots are immutable - they capture a moment in time.
    """
    id: UUID = Field(..., description="Unique snapshot identifier")

    model_config = ConfigDict(
        from_attributes=True,
        populate_by_name=True,
        json_schema_extra={
            "example": {
                "id": "550e8400-e29b-41d4-a716-446655440000",
                "user_id": "user_abc123",
                "snapshot_date": "2025-01-31T23:59:59Z",
                "total_assets": 150000.00,
                "total_liabilities": 50000.00,
                "net_worth": 100000.00,
                "liquid_net_worth": 75000.00,
                "created_at": "2025-02-01T08:30:00Z",
                "asset_breakdown": {
                    "cash": 10000.00,
                    "stocks": 50000.00,
                    "real_estate": 200000.00,
                    "retirement": 40000.00
                },
                "liability_breakdown": {
                    "credit_cards": 2000.00,
                    "student_loans": 15000.00,
                    "mortgage": 180000.00
                }
            }
        }
    )


# Note: No ${Entity}Update schema - snapshots are immutable
# To correct errors, delete the snapshot and create a new one
