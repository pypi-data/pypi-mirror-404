"""
${Entity} Pydantic schemas for API request/response validation.

Auto-generated by fin-infra scaffold. Customize as needed.
"""
from datetime import datetime
from decimal import Decimal
from typing import Any, Dict, Optional
from uuid import UUID

from pydantic import BaseModel, ConfigDict, Field


class Timestamped(BaseModel):
    """Mixin for models with timestamps."""
    created_at: datetime


class ${Entity}Base(BaseModel):
    """Base holding snapshot schema with core fields."""
    user_id: Optional[str] = Field(None, max_length=64, description="User who owns this snapshot")
    snapshot_date: datetime = Field(..., description="Date/time when snapshot was taken (timezone-aware)")
    total_value: Decimal = Field(..., ge=0, description="Total portfolio value at snapshot time")
    total_cost_basis: Optional[Decimal] = Field(None, ge=0, description="Total cost basis (if available)")
    total_unrealized_gain_loss: Optional[Decimal] = Field(None, description="Total unrealized profit/loss")
    holdings_count: int = Field(..., ge=0, description="Number of holdings in snapshot")
    holdings_data: Dict[str, Any] = Field(..., description="Complete holdings data from provider (JSON)")
    provider: str = Field("plaid", max_length=50, description="Provider source (plaid, snaptrade, etc.)")
    provider_metadata: Optional[Dict[str, Any]] = Field(None, description="Provider-specific metadata (JSON)")
    notes: Optional[str] = Field(None, description="Optional user notes about this snapshot")
    metadata: Optional[Dict[str, Any]] = Field(None, description="Additional snapshot metadata (JSON)", alias="extra")${tenant_field_create}

    model_config = ConfigDict(
        from_attributes=True,
        populate_by_name=True,
        json_schema_extra={
            "example": {
                "user_id": "user_abc123",
                "snapshot_date": "2025-01-31T23:59:59Z",
                "total_value": 125000.50,
                "total_cost_basis": 100000.00,
                "total_unrealized_gain_loss": 25000.50,
                "holdings_count": 15,
                "provider": "plaid",
                "holdings_data": {
                    "accounts": [
                        {
                            "account_id": "acc_123",
                            "name": "Vanguard Brokerage",
                            "holdings": [
                                {
                                    "security": {"ticker_symbol": "AAPL", "name": "Apple Inc."},
                                    "quantity": 100,
                                    "institution_value": 18500.00
                                }
                            ]
                        }
                    ]
                },
                "notes": "Quarterly portfolio snapshot"
            }
        }
    )


class ${Entity}Create(${Entity}Base):
    """Schema for creating a new holding snapshot (POST /holding-snapshots).
    
    Note: Snapshots are immutable. No update operation exists.
    Use this to capture periodic snapshots of investment holdings.
    """
    pass


class ${Entity}Read(${Entity}Base, Timestamped):
    """Schema for reading a holding snapshot (GET /holding-snapshots/{id}).
    
    Includes database-generated fields like id and created_at.
    Snapshots are immutable - they capture investment state at a moment in time.
    """
    id: UUID = Field(..., description="Unique snapshot identifier")

    model_config = ConfigDict(
        from_attributes=True,
        populate_by_name=True,
        json_schema_extra={
            "example": {
                "id": "550e8400-e29b-41d4-a716-446655440000",
                "user_id": "user_abc123",
                "snapshot_date": "2025-01-31T23:59:59Z",
                "total_value": 125000.50,
                "total_cost_basis": 100000.00,
                "total_unrealized_gain_loss": 25000.50,
                "holdings_count": 15,
                "provider": "plaid",
                "created_at": "2025-02-01T00:05:00Z",
                "holdings_data": {
                    "accounts": [
                        {
                            "account_id": "acc_123",
                            "name": "Vanguard Brokerage",
                            "holdings": [
                                {
                                    "security": {"ticker_symbol": "AAPL", "name": "Apple Inc."},
                                    "quantity": 100,
                                    "institution_value": 18500.00
                                }
                            ]
                        }
                    ]
                },
                "notes": "Quarterly portfolio snapshot"
            }
        }
    )


class ${Entity}Update(BaseModel):
    """Schema for updating a holding snapshot (PATCH /holding-snapshots/{id}).
    
    Only notes field can be updated - all other fields are immutable.
    To correct snapshot data, delete and recreate the snapshot.
    """
    notes: Optional[str] = Field(None, description="Update user notes")

    model_config = ConfigDict(
        from_attributes=True,
        json_schema_extra={
            "example": {
                "notes": "Updated: End of Q1 2025 portfolio snapshot"
            }
        }
    )


# Note: Snapshots are mostly immutable (only notes can be updated)
# To correct snapshot data errors, delete the snapshot and create a new one
