"""
${Entity} Pydantic schemas for API request/response validation.

Auto-generated by fin-infra scaffold. Customize as needed.
"""
from datetime import datetime
from decimal import Decimal
from typing import Any, Dict, Optional
from uuid import UUID

from pydantic import BaseModel, ConfigDict, Field, field_validator


class Timestamped(BaseModel):
    """Mixin for models with timestamps."""
    created_at: datetime
    updated_at: datetime


class ${Entity}Base(BaseModel):
    """Base ${entity} schema with core fields."""
    user_id: Optional[str] = Field(None, max_length=64, description="User who owns this goal")
    name: str = Field(..., max_length=128, description="Goal name (e.g., 'Emergency Fund')")
    description: Optional[str] = Field(None, description="Optional detailed description")
    target_amount: Decimal = Field(..., ge=0, description="Financial goal amount (e.g., 10000.00)")
    current_amount: Decimal = Field(Decimal("0.00"), ge=0, description="Current progress toward goal")
    target_date: datetime = Field(..., description="Goal deadline (timezone-aware)")
    status: str = Field("active", max_length=32, description="Goal status (active, achieved, abandoned, paused)")
    priority: int = Field(1, ge=1, description="Goal importance ranking (1=highest)")
    category: Optional[str] = Field(None, max_length=64, description="Goal category (emergency_fund, retirement, vacation, etc.)")
    metadata: Optional[Dict[str, Any]] = Field(None, description="Additional metadata (JSON)", alias="extra")
    milestones: Optional[Dict[str, Any]] = Field(None, description="Progress milestones (JSON)")${tenant_field_create}

    model_config = ConfigDict(
        from_attributes=True,
        populate_by_name=True,
        json_schema_extra={
            "example": {
                "user_id": "user_abc123",
                "name": "Emergency Fund",
                "description": "Build 6-month emergency fund",
                "target_amount": 10000.00,
                "current_amount": 2500.00,
                "target_date": "2025-12-31T23:59:59Z",
                "status": "active",
                "priority": 1,
                "category": "emergency_fund",
                "milestones": [
                    {"amount": 5000, "label": "Halfway there!"},
                    {"amount": 7500, "label": "Three-quarters done"}
                ]
            }
        }
    )

    @field_validator("status")
    @classmethod
    def validate_status(cls, v: str) -> str:
        """Validate goal status is one of the allowed values."""
        allowed = {"active", "achieved", "abandoned", "paused"}
        if v not in allowed:
            raise ValueError(f"Status must be one of {allowed}, got {v}")
        return v


class ${Entity}Create(${Entity}Base):
    """Schema for creating a new ${entity} (POST /goals)."""
    pass


class ${Entity}Update(BaseModel):
    """Schema for updating an existing ${entity} (PATCH /goals/{id}).
    
    All fields are optional to support partial updates.
    """
    name: Optional[str] = Field(None, max_length=128)
    description: Optional[str] = None
    target_amount: Optional[Decimal] = Field(None, ge=0)
    current_amount: Optional[Decimal] = Field(None, ge=0)
    target_date: Optional[datetime] = None
    status: Optional[str] = Field(None, max_length=32)
    priority: Optional[int] = Field(None, ge=1)
    category: Optional[str] = Field(None, max_length=64)
    metadata: Optional[Dict[str, Any]] = Field(None, alias="extra")
    milestones: Optional[Dict[str, Any]] = None${tenant_field_update}

    model_config = ConfigDict(
        from_attributes=True,
        populate_by_name=True
    )

    @field_validator("status")
    @classmethod
    def validate_status(cls, v: Optional[str]) -> Optional[str]:
        """Validate goal status if provided."""
        if v is not None:
            allowed = {"active", "achieved", "abandoned", "paused"}
            if v not in allowed:
                raise ValueError(f"Status must be one of {allowed}, got {v}")
        return v


class ${Entity}Read(${Entity}Base, Timestamped):
    """Schema for reading a ${entity} (GET /goals/{id}, GET /goals).
    
    Includes database-generated fields like id and timestamps.
    """
    id: UUID = Field(..., description="Unique goal identifier")
    percent_complete: Decimal = Field(..., description="Goal completion percentage (0-100)")

    model_config = ConfigDict(
        from_attributes=True,
        populate_by_name=True,
        json_schema_extra={
            "example": {
                "id": "550e8400-e29b-41d4-a716-446655440000",
                "user_id": "user_abc123",
                "name": "Emergency Fund",
                "description": "Build 6-month emergency fund",
                "target_amount": 10000.00,
                "current_amount": 2500.00,
                "percent_complete": 25.00,
                "target_date": "2025-12-31T23:59:59Z",
                "status": "active",
                "priority": 1,
                "category": "emergency_fund",
                "created_at": "2025-01-15T10:30:00Z",
                "updated_at": "2025-06-01T14:45:00Z",
                "milestones": [
                    {"amount": 5000, "label": "Halfway there!"}
                ]
            }
        }
    )
