{
  "session_id": "00000000-0000-0000-0000-000000000000",
  "transcript_path": "/home/testuser/.claude/projects/-workspace-vibes-claude-nagger/00000000-0000-0000-0000-000000000000.jsonl",
  "cwd": "/workspace/vibes/claude_nagger",
  "permission_mode": "acceptEdits",
  "hook_event_name": "PreToolUse",
  "tool_name": "Write",
  "tool_input": {
    "file_path": "/workspace/vibes/claude_nagger/scripts/setup_test_env.sh",
    "content": "#!/bin/bash\n# claude-nagger ローカルテスト環境セットアップ\n#\n# 使い方:\n#   ./scripts/setup_test_env.sh          # テスト環境構築\n#   ./scripts/setup_test_env.sh --run    # セットアップ後にinstall-hooks実行\n#   ./scripts/setup_test_env.sh --clean  # クリーンアップ\n#   ./scripts/setup_test_env.sh --capture # フィクスチャキャプチャ\n\nset -e\n\n# 設定\nSCRIPT_DIR=\"$(cd \"$(dirname \"$0\")\" && pwd)\"\nPROJECT_ROOT=\"$(dirname \"$SCRIPT_DIR\")\"\nTEST_DIR=\"/tmp/claude-nagger-test\"\nCLAUDE_NAGGER_PATH=\"$PROJECT_ROOT\"\n\n# 色付き出力\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m' # No Color\n\nlog_info() { echo -e \"${BLUE}[INFO]${NC} $1\"; }\nlog_success() { echo -e \"${GREEN}[OK]${NC} $1\"; }\nlog_warn() { echo -e \"${YELLOW}[WARN]${NC} $1\"; }\n\n# クリーンアップ\ncleanup() {\n    log_info \"テスト環境をクリーンアップ...\"\n    rm -rf \"$TEST_DIR\"\n    log_success \"クリーンアップ完了\"\n}\n\n# テスト環境セットアップ\nsetup() {\n    log_info \"テスト環境を構築: $TEST_DIR\"\n\n    # ディレクトリ作成\n    mkdir -p \"$TEST_DIR\"\n    cd \"$TEST_DIR\"\n\n    # 疑似プロジェクト構造を作成\n    mkdir -p src tests docs\n\n    # サンプルファイル作成\n    cat > src/main.py << 'EOF'\n\"\"\"サンプルプロジェクト\"\"\"\n\ndef main():\n    print(\"Hello, World!\")\n\nif __name__ == \"__main__\":\n    main()\nEOF\n\n    cat > README.md << 'EOF'\n# Test Project\n\nclaude-nagger テスト用プロジェクト\nEOF\n\n    # pyproject.toml (テスト用)\n    cat > pyproject.toml << 'EOF'\n[project]\nname = \"test-project\"\nversion = \"0.1.0\"\nEOF\n\n    log_success \"テストプロジェクト作成完了\"\n\n    # 状態表示\n    echo \"\"\n    log_info \"テストディレクトリ: $TEST_DIR\"\n    log_info \"claude-nagger パス: $CLAUDE_NAGGER_PATH\"\n    echo \"\"\n    echo \"次のコマンドでテスト可能:\"\n    echo \"\"\n    echo \"  cd $TEST_DIR\"\n    echo \"  uvx --from $CLAUDE_NAGGER_PATH claude-nagger install-hooks --dry-run\"\n    echo \"  uvx --from $CLAUDE_NAGGER_PATH claude-nagger install-hooks\"\n    echo \"\"\n}\n\n# install-hooks実行\nrun_install() {\n    log_info \"install-hooks を実行...\"\n    cd \"$TEST_DIR\"\n\n    # dry-run\n    log_info \"[dry-run]\"\n    uvx --from \"$CLAUDE_NAGGER_PATH\" claude-nagger install-hooks --dry-run\n    echo \"\"\n\n    # 実行\n    log_info \"[実行]\"\n    uvx --from \"$CLAUDE_NAGGER_PATH\" claude-nagger install-hooks\n    echo \"\"\n\n    # 結果確認\n    log_info \"生成されたファイル:\"\n    echo \"\"\n    if [ -d \".claude\" ]; then\n        echo \".claude/\"\n        ls -la .claude/\n        echo \"\"\n        if [ -f \".claude/settings.json\" ]; then\n            echo \"=== .claude/settings.json ===\"\n            cat .claude/settings.json\n            echo \"\"\n        fi\n    fi\n\n    if [ -d \".claude-nagger\" ]; then\n        echo \".claude-nagger/\"\n        ls -la .claude-nagger/\n    fi\n\n    log_success \"install-hooks 完了\"\n}\n\n# フィクスチャキャプチャ\ncapture() {\n    log_info \"フィクスチャをキャプチャ...\"\n    cd \"$PROJECT_ROOT\"\n    python3 scripts/capture_fixture.py --sanitize -n 10\n\n    log_info \"フィクスチャ一覧:\"\n    python3 scripts/capture_fixture.py --list\n\n    log_success \"キャプチャ完了\"\n}\n\n# テスト実行\nrun_tests() {\n    log_info \"スキーマ検証テスト実行...\"\n    cd \"$PROJECT_ROOT\"\n    python3 -m pytest tests/test_hook_schema_validation.py -v\n    log_success \"テスト完了\"\n}\n\n# メイン処理\ncase \"${1:-}\" in\n    --clean)\n        cleanup\n        ;;\n    --run)\n        if [ ! -d \"$TEST_DIR\" ]; then\n            setup\n        fi\n        run_install\n        ;;\n    --capture)\n        capture\n        ;;\n    --test)\n        run_tests\n        ;;\n    --all)\n        cleanup\n        setup\n        run_install\n        capture\n        run_tests\n        ;;\n    --help|-h)\n        echo \"claude-nagger ローカルテスト環境\"\n        echo \"\"\n        echo \"使い方:\"\n        echo \"  $0              テスト環境セットアップ\"\n        echo \"  $0 --run        install-hooks実行\"\n        echo \"  $0 --capture    フィクスチャキャプチャ\"\n        echo \"  $0 --test       スキーマ検証テスト実行\"\n        echo \"  $0 --clean      クリーンアップ\"\n        echo \"  $0 --all        全て実行\"\n        ;;\n    *)\n        setup\n        ;;\nesac\n"
  },
  "tool_use_id": "toolu_016oMqWSoiydf1x4D1g9rkNM"
}