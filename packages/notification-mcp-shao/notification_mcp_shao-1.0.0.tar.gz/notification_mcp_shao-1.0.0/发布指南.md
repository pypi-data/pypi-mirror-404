# PyPI å‘å¸ƒè¯¦ç»†æŒ‡å—

## ğŸ“‹ å‡†å¤‡å·¥ä½œ

### 1. æ³¨å†Œè´¦å·

**TestPyPIï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰:**
- è®¿é—®ï¼šhttps://test.pypi.org/account/register/
- æ³¨å†Œä¸€ä¸ªæµ‹è¯•è´¦å·

**PyPIï¼ˆæ­£å¼ç¯å¢ƒï¼‰:**
- è®¿é—®ï¼šhttps://pypi.org/account/register/
- æ³¨å†Œæ­£å¼è´¦å·

### 2. è·å– API Token

#### TestPyPI Token
1. ç™»å½• https://test.pypi.org
2. è®¿é—® https://test.pypi.org/manage/account/token/
3. ç‚¹å‡» "Add API token"
4. Token name: `notification-mcp-upload`
5. Scope: é€‰æ‹© "Entire account"ï¼ˆé¦–æ¬¡ä¸Šä¼ ï¼‰
6. ç‚¹å‡» "Add token"
7. **ç«‹å³å¤åˆ¶ token**ï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼ï¼‰
   - æ ¼å¼ï¼š`pypi-AgEIcHlwaS5vcmc...`

#### PyPI Tokenï¼ˆæ­£å¼å‘å¸ƒæ—¶ï¼‰
1. ç™»å½• https://pypi.org
2. è®¿é—® https://pypi.org/manage/account/token/
3. åŒæ ·æ­¥éª¤åˆ›å»º token

## ğŸ”§ é…ç½®è®¤è¯

### æ–¹å¼ 1ï¼šé…ç½®æ–‡ä»¶ï¼ˆæ¨èï¼‰

åˆ›å»º `~/.pypirc` æ–‡ä»¶ï¼š

```bash
cat > ~/.pypirc << 'EOF'
[distutils]
index-servers =
    pypi
    testpypi

[testpypi]
repository = https://test.pypi.org/legacy/
username = __token__
password = pypi-AgEIcHlwaS5vcmc...ä½ çš„TestPyPI_token...

[pypi]
username = __token__
password = pypi-AgEIcHlwaS5vcmc...ä½ çš„æ­£å¼PyPI_token...
EOF

# è®¾ç½®æƒé™ï¼ˆé‡è¦ï¼ï¼‰
chmod 600 ~/.pypirc
```

**æ³¨æ„**ï¼š
- `username` å¿…é¡»æ˜¯ `__token__`ï¼ˆä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰
- `password` æ˜¯å®Œæ•´çš„ token å­—ç¬¦ä¸²
- æ–‡ä»¶æƒé™å¿…é¡»æ˜¯ 600

### æ–¹å¼ 2ï¼šç¯å¢ƒå˜é‡

```bash
# ä¸´æ—¶è®¾ç½®ï¼ˆå½“å‰ç»ˆç«¯æœ‰æ•ˆï¼‰
export TWINE_USERNAME=__token__
export TWINE_PASSWORD=pypi-AgEIcHlwaS5vcmc...ä½ çš„token...

# æˆ–æ·»åŠ åˆ° ~/.zshrc æˆ– ~/.bashrcï¼ˆæ°¸ä¹…æœ‰æ•ˆï¼‰
echo 'export TWINE_USERNAME=__token__' >> ~/.zshrc
echo 'export TWINE_PASSWORD=pypi-AgEIcHlwaS...' >> ~/.zshrc
source ~/.zshrc
```

### æ–¹å¼ 3ï¼šå‘½ä»¤è¡Œè¾“å…¥

ä¸é…ç½®æ–‡ä»¶ï¼Œä¸Šä¼ æ—¶æ‰‹åŠ¨è¾“å…¥ï¼š

```bash
twine upload --repository testpypi dist/*
# ä¼šæç¤ºè¾“å…¥ username å’Œ password
```

## ğŸ“¦ æ„å»ºå’Œä¸Šä¼ æµç¨‹

### 1. å®‰è£…å·¥å…·

```bash
pip install build twine
```

### 2. æ„å»ºåŒ…

```bash
cd notification-test

# æ¸…ç†æ—§çš„æ„å»ºæ–‡ä»¶
rm -rf dist/ build/ *.egg-info

# æ„å»ºæ–°åŒ…
python -m build
```

è¾“å‡ºï¼š
```
dist/
â”œâ”€â”€ notification_mcp_server-1.0.0.tar.gz
â””â”€â”€ notification_mcp_server-1.0.0-py3-none-any.whl
```

### 3. æ£€æŸ¥åŒ…

```bash
twine check dist/*
```

åº”è¯¥çœ‹åˆ°ï¼š
```
Checking dist/notification_mcp_server-1.0.0.tar.gz: PASSED
Checking dist/notification_mcp_server-1.0.0-py3-none-any.whl: PASSED
```

### 4. ä¸Šä¼ åˆ° TestPyPIï¼ˆæµ‹è¯•ï¼‰

```bash
twine upload --repository testpypi dist/*
```

æˆåŠŸè¾“å‡ºï¼š
```
Uploading distributions to https://test.pypi.org/legacy/
Uploading notification_mcp_server-1.0.0-py3-none-any.whl
100% â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 15.2/15.2 kB â€¢ 00:00 â€¢ ?
Uploading notification_mcp_server-1.0.0.tar.gz
100% â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 12.8/12.8 kB â€¢ 00:00 â€¢ ?

View at:
https://test.pypi.org/project/notification-mcp-server/1.0.0/
```

### 5. æµ‹è¯•å®‰è£…

```bash
# ä» TestPyPI å®‰è£…æµ‹è¯•
pip install --index-url https://test.pypi.org/simple/ notification-mcp-server

# æˆ–ä½¿ç”¨ uvx æµ‹è¯•
uvx --index-url https://test.pypi.org/simple/ notification-mcp-server@latest
```

### 6. ä¸Šä¼ åˆ°æ­£å¼ PyPI

ç¡®è®¤æµ‹è¯•æ— è¯¯åï¼š

```bash
twine upload dist/*
```

æˆåŠŸåè®¿é—®ï¼šhttps://pypi.org/project/notification-mcp-server/

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼š403 Forbidden

```
HTTPError: 403 Forbidden from https://test.pypi.org/legacy/
Invalid or non-existent authentication information.
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ token æ˜¯å¦æ­£ç¡®å¤åˆ¶ï¼ˆåŒ…å« `pypi-` å‰ç¼€ï¼‰
- ç¡®è®¤ username æ˜¯ `__token__`ï¼ˆä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰
- æ£€æŸ¥ `~/.pypirc` æ–‡ä»¶æƒé™ï¼š`chmod 600 ~/.pypirc`

### é—®é¢˜ 2ï¼šåŒ…åå·²å­˜åœ¨

```
HTTPError: 400 Bad Request from https://test.pypi.org/legacy/
The name 'notification-mcp-server' is too similar to an existing project.
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä¿®æ”¹ `pyproject.toml` ä¸­çš„ `name`
- ä¾‹å¦‚ï¼š`notification-mcp-server-shao`

### é—®é¢˜ 3ï¼šç‰ˆæœ¬å·²å­˜åœ¨

```
HTTPError: 400 Bad Request from https://test.pypi.org/legacy/
File already exists.
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä¿®æ”¹ `pyproject.toml` ä¸­çš„ `version`
- ä¾‹å¦‚ï¼šä» `1.0.0` æ”¹ä¸º `1.0.1`
- é‡æ–°æ„å»ºï¼š`python -m build`

### é—®é¢˜ 4ï¼šä¾èµ–å®‰è£…å¤±è´¥

ä» TestPyPI å®‰è£…æ—¶ï¼Œä¾èµ–åŒ…å¯èƒ½æ‰¾ä¸åˆ°ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# åŒæ—¶ä½¿ç”¨ TestPyPI å’Œæ­£å¼ PyPI
pip install --index-url https://test.pypi.org/simple/ \
            --extra-index-url https://pypi.org/simple/ \
            notification-mcp-server
```

## ğŸ“Š éªŒè¯å‘å¸ƒ

### 1. æŸ¥çœ‹é¡¹ç›®é¡µé¢

- TestPyPI: https://test.pypi.org/project/notification-mcp-server/
- PyPI: https://pypi.org/project/notification-mcp-server/

### 2. æµ‹è¯•å®‰è£…

```bash
# ä½¿ç”¨ uvxï¼ˆæ¨èï¼‰
uvx notification-mcp-server@latest

# æˆ–ä½¿ç”¨ pip
pip install notification-mcp-server
notification-mcp-server
```

### 3. åœ¨ Kiro ä¸­ä½¿ç”¨

æ›´æ–° `.kiro/settings/mcp.json`ï¼š

```json
{
  "mcpServers": {
    "notification": {
      "command": "uvx",
      "args": ["notification-mcp-server@latest"],
      "env": {
        "SMTP_SERVER": "smtp.163.com",
        "SMTP_PORT": "465",
        "EMAIL_ACCOUNT": "your@email.com",
        "EMAIL_PASSWORD": "your-auth-code",
        "SMTP_SSL": "true",
        "DINGTALK_WEBHOOK": "your-webhook-url"
      }
    }
  }
}
```

## ğŸ”„ æ›´æ–°ç‰ˆæœ¬

å‘å¸ƒæ–°ç‰ˆæœ¬ï¼š

```bash
# 1. ä¿®æ”¹ç‰ˆæœ¬å·
# ç¼–è¾‘ pyproject.toml: version = "1.0.1"
# ç¼–è¾‘ src/notification_mcp/__init__.py: __version__ = "1.0.1"

# 2. æ¸…ç†æ—§æ„å»º
rm -rf dist/ build/ *.egg-info

# 3. é‡æ–°æ„å»º
python -m build

# 4. ä¸Šä¼ 
twine upload dist/*
```

## ğŸ“ æ£€æŸ¥æ¸…å•

ä¸Šä¼ å‰æ£€æŸ¥ï¼š

- [ ] å·²æ³¨å†Œ TestPyPI/PyPI è´¦å·
- [ ] å·²è·å– API token
- [ ] å·²é…ç½® `~/.pypirc` æˆ–ç¯å¢ƒå˜é‡
- [ ] å·²å®‰è£… `build` å’Œ `twine`
- [ ] å·²æ„å»ºåŒ…ï¼š`python -m build`
- [ ] å·²æ£€æŸ¥åŒ…ï¼š`twine check dist/*`
- [ ] åŒ…ååœ¨ PyPI ä¸Šä¸å­˜åœ¨æˆ–å·²æ›´æ–°ç‰ˆæœ¬å·
- [ ] README.md å†…å®¹å®Œæ•´
- [ ] ä¾èµ–é¡¹æ­£ç¡®é…ç½®

@author shao
