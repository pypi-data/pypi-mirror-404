{
  "deterministic": {
    "column_analysis": {
      "column_refs": [
        {
          "alias": "c",
          "column": "CUSTOMER_ID",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "c",
          "column": "EMAIL",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "c",
          "column": "NAME",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "c",
          "column": "PORTAL_CUSTOMER_ID",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "p",
          "column": "NAME",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "p",
          "column": "PRODUCT_ID",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "s",
          "column": "CURRENT_PRODUCT_ID",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "s",
          "column": "CUSTOMER_ID",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "s",
          "column": "CWS_INSTALLATION",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "s",
          "column": "CWS_INSTALLATION",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "s",
          "column": "EDITION",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "s",
          "column": "PRODUCT_ID",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "s",
          "column": "current_period_end_at",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "s",
          "column": "cws_installation",
          "evidence": null,
          "scope": "outer"
        }
      ],
      "columns_by_alias": [
        {
          "alias": "c",
          "columns": [
            "CUSTOMER_ID",
            "EMAIL",
            "NAME",
            "PORTAL_CUSTOMER_ID"
          ]
        },
        {
          "alias": "p",
          "columns": [
            "NAME",
            "PRODUCT_ID"
          ]
        },
        {
          "alias": "s",
          "columns": [
            "CURRENT_PRODUCT_ID",
            "CUSTOMER_ID",
            "CWS_INSTALLATION",
            "EDITION",
            "PRODUCT_ID",
            "current_period_end_at",
            "cws_installation"
          ]
        }
      ],
      "unresolved_unqualified": []
    },
    "filter_analysis": {
      "having": [],
      "normalized_predicates": [],
      "null_killing_on_outer": [],
      "qualify": [
        "ROW_NUMBER() OVER (PARTITION BY cws_installation ORDER BY current_period_end_at DESC NULLS FIRST) = 1"
      ],
      "unresolved_predicates": [],
      "where": [
        "NOT s.CWS_INSTALLATION IS NULL"
      ]
    },
    "grouping_outer": {
      "group_by": [],
      "is_aggregated": false,
      "measures": [],
      "result_grain": [
        "s.CWS_INSTALLATION",
        "c.PORTAL_CUSTOMER_ID",
        "c.EMAIL",
        "c.NAME",
        "COALESCE(s.EDITION, p.NAME)",
        "'Stripe'"
      ],
      "select": [
        {
          "alias": "company_name",
          "expr": "c.NAME",
          "is_literal": false,
          "source_aliases": [
            "c"
          ]
        },
        {
          "alias": "customer_id",
          "expr": "c.PORTAL_CUSTOMER_ID",
          "is_literal": false,
          "source_aliases": [
            "c"
          ]
        },
        {
          "alias": "email",
          "expr": "c.EMAIL",
          "is_literal": false,
          "source_aliases": [
            "c"
          ]
        },
        {
          "alias": "installation_id",
          "expr": "s.CWS_INSTALLATION",
          "is_literal": false,
          "source_aliases": [
            "s"
          ]
        },
        {
          "alias": "license_name",
          "expr": "COALESCE(s.EDITION, p.NAME)",
          "is_literal": false,
          "source_aliases": [
            "p",
            "s"
          ]
        },
        {
          "alias": "source",
          "expr": "'Stripe'",
          "is_literal": true,
          "source_aliases": []
        }
      ]
    },
    "join_analysis": {
      "joins": [
        {
          "effective_type": "LEFT",
          "equi_condition": "",
          "left": "c",
          "normalized_equi_condition": "",
          "normalized_raw_condition": "COALESCE(s.PRODUCT_ID, s.CURRENT_PRODUCT_ID) = p.PRODUCT_ID",
          "raw_condition": "COALESCE(s.PRODUCT_ID, s.CURRENT_PRODUCT_ID) = p.PRODUCT_ID",
          "right": "p",
          "type": "LEFT"
        },
        {
          "effective_type": "INNER",
          "equi_condition": "s.CUSTOMER_ID = c.CUSTOMER_ID",
          "left": "s",
          "normalized_equi_condition": "s.CUSTOMER_ID = c.CUSTOMER_ID",
          "normalized_raw_condition": "s.CUSTOMER_ID = c.CUSTOMER_ID",
          "raw_condition": "s.CUSTOMER_ID = c.CUSTOMER_ID",
          "right": "c",
          "type": "INNER"
        }
      ]
    },
    "output_outer": {
      "limit": null,
      "offset": null,
      "order_by": [
        {
          "dir": "DESC",
          "expr": "current_period_end_at"
        }
      ],
      "select_distinct": false,
      "set_ops": []
    },
    "relation_analysis": {
      "alias_mappings": [
        {
          "alias": "c",
          "base": "stg_stripe__customers"
        },
        {
          "alias": "p",
          "base": "stg_stripe__products"
        },
        {
          "alias": "s",
          "base": "stg_stripe__subscriptions"
        }
      ],
      "cte_defs": [],
      "driving_relations": [
        "s"
      ],
      "from_clause_order": [
        "s",
        "c",
        "p"
      ],
      "relations": [
        {
          "alias": "c",
          "base": "stg_stripe__customers",
          "catalog": "ANALYTICS_BRANDON",
          "evidence": [],
          "is_temp": false,
          "kind": "table",
          "schema_name": "dbt_staging",
          "scope": "outer"
        },
        {
          "alias": "p",
          "base": "stg_stripe__products",
          "catalog": "ANALYTICS_BRANDON",
          "evidence": [],
          "is_temp": false,
          "kind": "table",
          "schema_name": "dbt_staging",
          "scope": "outer"
        },
        {
          "alias": "s",
          "base": "stg_stripe__subscriptions",
          "catalog": "ANALYTICS_BRANDON",
          "evidence": [],
          "is_temp": false,
          "kind": "table",
          "schema_name": "dbt_staging",
          "scope": "outer"
        }
      ],
      "self_join_groups": [],
      "subqueries": [],
      "tables": [
        "stg_stripe__customers",
        "stg_stripe__products",
        "stg_stripe__subscriptions"
      ]
    },
    "window_outer": {
      "windows": [
        {
          "frame": "",
          "func": "ROW_NUMBER()",
          "order_by": [
            "current_period_end_at DESC NULLS FIRST"
          ],
          "partition_by": [
            "cws_installation"
          ]
        }
      ]
    }
  },
  "dialect": "snowflake",
  "fixture": "mm_int_cloud_licenses",
  "heuristics": {
    "semantic": {
      "classifications": [
        {
          "business_name": "Company Name",
          "cardinality_hint": null,
          "column_alias": "company_name",
          "confidence": "medium",
          "derivation": "direct",
          "expr": "c.NAME",
          "is_categorical": false,
          "is_pii": false,
          "is_time_related": false,
          "pii_confidence": null,
          "pii_type": null,
          "semantic_role": "attribute",
          "table_type": "fact"
        },
        {
          "business_name": "Customer Id",
          "cardinality_hint": "high",
          "column_alias": "customer_id",
          "confidence": "medium",
          "derivation": "direct",
          "expr": "c.PORTAL_CUSTOMER_ID",
          "is_categorical": false,
          "is_pii": false,
          "is_time_related": false,
          "pii_confidence": null,
          "pii_type": null,
          "semantic_role": "foreign_key",
          "table_type": "fact"
        },
        {
          "business_name": "Email",
          "cardinality_hint": null,
          "column_alias": "email",
          "confidence": "medium",
          "derivation": "direct",
          "expr": "c.EMAIL",
          "is_categorical": false,
          "is_pii": true,
          "is_time_related": false,
          "pii_confidence": "high",
          "pii_type": "email",
          "semantic_role": "attribute",
          "table_type": "fact"
        },
        {
          "business_name": "Installation Id",
          "cardinality_hint": "high",
          "column_alias": "installation_id",
          "confidence": "medium",
          "derivation": "direct",
          "expr": "s.CWS_INSTALLATION",
          "is_categorical": false,
          "is_pii": false,
          "is_time_related": false,
          "pii_confidence": null,
          "pii_type": null,
          "semantic_role": "foreign_key",
          "table_type": "fact"
        },
        {
          "business_name": "License Name",
          "cardinality_hint": null,
          "column_alias": "license_name",
          "confidence": "medium",
          "derivation": "direct",
          "expr": "COALESCE(s.EDITION, p.NAME)",
          "is_categorical": false,
          "is_pii": false,
          "is_time_related": false,
          "pii_confidence": null,
          "pii_type": null,
          "semantic_role": "attribute",
          "table_type": "fact"
        },
        {
          "business_name": "Source",
          "cardinality_hint": null,
          "column_alias": "source",
          "confidence": "medium",
          "derivation": "direct",
          "expr": "'Stripe'",
          "is_categorical": false,
          "is_pii": false,
          "is_time_related": false,
          "pii_confidence": null,
          "pii_type": null,
          "semantic_role": "attribute",
          "table_type": "unknown"
        }
      ],
      "fact_alias": "s",
      "has_surrogate_keys": false,
      "high_risk_pii_count": 1,
      "intent": "unknown",
      "pii_columns": [
        "email"
      ],
      "primary_key_candidates": []
    },
    "time": {
      "classifications": [
        {
          "column_alias": "company_name",
          "expr": "c.NAME",
          "grain": null,
          "is_time_column": false,
          "time_role": null
        },
        {
          "column_alias": "customer_id",
          "expr": "c.PORTAL_CUSTOMER_ID",
          "grain": null,
          "is_time_column": false,
          "time_role": null
        },
        {
          "column_alias": "email",
          "expr": "c.EMAIL",
          "grain": null,
          "is_time_column": false,
          "time_role": null
        },
        {
          "column_alias": "installation_id",
          "expr": "s.CWS_INSTALLATION",
          "grain": null,
          "is_time_column": false,
          "time_role": null
        },
        {
          "column_alias": "license_name",
          "expr": "COALESCE(s.EDITION, p.NAME)",
          "grain": null,
          "is_time_column": false,
          "time_role": null
        },
        {
          "column_alias": "source",
          "expr": "'Stripe'",
          "grain": null,
          "is_time_column": false,
          "time_role": null
        }
      ]
    },
    "watermark": {
      "classifications": [
        {
          "description": null,
          "is_watermark": false,
          "predicate": "NOT s.CWS_INSTALLATION IS NULL",
          "watermark_column": null,
          "watermark_type": null
        }
      ],
      "has_watermark": false,
      "watermark_summary": null
    }
  }
}
