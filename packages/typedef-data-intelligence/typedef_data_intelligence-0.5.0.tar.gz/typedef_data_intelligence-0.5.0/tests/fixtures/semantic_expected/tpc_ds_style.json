{
  "deterministic": {
    "column_analysis": {
      "column_refs": [
        {
          "alias": "d",
          "column": "d_date_sk",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "d",
          "column": "d_month",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "d",
          "column": "d_month",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "d",
          "column": "d_month",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "d",
          "column": "d_year",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "d",
          "column": "d_year",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "d",
          "column": "d_year",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "d",
          "column": "d_year",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "s",
          "column": "s_store_name",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "s",
          "column": "s_store_name",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "s",
          "column": "s_store_sk",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "ss",
          "column": "ss_net_profit",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "ss",
          "column": "ss_sold_date_sk",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "ss",
          "column": "ss_store_sk",
          "evidence": null,
          "scope": "outer"
        },
        {
          "alias": "ss",
          "column": "ss_ticket_number",
          "evidence": null,
          "scope": "outer"
        }
      ],
      "columns_by_alias": [
        {
          "alias": "d",
          "columns": [
            "d_date_sk",
            "d_month",
            "d_year"
          ]
        },
        {
          "alias": "s",
          "columns": [
            "s_store_name",
            "s_store_sk"
          ]
        },
        {
          "alias": "ss",
          "columns": [
            "ss_net_profit",
            "ss_sold_date_sk",
            "ss_store_sk",
            "ss_ticket_number"
          ]
        }
      ],
      "unresolved_unqualified": []
    },
    "filter_analysis": {
      "having": [],
      "normalized_predicates": [],
      "null_killing_on_outer": [],
      "qualify": [],
      "unresolved_predicates": [],
      "where": [
        "d.d_year BETWEEN 2020 AND 2022"
      ]
    },
    "grouping_outer": {
      "group_by": [
        "d.d_year",
        "d.d_month",
        "s.s_store_name"
      ],
      "is_aggregated": true,
      "measures": [
        "SUM(ss.ss_net_profit)",
        "COUNT(DISTINCT ss.ss_ticket_number)"
      ],
      "result_grain": [
        "d.d_year",
        "d.d_month",
        "s.s_store_name"
      ],
      "select": [
        {
          "alias": "d_month",
          "expr": "d.d_month",
          "is_literal": false,
          "source_aliases": [
            "d"
          ]
        },
        {
          "alias": "d_year",
          "expr": "d.d_year",
          "is_literal": false,
          "source_aliases": [
            "d"
          ]
        },
        {
          "alias": "profit",
          "expr": "SUM(ss.ss_net_profit)",
          "is_literal": false,
          "source_aliases": [
            "ss"
          ]
        },
        {
          "alias": "s_store_name",
          "expr": "s.s_store_name",
          "is_literal": false,
          "source_aliases": [
            "s"
          ]
        },
        {
          "alias": "ticket_count",
          "expr": "COUNT(DISTINCT ss.ss_ticket_number)",
          "is_literal": false,
          "source_aliases": [
            "ss"
          ]
        }
      ]
    },
    "join_analysis": {
      "joins": [
        {
          "effective_type": "INNER",
          "equi_condition": "ss.ss_store_sk = s.s_store_sk",
          "left": "d",
          "normalized_equi_condition": "ss.ss_store_sk = s.s_store_sk",
          "normalized_raw_condition": "ss.ss_store_sk = s.s_store_sk",
          "raw_condition": "ss.ss_store_sk = s.s_store_sk",
          "right": "s",
          "type": "INNER"
        },
        {
          "effective_type": "INNER",
          "equi_condition": "ss.ss_sold_date_sk = d.d_date_sk",
          "left": "ss",
          "normalized_equi_condition": "ss.ss_sold_date_sk = d.d_date_sk",
          "normalized_raw_condition": "ss.ss_sold_date_sk = d.d_date_sk",
          "raw_condition": "ss.ss_sold_date_sk = d.d_date_sk",
          "right": "d",
          "type": "INNER"
        }
      ]
    },
    "output_outer": {
      "limit": null,
      "offset": null,
      "order_by": [
        {
          "dir": "ASC",
          "expr": "d.d_month"
        },
        {
          "dir": "ASC",
          "expr": "d.d_year"
        }
      ],
      "select_distinct": false,
      "set_ops": []
    },
    "relation_analysis": {
      "alias_mappings": [
        {
          "alias": "d",
          "base": "date_dim"
        },
        {
          "alias": "s",
          "base": "store"
        },
        {
          "alias": "ss",
          "base": "store_sales"
        }
      ],
      "cte_defs": [],
      "driving_relations": [
        "ss"
      ],
      "from_clause_order": [
        "ss",
        "d",
        "s"
      ],
      "relations": [
        {
          "alias": "d",
          "base": "date_dim",
          "catalog": null,
          "evidence": [],
          "is_temp": false,
          "kind": "table",
          "schema_name": null,
          "scope": "outer"
        },
        {
          "alias": "s",
          "base": "store",
          "catalog": null,
          "evidence": [],
          "is_temp": false,
          "kind": "table",
          "schema_name": null,
          "scope": "outer"
        },
        {
          "alias": "ss",
          "base": "store_sales",
          "catalog": null,
          "evidence": [],
          "is_temp": false,
          "kind": "table",
          "schema_name": null,
          "scope": "outer"
        }
      ],
      "self_join_groups": [],
      "subqueries": [],
      "tables": [
        "date_dim",
        "store",
        "store_sales"
      ]
    },
    "window_outer": {
      "windows": []
    }
  },
  "dialect": "duckdb",
  "fixture": "tpc_ds_style",
  "heuristics": {
    "semantic": {
      "classifications": [
        {
          "business_name": "Month",
          "cardinality_hint": null,
          "column_alias": "d_month",
          "confidence": "medium",
          "derivation": "direct",
          "expr": "d.d_month",
          "is_categorical": false,
          "is_pii": false,
          "is_time_related": false,
          "pii_confidence": null,
          "pii_type": null,
          "semantic_role": "attribute",
          "table_type": "dimension"
        },
        {
          "business_name": "Year",
          "cardinality_hint": null,
          "column_alias": "d_year",
          "confidence": "medium",
          "derivation": "direct",
          "expr": "d.d_year",
          "is_categorical": false,
          "is_pii": false,
          "is_time_related": false,
          "pii_confidence": null,
          "pii_type": null,
          "semantic_role": "attribute",
          "table_type": "dimension"
        },
        {
          "business_name": "Profit",
          "cardinality_hint": null,
          "column_alias": "profit",
          "confidence": "high",
          "derivation": "aggregated",
          "expr": "SUM(ss.ss_net_profit)",
          "is_categorical": false,
          "is_pii": false,
          "is_time_related": false,
          "pii_confidence": null,
          "pii_type": null,
          "semantic_role": "metric",
          "table_type": "fact"
        },
        {
          "business_name": "Store Name",
          "cardinality_hint": null,
          "column_alias": "s_store_name",
          "confidence": "medium",
          "derivation": "direct",
          "expr": "s.s_store_name",
          "is_categorical": false,
          "is_pii": false,
          "is_time_related": false,
          "pii_confidence": null,
          "pii_type": null,
          "semantic_role": "attribute",
          "table_type": "unknown"
        },
        {
          "business_name": "Ticket Count",
          "cardinality_hint": null,
          "column_alias": "ticket_count",
          "confidence": "high",
          "derivation": "aggregated",
          "expr": "COUNT(DISTINCT ss.ss_ticket_number)",
          "is_categorical": false,
          "is_pii": false,
          "is_time_related": false,
          "pii_confidence": null,
          "pii_type": null,
          "semantic_role": "metric",
          "table_type": "fact"
        }
      ],
      "fact_alias": null,
      "has_surrogate_keys": false,
      "high_risk_pii_count": 0,
      "intent": "comparison",
      "pii_columns": [],
      "primary_key_candidates": []
    },
    "time": {
      "classifications": [
        {
          "column_alias": "d_month",
          "expr": "d.d_month",
          "grain": "month",
          "is_time_column": true,
          "time_role": "attribute"
        },
        {
          "column_alias": "d_year",
          "expr": "d.d_year",
          "grain": "year",
          "is_time_column": true,
          "time_role": "range_boundary"
        },
        {
          "column_alias": "profit",
          "expr": "SUM(ss.ss_net_profit)",
          "grain": null,
          "is_time_column": false,
          "time_role": null
        },
        {
          "column_alias": "s_store_name",
          "expr": "s.s_store_name",
          "grain": null,
          "is_time_column": false,
          "time_role": null
        },
        {
          "column_alias": "ticket_count",
          "expr": "COUNT(DISTINCT ss.ss_ticket_number)",
          "grain": null,
          "is_time_column": false,
          "time_role": null
        }
      ]
    },
    "watermark": {
      "classifications": [
        {
          "description": null,
          "is_watermark": false,
          "predicate": "d.d_year BETWEEN 2020 AND 2022",
          "watermark_column": null,
          "watermark_type": null
        }
      ],
      "has_watermark": false,
      "watermark_summary": null
    }
  }
}
