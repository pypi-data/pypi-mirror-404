from __future__ import annotations
from datetime import datetime
from pydantic import BaseModel, Field, UUID4


class Session(BaseModel):
    """RATS Session tracking for freshness and anti-replay."""
    session_id: UUID4 = Field(
        ...,
        description="Unique ID for this attester session.",
        examples=["550e8400-e29b-41d4-a716-446655440000"]
    )
    nonce: str = Field(
        ...,
        description="Anti-replay nonce generated by the relay/appraiser.",
        examples=["base64-random-string"]
    )
    expires_at: datetime = Field(
        ...,
        description="Timestamp when this session becomes invalid.",
        examples=["2025-12-30T23:59:59Z"]
    )
