$schema: "https://json-schema.org/draft/2020-12/schema"
title: "JSON schema for standard Ansible role spec files"
description: "JSON schema for validating the standard role spec file format defined by Ansible"
definitions:
  description:
    description: "A description with a single string or a list of strings."
    oneOf:
      - description: "A single string. Ansible markup can be used."
        type: string
      - description: "A list of strings. Each list item is a new paragraph."
        type: array
        items:
          description: "A single string. Ansible markup can be used."
          type: string
  options:
    description: "Options (i.e. input parameters, local variables, output parameters) for the role entry point."
    type: object
    patternProperties:
      ^[a-zA-Z0-9_]+$:
        description: "Key: The name of the option."
        type: object
        additionalProperties: true
        properties:
          description:
            description: "Detailed explanation of the role variable. It should be written in full sentences."
            $ref: "#/definitions/description"
          version_added:
            description: "Collection or Ansible version in which the variable was added. Only needed if the variable
              was added after the initial role/entry point release."
            type: string
          type:
            description: "The Ansible data type of the variable. See
              https://docs.ansible.com/projects/ansible/latest/dev_guide/developing_program_flow_modules.html#argument-spec
              for allowed values. The default is 'str'."
            type: string
          required:
            description: "Indicates that the variable is required to be specified in the role input. Default: false"
            type: boolean
          default:
            description: "Default value for the variable if it is not required. Default: null. If the variable has a
              boolean type, you should use true/false if you want to be compatible with ansible-lint."
            # The default value can have any Ansible data type
          choices:
            description: "List of valid values for the variable."
            type: array
            items:
              description: "A valid value for the variable."
              # The array items can have any Ansible data type
          elements:
            description: "The Ansible data type for list elements when the type is list."
            type: string
          options:
            # The structure of the variable value when the type is dict.
            $ref: "#/definitions/options"
type: object
required:
  - argument_specs
additionalProperties: false
properties:
  argument_specs:
    description: "The argument specifications for the role"
    type: object
    required:
      - main
    patternProperties:
      ^[a-zA-Z0-9_]+$:
        description: "The argument specification for a single role entry point of the role (e.g. main).
          The property name is the name of the role entry point.
          This should be 'main' in the case of an unspecified entry point.
          This will be the base name of the tasks file to execute, with no .yml or .yaml file extension."
        type: object
        required:
          - short_description
          - description
          - options
        additionalProperties: true
        properties:
          short_description:
            description: "A short, one-line description of the role entry point.
              Ansible markup can be used.
              It should be a phrase and not a sentence, and it should not end in a period."
            type: string
          description:
            description: "A longer description of the role entry point that may contain multiple lines. Ansible markup
              can be used."
            $ref: "#/definitions/description"
          version_added:
            description: "Collection or Ansible version in which the role entry point was added."
            type: string
          author:
            description: "The author(s) of the role. A single author can be specified as a single string or as a list
              of strings with one item."
            oneOf:
              - description: "Full name of the author."
                type: string
              - description: "A list of authors."
                type: array
                items:
                  description: "Full name of the author."
                  type: string
          options:
            $ref: "#/definitions/options"
