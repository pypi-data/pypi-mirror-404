reference-state:
  Tref: 0.
  Pref: 1.e5

species:
  - name: dry
    composition: {H: 1.5, He: 0.15}
    cv_R: 2.5

  - name: H2O
    composition: {H: 2, O: 1}
    cv_R: 2.5
    u0_R: 0.

  - name: NH3
    composition: {H: 2, O: 1}
    cv_R: 2.5
    u0_R: 0.

  - name: H2S
    composition: {H: 2, S: 1}
    cv_R: 2.5
    u0_R: 0.

  - name: H2O(l)
    composition: {H: 2, O: 1}
    cv_R: 9.0
    u0_R: -3430.

  - name: H2O(l,p)
    composition: {H: 2, O: 1}
    cv_R: 9.0
    u0_R: -3430.

  - name: NH3(s)
    composition: {N: 1, H: 3}
    cv_R: 9.0
    u0_R: -5520.

  - name: NH3(s,p)
    composition: {N: 1, H: 3}
    cv_R: 9.0
    u0_R: -5520.

  - name: NH4SH(s)
    composition: {N: 1, H: 5, S: 1}
    cv_R: 9.0
    u0_R: -1.2e4

  - name: NH4SH(s,p)
    composition: {N: 1, H: 5, S: 1}
    cv_R: 9.0
    u0_R: -1.2e4

geometry:
  type: cartesian

  bounds:
    x1min: 0.
    x1max: 300.e3
    x2min: 0.
    x2max: 2400.e3
    x3min: 0.
    x3max: 2400.e3

  cells:
    nx1: 100
    nx2: 100
    nx3: 100
    nghost: 3

distribute:
  backend: gloo
  layout: slab
  nb2: 2
  nb3: 2
  verbose: false

dynamics:
  equation-of-state:
    type: ideal-moist
    density-floor:  1.e-10
    pressure-floor: 1.e-10
    tracer-floor: 1.e-10
    limiter: true
    max-iter: 20
    ftol: 1.e-6

  vertical-projection:
    type: temperature
    pressure-margin: 1.e-6

  reconstruct:
    vertical: {type: weno5, scale: true, shock: true}
    horizontal: {type: weno5, scale: true, shock: true}

  riemann-solver:
    type: hllc

boundary-condition:
  external:
    x1-inner: reflecting
    x1-outer: reflecting
    x2-inner: reflecting
    x2-outer: reflecting
    x3-inner: reflecting
    x3-outer: reflecting

integration:
  type: rk3
  cfl: 0.45
  implicit-scheme: 1
  nlim: -1
  tlim: 100.e5
  ncycle_out: 1

outputs:
  - type: restart
    dt: 1.E5
  - type: netcdf
    variables: [prim, uov]
    dt: 1.E3
  - type: netcdf
    variables: [thermo, path]
    dt: 1.E3

forcing:
  const-gravity:
    grav1: -22.

  top-cool:
    flux: -100.
    depth: 5

  bot-heat:
    flux: 100
    depth: 5

sedimentation:
  radius:
    H2O(l,p): 1.0e-10
    NH3(s,p): 1.0e-10
    NH4SH(s,p): 1.0e-10

  density:
    H2O(l,p): 1000.
    NH3(s,p): 800.
    NH4SH(s,p): 1500.

  const-vsed:
    H2O(l,p): -20.0
    NH3(s,p): -20.0
    NH4SH(s,p): -20.0

reactions:
  - equation: H2O => H2O(l)
    type: nucleation
    rate-constant: {formula: h2o_ideal}

  - equation: H2O(l) => H2O(l,p)
    type: coagulation
    rate-constant: {A: 0.001, b: 0, Ea_R: 0.}

  - equation: H2O(l,p) => H2O
    type: evaporation
    rate-constant: {formula: h2o_ideal, diff_c: 0.2e-4, diff_T: 0., diff_P: 0., vm: 18.e-6, diameter: 1.0e-4}

  - equation: NH3 => NH3(s)
    type: nucleation
    rate-constant: {formula: nh3_ideal}

  - equation: NH3(s) => NH3(s,p)
    type: coagulation
    rate-constant: {A: 0.001, b: 0, Ea_R: 2.}

  - equation: NH3(s,p) => NH3
    type: evaporation
    rate-constant: {formula: nh3_ideal, diff_c: 0.2e-4, diff_T: 0., diff_P: 0., vm: 18.e-6, diameter: 1.0e-4}

  - equation: NH3 + H2S <=> NH4SH(s)
    type: nucleation
    rate-constant: {formula: nh3_h2s_lewis}

  - equation: NH4SH(s) => NH4SH(s,p)
    type: coagulation
    rate-constant: {A: 0.001, b: 0, Ea_R: 0.}

  - equation: NH4SH(s,p) => NH3 + H2S
    type: evaporation
    rate-constant: {formula: nh3_h2s_lewis, diff_c: 0.2e-4, diff_T: 0., diff_P: 0., vm: 18.e-6, diameter: 1.0e-4}

problem:
  Ps: 100.e5
  Ts: 600.
  Tmin: 110.
  xH2O: 3.e-3
  xNH3: 3.2e-4
  xH2S: 1.e-5
