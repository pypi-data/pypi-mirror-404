"use strict";(self.webpackChunkgitoon_frontend=self.webpackChunkgitoon_frontend||[]).push([["11384"],{40235:function(a,t,e){e.a(a,async function(a,n){try{e.r(t),e.d(t,{HuiPowerSourcesGraphCard:function(){return H}});var r,o,s,i,c=e(78261),l=e(61397),h=e(7739),u=e(47075),d=e(31432),p=e(50264),g=e(72153),f=e(44734),v=e(43080),y=e(69683),_=e(6454),b=(e(28706),e(62062),e(44114),e(72712),e(18111),e(7588),e(61701),e(18237),e(13579),e(2892),e(69085),e(5506),e(79432),e(26099),e(23500),e(40445)),m=e(81859),w=e(40600),k=e(73684),A=e(83309),D=e(96196),C=e(77845),S=e(94333),j=e(22786),z=e(71578),O=e(44439),x=(e(76776),e(38114)),E=e(54706),P=e(784),M=e(97372),q=e(79468),G=a([O,x,M]);[O,x,M]=G.then?(await G)():G;var H=function(a){function t(){var a;(0,f.A)(this,t);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(a=(0,y.A)(this,t,[].concat(n)))._chartData=[],a._start=(0,m.R)(),a._end=(0,w.o)(),a.hassSubscribeRequiredHostProps=["_config"],a._createOptions=(0,j.A)(function(t,e,n,r,o,s,i){var c;return Object.assign(Object.assign({},(0,M.od)(t,e,n,r,"kW",o,s,void 0,!0)),{},{legend:{show:!1!==(null===(c=a._config)||void 0===c?void 0:c.show_legend),type:"custom",data:i}})}),a}return(0,_.A)(t,a),(0,v.A)(t,[{key:"hassSubscribe",value:function(){var a,t=this;return[(0,x.tb)(this.hass,{key:null===(a=this._config)||void 0===a?void 0:a.collection_key}).subscribe(function(a){return t._getStatistics(a)})]}},{key:"getCardSize",value:function(){return 3}},{key:"setConfig",value:function(a){this._config=a}},{key:"shouldUpdate",value:function(a){return(0,P.xP)(this,a)||a.size>1||!a.has("hass")}},{key:"render",value:function(){return this.hass&&this._config?(0,D.qy)(r||(r=(0,g.A)([" <ha-card> ",' <div class="content ','"> <ha-chart-base .hass="','" .data="','" .options="','"></ha-chart-base> '," </div> </ha-card> "])),this._config.title?(0,D.qy)(o||(o=(0,g.A)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",(0,S.H)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,this._compareStart,this._compareEnd,this._legendData),this._chartData.some(function(a){return a.data.length})?D.s6:(0,D.qy)(s||(s=(0,g.A)(['<div class="no-data"> '," </div>"])),(0,k.c)(this._start)?this.hass.localize("ui.panel.lovelace.cards.energy.no_data"):this.hass.localize("ui.panel.lovelace.cards.energy.no_data_period"))):D.s6}},{key:"_getStatistics",value:(e=(0,p.A)((0,l.A)().m(function a(t){var e,n,r,o,s,i,c,p,g,f,v,y,_=this;return(0,l.A)().w(function(a){for(;;)switch(a.p=a.n){case 0:n=[],this._legendData=[],r={solar:{stats:[],color:"--energy-solar-color",name:this.hass.localize("ui.panel.lovelace.cards.energy.power_graph.solar")},grid:{stats:[],color:"--energy-grid-consumption-color",name:this.hass.localize("ui.panel.lovelace.cards.energy.power_graph.grid")},battery:{stats:[],color:"--energy-battery-out-color",name:this.hass.localize("ui.panel.lovelace.cards.energy.power_graph.battery")}},o=getComputedStyle(this),s=(0,d.A)(t.prefs.energy_sources),a.p=1,s.s();case 2:if((i=s.n()).done){a.n=6;break}if("solar"!==(c=i.value).type){a.n=3;break}return c.stat_rate&&r.solar.stats.push(c.stat_rate),a.a(3,5);case 3:if("battery"!==c.type){a.n=4;break}return c.stat_rate&&r.battery.stats.push(c.stat_rate),a.a(3,5);case 4:"grid"===c.type&&c.power&&(p=r.grid.stats).push.apply(p,(0,h.A)(c.power.map(function(a){return a.stat_rate})));case 5:a.n=2;break;case 6:a.n=8;break;case 7:a.p=7,y=a.v,s.e(y);case 8:return a.p=8,s.f(),a.f(8);case 9:g={type:"line",smooth:.4,smoothMonotone:"x",lineStyle:{width:1}},f=Date.now(),Object.keys(r).forEach(function(a,e){if(r[a].stats.length){var s=o.getPropertyValue(r[a].color),i=(0,q.xp)(s),c=_._processData(r[a].stats.map(function(a){var e,n=null!==(e=t.stats[a])&&void 0!==e?e:[];if((0,A.r)(f,_._start)&&(0,A.r)(f,_._end)){var r=(0,x.h4)(_.hass.states[a]);void 0!==r&&n.push({start:f,end:f,mean:r/1e3})}return n})),l=c.positive,h=c.negative;n.push(Object.assign(Object.assign({},g),{},{id:a,name:r[a].name,color:s,stack:"positive",areaStyle:{color:new z.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(".concat(i[0],", ").concat(i[1],", ").concat(i[2],", 0.75)")},{offset:1,color:"rgba(".concat(i[0],", ").concat(i[1],", ").concat(i[2],", 0.25)")}])},data:l,z:3-e})),"solar"!==a&&n.push(Object.assign(Object.assign({},g),{},{id:"".concat(a,"-negative"),name:r[a].name,color:s,stack:"negative",areaStyle:{color:new z.LinearGradient(0,1,0,0,[{offset:0,color:"rgba(".concat(i[0],", ").concat(i[1],", ").concat(i[2],", 0.75)")},{offset:1,color:"rgba(".concat(i[0],", ").concat(i[1],", ").concat(i[2],", 0.25)")}])},data:h,z:4-e})),_._legendData.push({id:a,secondaryIds:"solar"!==a?["".concat(a,"-negative")]:[],name:r[a].name,itemStyle:{color:"rgba(".concat(i[0],", ").concat(i[1],", ").concat(i[2],", 0.75)"),borderColor:s}})}}),this._start=t.start,this._end=t.end||(0,w.o)(),this._chartData=(0,M.JR)(n),v=[],null===(e=this._chartData[0])||void 0===e||e.data.forEach(function(a,t){var e="object"===(0,u.A)(a)&&"value"in a?a.value[0]:a[0];v[t]=[e,0],_._chartData.forEach(function(a){var e="object"===(0,u.A)(a.data[t])&&"value"in a.data[t]?a.data[t].value[1]:a.data[t][1];v[t][1]+=e})}),this._chartData.push(Object.assign(Object.assign({},g),{},{id:"usage",name:this.hass.localize("ui.panel.lovelace.cards.energy.power_graph.usage"),color:o.getPropertyValue("--primary-text-color"),lineStyle:{type:[7,2],width:1.5},data:v,z:5})),this._legendData.push({id:"usage",name:this.hass.localize("ui.panel.lovelace.cards.energy.power_graph.usage"),itemStyle:{color:o.getPropertyValue("--primary-text-color")}});case 10:return a.a(2)}},a,this,[[1,7,8,9]])})),function(a){return e.apply(this,arguments)})},{key:"_processData",value:function(a){var t={};a.forEach(function(a){a.forEach(function(a){var e;if(null!=a.mean){var n=(a.start+a.end)/2;t[n]=[].concat((0,h.A)(null!==(e=t[n])&&void 0!==e?e:[]),[a.mean])}})});var e=[],n=[];return Object.entries(t).forEach(function(a){var t=(0,c.A)(a,2),r=t[0],o=t[1],s=Number(r),i=o.reduce(function(a,t){return a+t},0);e.push([s,Math.max(0,i)]),n.push([s,Math.min(0,i)])}),{positive:e,negative:n}}}]);var e}((0,E.E)(D.WF));H.styles=(0,D.AH)(i||(i=(0,g.A)(["ha-card{height:100%}.card-header{padding-bottom:0}.content{padding:var(--ha-space-4)}.has-header{padding-top:0}.no-data{position:absolute;height:100%;top:0;left:0;right:0;display:flex;justify-content:center;align-items:center;padding:20%;margin-left:var(--ha-space-8);margin-inline-start:var(--ha-space-8);margin-inline-end:initial;box-sizing:border-box}"]))),(0,b.Cg)([(0,C.MZ)({attribute:!1})],H.prototype,"hass",void 0),(0,b.Cg)([(0,C.wk)()],H.prototype,"_config",void 0),(0,b.Cg)([(0,C.wk)()],H.prototype,"_chartData",void 0),(0,b.Cg)([(0,C.wk)()],H.prototype,"_legendData",void 0),(0,b.Cg)([(0,C.wk)()],H.prototype,"_start",void 0),(0,b.Cg)([(0,C.wk)()],H.prototype,"_end",void 0),(0,b.Cg)([(0,C.wk)()],H.prototype,"_compareStart",void 0),(0,b.Cg)([(0,C.wk)()],H.prototype,"_compareEnd",void 0),H=(0,b.Cg)([(0,C.EM)("hui-power-sources-graph-card")],H),n()}catch(L){n(L)}})},71578:function(a,t,e){e.r(t),e.d(t,{LinearGradient:function(){return b.A}});var n=e(88648),r=e(59126),o=e(25636),s=e(2403),i=e(3650),c=e(30137),l=e(69913),h=e(43401),u=e(87370),d=e(57610),p=e(44390),g=e(11069),f=e(88132),v=e(6036),y=e(88298),_=e(15490),b=e(67665);n.Y([o.a,s.a,i.a,c.a,l.a,h.a,u.a,d.a,p.a,g.a,v._,y.i,_.a,f.a]),t.default=r},43382:function(a,t,e){e.d(t,{A:function(){return r}});var n=e(51039);function r(a){return(0,n.w)(a,Date.now())}},83309:function(a,t,e){e.d(t,{r:function(){return s}});var n=e(78261),r=e(74816),o=e(35932);function s(a,t,e){var s=(0,r.x)(null==e?void 0:e.in,a,t),i=(0,n.A)(s,2),c=i[0],l=i[1];return+(0,o.o)(c)===+(0,o.o)(l)}},73684:function(a,t,e){e.d(t,{c:function(){return s}});var n=e(51039),r=e(43382),o=e(83309);function s(a,t){return(0,o.r)((0,n.w)((null==t?void 0:t.in)||a,a),(0,r.A)((null==t?void 0:t.in)||a))}}}]);
//# sourceMappingURL=11384.95d1a0a062f5e6e9.js.map