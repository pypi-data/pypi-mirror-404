/*! For license information please see 53982.40b58952c9f6e709.js.LICENSE.txt */
"use strict";(self.webpackChunkgitoon_frontend=self.webpackChunkgitoon_frontend||[]).push([["53982"],{29781:function(e,t,a){a.d(t,{$:function(){return C}});var n,i,r,s=a(44734),o=a(43080),c=a(69683),l=a(6454),h=a(25460),u=(a(69085),a(40445)),d=a(96592),p=a(77845),f=a(72153),g=a(12451),v=a(12130),_=a(84730),m=a(96196),y=a(94333),b=v.QQ?{passive:!0}:void 0,w=function(e){function t(){var e;return(0,s.A)(this,t),(e=(0,c.A)(this,t,arguments)).centerTitle=!1,e.handleTargetScroll=function(){e.mdcFoundation.handleTargetScroll()},e.handleNavigationClick=function(){e.mdcFoundation.handleNavigationClick()},e}return(0,l.A)(t,e),(0,o.A)(t,[{key:"scrollTarget",get:function(){return this._scrollTarget||window},set:function(e){this.unregisterScrollListener();var t=this.scrollTarget;this._scrollTarget=e,this.updateRootPosition(),this.requestUpdate("scrollTarget",t),this.registerScrollListener()}},{key:"updateRootPosition",value:function(){if(this.mdcRoot){var e=this.scrollTarget===window;this.mdcRoot.style.position=e?"":"absolute"}}},{key:"render",value:function(){var e=(0,m.qy)(n||(n=(0,f.A)(['<span class="mdc-top-app-bar__title"><slot name="title"></slot></span>'])));return this.centerTitle&&(e=(0,m.qy)(i||(i=(0,f.A)(['<section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-center">',"</section>"])),e)),(0,m.qy)(r||(r=(0,f.A)([' <header class="mdc-top-app-bar ','"> <div class="mdc-top-app-bar__row"> <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start" id="navigation"> <slot name="navigationIcon" @click="','"></slot> '," </section> ",' <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end" id="actions" role="toolbar"> <slot name="actionItems"></slot> </section> </div> </header> <div class="','"> <slot></slot> </div> '])),(0,y.H)(this.barClasses()),this.handleNavigationClick,this.centerTitle?null:e,this.centerTitle?e:null,(0,y.H)(this.contentClasses()))}},{key:"createAdapter",value:function(){var e=this;return Object.assign(Object.assign({},(0,g.i)(this.mdcRoot)),{setStyle:function(t,a){return e.mdcRoot.style.setProperty(t,a)},getTopAppBarHeight:function(){return e.mdcRoot.clientHeight},notifyNavigationIconClicked:function(){e.dispatchEvent(new Event(_.P$.NAVIGATION_EVENT,{bubbles:!0,cancelable:!0}))},getViewportScrollY:function(){return e.scrollTarget instanceof Window?e.scrollTarget.pageYOffset:e.scrollTarget.scrollTop},getTotalActionItems:function(){return e._actionItemsSlot.assignedNodes({flatten:!0}).length}})}},{key:"registerListeners",value:function(){this.registerScrollListener()}},{key:"unregisterListeners",value:function(){this.unregisterScrollListener()}},{key:"registerScrollListener",value:function(){this.scrollTarget.addEventListener("scroll",this.handleTargetScroll,b)}},{key:"unregisterScrollListener",value:function(){this.scrollTarget.removeEventListener("scroll",this.handleTargetScroll)}},{key:"firstUpdated",value:function(){(0,h.A)(t,"firstUpdated",this,3)([]),this.updateRootPosition(),this.registerListeners()}},{key:"disconnectedCallback",value:function(){(0,h.A)(t,"disconnectedCallback",this,3)([]),this.unregisterListeners()}}])}(g.O);(0,u.Cg)([(0,p.P)(".mdc-top-app-bar")],w.prototype,"mdcRoot",void 0),(0,u.Cg)([(0,p.P)('slot[name="actionItems"]')],w.prototype,"_actionItemsSlot",void 0),(0,u.Cg)([(0,p.MZ)({type:Boolean})],w.prototype,"centerTitle",void 0),(0,u.Cg)([(0,p.MZ)({type:Object})],w.prototype,"scrollTarget",null);var k=function(e){function t(){var e;return(0,s.A)(this,t),(e=(0,c.A)(this,t,arguments)).mdcFoundationClass=d.A,e.prominent=!1,e.dense=!1,e.handleResize=function(){e.mdcFoundation.handleWindowResize()},e}return(0,l.A)(t,e),(0,o.A)(t,[{key:"barClasses",value:function(){return{"mdc-top-app-bar--dense":this.dense,"mdc-top-app-bar--prominent":this.prominent,"center-title":this.centerTitle}}},{key:"contentClasses",value:function(){return{"mdc-top-app-bar--fixed-adjust":!this.dense&&!this.prominent,"mdc-top-app-bar--dense-fixed-adjust":this.dense&&!this.prominent,"mdc-top-app-bar--prominent-fixed-adjust":!this.dense&&this.prominent,"mdc-top-app-bar--dense-prominent-fixed-adjust":this.dense&&this.prominent}}},{key:"registerListeners",value:function(){(0,h.A)(t,"registerListeners",this,3)([]),window.addEventListener("resize",this.handleResize,b)}},{key:"unregisterListeners",value:function(){(0,h.A)(t,"unregisterListeners",this,3)([]),window.removeEventListener("resize",this.handleResize)}}])}(w);(0,u.Cg)([(0,p.MZ)({type:Boolean,reflect:!0})],k.prototype,"prominent",void 0),(0,u.Cg)([(0,p.MZ)({type:Boolean,reflect:!0})],k.prototype,"dense",void 0);var A=a(23665),C=function(e){function t(){var e;return(0,s.A)(this,t),(e=(0,c.A)(this,t,arguments)).mdcFoundationClass=A.A,e}return(0,l.A)(t,e),(0,o.A)(t,[{key:"barClasses",value:function(){return Object.assign(Object.assign({},(0,h.A)(t,"barClasses",this,3)([])),{"mdc-top-app-bar--fixed":!0})}},{key:"registerListeners",value:function(){this.scrollTarget.addEventListener("scroll",this.handleTargetScroll,b)}},{key:"unregisterListeners",value:function(){this.scrollTarget.removeEventListener("scroll",this.handleTargetScroll)}}])}(k)},27330:function(e,t,a){var n,i=a(72153),r=a(43080),s=a(44734),o=a(69683),c=a(6454),l=(a(28706),a(40445)),h=a(29781),u=a(71467),d=a(96196),p=a(77845),f=function(e){function t(){var e;(0,s.A)(this,t);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(e=(0,o.A)(this,t,[].concat(n))).narrow=!1,e}return(0,c.A)(t,e),(0,r.A)(t)}(h.$);f.styles=[u.R,(0,d.AH)(n||(n=(0,i.A)(["header{padding-top:var(--safe-area-inset-top)}.mdc-top-app-bar__row{height:var(--header-height);border-bottom:var(--app-header-border-bottom)}.mdc-top-app-bar--fixed-adjust{padding-top:calc(var(--header-height,0px) + var(--safe-area-inset-top,0px));padding-bottom:var(--safe-area-inset-bottom);padding-right:var(--safe-area-inset-right)}:host([narrow]) .mdc-top-app-bar--fixed-adjust{padding-left:var(--safe-area-inset-left)}.mdc-top-app-bar{--mdc-typography-headline6-font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,var(--mdc-theme-on-primary,#fff));background-color:var(--app-header-background-color,var(--mdc-theme-primary));padding-top:var(--safe-area-inset-top);padding-right:var(--safe-area-inset-right)}:host([narrow]) .mdc-top-app-bar{padding-left:var(--safe-area-inset-left)}.mdc-top-app-bar__title{font-size:var(--ha-font-size-xl);padding-inline-start:24px;padding-inline-end:initial}"])))],(0,l.Cg)([(0,p.MZ)({type:Boolean,reflect:!0})],f.prototype,"narrow",void 0),f=(0,l.Cg)([(0,p.EM)("ha-top-app-bar-fixed")],f)},4203:function(e,t,a){a.a(e,async function(e,n){try{a.r(t),a.d(t,{DEFAULT_ENERGY_COLLECTION_KEY:function(){return L}});var i,r,s,o,c,l=a(72153),h=a(78261),u=a(61397),d=a(50264),p=a(44734),f=a(43080),g=a(69683),v=a(6454),_=a(25460),m=(a(28706),a(2008),a(50113),a(23418),a(74423),a(23792),a(62062),a(44114),a(26910),a(13609),a(18111),a(22489),a(20116),a(7588),a(61701),a(13579),a(2892),a(69085),a(5506),a(26099),a(16034),a(3362),a(38781),a(31415),a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698),a(21699),a(47764),a(23500),a(62953),a(3296),a(27208),a(48408),a(14603),a(47566),a(98721),a(40445)),y=a(96196),b=a(77845),w=a(94333),k=a(91926),A=(a(38962),a(90248),a(2054),a(27330),a(38114)),C=a(91984),x=a(14503),D=a(30039),E=a(73887),O=a(29994),T=a(75400),z=(a(87778),e([E,O,T,A]));[E,O,T,A]=z.then?(await z)():z;var L="energy_dashboard",S={energy_sources:[],device_consumption:[],device_consumption_water:[]},R={path:"overview",strategy:{type:"energy-overview",collection_key:L,show_period_selector:!0}},M={path:"electricity",strategy:{type:"energy",collection_key:L,show_period_selector:!0}},P={path:"water",strategy:{type:"water",collection_key:L,show_period_selector:!0}},j={path:"gas",strategy:{type:"gas",collection_key:L,show_period_selector:!0}},N={path:"now",strategy:{type:"power",collection_key:"energy_dashboard_now"}},U={type:"panel",path:"setup",cards:[{type:"custom:energy-setup-wizard-card"}]},q=function(e){function t(){var e;(0,p.A)(this,t);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(e=(0,g.A)(this,t,[].concat(n))).narrow=!1,e._fetchEnergyPrefs=(0,d.A)((0,u.A)().m(function t(){var a,n;return(0,u.A)().w(function(t){for(;;)switch(t.p=t.n){case 0:return a=(0,A.tb)(e.hass,{key:L}),t.p=1,t.n=2,a.refresh();case 2:t.n=5;break;case 3:if(t.p=3,"not_found"!==(n=t.v).code){t.n=4;break}return t.a(2,void 0);case 4:throw n;case 5:return t.a(2,a.prefs)}},t,null,[[1,3]])})),e._dumpCSV=(0,d.A)((0,u.A)().m(function t(){var a,n,i,r,s,o,c,l,d,p,f,g,v,_,m,y,b,w,k,C,x,E,O,T,z,L,S,R,M,P,j,N,U,q,I,Z,F,H,V;return(0,u.A)().w(function(t){for(;;)switch(t.n){case 0:if((a=(0,A.tb)(e.hass,{key:"energy_dashboard"})).prefs&&a.state.stats){t.n=1;break}return t.a(2);case 1:n=a.state.gasUnit,i="kWh",r=a.prefs.energy_sources,s=a.prefs.device_consumption,o=a.prefs.device_consumption_water,c=a.state.stats,l=new Set,Object.values(c).forEach(function(e){e.forEach(function(e){l.add(e.start)})}),d=Array.from(l).sort(),p="entity_id,type,unit,"+d.map(function(e){return new Date(e).toISOString()}).join(",")+"\n",(f=[])[0]=p,g=function(e,t,a,n){var i=0,r=[];r.push(e),r.push(t),r.push(a.normalize("NFKD")),d.forEach(function(e){var t;i<n.length&&n[i].start===e?(r.push((null!==(t=n[i].change)&&void 0!==t?t:"").toString()),i++):r.push("")}),f.push(r.join(",")+"\n")},v=function(e,t,a){c[e]&&g(e,t,a,c[e])},_=e.hass.config.currency,m=function(e,t,a,n,i){t.length&&(t.forEach(function(t){return v(t,e,a)}),n&&i&&i.forEach(function(e){return v(e,n,_)}))},y=[],b=[],w=[],k=[],r.filter(function(e){return"grid"===e.type}).forEach(function(e){e.flow_from.forEach(function(e){var t=e.stat_energy_from;y.push(t);var n=e.stat_cost||a.state.info.cost_sensors[t];n&&w.push(n)}),e.flow_to.forEach(function(e){var t=e.stat_energy_to;b.push(t);var n=e.stat_compensation||a.state.info.cost_sensors[t];n&&k.push(n)})}),m("grid_consumption",y,i,"grid_consumption_cost",w),m("grid_return",b,i,"grid_return_compensation",k),C=[],x=[],r.filter(function(e){return"battery"===e.type}).forEach(function(e){C.push(e.stat_energy_to),x.push(e.stat_energy_from)}),m("battery_in",C,i),m("battery_out",x,i),E=[],r.filter(function(e){return"solar"===e.type}).forEach(function(e){E.push(e.stat_energy_from)}),m("solar_production",E,i),O=[],T=[],r.filter(function(e){return"gas"===e.type}).forEach(function(e){var t=e.stat_energy_from;O.push(t);var n=e.stat_cost||a.state.info.cost_sensors[t];n&&T.push(n)}),m("gas_consumption",O,n,"gas_consumption_cost",T),z=[],L=[],r.filter(function(e){return"water"===e.type}).forEach(function(e){var t=e.stat_energy_from;z.push(t);var n=e.stat_cost||a.state.info.cost_sensors[t];n&&L.push(n)}),m("water_consumption",z,a.state.waterUnit,"water_consumption_cost",L),S=[],s.forEach(function(e){S.push(e.stat_consumption)}),m("device_consumption",S,i),o&&(R=[],o.forEach(function(e){R.push(e.stat_consumption)}),m("device_consumption_water",R,a.state.waterUnit)),M=(0,A.gv)(a.state),P=M.summedData,M.compareSummedData,j=(0,A.DR)(P,void 0),N=j.consumption,j.compareConsumption,U=function(e,t,a){var n=[];Object.entries(a).forEach(function(e){var t=(0,h.A)(e,2),a=t[0],i=t[1];n.push({start:Number(a),end:NaN,change:i})}),g("",e,t,n)},q=!!E.length,I=!!C.length,Z=!!b.length,(F=!!y.length)&&(U("calculated_consumed_grid",i,N.used_grid),I&&U("calculated_grid_to_battery",i,N.grid_to_battery)),Z&&I&&U("calculated_battery_to_grid",i,N.battery_to_grid),I&&U("calculated_consumed_battery",i,N.used_battery),q&&(U("calculated_consumed_solar",i,N.used_solar),I&&U("calculated_solar_to_battery",i,N.solar_to_battery),Z&&U("calculated_solar_to_grid",i,N.solar_to_grid)),(F?1:0)+(q?1:0)+(I?1:0)>1&&U("calculated_total_consumption",i,N.used_total),H=new Blob(f,{type:"text/csv"}),V=window.URL.createObjectURL(H),(0,D.R)(V,"energy.csv");case 2:return t.a(2)}},t)})),e}return(0,v.A)(t,e),(0,f.A)(t,[{key:"_extraActionItems",get:function(){return[{icon:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z",labelKey:"ui.panel.energy.download_data",action:this._dumpCSV}]}},{key:"willUpdate",value:function(e){if((0,_.A)(t,"willUpdate",this,3)([e]),!this.hasUpdated)return this.hass.loadFragmentTranslation("lovelace"),void this._loadConfig();if(e.has("hass")){var a=e.get("hass");a&&a.localize!==this.hass.localize&&this._setLovelace()}}},{key:"_loadConfig",value:(b=(0,d.A)((0,u.A)().m(function e(){var t,a,n,i,r,s;return(0,u.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,this._error=void 0,e.n=1,this._fetchEnergyPrefs();case 1:a=e.v,this._prefs=a||S,e.n=3;break;case 2:e.p=2,s=e.v,console.error("Failed to load prefs:",s),this._prefs=S,this._error=s.message||"Unknown error";case 3:return e.n=4,this._setLovelace();case 4:n=(null===(t=this._lovelace.config)||void 0===t?void 0:t.views)||[],i=n.map(function(e){return e.path}),(r=this.route.path.split("/")[1])&&i.includes(r)?this.route=Object.assign({},this.route):(0,k.o)("".concat(this.route.prefix,"/").concat(i[0]),{replace:!0});case 5:return e.a(2)}},e,this,[[0,2]])})),function(){return b.apply(this,arguments)})},{key:"_setLovelace",value:(m=(0,d.A)((0,u.A)().m(function e(){var t,a=this;return(0,u.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this._generateLovelaceConfig();case 1:t=e.v,this._lovelace={config:t,rawConfig:t,editMode:!1,urlPath:"energy",mode:"generated",locale:this.hass.locale,enableFullEditMode:function(){},saveConfig:function(){var e=(0,d.A)((0,u.A)().m(function e(){return(0,u.A)().w(function(e){for(;;)if(0===e.n)return e.a(2,void 0)},e)}));return function(){return e.apply(this,arguments)}}(),deleteConfig:function(){var e=(0,d.A)((0,u.A)().m(function e(){return(0,u.A)().w(function(e){for(;;)if(0===e.n)return e.a(2,void 0)},e)}));return function(){return e.apply(this,arguments)}}(),setEditMode:function(){return a._navigateConfig()},showToast:function(){}};case 2:return e.a(2)}},e,this)})),function(){return m.apply(this,arguments)})},{key:"render",value:function(){var e,t;if(this._error)return(0,y.qy)(i||(i=(0,l.A)([' <div class="centered"> <ha-alert alert-type="error"> An error occurred loading energy preferences: '," </ha-alert> </div> "])),this._error);if(!this._prefs)return(0,y.qy)(r||(r=(0,l.A)([' <div class="centered"> <ha-spinner size="large"></ha-spinner> </div> '])));if(!this._lovelace)return y.s6;var a=(null===(e=this.route)||void 0===e||null===(e=e.path)||void 0===e?void 0:e.split("/")[1])||"",n=this._lovelace.config.views.find(function(e){return e.path===a}),c=n&&(0,C.R)(n)&&(null===(t=n.strategy)||void 0===t?void 0:t.show_period_selector);return(0,y.qy)(s||(s=(0,l.A)([' <hui-root .hass="','" .narrow="','" .lovelace="','" .route="','" .panel="','" .extraActionItems="','" @reload-energy-panel="','" class="','"> </hui-root> '," "])),this.hass,this.narrow,this._lovelace,this.route,this.panel,this._extraActionItems,this._reloadConfig,(0,w.H)({"has-period-selector":c}),c?(0,y.qy)(o||(o=(0,l.A)([' <ha-card class="period-selector"> <hui-energy-period-selector .hass="','" .collectionKey="','" vertical-opening-direction="up"></hui-energy-period-selector> </ha-card> '])),this.hass,L):y.s6)}},{key:"_generateLovelaceConfig",value:(n=(0,d.A)((0,u.A)().m(function e(){var t,n,i,r,s,o,c,l=this;return(0,u.A)().w(function(e){for(;;)switch(e.n){case 0:if(this._prefs&&(0!==this._prefs.device_consumption.length||0!==this._prefs.energy_sources.length)){e.n=2;break}return e.n=1,Promise.all([a.e("71380"),a.e("86236")]).then(a.bind(a,97431));case 1:return e.a(2,{views:[U]});case 2:return n=this._prefs.energy_sources.some(function(e){return["grid","solar","battery"].includes(e.type)}),i=this._prefs.energy_sources.some(function(e){var t;return"solar"===e.type&&e.stat_rate||"battery"===e.type&&e.stat_rate||"grid"===e.type&&(null===(t=e.power)||void 0===t?void 0:t.length)})||this._prefs.device_consumption.some(function(e){return e.stat_rate}),r=this._prefs.energy_sources.some(function(e){return"water"===e.type})||(null===(t=this._prefs.device_consumption_water)||void 0===t?void 0:t.length)>0,s=this._prefs.energy_sources.some(function(e){return"gas"===e.type}),o=this._prefs.device_consumption.length>0,c=[],(n||o)&&c.push(M),s&&c.push(j),r&&c.push(P),i&&c.push(N),c.length>1&&c.unshift(R),e.a(2,{views:c.map(function(e){return Object.assign(Object.assign({},e),{},{title:e.title||l.hass.localize("ui.panel.energy.title.".concat(e.path))})})})}},e,this)})),function(){return n.apply(this,arguments)})},{key:"_navigateConfig",value:function(e){null==e||e.stopPropagation(),(0,k.o)("/config/energy?historyBack=1")}},{key:"_reloadConfig",value:function(){this._loadConfig()}}],[{key:"styles",get:function(){return[x.RF,(0,y.AH)(c||(c=(0,l.A)([":host{--ha-view-sections-column-max-width:100%;-ms-user-select:none;-webkit-user-select:none;-moz-user-select:none}.centered{width:100%;height:100%;display:flex;align-items:center;justify-content:center}hui-root.has-period-selector{--view-container-padding-bottom:var(--ha-space-18)}.period-selector{position:fixed;z-index:4;bottom:max(var(--ha-space-4),var(--safe-area-inset-bottom,0px));left:max(var(--mdc-drawer-width,0px),var(--safe-area-inset-left,0px));right:var(--safe-area-inset-right,0);inset-inline-start:max(var(--mdc-drawer-width,0px),var(--safe-area-inset-left,0px));inset-inline-end:var(--safe-area-inset-right,0);margin:0 auto;max-width:calc(min(450px,100% - var(--ha-space-4)));box-sizing:border-box;padding-left:var(--ha-space-2);padding-right:0;padding-inline-start:var(--ha-space-4);padding-inline-end:0;--ha-card-box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2),0px 6px 10px 0px rgba(0, 0, 0, 0.14),0px 1px 18px 0px rgba(0, 0, 0, 0.12);--ha-card-border-color:var(--divider-color);--ha-card-border-width:var(--ha-card-border-width, 1px)}@media all and (max-width:450px),all and (max-height:500px){hui-root.has-period-selector{--view-container-padding-bottom:var(--ha-space-14)}.period-selector{bottom:max(var(--ha-space-2),var(--safe-area-inset-bottom,0px))}}"])))]}}]);var n,m,b}(y.WF);(0,m.Cg)([(0,b.MZ)({attribute:!1})],q.prototype,"hass",void 0),(0,m.Cg)([(0,b.MZ)({type:Boolean,reflect:!0})],q.prototype,"narrow",void 0),(0,m.Cg)([(0,b.MZ)({attribute:!1})],q.prototype,"panel",void 0),(0,m.Cg)([(0,b.wk)()],q.prototype,"_lovelace",void 0),(0,m.Cg)([(0,b.MZ)({attribute:!1})],q.prototype,"route",void 0),(0,m.Cg)([(0,b.wk)()],q.prototype,"_prefs",void 0),(0,m.Cg)([(0,b.wk)()],q.prototype,"_error",void 0),q=(0,m.Cg)([(0,b.EM)("ha-panel-energy")],q),n()}catch(I){n(I)}})},73887:function(e,t,a){a.a(e,async function(e,t){try{var n,i,r,s,o=a(78261),c=a(72153),l=a(61397),h=a(50264),u=a(44734),d=a(43080),p=a(69683),f=a(6454),g=a(25460),v=a(69235),_=(a(28706),a(26099),a(40445)),m=a(6946),y=a(78016),b=a(31810),w=a(49134),k=a(35932),A=a(73983),C=a(52640),x=a(69137),D=a(55144),E=a(40600),O=a(96196),T=a(77845),z=a(22786),L=a(94333),S=a(91069),R=a(380),M=a(72487),P=a(9899),j=(a(13416),a(18350)),N=(a(58349),a(15397)),U=(a(3059),a(45100),a(38114)),q=a(54706),I=a(46223),Z=e([v,j,N,M,R,I,S,U]);[v,j,N,M,R,I,S,U]=Z.then?(await Z)():Z;var F=["today","yesterday","this_week","this_month","this_quarter","this_year","now-7d","now-30d","now-12m"],H=function(e){function t(){var e;(0,u.A)(this,t);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(e=(0,p.A)(this,t,[].concat(n))).allowCompare=!0,e._datepickerOpen=!1,e._ranges={},e._compare=!1,e._simpleRange=(0,z.A)(function(e,t,a,n){if(0===(0,m.c)(t,e))return"day";if((0,S.xo)(e,y.e,a,n)&&(0,S.xo)(t,b.c,a,n)){if(0===(0,S.EO)(t,e,w.W,a,n))return"month";if(2===(0,S.EO)(t,e,w.W,a,n)&&e.getMonth()%3==0)return"quarter"}return(0,S.xo)(e,y.e,a,n)&&(0,S.xo)(t,b.c,a,n)&&11===(0,S.EO)(t,e,w.W,a,n)?"year":"other"}),e}return(0,f.A)(t,e),(0,d.A)(t,[{key:"hassSubscribe",value:function(){var e=this;return[(0,U.tb)(this.hass,{key:this.collectionKey}).subscribe(function(t){return e._updateDates(t)})]}},{key:"_measure",value:function(){this.narrow=this.offsetWidth<450}},{key:"_attachObserver",value:(a=(0,h.A)((0,l.A)().m(function e(){var t=this;return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:this._resizeObserver||(this._resizeObserver=new ResizeObserver((0,P.s)(function(){return t._measure()},250,!1))),this._resizeObserver.observe(this);case 1:return e.a(2)}},e,this)})),function(){return a.apply(this,arguments)})},{key:"firstUpdated",value:function(){this._attachObserver()}},{key:"connectedCallback",value:function(){var e=this;(0,g.A)(t,"connectedCallback",this,3)([]),this.updateComplete.then(function(){return e._attachObserver()})}},{key:"disconnectedCallback",value:function(){(0,g.A)(t,"disconnectedCallback",this,3)([]),this._resizeObserver&&this._resizeObserver.disconnect()}},{key:"willUpdate",value:function(e){var a,n,i=this;(0,g.A)(t,"willUpdate",this,3)([e]),this.hasUpdated||this._measure(),(!this.hasUpdated||e.has("hass")&&(null===(a=this.hass)||void 0===a?void 0:a.localize)!==(null===(n=e.get("hass"))||void 0===n?void 0:n.localize))&&(this._ranges={},F.forEach(function(e){i._ranges[i.hass.localize("ui.components.date-range-picker.ranges.".concat(e))]=(0,I.b)(i.hass,e)}))}},{key:"render",value:function(){if(!this.hass||!this._startDate)return O.s6;var e=this._simpleRange(this._startDate,this._endDate,this.hass.locale,this.hass.config);return(0,O.qy)(n||(n=(0,c.A)([' <div class="','"> <div class="backdrop"></div> <div class="label"> ',' </div> <div class="time-handle"> <ha-icon-button-prev .label="','" @click="','"></ha-icon-button-prev> <ha-icon-button-next .label="','" @click="','"></ha-icon-button-next> <ha-date-range-picker .hass="','" .startDate="','" .endDate="','" .ranges="','" @value-changed="','" @preset-selected="','" @toggle="','" minimal header-position .verticalOpeningDirection="','"></ha-date-range-picker> </div> ',' <ha-button-menu> <ha-icon-button slot="trigger" .label="','" .path="','"></ha-icon-button> ',' <slot name="overflow-menu"></slot> </ha-button-menu> </div> '])),(0,L.H)({row:!0,"datepicker-open":this._datepickerOpen}),"day"===e?this.narrow?(0,M.kz)(this._startDate,this.hass.locale,this.hass.config):(0,M.Yq)(this._startDate,this.hass.locale,this.hass.config):"month"===e?(0,M.fr)(this._startDate,this.hass.locale,this.hass.config):"year"===e?(0,M.Pm)(this._startDate,this.hass.locale,this.hass.config):"".concat((0,M.sl)(this._startDate,this.hass.locale,this.hass.config)," â€“ ").concat((0,M.sl)(this._endDate||new Date,this.hass.locale,this.hass.config)),this.hass.localize("ui.panel.lovelace.components.energy_period_selector.previous"),this._pickPrevious,this.hass.localize("ui.panel.lovelace.components.energy_period_selector.next"),this._pickNext,this.hass,this._startDate,this._endDate||new Date,this._ranges,this._dateRangeChanged,this._presetSelected,this._handleDatepickerToggle,this.verticalOpeningDirection,this.narrow?O.s6:(0,O.qy)(i||(i=(0,c.A)(['<ha-button appearance="filled" size="small" @click="','"> '," </ha-button>"])),this._pickNow,this.hass.localize("ui.panel.lovelace.components.energy_period_selector.now")),this.hass.localize("ui.common.menu"),"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",this.allowCompare?(0,O.qy)(r||(r=(0,c.A)(['<ha-check-list-item left @request-selected="','" .selected="','"> '," </ha-check-list-item>"])),this._toggleCompare,this._compare,this.hass.localize("ui.panel.lovelace.components.energy_period_selector.compare")):O.s6)}},{key:"_updateCollectionPeriod",value:function(){var e=(0,U.tb)(this.hass,{key:this.collectionKey});e.setPeriod(this._startDate,this._endDate),e.refresh()}},{key:"_dateRangeChanged",value:function(e){this._startDate=(0,S.ol)(e.detail.value.startDate,k.o,this.hass.locale,this.hass.config),this._endDate=(0,S.ol)(e.detail.value.endDate,A.D,this.hass.locale,this.hass.config),this._updateCollectionPeriod()}},{key:"_presetSelected",value:function(e){localStorage.setItem("energy-default-period-_".concat(this.collectionKey||"energy"),F[e.detail.index])}},{key:"_pickNow",value:function(){if(this._startDate){var e=this._simpleRange(this._startDate,this._endDate,this.hass.locale,this.hass.config),t=new Date;if("month"===e){var a=(0,I.b)(this.hass,"this_month"),n=(0,o.A)(a,2);this._startDate=n[0],this._endDate=n[1]}else if("quarter"===e){var i=(0,I.b)(this.hass,"this_quarter"),r=(0,o.A)(i,2);this._startDate=r[0],this._endDate=r[1]}else if("year"===e){var s=(0,I.b)(this.hass,"this_year"),c=(0,o.A)(s,2);this._startDate=c[0],this._endDate=c[1]}else{var l=(0,R.P)(this.hass.locale),h=(0,S.ol)(this._endDate,C.k,this.hass.locale,this.hass.config,{weekStartsOn:l}),u=(0,S.ol)(this._endDate,x.$,this.hass.locale,this.hass.config,{weekStartsOn:l});if(this._startDate.getTime()===h.getTime()&&this._endDate.getTime()===u.getTime()){var d=(0,I.b)(this.hass,"this_week"),p=(0,o.A)(d,2);this._startDate=p[0],this._endDate=p[1]}else{var f=(0,S.EO)(this._endDate,this._startDate,m.c,this.hass.locale,this.hass.config);this._startDate=(0,S.ol)((0,S.ol)(t,D.e,this.hass.locale,this.hass.config,f),k.o,this.hass.locale,this.hass.config,{weekStartsOn:l}),this._endDate=(0,S.ol)(t,A.D,this.hass.locale,this.hass.config,{weekStartsOn:l})}}this._updateCollectionPeriod()}}},{key:"_pickPrevious",value:function(){this._shift(!1)}},{key:"_pickNext",value:function(){this._shift(!0)}},{key:"_shift",value:function(e){if(this._startDate){var t=(0,S.eE)(this._startDate,this._endDate,e,this.hass.locale,this.hass.config),a=t.start,n=t.end;this._startDate=a,this._endDate=n,this._updateCollectionPeriod()}}},{key:"_updateDates",value:function(e){this._compare=void 0!==e.startCompare,this._startDate=e.start,this._endDate=e.end||(0,E.o)()}},{key:"_handleDatepickerToggle",value:function(e){this._datepickerOpen=e.detail.open}},{key:"_toggleCompare",value:function(e){if("interaction"===e.detail.source){this._compare=e.detail.selected;var t=(0,U.tb)(this.hass,{key:this.collectionKey});t.setCompare(this._compare?U.lh.PREVIOUS:U.lh.NONE),t.refresh()}}}]);var a}((0,q.E)(O.WF));H.styles=(0,O.AH)(s||(s=(0,c.A)([".row{display:flex;align-items:center}:host .time-handle{display:flex;justify-content:flex-end;align-items:center}:host([narrow]) .time-handle{margin-left:auto;margin-inline-start:auto;margin-inline-end:initial}.label{display:flex;align-items:center;justify-content:flex-end;font-size:var(--ha-font-size-xl);margin-left:auto;margin-inline-start:auto;margin-inline-end:initial}:host([narrow]) .label{margin-left:unset;margin-inline-start:unset;margin-inline-end:initial}ha-button{margin-left:8px;margin-inline-start:8px;margin-inline-end:initial;flex-shrink:0;--ha-button-theme-color:currentColor}.backdrop{position:fixed;top:0;left:0;right:0;bottom:0;z-index:var(--dialog-z-index,8);-webkit-backdrop-filter:var(--ha-dialog-scrim-backdrop-filter,var(--dialog-backdrop-filter));backdrop-filter:var(--ha-dialog-scrim-backdrop-filter,var(--dialog-backdrop-filter));pointer-events:none;opacity:0;transition:opacity var(--ha-animation-base-duration) ease-in-out}.datepicker-open .backdrop{opacity:1;pointer-events:auto}"]))),(0,_.Cg)([(0,T.MZ)({attribute:!1})],H.prototype,"hass",void 0),(0,_.Cg)([(0,T.MZ)({attribute:"collection-key"})],H.prototype,"collectionKey",void 0),(0,_.Cg)([(0,T.MZ)({type:Boolean,reflect:!0})],H.prototype,"narrow",void 0),(0,_.Cg)([(0,T.MZ)({type:Boolean,attribute:"allow-compare"})],H.prototype,"allowCompare",void 0),(0,_.Cg)([(0,T.MZ)({attribute:"vertical-opening-direction"})],H.prototype,"verticalOpeningDirection",void 0),(0,_.Cg)([(0,T.wk)()],H.prototype,"_datepickerOpen",void 0),(0,_.Cg)([(0,T.wk)()],H.prototype,"_startDate",void 0),(0,_.Cg)([(0,T.wk)()],H.prototype,"_endDate",void 0),(0,_.Cg)([(0,T.wk)()],H.prototype,"_ranges",void 0),(0,_.Cg)([(0,T.wk)()],H.prototype,"_compare",void 0),H=(0,_.Cg)([(0,T.EM)("hui-energy-period-selector")],H),t()}catch(V){t(V)}})},30039:function(e,t,a){a.d(t,{R:function(){return i},h:function(){return r}});var n=a(22348),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=document.createElement("a");a.target="_blank",a.href=e,a.download=t,a.style.display="none",document.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),document.body.removeChild(a)},r=function(e){var t;return!(0,n.V)(e)||!(null===(t=e.auth.external)||void 0===t||!t.config.downloadFileSupported)}},22348:function(e,t,a){a.d(t,{V:function(){return i}});var n=a(37177),i=function(e){return!!e.auth.external&&n.n}},37177:function(e,t,a){a.d(t,{n:function(){return n}});a(27495),a(90906);var n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},50778:function(e,t,a){var n=a(46518),i=a(77240);n({target:"String",proto:!0,forced:a(23061)("link")},{link:function(e){return i(this,"a","href",e)}})},56434:function(e,t,a){a.d(t,{e:function(){return i}});var n=a(81977);function i(e,t,a){return(0,n.P)(e,12*t,a)}},40600:function(e,t,a){a.d(t,{o:function(){return i}});var n=a(73983);function i(e){return(0,n.D)(Date.now(),e)}}}]);
//# sourceMappingURL=53982.40b58952c9f6e709.js.map