"use strict";(self.webpackChunkgitoon_frontend=self.webpackChunkgitoon_frontend||[]).push([["93505"],{23528:function(e,t,a){a.a(e,async function(e,r){try{a.d(t,{$3:function(){return f},$O:function(){return S},$j:function(){return b},ED:function(){return o},JE:function(){return x},OQ:function(){return W},PU:function(){return q},Ph:function(){return y},Uf:function(){return A},W1:function(){return m},Wr:function(){return _},Z:function(){return d},gF:function(){return p},iY:function(){return v},jU:function(){return c},nN:function(){return C},p3:function(){return u},pJ:function(){return g},r_:function(){return i},sz:function(){return h}});a(74423),a(18111),a(13579),a(62953);var n=a(28978),l=a(380),s=e([l]);l=(s.then?(await s)():s)[0];var o=function(e){return e[e.NONE=0]="NONE",e[e.ARITHMETIC=1]="ARITHMETIC",e[e.CIRCULAR=2]="CIRCULAR",e}({});const c=["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"],i=["L","gal","ft³","m³","CCF","MCF"],d=e=>e.sendMessagePromise({type:"recorder/info"}),u=(e,t)=>e.callWS({type:"recorder/list_statistic_ids",statistic_type:t}),_=(e,t)=>e.callWS({type:"recorder/get_statistics_metadata",statistic_ids:t}),h=(e,t,a,r,n="hour",l,s)=>e.callWS({type:"recorder/statistics_during_period",start_time:t.toISOString(),end_time:null==a?void 0:a.toISOString(),statistic_ids:r,period:n,units:l,types:s}),g=(e,t,a,r)=>e.callWS({type:"recorder/statistic_during_period",statistic_id:t,units:r,fixed_period:a.fixed_period?{start_time:a.fixed_period.start instanceof Date?a.fixed_period.start.toISOString():a.fixed_period.start,end_time:a.fixed_period.end instanceof Date?a.fixed_period.end.toISOString():a.fixed_period.end}:void 0,calendar:a.calendar?{..."week"===a.calendar.period?{first_weekday:(0,l.D)(e.locale).substring(0,3)}:{},...a.calendar}:void 0,rolling_window:a.rolling_window}),y=e=>e.callWS({type:"recorder/validate_statistics"}),m=(e,t,a,r)=>e.callWS({type:"recorder/update_statistics_metadata",statistic_id:t,unit_of_measurement:a,unit_class:r}),f=(e,t)=>e.callWS({type:"recorder/clear_statistics",statistic_ids:t}),b=e=>{let t=null;if(!e)return null;for(const a of e)null!==a.change&&void 0!==a.change&&(null===t?t=a.change:t+=a.change);return t},p=(e,t)=>{let a=null;for(const r of t){if(!(r in e))continue;const t=b(e[r]);null!==t&&(null===a?a=t:a+=t)}return a},v=(e,t)=>e.some(e=>void 0!==e[t]&&null!==e[t]),w=["mean","min","max"],k=["sum","state","change"],C=(e,t)=>!(!w.includes(t)||0===e.mean_type)||!(!k.includes(t)||!e.has_sum),A=(e,t,a,r,n)=>{const l=new Date(a).toISOString();return e.callWS({type:"recorder/adjust_sum_statistics",statistic_id:t,start_time:l,adjustment:r,adjustment_unit_of_measurement:n})},S=(e,t,a)=>{const r=e.states[t];return r?(0,n.u)(r):(null==a?void 0:a.name)||t},x=(e,t,a)=>{let r;var n;t&&(r=null===(n=e.states[t])||void 0===n?void 0:n.attributes.unit_of_measurement);return void 0===r?null==a?void 0:a.statistics_unit_of_measurement:r},W=e=>e.includes(":"),q=e=>e.callWS({type:"recorder/update_statistics_issues"});r()}catch(c){r(c)}})},18427:function(e,t,a){a.d(t,{g:function(){return l}});a(42762);var r=a(79468),n=a(39274);function l(e,t,a,l,s,o){var c=e.getPropertyValue(s+"-"+o).trim(),i=c.length>0?c:e.getPropertyValue(s).trim(),d=(0,r.RQ)(i);return 0===c.length&&o&&(d=(0,r.v2)((0,r.BE)(t?(0,n.T)((0,r.Nc)((0,r.xp)(d)),o):(0,n.d)((0,r.Nc)((0,r.xp)(d)),o)))),l?d+=a?"32":"7F":a&&(d+="7F"),d}},24408:function(e,t,a){a.a(e,async function(e,r){try{a.r(t),a.d(t,{HuiEnergySourcesTableCard:function(){return F}});var n,l,s,o,c,i,d,u,_,h,g,y,m,f,b,p,v,w,k,C=a(78261),A=a(72153),S=a(44734),x=a(43080),W=a(69683),q=a(6454),R=(a(28706),a(2008),a(74423),a(23792),a(62062),a(18111),a(22489),a(61701),a(13579),a(5506),a(53921),a(26099),a(21699),a(40445)),M=a(68560),z=a(96196),I=a(77845),O=a(94333),E=a(6415),D=a(20058),T=a(18427),j=(a(76776),a(38114)),V=a(23528),Z=a(54706),$=a(784),U=a(1087),N=e([D,j,V]);[D,j,V]=N.then?(await N)():N;var P={grid_return:"--energy-grid-return-color",grid_consumption:"--energy-grid-consumption-color",battery_in:"--energy-battery-in-color",battery_out:"--energy-battery-out-color",solar:"--energy-solar-color",gas:"--energy-gas-color",water:"--energy-water-color"},F=function(e){function t(){var e;(0,S.A)(this,t);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return(e=(0,W.A)(this,t,[].concat(r))).hassSubscribeRequiredHostProps=["_config"],e}return(0,q.A)(t,e),(0,x.A)(t,[{key:"hassSubscribe",value:function(){var e,t=this;return[(0,j.tb)(this.hass,{key:null===(e=this._config)||void 0===e?void 0:e.collection_key}).subscribe(function(e){t._data=e})]}},{key:"getCardSize",value:function(){return 3}},{key:"setConfig",value:function(e){this._config=e}},{key:"shouldUpdate",value:function(e){return(0,$.xP)(this,e)||e.size>1||!e.has("hass")}},{key:"_renderRow",value:function(e,t,a,r,c,i,d,u,_,h,g){var y;return(0,z.qy)(n||(n=(0,A.A)(['<tr class="mdc-data-table__row ','" @click="','" .entity="','"> <td class="mdc-data-table__cell cell-bullet"> <div class="bullet" style="','"></div> </td> <th class="mdc-data-table__cell" scope="row"> '," </th> ",' <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> '," "," </td> "," </tr>"])),(0,O.H)({clickable:!(0,V.OQ)(a)}),this._handleMoreInfo,a,(0,E.W)({borderColor:(0,T.g)(e,this.hass.themes.darkMode,!1,!1,P[t],r),backgroundColor:(0,T.g)(e,this.hass.themes.darkMode,!0,!1,P[t],r)}),(0,V.$O)(this.hass,a,null===(y=this._data)||void 0===y?void 0:y.statsMetadata[a]),g?(0,z.qy)(l||(l=(0,A.A)(['<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> '," "," </td> ",""])),(0,D.ZV)(i,this.hass.locale),d,h?(0,z.qy)(s||(s=(0,A.A)(['<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> '," </td>"])),null!==_?(0,D.ZV)(_,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""):""):"",(0,D.ZV)(c,this.hass.locale),d,h?(0,z.qy)(o||(o=(0,A.A)([' <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> '," </td>"])),null!==u?(0,D.ZV)(u,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""):"")}},{key:"_renderTotalRow",value:function(e,t,a,r,n,l,s,o,h,g){return(0,z.qy)(c||(c=(0,A.A)([' <tr class="mdc-data-table__row ','"> <td class="mdc-data-table__cell cell-bullet"> ',' </td> <th class="mdc-data-table__cell" scope="row">',"</th> ",' <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> '," </td> "," </tr>"])),h&&!g?"":"total",h?(0,z.qy)(i||(i=(0,A.A)(['<div class="bullet" style="','"></div>'])),(0,E.W)({borderColor:h.border,backgroundColor:h.background})):z.s6,e,o?(0,z.qy)(d||(d=(0,A.A)(['<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> '," </td> ",""])),null===a?"":"".concat((0,D.ZV)(a,this.hass.locale)," ").concat(r),s?(0,z.qy)(u||(u=(0,A.A)(['<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> '," </td>"])),null!==l?(0,D.ZV)(l,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""):""):"",null===t?"":"".concat((0,D.ZV)(t,this.hass.locale)," ").concat(r),s?(0,z.qy)(_||(_=(0,A.A)(['<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> '," </td>"])),null!==n?(0,D.ZV)(n,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""):"")}},{key:"render",value:function(){var e,t,a,r,n,l,s,o,c,i=this;if(!this.hass||!this._config)return z.s6;if(!this._data)return(0,z.qy)(h||(h=(0,A.A)(["",""])),this.hass.localize("ui.panel.lovelace.cards.energy.loading"));var d=0,u=0,_=0,k=!1,S=0,x=0,W=0,q={gas:0,water:0,solar:0},R={gas:0,water:0,solar:0},M={gas:0,water:0},I={gas:0,water:0},O={gas:!1,water:!1},E=(0,j.E$)(this._data.prefs),D=null===(e=this._config)||void 0===e?void 0:e.types,Z=D?Object.fromEntries(Object.entries(E).filter(function(e){var t=(0,C.A)(e,1)[0];return D.includes(t)})):E,$=getComputedStyle(this),U=!!(null!==(t=Z.grid)&&void 0!==t&&t[0].flow_from.some(function(e){return e.stat_cost||e.entity_energy_price||e.number_energy_price})||null!==(a=Z.grid)&&void 0!==a&&a[0].flow_to.some(function(e){return e.stat_compensation||e.entity_energy_price||e.number_energy_price})||null!==(r=Z.gas)&&void 0!==r&&r.some(function(e){return e.stat_cost||e.entity_energy_price||e.number_energy_price})||null!==(n=Z.water)&&void 0!==n&&n.some(function(e){return e.stat_cost||e.entity_energy_price||e.number_energy_price})),N={solar:"kWh",gas:this._data.gasUnit,water:this._data.waterUnit},F=void 0!==this._data.statsCompare,H=function(e,t){var a=(0,V.$j)(i._data.stats[e]),r=F&&(0,V.$j)(i._data.statsCompare[e]),n=t&&(0,V.$j)(i._data.stats[t])||0,l=F&&t&&(0,V.$j)(i._data.statsCompare[t])||0;return null!==a||F&&null!==r?{hasData:!0,energy:a||0,energyCompare:r||0,cost:n,costCompare:l}:{hasData:!1,energy:a||0,energyCompare:r||0,cost:n,costCompare:l}},Q=this._config.show_only_totals,L=function(e){var t;return(0,z.qy)(g||(g=(0,A.A)([" "," ",""])),null===(t=Z[e])||void 0===t?void 0:t.map(function(t,a){var r=e in O&&(t.stat_cost||i._data.info.cost_sensors[t.stat_energy_from]),n=H(t.stat_energy_from,r||null),l=n.hasData,s=n.energy,o=n.energyCompare,c=n.cost,d=n.costCompare;return l||c||d?(q[e]+=s,R[e]+=o,r&&(O[e]=!0,M[e]+=c,I[e]+=d),Q?z.s6:i._renderRow($,e,t.stat_energy_from,a,s,o,N[e],r?c:null,r?d:null,U,F)):z.s6}),Z[e]?i._renderTotalRow(i.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.".concat(e,"_total")),q[e],R[e],N[e],O[e]?M[e]:null,O[e]?I[e]:null,U,F,Q?{border:(0,T.g)($,i.hass.themes.darkMode,!1,!1,P[e],0),background:(0,T.g)($,i.hass.themes.darkMode,!0,!1,P[e],0)}:void 0):"")};return(0,z.qy)(y||(y=(0,A.A)([" <ha-card> ",' <div class="mdc-data-table"> <div class="mdc-data-table__table-container"> <table class="mdc-data-table__table" aria-label="Energy sources"> <thead> <tr class="mdc-data-table__header-row"> <th class="mdc-data-table__header-cell"></th> <th class="mdc-data-table__header-cell" role="columnheader" scope="col"> '," </th> ",' <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> '," </th> ",' </tr> </thead> <tbody class="mdc-data-table__content"> '," "," "," "," "," "," "," "," </tbody> </table> </div> </div> </ha-card>"])),this._config.title?(0,z.qy)(m||(m=(0,A.A)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.source"),F?(0,z.qy)(f||(f=(0,A.A)(['<th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> '," </th> ",""])),this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.previous_energy"),U?(0,z.qy)(b||(b=(0,A.A)(['<th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> '," </th>"])),this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.previous_cost")):""):"",this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.energy"),U?(0,z.qy)(p||(p=(0,A.A)([' <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> '," </th>"])),this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.cost")):"",L("solar"),null===(l=Z.battery)||void 0===l?void 0:l.map(function(e,t){var a=H(e.stat_energy_from,null),r=a.hasData,n=a.energy,l=a.energyCompare,s=H(e.stat_energy_to,null),o=s.hasData,c=s.energy,d=s.energyCompare;return r||o?(_+=n-c,W+=l-d,Q?z.s6:(0,z.qy)(v||(v=(0,A.A)([" ","",""])),i._renderRow($,"battery_out",e.stat_energy_from,t,n,l,"kWh",null,null,U,F),i._renderRow($,"battery_in",e.stat_energy_to,t,-c,-d,"kWh",null,null,U,F))):z.s6}),Z.battery?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.battery_total"),_,W,"kWh",null,null,U,F,Q?{border:(0,T.g)($,this.hass.themes.darkMode,!1,!1,P.battery_out,0),background:(0,T.g)($,this.hass.themes.darkMode,!0,!1,P.battery_out,0)}:void 0):"",null===(s=Z.grid)||void 0===s?void 0:s.map(function(e){return(0,z.qy)(w||(w=(0,A.A)([""," ",""])),e.flow_from.map(function(e,t){var a=e.stat_cost||i._data.info.cost_sensors[e.stat_energy_from],r=H(e.stat_energy_from,a||null),n=r.hasData,l=r.energy,s=r.energyCompare,o=r.cost,c=r.costCompare;return n||o||c?(d+=l,S+=s,a&&(k=!0,u+=o,x+=c),Q?z.s6:i._renderRow($,"grid_consumption",e.stat_energy_from,t,l,s,"kWh",o,c,U,F)):z.s6}),e.flow_to.map(function(e,t){var a=e.stat_compensation||i._data.info.cost_sensors[e.stat_energy_to],r=H(e.stat_energy_to,a||null),n=r.hasData,l=r.energy,s=r.energyCompare,o=r.cost,c=r.costCompare;return n||o||c?(d-=l,S-=s,null!==a&&(k=!0,u-=o,x-=c),Q?z.s6:i._renderRow($,"grid_return",e.stat_energy_to,t,-l,-s,"kWh",-o,-c,U,F)):z.s6}))}),Z.grid&&(null!==(o=Z.grid)&&void 0!==o&&null!==(o=o[0].flow_from)&&void 0!==o&&o.length||null!==(c=Z.grid)&&void 0!==c&&null!==(c=c[0].flow_to)&&void 0!==c&&c.length)?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.grid_total"),d,S,"kWh",k?u:null,k?x:null,U,F,Q?{border:(0,T.g)($,this.hass.themes.darkMode,!1,!1,P.grid_consumption,0),background:(0,T.g)($,this.hass.themes.darkMode,!0,!1,P.grid_consumption,0)}:void 0):"",L("gas"),L("water"),[O.gas,O.water,k].filter(Boolean).length>1?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.total_costs"),null,null,"",M.gas+u+M.water,I.gas+x+I.water,U,F,void 0,!0):"")}},{key:"_handleMoreInfo",value:function(e){var t,a=null===(t=e.currentTarget)||void 0===t?void 0:t.entity;a&&!(0,V.OQ)(a)&&(0,U.r)(this,"hass-more-info",{entityId:a})}}],[{key:"styles",get:function(){return(0,z.AH)(k||(k=(0,A.A)([""," .mdc-data-table{width:100%;border:0}.mdc-data-table__cell,.mdc-data-table__header-cell{color:var(--primary-text-color);border-bottom-color:var(--divider-color);text-align:var(--float-start)}.mdc-data-table__row:not(.mdc-data-table__row--selected):hover{background-color:rgba(var(--rgb-primary-text-color),.04)}.clickable{cursor:pointer}.total{--mdc-typography-body2-font-weight:var(--ha-font-weight-medium)}.total .mdc-data-table__cell{border-top:1px solid var(--divider-color)}ha-card{max-height:100%;overflow:auto}.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}.cell-bullet{width:32px;padding-right:0;padding-inline-end:0;padding-inline-start:16px;direction:var(--direction)}.bullet{border-width:1px;border-style:solid;border-radius:var(--ha-border-radius-sm);height:16px;width:32px}.mdc-data-table__cell--numeric{direction:ltr}"])),(0,z.iz)(M))}}])}((0,Z.E)(z.WF));(0,R.Cg)([(0,I.MZ)({attribute:!1})],F.prototype,"hass",void 0),(0,R.Cg)([(0,I.wk)()],F.prototype,"_config",void 0),(0,R.Cg)([(0,I.wk)()],F.prototype,"_data",void 0),F=(0,R.Cg)([(0,I.EM)("hui-energy-sources-table-card")],F),r()}catch(H){r(H)}})}}]);
//# sourceMappingURL=93505.bef9ebfcedf7b7d6.js.map