"use strict";(self.webpackChunkgitoon_frontend=self.webpackChunkgitoon_frontend||[]).push([["70581"],{78870:function(t,e,i){i.d(e,{M:function(){return a},l:function(){return n}});i(23792),i(26099),i(31415),i(17642),i(58004),i(33853),i(45876),i(32475),i(15024),i(31698),i(47764),i(62953);var n=new Set(["primary","accent","red","pink","purple","deep-purple","indigo","blue","light-blue","cyan","teal","green","light-green","lime","yellow","amber","orange","deep-orange","brown","light-grey","grey","dark-grey","blue-grey","black","white","primary-text","secondary-text","disabled"]);function a(t){return n.has(t)?"var(--".concat(t,"-color)"):t}},91069:function(t,e,i){i.a(t,async function(t,n){try{i.d(e,{EO:function(){return x},Yq:function(){return A},_U:function(){return k},eE:function(){return w},fU:function(){return C},ol:function(){return _},xo:function(){return b}});var a=i(78016),r=i(31810),o=i(49134),s=i(81977),l=i(36307),c=i(35932),d=i(73983),u=i(6946),h=i(92913),f=i(83339),p=i(77972),v=i(31886),g=i(46927),y=t([v]);v=(y.then?(await y)():y)[0];var m=function(t,e,i,n){var a=i(new v.BB(t,e),n);return a instanceof Date?new Date(a.getTime()):a},_=function(t,e,i,n,a){return i.time_zone===g.Wj.server?m(t,n.time_zone,e,a):e(t,a)},b=function(t,e,i,n,a){return i.time_zone===g.Wj.server?m(t,n.time_zone,e,a):e(t,a)},x=function(t,e,i,n,a){return b(t,i,n,a,n.time_zone===g.Wj.server?new v.BB(e,a.time_zone):e)},w=function(t,e,i,n,v){var g,y;if(b(t,a.e,n,v)&&b(e,r.c,n,v)){var m=(x(e,t,o.W,n,v)+1)*(i?1:-1);g=_(t,s.P,n,v,m),y=_(_(e,s.P,n,v,m),l.p,n,v)}else if(b(t,function(t){return(0,c.o)(t).getMilliseconds()===t.getMilliseconds()},n,v)&&b(e,function(t){return(0,d.D)(t).getMilliseconds()===t.getMilliseconds()},n,v)){var w=(x(e,t,u.c,n,v)+1)*(i?1:-1);g=_(t,h.f,n,v,w),y=_(e,h.f,n,v,w)}else{var k=x(e,t,f.b,n,v)*(i?1:-1);g=_(t,p.A,n,v,k),y=_(e,p.A,n,v,k)}return{start:g,end:y}},k=function(t,e){var i=new v.BB(t,e);return new Date(i.getTime())},A=function(t,e){return new v.BB(t,e).toISOString().split("T")[0]},C=function(t,e){return new v.BB(t,e).toISOString().split("T")[1].split(".")[0]};n()}catch(H){n(H)}})},46223:function(t,e,i){i.a(t,async function(t,n){try{i.d(e,{b:function(){return x}});var a=i(35932),r=i(73983),o=i(92913),s=i(52640),l=i(69137),c=i(35660),d=i(36307),u=i(11650),h=i(15797),f=i(33977),p=i(69748),v=i(55144),g=i(21828),y=i(66708),m=i(91069),_=i(380),b=t([_,m]);[_,m]=b.then?(await b)():b;var x=function(t,e){var i=new Date,n=(0,_.P)(t.locale);switch(e){case"today":return[(0,m.ol)(i,a.o,t.locale,t.config,{weekStartsOn:n}),(0,m.ol)(i,r.D,t.locale,t.config,{weekStartsOn:n})];case"yesterday":return[(0,m.ol)((0,o.f)(i,-1),a.o,t.locale,t.config,{weekStartsOn:n}),(0,m.ol)((0,o.f)(i,-1),r.D,t.locale,t.config,{weekStartsOn:n})];case"this_week":return[(0,m.ol)(i,s.k,t.locale,t.config,{weekStartsOn:n}),(0,m.ol)(i,l.$,t.locale,t.config,{weekStartsOn:n})];case"this_month":return[(0,m.ol)(i,c.w,t.locale,t.config),(0,m.ol)(i,d.p,t.locale,t.config)];case"this_quarter":return[(0,m.ol)(i,u.a,t.locale,t.config),(0,m.ol)(i,h.j,t.locale,t.config)];case"this_year":return[(0,m.ol)(i,f.D,t.locale,t.config),(0,m.ol)(i,p.Q,t.locale,t.config)];case"now-7d":return[(0,m.ol)(i,v.e,t.locale,t.config,7),(0,m.ol)(i,v.e,t.locale,t.config,0)];case"now-30d":return[(0,m.ol)(i,v.e,t.locale,t.config,30),(0,m.ol)(i,v.e,t.locale,t.config,0)];case"now-12m":return[(0,m.ol)((0,g.a)(i,12),c.w,t.locale,t.config),(0,m.ol)((0,g.a)(i,1),d.p,t.locale,t.config)];case"now-1h":return[(0,m.ol)(i,y.O,t.locale,t.config,1),(0,m.ol)(i,y.O,t.locale,t.config,0)];case"now-12h":return[(0,m.ol)(i,y.O,t.locale,t.config,12),(0,m.ol)(i,y.O,t.locale,t.config,0)];case"now-24h":return[(0,m.ol)(i,y.O,t.locale,t.config,24),(0,m.ol)(i,y.O,t.locale,t.config,0)]}return[i,i]};n()}catch(w){n(w)}})},51758:function(t,e,i){i.d(e,{Z:function(){return n}});var n=function(t){var e=window.location.pathname;return t?e+"?"+t:e}},34218:function(t,e,i){i.d(e,{P:function(){return o}});var n=i(47075),a=i(78261),r=i(31432);i(23792),i(44114),i(72712),i(18111),i(18237),i(36033),i(2892),i(26099),i(47764),i(62953);function o(t,e,i,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!t)return[];if(t.length<=e)return t;var l,c=null!=i?i:s(t[0])[0],d=null!=n?n:s(t[t.length-1])[0],u=Math.ceil((d-c)/Math.floor(e)),h=new Map,f=(0,r.A)(t);try{for(f.s();!(l=f.n()).done;){var p=l.value,v=s(p);if(Array.isArray(v)){var g=Number(v[0]),y=Number(v[1]);if(!isNaN(g)&&!isNaN(y)){var m=Math.floor((g-c)/u),_=h.get(m);_?_.push({point:p,x:g,y:y}):h.set(m,[{point:p,x:g,y:y}])}}}}catch(T){f.e(T)}finally{f.f()}var b=[];if(o){var x,w=(0,r.A)(h);try{for(w.s();!(x=w.n()).done;){var k=(0,a.A)(x.value,2),A=(k[0],k[1]),C=A.reduce(function(t,e){return t+e.y},0),H=C/A.length,M=A.reduce(function(t,e){return t+e.x},0),L=M/A.length,D=s(A[0].point),E=Array.isArray(D)?[L,H]:{value:[L,H]};b.push(E)}}catch(T){w.e(T)}finally{w.f()}}else{var O,V=(0,r.A)(h);try{for(V.s();!(O=V.n()).done;){var j,P=(0,a.A)(O.value,2),S=(P[0],P[1]),B=S[0],Z=S[0],z=(0,r.A)(S);try{for(z.s();!(j=z.n()).done;){var I=j.value;I.y<B.y&&(B=I),I.y>Z.y&&(Z=I)}}catch(T){z.e(T)}finally{z.f()}B.x>Z.x&&b.push(Z.point),b.push(B.point),B.x<Z.x&&b.push(Z.point)}}catch(T){V.e(T)}finally{V.f()}}return b}function s(t){return t&&"object"===(0,n.A)(t)&&"value"in t?t.value:t}},72190:function(t,e,i){i.d(e,{c:function(){return v}});i(25276),i(23792),i(36033),i(26099),i(47764),i(62953);var n=i(90433),a=i(79468),r=i(39274),o=i(71727),s=i(69093),l=i(15090),c=i(27120),d=i(22675),u=i(86030),h={media_player:{paused:.5,idle:1},vacuum:{returning:.5}};var f=0,p=new Map;function v(t,e,i){return function(t,e,i){var n;if(!i||t===d.Hh)return(0,u.a)("--history-unavailable-color",e);if(t===d.HV)return(0,u.a)("--history-unknown-color",e);var s=(0,c.mg)(i,t);if(s){var l=(0,u.a)(s,e);if(l){var f=(0,o.m)(i.entity_id),p=null===(n=h[f])||void 0===n?void 0:n[t];return p?(0,a.zm)((0,r.T)((0,a.Nc)((0,a.xp)(l)),p)):l}}}(t,e,i)||function(t,e,i){if(i){var a=(0,s.t)(i),r=(l.v[a]||"sensor"===a&&"enum"===i.attributes.device_class&&i.attributes.options||[]).indexOf(t);if(-1!==r)return(0,n.fI)(r,e)}}(t,e,i)||function(t,e){if(p.has(t))return p.get(t);var i=(0,n.fI)(f,e);return f++,p.set(t,i),i}(t,e)}},5745:function(t,e,i){var n=i(43080),a=i(44734),r=i(69683),o=i(6454),s=i(40445),l=i(82339),c=i(77845),d=function(t){function e(){return(0,a.A)(this,e),(0,r.A)(this,e,arguments)}return(0,o.A)(e,t),(0,n.A)(e)}(l.Y);d=(0,s.Cg)([(0,c.EM)("ha-chip-set")],d)},13416:function(t,e,i){var n,a,r=i(72153),o=i(44734),s=i(43080),l=i(69683),c=i(6454),d=i(25460),u=(i(28706),i(18111),i(7588),i(2892),i(26099),i(89907),i(23500),i(40445)),h=i(96196),f=i(77845),p=i(63091),v=(i(22444),i(79817),function(t){function e(){var t;(0,o.A)(this,e);for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(t=(0,l.A)(this,e,[].concat(n))).corner="BOTTOM_START",t.menuCorner="START",t.x=null,t.y=null,t.multi=!1,t.activatable=!1,t.disabled=!1,t.fixed=!1,t.noAnchor=!1,t}return(0,c.A)(e,t),(0,s.A)(e,[{key:"items",get:function(){var t;return null===(t=this._menu)||void 0===t?void 0:t.items}},{key:"selected",get:function(){var t;return null===(t=this._menu)||void 0===t?void 0:t.selected}},{key:"focus",value:function(){var t,e;null!==(t=this._menu)&&void 0!==t&&t.open?this._menu.focusItemAtIndex(0):null===(e=this._triggerButton)||void 0===e||e.focus()}},{key:"render",value:function(){return(0,h.qy)(n||(n=(0,r.A)([' <div @click="','"> <slot name="trigger" @slotchange="','"></slot> </div> <ha-menu .corner="','" .menuCorner="','" .fixed="','" .multi="','" .activatable="','" .y="','" .x="','"> <slot></slot> </ha-menu> '])),this._handleClick,this._setTriggerAria,this.corner,this.menuCorner,this.fixed,this.multi,this.activatable,this.y,this.x)}},{key:"firstUpdated",value:function(t){var i=this;(0,d.A)(e,"firstUpdated",this,3)([t]),"rtl"===p.G.document.dir&&this.updateComplete.then(function(){i.querySelectorAll("ha-list-item").forEach(function(t){var e=document.createElement("style");e.innerHTML="span.material-icons:first-of-type { margin-left: var(--mdc-list-item-graphic-margin, 32px) !important; margin-right: 0px !important;}",t.shadowRoot.appendChild(e)})})}},{key:"_handleClick",value:function(){this.disabled||(this._menu.anchor=this.noAnchor?null:this,this._menu.show())}},{key:"_triggerButton",get:function(){return this.querySelector('ha-icon-button[slot="trigger"], ha-button[slot="trigger"]')}},{key:"_setTriggerAria",value:function(){this._triggerButton&&(this._triggerButton.ariaHasPopup="menu")}}])}(h.WF));v.styles=(0,h.AH)(a||(a=(0,r.A)([":host{display:inline-block;position:relative}::slotted([disabled]){color:var(--disabled-text-color)}"]))),(0,u.Cg)([(0,f.MZ)()],v.prototype,"corner",void 0),(0,u.Cg)([(0,f.MZ)({attribute:"menu-corner"})],v.prototype,"menuCorner",void 0),(0,u.Cg)([(0,f.MZ)({type:Number})],v.prototype,"x",void 0),(0,u.Cg)([(0,f.MZ)({type:Number})],v.prototype,"y",void 0),(0,u.Cg)([(0,f.MZ)({type:Boolean})],v.prototype,"multi",void 0),(0,u.Cg)([(0,f.MZ)({type:Boolean})],v.prototype,"activatable",void 0),(0,u.Cg)([(0,f.MZ)({type:Boolean})],v.prototype,"disabled",void 0),(0,u.Cg)([(0,f.MZ)({type:Boolean})],v.prototype,"fixed",void 0),(0,u.Cg)([(0,f.MZ)({type:Boolean,attribute:"no-anchor"})],v.prototype,"noAnchor",void 0),(0,u.Cg)([(0,f.P)("ha-menu",!0)],v.prototype,"_menu",void 0),v=(0,u.Cg)([(0,f.EM)("ha-button-menu")],v)},11382:function(t,e,i){var n,a,r,o,s=i(61397),l=i(50264),c=i(72153),d=i(44734),u=i(43080),h=i(69683),f=i(6454),p=i(25460),v=(i(28706),i(40445)),g=i(96196),y=i(77845),m=i(94333),_=i(1087),b=i(12587),x=(i(67094),function(t){function e(){var t;(0,d.A)(this,e);for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(t=(0,h.A)(this,e,[].concat(n))).expanded=!1,t.outlined=!1,t.leftChevron=!1,t.noCollapse=!1,t._showContent=t.expanded,t}return(0,f.A)(e,t),(0,u.A)(e,[{key:"render",value:function(){var t=this.noCollapse?g.s6:(0,g.qy)(n||(n=(0,c.A)([' <ha-svg-icon .path="','" class="summary-icon ','"></ha-svg-icon> '])),"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z",(0,m.H)({expanded:this.expanded}));return(0,g.qy)(a||(a=(0,c.A)([' <div class="top ','"> <div id="summary" class="','" @click="','" @keydown="','" @focus="','" @blur="','" role="button" tabindex="','" aria-expanded="','" aria-controls="sect1" part="summary"> ',' <slot name="leading-icon"></slot> <slot name="header"> <div class="header"> ',' <slot class="secondary" name="secondary">',"</slot> </div> </slot> ",' <slot name="icons"></slot> </div> </div> <div class="container ','" @transitionend="','" role="region" aria-labelledby="summary" aria-hidden="','" tabindex="-1"> '," </div> "])),(0,m.H)({expanded:this.expanded}),(0,m.H)({noCollapse:this.noCollapse}),this._toggleContainer,this._toggleContainer,this._focusChanged,this._focusChanged,this.noCollapse?-1:0,this.expanded,this.leftChevron?t:g.s6,this.header,this.secondary,this.leftChevron?g.s6:t,(0,m.H)({expanded:this.expanded}),this._handleTransitionEnd,!this.expanded,this._showContent?(0,g.qy)(r||(r=(0,c.A)(["<slot></slot>"]))):"")}},{key:"willUpdate",value:function(t){var i=this;(0,p.A)(e,"willUpdate",this,3)([t]),t.has("expanded")&&(this._showContent=this.expanded,setTimeout(function(){i._container.style.overflow=i.expanded?"initial":"hidden"},300))}},{key:"_handleTransitionEnd",value:function(){this._container.style.removeProperty("height"),this._container.style.overflow=this.expanded?"initial":"hidden",this._showContent=this.expanded}},{key:"_toggleContainer",value:(i=(0,l.A)((0,s.A)().m(function t(e){var i,n,a=this;return(0,s.A)().w(function(t){for(;;)switch(t.n){case 0:if(!e.defaultPrevented){t.n=1;break}return t.a(2);case 1:if("keydown"!==e.type||"Enter"===e.key||" "===e.key){t.n=2;break}return t.a(2);case 2:if(e.preventDefault(),!this.noCollapse){t.n=3;break}return t.a(2);case 3:if(i=!this.expanded,(0,_.r)(this,"expanded-will-change",{expanded:i}),this._container.style.overflow="hidden",!i){t.n=4;break}return this._showContent=!0,t.n=4,(0,b.E)();case 4:n=this._container.scrollHeight,this._container.style.height="".concat(n,"px"),i||setTimeout(function(){a._container.style.height="0px"},0),this.expanded=i,(0,_.r)(this,"expanded-changed",{expanded:this.expanded});case 5:return t.a(2)}},t,this)})),function(t){return i.apply(this,arguments)})},{key:"_focusChanged",value:function(t){this.noCollapse||this.shadowRoot.querySelector(".top").classList.toggle("focused","focus"===t.type)}}]);var i}(g.WF));x.styles=(0,g.AH)(o||(o=(0,c.A)([":host{display:block}.top{display:flex;align-items:center;border-radius:var(--ha-card-border-radius,var(--ha-border-radius-lg))}.top.expanded{border-bottom-left-radius:0px;border-bottom-right-radius:0px}.top.focused{background:var(--input-fill-color)}:host([outlined]){box-shadow:none;border-width:1px;border-style:solid;border-color:var(--outline-color);border-radius:var(--ha-card-border-radius,var(--ha-border-radius-lg))}.summary-icon{transition:transform 150ms cubic-bezier(.4, 0, .2, 1);direction:var(--direction);margin-left:8px;margin-inline-start:8px;margin-inline-end:initial;border-radius:var(--ha-border-radius-circle)}#summary:focus-visible ha-svg-icon.summary-icon{background-color:var(--ha-color-fill-neutral-normal-active)}::slotted([slot=leading-icon]),:host([left-chevron]) .summary-icon{margin-left:0;margin-right:8px;margin-inline-start:0;margin-inline-end:8px}#summary{flex:1;display:flex;padding:var(--expansion-panel-summary-padding,0 8px);min-height:48px;align-items:center;cursor:pointer;overflow:hidden;font-weight:var(--ha-font-weight-medium);outline:0}#summary.noCollapse{cursor:default}.summary-icon.expanded{transform:rotate(180deg)}.header,::slotted([slot=header]){flex:1;overflow-wrap:anywhere;color:var(--primary-text-color)}.container{padding:var(--expansion-panel-content-padding,0 8px);overflow:hidden;transition:height .3s cubic-bezier(.4, 0, .2, 1);height:0px}.container.expanded{height:auto}.secondary{display:block;color:var(--secondary-text-color);font-size:var(--ha-font-size-s)}"]))),(0,v.Cg)([(0,y.MZ)({type:Boolean,reflect:!0})],x.prototype,"expanded",void 0),(0,v.Cg)([(0,y.MZ)({type:Boolean,reflect:!0})],x.prototype,"outlined",void 0),(0,v.Cg)([(0,y.MZ)({attribute:"left-chevron",type:Boolean,reflect:!0})],x.prototype,"leftChevron",void 0),(0,v.Cg)([(0,y.MZ)({attribute:"no-collapse",type:Boolean,reflect:!0})],x.prototype,"noCollapse",void 0),(0,v.Cg)([(0,y.MZ)()],x.prototype,"header",void 0),(0,v.Cg)([(0,y.MZ)()],x.prototype,"secondary",void 0),(0,v.Cg)([(0,y.wk)()],x.prototype,"_showContent",void 0),(0,v.Cg)([(0,y.P)(".container")],x.prototype,"_container",void 0),x=(0,v.Cg)([(0,y.EM)("ha-expansion-panel")],x)},90248:function(t,e,i){i.r(e),i.d(e,{HaIconButtonArrowPrev:function(){return f}});var n,a=i(72153),r=i(44734),o=i(43080),s=i(69683),l=i(6454),c=(i(28706),i(40445)),d=i(96196),u=i(77845),h=i(63091),f=(i(26300),function(t){function e(){var t;(0,r.A)(this,e);for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(t=(0,s.A)(this,e,[].concat(n))).disabled=!1,t._icon="rtl"===h.G.document.dir?"M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z":"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z",t}return(0,l.A)(e,t),(0,o.A)(e,[{key:"render",value:function(){var t;return(0,d.qy)(n||(n=(0,a.A)([' <ha-icon-button .disabled="','" .label="','" .path="','"></ha-icon-button> '])),this.disabled,this.label||(null===(t=this.hass)||void 0===t?void 0:t.localize("ui.common.back"))||"Back",this._icon)}}])}(d.WF));(0,c.Cg)([(0,u.MZ)({attribute:!1})],f.prototype,"hass",void 0),(0,c.Cg)([(0,u.MZ)({type:Boolean})],f.prototype,"disabled",void 0),(0,c.Cg)([(0,u.MZ)()],f.prototype,"label",void 0),(0,c.Cg)([(0,u.wk)()],f.prototype,"_icon",void 0),f=(0,c.Cg)([(0,u.EM)("ha-icon-button-arrow-prev")],f)},2846:function(t,e,i){i.d(e,{G:function(){return g},J:function(){return v}});var n,a,r=i(44734),o=i(43080),s=i(69683),l=i(6454),c=i(72153),d=i(40445),u=i(97154),h=i(82553),f=i(96196),p=i(77845),v=(i(54276),[h.R,(0,f.AH)(n||(n=(0,c.A)([":host{--ha-icon-display:block;--md-sys-color-primary:var(--primary-text-color);--md-sys-color-secondary:var(--secondary-text-color);--md-sys-color-surface:var(--card-background-color);--md-sys-color-on-surface:var(--primary-text-color);--md-sys-color-on-surface-variant:var(--secondary-text-color)}md-item{overflow:var(--md-item-overflow,hidden);align-items:var(--md-item-align-items,center);gap:var(--ha-md-list-item-gap,16px)}"])))]),g=function(t){function e(){return(0,r.A)(this,e),(0,s.A)(this,e,arguments)}return(0,l.A)(e,t),(0,o.A)(e,[{key:"renderRipple",value:function(){return"text"===this.type?f.s6:(0,f.qy)(a||(a=(0,c.A)(['<ha-ripple part="ripple" for="item" ?disabled="','"></ha-ripple>'])),this.disabled&&"link"!==this.type)}}])}(u.n);g.styles=v,g=(0,d.Cg)([(0,p.EM)("ha-md-list-item")],g)},79817:function(t,e,i){var n,a=i(72153),r=i(44734),o=i(43080),s=i(69683),l=i(6454),c=i(40445),d=i(43976),u=i(703),h=i(96196),f=i(77845),p=i(94333),v=(i(8630),function(t){function e(){return(0,r.A)(this,e),(0,s.A)(this,e,arguments)}return(0,l.A)(e,t),(0,o.A)(e,[{key:"listElement",get:function(){return this.listElement_||(this.listElement_=this.renderRoot.querySelector("ha-list")),this.listElement_}},{key:"renderList",value:function(){var t="menu"===this.innerRole?"menuitem":"option",e=this.renderListClasses();return(0,h.qy)(n||(n=(0,a.A)(['<ha-list rootTabbable .innerAriaLabel="','" .innerRole="','" .multi="','" class="','" .itemRoles="','" .wrapFocus="','" .activatable="','" @action="','"> <slot></slot> </ha-list>'])),this.innerAriaLabel,this.innerRole,this.multi,(0,p.H)(e),t,this.wrapFocus,this.activatable,this.onAction)}}])}(d.ZR));v.styles=u.R,v=(0,c.Cg)([(0,f.EM)("ha-menu")],v)},75709:function(t,e,i){var n,a,r,o,s=i(72153),l=i(44734),c=i(43080),d=i(69683),u=i(6454),h=i(25460),f=(i(28706),i(40445)),p=i(68846),v=i(92347),g=i(96196),y=i(77845),m=i(63091),_=function(t){function e(){var t;(0,l.A)(this,e);for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(t=(0,d.A)(this,e,[].concat(n))).icon=!1,t.iconTrailing=!1,t.autocorrect=!0,t}return(0,u.A)(e,t),(0,c.A)(e,[{key:"updated",value:function(t){(0,h.A)(e,"updated",this,3)([t]),(t.has("invalid")||t.has("errorMessage"))&&(this.setCustomValidity(this.invalid?this.errorMessage||this.validationMessage||"Invalid":""),(this.invalid||this.validateOnInitialRender||t.has("invalid")&&void 0!==t.get("invalid"))&&this.reportValidity()),t.has("autocomplete")&&(this.autocomplete?this.formElement.setAttribute("autocomplete",this.autocomplete):this.formElement.removeAttribute("autocomplete")),t.has("autocorrect")&&(!1===this.autocorrect?this.formElement.setAttribute("autocorrect","off"):this.formElement.removeAttribute("autocorrect")),t.has("inputSpellcheck")&&(this.inputSpellcheck?this.formElement.setAttribute("spellcheck",this.inputSpellcheck):this.formElement.removeAttribute("spellcheck"))}},{key:"renderIcon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e?"trailing":"leading";return(0,g.qy)(n||(n=(0,s.A)([' <span class="mdc-text-field__icon mdc-text-field__icon--','" tabindex="','"> <slot name="','Icon"></slot> </span> '])),i,e?1:-1,i)}}])}(p.J);_.styles=[v.R,(0,g.AH)(a||(a=(0,s.A)([".mdc-text-field__input{width:var(--ha-textfield-input-width,100%)}.mdc-text-field:not(.mdc-text-field--with-leading-icon){padding:var(--text-field-padding,0px 16px)}.mdc-text-field__affix--suffix{padding-left:var(--text-field-suffix-padding-left,12px);padding-right:var(--text-field-suffix-padding-right,0px);padding-inline-start:var(--text-field-suffix-padding-left,12px);padding-inline-end:var(--text-field-suffix-padding-right,0px);direction:ltr}.mdc-text-field--with-leading-icon{padding-inline-start:var(--text-field-suffix-padding-left,0px);padding-inline-end:var(--text-field-suffix-padding-right,16px);direction:var(--direction)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:var(--text-field-suffix-padding-left,0px);padding-right:var(--text-field-suffix-padding-right,0px);padding-inline-start:var(--text-field-suffix-padding-left,0px);padding-inline-end:var(--text-field-suffix-padding-right,0px)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__affix--suffix{color:var(--secondary-text-color)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__icon{color:var(--secondary-text-color)}.mdc-text-field__icon--leading{margin-inline-start:16px;margin-inline-end:8px;direction:var(--direction)}.mdc-text-field__icon--trailing{padding:var(--textfield-icon-trailing-padding,12px)}.mdc-floating-label:not(.mdc-floating-label--float-above){max-width:calc(100% - 16px)}.mdc-floating-label--float-above{max-width:calc((100% - 16px)/ .75);transition:none}input{text-align:var(--text-field-text-align,start)}input[type=color]{height:20px}::-ms-reveal{display:none}:host([no-spinner]) input::-webkit-inner-spin-button,:host([no-spinner]) input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=color]::-webkit-color-swatch-wrapper{padding:0}:host([no-spinner]) input[type=number]{-moz-appearance:textfield}.mdc-text-field__ripple{overflow:hidden}.mdc-text-field{overflow:var(--text-field-overflow)}.mdc-floating-label{padding-inline-end:16px;padding-inline-start:initial;inset-inline-start:16px!important;inset-inline-end:initial!important;transform-origin:var(--float-start);direction:var(--direction);text-align:var(--float-start);box-sizing:border-box;text-overflow:ellipsis}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px - var(--text-field-suffix-padding-left,0px));inset-inline-start:calc(48px + var(--text-field-suffix-padding-left,0px))!important;inset-inline-end:initial!important;direction:var(--direction)}.mdc-text-field__input[type=number]{direction:var(--direction)}.mdc-text-field__affix--prefix{padding-right:var(--text-field-prefix-padding-right,2px);padding-inline-end:var(--text-field-prefix-padding-right,2px);padding-inline-start:initial}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__affix--prefix{color:var(--mdc-text-field-label-ink-color)}#helper-text ha-markdown{display:inline-block}"]))),"rtl"===m.G.document.dir?(0,g.AH)(r||(r=(0,s.A)([".mdc-floating-label,.mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field__icon--leading,.mdc-text-field__input[type=number]{direction:rtl;--direction:rtl}"]))):(0,g.AH)(o||(o=(0,s.A)([""])))],(0,f.Cg)([(0,y.MZ)({type:Boolean})],_.prototype,"invalid",void 0),(0,f.Cg)([(0,y.MZ)({attribute:"error-message"})],_.prototype,"errorMessage",void 0),(0,f.Cg)([(0,y.MZ)({type:Boolean})],_.prototype,"icon",void 0),(0,f.Cg)([(0,y.MZ)({type:Boolean})],_.prototype,"iconTrailing",void 0),(0,f.Cg)([(0,y.MZ)()],_.prototype,"autocomplete",void 0),(0,f.Cg)([(0,y.MZ)({type:Boolean})],_.prototype,"autocorrect",void 0),(0,f.Cg)([(0,y.MZ)({attribute:"input-spellcheck"})],_.prototype,"inputSpellcheck",void 0),(0,f.Cg)([(0,y.P)("input")],_.prototype,"formElement",void 0),_=(0,f.Cg)([(0,y.EM)("ha-textfield")],_)},27330:function(t,e,i){var n,a=i(72153),r=i(43080),o=i(44734),s=i(69683),l=i(6454),c=(i(28706),i(40445)),d=i(29781),u=i(71467),h=i(96196),f=i(77845),p=function(t){function e(){var t;(0,o.A)(this,e);for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(t=(0,s.A)(this,e,[].concat(n))).narrow=!1,t}return(0,l.A)(e,t),(0,r.A)(e)}(d.$);p.styles=[u.R,(0,h.AH)(n||(n=(0,a.A)(["header{padding-top:var(--safe-area-inset-top)}.mdc-top-app-bar__row{height:var(--header-height);border-bottom:var(--app-header-border-bottom)}.mdc-top-app-bar--fixed-adjust{padding-top:calc(var(--header-height,0px) + var(--safe-area-inset-top,0px));padding-bottom:var(--safe-area-inset-bottom);padding-right:var(--safe-area-inset-right)}:host([narrow]) .mdc-top-app-bar--fixed-adjust{padding-left:var(--safe-area-inset-left)}.mdc-top-app-bar{--mdc-typography-headline6-font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,var(--mdc-theme-on-primary,#fff));background-color:var(--app-header-background-color,var(--mdc-theme-primary));padding-top:var(--safe-area-inset-top);padding-right:var(--safe-area-inset-right)}:host([narrow]) .mdc-top-app-bar{padding-left:var(--safe-area-inset-left)}.mdc-top-app-bar__title{font-size:var(--ha-font-size-xl);padding-inline-start:24px;padding-inline-end:initial}"])))],(0,c.Cg)([(0,f.MZ)({type:Boolean,reflect:!0})],p.prototype,"narrow",void 0),p=(0,c.Cg)([(0,f.EM)("ha-top-app-bar-fixed")],p)},53756:function(t,e,i){i.d(e,{t:function(){return c},w:function(){return d}});var n=i(78261),a=(i(28706),i(2008),i(74423),i(62062),i(18111),i(22489),i(61701),i(79432),i(26099),i(21699),i(71727)),r=i(74705),o=i(28978),s=i(15638),l=i(95350),c=[{name:"search_labels.entityName",weight:10},{name:"search_labels.friendlyName",weight:8},{name:"search_labels.deviceName",weight:7},{name:"search_labels.areaName",weight:6},{name:"search_labels.domainName",weight:6},{name:"search_labels.entityId",weight:3}],d=function(t,e,i,c,d,u,h,f,p){var v=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"",g=[],y=Object.keys(t.states);return h&&(y=y.filter(function(t){return h.includes(t)})),f&&(y=y.filter(function(t){return!f.includes(t)})),e&&(y=y.filter(function(t){return e.includes((0,a.m)(t))})),i&&(y=y.filter(function(t){return!i.includes((0,a.m)(t))})),g=y.map(function(e){var i=t.states[e],c=(0,o.u)(i),d=(0,r.Cf)(i,[{type:"entity"},{type:"device"},{type:"area"}],t.entities,t.devices,t.areas,t.floors),u=(0,n.A)(d,3),h=u[0],f=u[1],p=u[2],g=(0,l.p$)(t.localize,(0,a.m)(e)),y=(0,s.qC)(t),m=h||f||e,_=[p,h?f:void 0].filter(Boolean).join(y?" ◂ ":" ▸ ");return{id:"".concat(v).concat(e),primary:m,secondary:_,domain_name:g,sorting_label:[m,_].filter(Boolean).join("_"),search_labels:{entityName:h||null,deviceName:f||null,areaName:p||null,domainName:g||null,friendlyName:c||null,entityId:e},stateObj:i}}),d&&(g=g.filter(function(t){var e;return t.id===p||(null===(e=t.stateObj)||void 0===e?void 0:e.attributes.device_class)&&d.includes(t.stateObj.attributes.device_class)})),u&&(g=g.filter(function(t){var e;return t.id===p||(null===(e=t.stateObj)||void 0===e?void 0:e.attributes.unit_of_measurement)&&u.includes(t.stateObj.attributes.unit_of_measurement)})),c&&(g=g.filter(function(t){return t.id===p||t.stateObj&&c(t.stateObj)})),g}},95311:function(t,e,i){i.d(e,{DF:function(){return y},Lo:function(){return k},MH:function(){return f},MM:function(){return m},Qz:function(){return g},Ru:function(){return b},UU:function(){return x},_7:function(){return v},bZ:function(){return p},m0:function(){return h},tD:function(){return w},vX:function(){return _},wY:function(){return A}});var n=i(7739),a=i(20054),r=(i(2008),i(78350),i(23418),i(74423),i(23792),i(44114),i(30237),i(18111),i(22489),i(30531),i(7588),i(13579),i(69085),i(26099),i(16034),i(31415),i(17642),i(58004),i(33853),i(45876),i(32475),i(15024),i(31698),i(21699),i(47764),i(23500),i(62953),i(44537)),o=i(69093),s=i(82286),l=i(24367),c=i(44927),d=["domain","integration","device_class"],u=["integration","manufacturer","model"],h=function(t,e,i,n,a,r,o){var s=[],l=[],c=[];return Object.values(i).forEach(function(i){i.labels.includes(e)&&g(t,a,n,i.area_id,r,o)&&c.push(i.area_id)}),Object.values(n).forEach(function(i){i.labels.includes(e)&&y(t,Object.values(a),i,r,o)&&l.push(i.id)}),Object.values(a).forEach(function(i){i.labels.includes(e)&&m(t.states[i.entity_id],r,o)&&s.push(i.entity_id)}),{areas:c,devices:l,entities:s}},f=function(t,e,i,n,a){var r=[];return Object.values(i).forEach(function(i){i.floor_id===e&&g(t,t.entities,t.devices,i.area_id,n,a)&&r.push(i.area_id)}),{areas:r}},p=function(t,e,i,n,a,r){var o=[],s=[];return Object.values(i).forEach(function(i){i.area_id===e&&y(t,Object.values(n),i,a,r)&&s.push(i.id)}),Object.values(n).forEach(function(i){i.area_id===e&&m(t.states[i.entity_id],a,r)&&o.push(i.entity_id)}),{devices:s,entities:o}},v=function(t,e,i,n,a){var r=[];return Object.values(i).forEach(function(i){i.device_id===e&&m(t.states[i.entity_id],n,a)&&r.push(i.entity_id)}),{entities:r}},g=function(t,e,i,n,a,r){return!!Object.values(i).some(function(i){return!(i.area_id!==n||!y(t,Object.values(e),i,a,r))})||Object.values(e).some(function(e){return!(e.area_id!==n||!m(t.states[e.entity_id],a,r))})},y=function(t,e,i,n,a){var o,s,l=a?(0,c.fk)(a,e):void 0;return!(null!==(o=n.target)&&void 0!==o&&o.device&&!(0,r.e)(n.target.device).some(function(t){return _(t,i,l)}))&&(null===(s=n.target)||void 0===s||!s.entity||e.filter(function(t){return t.device_id===i.id}).some(function(e){var i=t.states[e.entity_id];return m(i,n,a)}))},m=function(t,e,i){var n;return!!t&&(null===(n=e.target)||void 0===n||!n.entity||(0,r.e)(e.target.entity).some(function(e){return b(e,t,i)}))},_=function(t,e,i){var n,a=t.manufacturer,r=t.model,o=t.model_id,s=t.integration;if(a&&e.manufacturer!==a)return!1;if(r&&e.model!==r)return!1;if(o&&e.model_id!==o)return!1;if(s&&i&&(null==i||null===(n=i[e.id])||void 0===n||!n.has(s)))return!1;return!0},b=function(t,e,i){var n,a=t.domain,l=t.device_class,c=t.supported_features,d=t.integration;if(a){var u=(0,o.t)(e);if(Array.isArray(a)?!a.includes(u):u!==a)return!1}if(l){var h=e.attributes.device_class;if(h&&Array.isArray(l)?!l.includes(h):h!==l)return!1}return!(c&&!(0,r.e)(c).some(function(t){return(0,s.$)(e,t)}))&&(!d||(null==i||null===(n=i[e.entity_id])||void 0===n?void 0:n.domain)===d)},x=function(t){if(!t.entity)return{entity:null};if("filter"in t.entity)return t;var e=t.entity,i=e.domain,n=e.integration,r=e.device_class,o=(0,a.A)(e,d);return i||n||r?{entity:Object.assign(Object.assign({},o),{},{filter:{domain:i,integration:n,device_class:r}})}:{entity:o}},w=function(t){if(!t.device)return{device:null};if("filter"in t.device)return t;var e=t.device,i=e.integration,n=e.manufacturer,r=e.model,o=(0,a.A)(e,u);return i||n||r?{device:Object.assign(Object.assign({},o),{},{filter:{integration:i,manufacturer:n,model:r}})}:{device:o}},k=function(t){var e,i;if("target"in t)e=(0,r.e)(null===(i=t.target)||void 0===i?void 0:i.entity);else if("entity"in t){var a,o;if(null!==(a=t.entity)&&void 0!==a&&a.include_entities)return;e=(0,r.e)(null===(o=t.entity)||void 0===o?void 0:o.filter)}if(e){var s=e.flatMap(function(t){return t.integration||t.device_class||t.supported_features||!t.domain?[]:(0,r.e)(t.domain).filter(function(t){return(0,l.zd)(t)})});return(0,n.A)(new Set(s))}},A=function(t,e,i,n,a){if(!e)return[];var o={target:{}},s=new Set((0,r.e)(e.entity_id)),l=new Set((0,r.e)(e.device_id)),c=new Set((0,r.e)(e.area_id)),d=new Set((0,r.e)(e.floor_id));return new Set((0,r.e)(e.label_id)).forEach(function(e){var r=h(t,e,a,n,i,o);r.devices.forEach(function(t){return l.add(t)}),r.entities.forEach(function(t){return s.add(t)}),r.areas.forEach(function(t){return c.add(t)})}),d.forEach(function(e){f(t,e,a,o).areas.forEach(function(t){return c.add(t)})}),c.forEach(function(e){var a=p(t,e,n,i,o);a.devices.forEach(function(t){return l.add(t)}),a.entities.forEach(function(t){return s.add(t)})}),l.forEach(function(e){v(t,e,i,o).entities.forEach(function(t){return s.add(t)})}),Array.from(s)}},19711:function(t,e,i){i.d(e,{$:function(){return r}});i(23792),i(26099),i(3362),i(47764),i(62953);var n=i(1087),a=function(){return Promise.all([i.e("93785"),i.e("26767"),i.e("80131"),i.e("12036"),i.e("94943")]).then(i.bind(i,79029))},r=function(t,e){(0,n.r)(t,"show-dialog",{dialogTag:"dialog-helper-detail",dialogImport:a,dialogParams:e})}},49131:function(t,e,i){i.a(t,async function(t,n){try{i.r(e);var a,r,o,s,l,c,d,u,h=i(78261),f=i(31432),p=i(7739),v=i(61397),g=i(50264),y=i(72153),m=i(44734),_=i(43080),b=i(69683),x=i(6454),w=i(25460),k=(i(28706),i(23792),i(44114),i(26910),i(5506),i(79432),i(26099),i(27495),i(90906),i(31415),i(17642),i(58004),i(33853),i(45876),i(32475),i(15024),i(31698),i(47764),i(25440),i(79978),i(62953),i(3296),i(27208),i(48408),i(14603),i(47566),i(98721),i(40445)),A=i(44018),C=i(96196),H=i(77845),M=i(22786),L=i(44537),D=i(93905),E=i(71727),O=i(91926),V=i(51758),j=i(6030),P=i(44439),S=i(66737),B=(i(13416),i(15397)),Z=(i(26300),i(90248),i(28732),i(2054),i(65829)),z=i(79286),I=(i(27330),i(25064)),T=i(23528),R=i(95311),q=i(64808),N=i(65063),U=i(14503),F=i(30039),W=i(12496),G=t([S,B,Z,z,T,I,P]);[S,B,Z,z,T,I,P]=G.then?(await G)():G;var $=function(t){function e(){var t;(0,m.A)(this,e),(t=(0,b.A)(this,e)).narrow=!1,t.rtl=!1,t._targetPickerValue={},t._isLoading=!1,t.__getEntityIds=(0,M.A)(function(e,i,n,a){return(0,R.wY)(t.hass,e,i,n,a)});var i=new Date;i.setHours(i.getHours()-1,0,0,0),t._startDate=i;var n=new Date;return n.setHours(n.getHours()+2,0,0,0),t._endDate=n,t}return(0,x.A)(e,t),(0,_.A)(e,[{key:"connectedCallback",value:function(){(0,w.A)(e,"connectedCallback",this,3)([]),this.hasUpdated&&this._getHistory()}},{key:"disconnectedCallback",value:function(){(0,w.A)(e,"disconnectedCallback",this,3)([]),this._unsubscribeHistory()}},{key:"_goBack",value:function(){(0,O.O)()}},{key:"render",value:function(){var t=this._getEntityIds().length>0;return(0,C.qy)(a||(a=(0,y.A)([' <ha-top-app-bar-fixed .narrow="','"> ',' <div slot="title">',"</div> ",' <ha-button-menu slot="actionItems" @action="','"> <ha-icon-button slot="trigger" .label="','" .path="','"></ha-icon-button> <ha-list-item graphic="icon" .disabled="','"> ',' <ha-svg-icon slot="graphic" .path="','"></ha-svg-icon> </ha-list-item> <ha-list-item graphic="icon" .disabled="','"> ',' <ha-svg-icon slot="graphic" .path="','"></ha-svg-icon> </ha-list-item> </ha-button-menu> <div class="flex content"> <div class="filters"> <ha-date-range-picker .hass="','" ?disabled="','" .startDate="','" .endDate="','" extended-presets time-picker @value-changed="','"></ha-date-range-picker> <ha-target-picker .hass="','" .value="','" .disabled="','" add-on-top @value-changed="','" compact="compact"></ha-target-picker> </div> '," </div> </ha-top-app-bar-fixed> "])),this.narrow,this._showBack?(0,C.qy)(r||(r=(0,y.A)([' <ha-icon-button-arrow-prev slot="navigationIcon" @click="','"></ha-icon-button-arrow-prev> '])),this._goBack):(0,C.qy)(o||(o=(0,y.A)([' <ha-menu-button slot="navigationIcon" .hass="','" .narrow="','"></ha-menu-button> '])),this.hass,this.narrow),this.hass.localize("panel.history"),t?(0,C.qy)(s||(s=(0,y.A)([' <ha-icon-button slot="actionItems" @click="','" .disabled="','" .path="','" .label="','"></ha-icon-button> '])),this._removeAll,this._isLoading,"M14.76,20.83L17.6,18L14.76,15.17L16.17,13.76L19,16.57L21.83,13.76L23.24,15.17L20.43,18L23.24,20.83L21.83,22.24L19,19.4L16.17,22.24L14.76,20.83M12,12V19.88C12.04,20.18 11.94,20.5 11.71,20.71C11.32,21.1 10.69,21.1 10.3,20.71L8.29,18.7C8.06,18.47 7.96,18.16 8,17.87V12H7.97L2.21,4.62C1.87,4.19 1.95,3.56 2.38,3.22C2.57,3.08 2.78,3 3,3V3H17V3C17.22,3 17.43,3.08 17.62,3.22C18.05,3.56 18.13,4.19 17.79,4.62L12.03,12H12Z",this.hass.localize("ui.panel.history.remove_all")):"",this._handleMenuAction,this.hass.localize("ui.common.menu"),"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",this._isLoading,this.hass.localize("ui.panel.history.download_data"),"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z",this._isLoading,this.hass.localize("ui.panel.history.add_card"),"M18 15V18H15V20H18V23H20V20H23V18H20V15H18M13.3 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H19C20.1 3 21 3.9 21 5V13.3C20.4 13.1 19.7 13 19 13C17.9 13 16.8 13.3 15.9 13.9L14.5 12L11 16.5L8.5 13.5L5 18H13.1C13 18.3 13 18.7 13 19C13 19.7 13.1 20.4 13.3 21Z",this.hass,this._isLoading,this._startDate,this._endDate,this._dateRangeChanged,this.hass,this._targetPickerValue,this._isLoading,this._targetsChanged,this._isLoading?(0,C.qy)(l||(l=(0,y.A)(['<div class="progress-wrapper"> <ha-spinner></ha-spinner> </div>']))):t?(0,C.qy)(d||(d=(0,y.A)([' <state-history-charts .hass="','" .historyData="','" .startTime="','" .endTime="','" .narrow="','" sync-charts> </state-history-charts> '])),this.hass,this._mungedStateHistory,this._startDate,this._endDate,this.narrow):(0,C.qy)(c||(c=(0,y.A)(['<div class="start-search"> '," </div>"])),this.hass.localize("ui.panel.history.start_search")))}},{key:"willUpdate",value:function(t){if((0,w.A)(e,"willUpdate",this,3)([t]),(t.has("_stateHistory")||t.has("_statisticsHistory")||t.has("_startDate")||t.has("_endDate")||t.has("_targetPickerValue"))&&(this._statisticsHistory&&this._stateHistory?this._mungedStateHistory=(0,I.tG)(this._stateHistory,this._statisticsHistory):this._mungedStateHistory=this._stateHistory||this._statisticsHistory),!this.hasUpdated){var i=(0,j.px)(),n=i.entity_id,a=i.device_id,r=i.area_id,o=i.floor_id,s=i.label_id;if((n||a||r||o||s)&&(this._targetPickerValue={}),n){var l=n.split(",");this._targetPickerValue.entity_id=l}if(a){var c=a.split(",");this._targetPickerValue.device_id=c}if(r){var d=r.split(",");this._targetPickerValue.area_id=d}if(o){var u=o.split(",");this._targetPickerValue.floor_id=u}if(s){var h=s.split(",");this._targetPickerValue.label_id=h}var f=i.start_date;f&&(this._startDate=new Date(f));var p=i.end_date;p&&(this._endDate=new Date(p))}}},{key:"firstUpdated",value:function(t){(0,w.A)(e,"firstUpdated",this,3)([t]),"1"===(0,j.px)().back&&history.length>1&&(this._showBack=!0,(0,O.o)((0,V.Z)((0,j.s8)("back")),{replace:!0}))}},{key:"updated",value:function(t){(t.has("_startDate")||t.has("_endDate")||t.has("_targetPickerValue")||!this._stateHistory&&(t.has("_deviceEntityLookup")||t.has("_areaEntityLookup")||t.has("_areaDeviceLookup")))&&(this._getHistory(),this._getStats())}},{key:"_removeAll",value:function(){this._targetPickerValue={},this._updatePath()}},{key:"_getStats",value:(k=(0,g.A)((0,v.A)().m(function t(){var e,i,n,a,r;return(0,v.A)().w(function(t){for(;;)switch(t.n){case 0:if(0!==(e=this._getEntityIds()).length){t.n=1;break}return this._statisticsHistory=void 0,t.a(2);case 1:return(i=new Date(this._startDate)).setHours(i.getHours()-1),t.n=2,(0,T.sz)(this.hass,i,this._endDate,e,"hour",void 0,["mean","state"]);case 2:return n=t.v,t.n=3,(0,q.KL)(this.hass);case 3:a=t.v,r=a.numeric_device_classes,this._statisticsHistory=(0,I._1)(this.hass,n,e,r,!0);case 4:return t.a(2)}},t,this)})),function(){return k.apply(this,arguments)})},{key:"_getHistory",value:(n=(0,g.A)((0,v.A)().m(function t(){var e,i,n,a,r=this;return(0,v.A)().w(function(t){for(;;)switch(t.n){case 0:if(0!==(e=this._getEntityIds()).length){t.n=1;break}return this._stateHistory=void 0,t.a(2);case 1:return this._isLoading=!0,this._subscribed&&this._unsubscribeHistory(),i=new Date,t.n=2,(0,q.KL)(this.hass);case 2:n=t.v,a=n.numeric_device_classes,this._subscribed=(0,I.Jo)(this.hass,function(t){r._isLoading=!1,r._stateHistory=(0,I.Mm)(r.hass,t,e,r.hass.localize,a,!0)},this._startDate,this._endDate,e),this._subscribed.catch(function(){r._isLoading=!1,r._unsubscribeHistory()}),this._endDate>i&&this._setRedrawTimer();case 3:return t.a(2)}},t,this)})),function(){return n.apply(this,arguments)})},{key:"_setRedrawTimer",value:function(){var t=this;clearInterval(this._interval);var e=new Date,i=this._endDate>e?e:this._endDate,n=(0,A.M)(i,this._startDate);this._interval=window.setInterval(function(){var e;return null===(e=t._stateHistoryCharts)||void 0===e?void 0:e.requestUpdate()},n<2?1e4:n<10?6e4:P.p)}},{key:"_unsubscribeHistory",value:function(){this._interval&&(clearInterval(this._interval),this._interval=void 0),this._subscribed&&(this._subscribed.then(function(t){return null==t?void 0:t()}),this._subscribed=void 0)}},{key:"_getEntityIds",value:function(){return this.__getEntityIds(this._targetPickerValue,this.hass.entities,this.hass.devices,this.hass.areas)}},{key:"_dateRangeChanged",value:function(t){this._startDate=t.detail.value.startDate,this._endDate=t.detail.value.endDate,this._updatePath()}},{key:"_targetsChanged",value:function(t){this._targetPickerValue=t.detail.value||{},this._updatePath()}},{key:"_updatePath",value:function(){var t={};this._targetPickerValue.entity_id&&(t.entity_id=(0,L.e)(this._targetPickerValue.entity_id).join(",")),this._targetPickerValue.label_id&&(t.label_id=(0,L.e)(this._targetPickerValue.label_id).join(",")),this._targetPickerValue.floor_id&&(t.floor_id=(0,L.e)(this._targetPickerValue.floor_id).join(",")),this._targetPickerValue.area_id&&(t.area_id=(0,L.e)(this._targetPickerValue.area_id).join(",")),this._targetPickerValue.device_id&&(t.device_id=(0,L.e)(this._targetPickerValue.device_id).join(",")),this._startDate&&(t.start_date=this._startDate.toISOString()),this._endDate&&(t.end_date=this._endDate.toISOString()),(0,O.o)("/history?".concat((0,j.KH)(t)),{replace:!0})}},{key:"_handleMenuAction",value:(i=(0,g.A)((0,v.A)().m(function t(e){var i;return(0,v.A)().w(function(t){for(;;)switch(t.n){case 0:i=e.detail.index,t.n=0===i?1:1===i?2:3;break;case 1:return this._downloadHistory(),t.a(3,3);case 2:return this._suggestCard(),t.a(3,3);case 3:return t.a(2)}},t,this)})),function(t){return i.apply(this,arguments)})},{key:"_downloadHistory",value:function(){if(0!==(0,p.A)(this._getEntityIds()).sort().length&&this._mungedStateHistory){var t,e=[""],i=["entity_id","state","last_changed"],n=new Set,a={climate:{current_temperature:0,hvac_action:0,target_temp_high:0,target_temp_low:0,temperature:0},humidifier:{action:0,current_humidity:0,humidity:0},water_heater:{current_temperature:0,operation_mode:0,temperature:0}},r=function(t){return new Date(t).toISOString()},o=(0,f.A)(this._mungedStateHistory.line);try{for(o.s();!(t=o.n()).done;){var s,l=t.value,c=(0,f.A)(l.data);try{for(c.s();!(s=c.n()).done;){var d=s.value,u=d.entity_id,v=(0,E.m)(u),g=a[v];if(g&&!n.has(v)){n.add(v);for(var y=i.length,m=0,_=Object.keys(g);m<_.length;m++){var b=_[m];i.push(b),g[b]=y,y+=1}}if(d.statistics){var x,w=(0,f.A)(d.statistics);try{for(w.s();!(x=w.n()).done;){var k=x.value;e.push("".concat(u,",").concat(k.state,",").concat(r(k.last_changed),"\n"))}}catch($){w.e($)}finally{w.f()}}var A,C=(0,f.A)(d.states);try{for(C.s();!(A=C.n()).done;){var H=A.value,M=r(H.last_changed),L=[u,H.state,M];if(H.attributes&&g)for(var D=H.attributes,O=0,V=Object.entries(g);O<V.length;O++){var j=(0,h.A)(V[O],2),P=j[0],S=j[1];P in D&&(L[S]=D[P])}e.push(L.join(",")+"\n")}}catch($){C.e($)}finally{C.f()}}}catch($){c.e($)}finally{c.f()}}}catch($){o.e($)}finally{o.f()}var B,Z=(0,f.A)(this._mungedStateHistory.timeline);try{for(Z.s();!(B=Z.n()).done;){var z,I=B.value,T=I.entity_id,R=(0,f.A)(I.data);try{for(R.s();!(z=R.n()).done;){var q=z.value,U=/,|"/.test(q.state)?'"'.concat(q.state.replaceAll('"','""'),'"'):q.state;e.push("".concat(T,",").concat(U,",").concat(r(q.last_changed),"\n"))}}catch($){R.e($)}finally{R.f()}}}catch($){Z.e($)}finally{Z.f()}e[0]=i.join(",")+"\n";var W=new Blob(e,{type:"text/csv"}),G=window.URL.createObjectURL(W);(0,F.R)(G,"history.csv")}else(0,N.showAlertDialog)(this,{title:this.hass.localize("ui.panel.history.download_data_error"),text:this.hass.localize("ui.panel.history.error_no_data"),warning:!0})}},{key:"_suggestCard",value:function(){var t=this._getEntityIds();if(0!==t.length&&this._mungedStateHistory){var e=Math.min(this._endDate.getTime(),Date.now()),i=[{title:this.hass.localize("panel.history"),type:"history-graph",hours_to_show:Math.round((e-this._startDate.getTime())/1e3/60/60),entities:t}];(0,W.Q)(this,this.hass,i,{title:this.hass.localize("panel.history"),cards:i},t)}else(0,N.showAlertDialog)(this,{title:this.hass.localize("ui.panel.history.add_card_error"),text:this.hass.localize("ui.panel.history.error_no_data"),warning:!0})}}],[{key:"styles",get:function(){return[U.RF,(0,C.AH)(u||(u=(0,y.A)(["ha-top-app-bar-fixed{height:100vh;overflow-x:hidden;overflow-y:visible}.content{padding:0 16px 16px}:host([virtualize]){height:100%;--ha-generic-picker-max-width:400px}.progress-wrapper{position:relative;display:flex;align-items:center;flex-direction:column;padding:16px}.filters{display:flex;align-items:flex-start;margin-top:16px}ha-date-range-picker{margin-right:16px;margin-inline-end:16px;margin-inline-start:initial;max-width:100%;direction:var(--direction)}ha-target-picker{flex:1}@media all and (max-width:1025px){.filters{flex-direction:column}ha-date-range-picker{width:100%;margin-bottom:8px}}.start-search{padding-top:16px;text-align:center;color:var(--secondary-text-color)}"])))]}}]);var i,n,k}(C.WF);(0,k.Cg)([(0,H.MZ)({attribute:!1})],$.prototype,"hass",void 0),(0,k.Cg)([(0,H.MZ)({reflect:!0,type:Boolean})],$.prototype,"narrow",void 0),(0,k.Cg)([(0,H.MZ)({reflect:!0,type:Boolean})],$.prototype,"rtl",void 0),(0,k.Cg)([(0,H.wk)()],$.prototype,"_startDate",void 0),(0,k.Cg)([(0,H.wk)()],$.prototype,"_endDate",void 0),(0,k.Cg)([(0,H.wk)(),(0,D.I)({key:"historyPickedValue",state:!0,subscribe:!1})],$.prototype,"_targetPickerValue",void 0),(0,k.Cg)([(0,H.wk)()],$.prototype,"_isLoading",void 0),(0,k.Cg)([(0,H.wk)()],$.prototype,"_stateHistory",void 0),(0,k.Cg)([(0,H.wk)()],$.prototype,"_statisticsHistory",void 0),(0,k.Cg)([(0,H.wk)()],$.prototype,"_showBack",void 0),(0,k.Cg)([(0,H.P)("state-history-charts")],$.prototype,"_stateHistoryCharts",void 0),$=(0,k.Cg)([(0,H.EM)("ha-panel-history")],$),n()}catch(Q){n(Q)}})},44144:function(t,e,i){i.d(e,{MR:function(){return n},QR:function(){return a},a_:function(){return r},bg:function(){return o}});i(28706),i(11392);var n=function(t){return"https://brands.home-assistant.io/".concat(t.brand?"brands/":"").concat(t.useFallback?"_/":"").concat(t.domain,"/").concat(t.darkOptimized?"dark_":"").concat(t.type,".png")},a=function(t){return"https://brands.home-assistant.io/hardware/".concat(t.category,"/").concat(t.darkOptimized?"dark_":"").concat(t.manufacturer).concat(t.model?"_".concat(t.model):"",".png")},r=function(t){return t.split("/")[4]},o=function(t){return t.startsWith("https://brands.home-assistant.io/")}}}]);
//# sourceMappingURL=70581.364892f71a637bd0.js.map