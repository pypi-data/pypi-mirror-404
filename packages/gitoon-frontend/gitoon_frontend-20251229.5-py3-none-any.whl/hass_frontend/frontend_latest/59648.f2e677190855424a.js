export const __rspack_esm_id="59648";export const __rspack_esm_ids=["59648"];export const __webpack_modules__={90433(t,e,a){a.d(e,{Vy:()=>r,fI:()=>o,ux:()=>n});var s=a(22786),i=a(79468);function r(t,e){const a=t%54+1;return e.getPropertyValue(`--color-${a}`)}function o(t,e){const a=e.getPropertyValue(`--graph-color-${t+1}`)||r(t,e);return(0,i.RQ)(a)}const n=(0,s.A)(t=>Array.from({length:54},(e,a)=>o(a,t)),(t,e)=>t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1")&&t[0].getPropertyValue("--color-1")===e[0].getPropertyValue("--color-1"))},36525(t,e,a){a.a(t,async function(t,s){try{a.d(e,{n:()=>v});a(44114),a(18111),a(22489),a(7588),a(61701),a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698);var i=a(62826),r=a(96196),o=a(44457),n=a(6415),h=a(22786),d=a(90433),l=a(36312),c=a(95747),p=a(20058),m=a(8549),u=a(15638),g=a(23528),y=a(44439),f=t([y,c,p]);[y,c,p]=f.then?(await f)():f;const v={mean:"mean",min:"min",max:"max",sum:"sum",state:"sum",change:"sum"};class _ extends r.WF{shouldUpdate(t){return t.size>1||!t.has("hass")}willUpdate(t){(t.has("statisticsData")||t.has("statTypes")||t.has("chartType")||t.has("hideLegend")||t.has("_hiddenStats"))&&this._generateData(),(!this.hasUpdated||t.has("unit")||t.has("period")||t.has("chartType")||t.has("minYAxis")||t.has("maxYAxis")||t.has("fitYData")||t.has("logarithmicScale")||t.has("hideLegend")||t.has("startTime")||t.has("endTime")||t.has("_legendData")||t.has("_chartData"))&&this._createOptions()}firstUpdated(){this._computedStyle=getComputedStyle(this)}render(){return(0,l.x)(this.hass,"history")?this.isLoadingData&&!this.statisticsData?r.qy`<div class="info"> ${this.hass.localize("ui.components.statistics_charts.loading_statistics")} </div>`:this.statisticsData&&Object.keys(this.statisticsData).length?r.qy` <ha-chart-base .hass="${this.hass}" .data="${this._chartData}" .options="${this._chartOptions}" .height="${this.height}" style="${(0,n.W)({height:this.height})}" @dataset-hidden="${this._datasetHidden}" @dataset-unhidden="${this._datasetUnhidden}" .expandLegend="${this.expandLegend}"></ha-chart-base> `:r.qy`<div class="info"> ${this.hass.localize("ui.components.statistics_charts.no_statistics_found")} </div>`:r.qy`<div class="info"> ${this.hass.localize("ui.components.history_charts.history_disabled")} </div>`}_datasetHidden(t){this._hiddenStats.add(t.detail.id),this.requestUpdate("_hiddenStats")}_datasetUnhidden(t){this._hiddenStats.delete(t.detail.id),this.requestUpdate("_hiddenStats")}_createOptions(){const t=this.daysToShow??1;let e=this.minYAxis,a=this.maxYAxis;"number"==typeof e?this.fitYData&&(e=({min:t})=>Math.min(this._roundYAxis(t,Math.floor),this.minYAxis)):this.logarithmicScale&&(e=({min:t})=>{const e=t>0?.95*t:1.05*t;return this._roundYAxis(e,Math.floor)}),"number"==typeof a?this.fitYData&&(a=({max:t})=>Math.max(this._roundYAxis(t,Math.ceil),this.maxYAxis)):this.logarithmicScale&&(a=({max:t})=>{const e=t>0?1.05*t:.95*t;return this._roundYAxis(e,Math.ceil)});const s=this.endTime??new Date;let i=this.startTime;i||(this._chartData.forEach(t=>{if(!Array.isArray(t.data)||!t.data[0])return;const e=t.data[0],a=Array.isArray(e)?e[0]:e.value?.[0];a&&(!i||new Date(a)<i)&&(i=new Date(a))}),i||(i=new Date(s.getTime()-24*t*3600*1e3))),this._chartOptions={xAxis:[{id:"xAxis",type:"time",min:i,max:this.endTime},{id:"hiddenAxis",type:"time",show:!1}],yAxis:{type:this.logarithmicScale?"log":"value",name:this.unit,nameGap:2,nameTextStyle:{align:"left"},position:(0,u.qC)(this.hass)?"right":"left",scale:"bar"!==this.chartType||this.logarithmicScale||void 0!==e||void 0!==a,min:this._clampYAxis(e),max:this._clampYAxis(a),splitLine:{show:!0},axisLabel:{formatter:this._formatYAxisLabel}},legend:{type:"custom",show:!this.hideLegend,data:this._legendData},grid:{top:15,left:1,right:1,bottom:0,containLabel:!0},tooltip:{trigger:"axis",appendTo:document.body,formatter:this._renderTooltip}}}async _generateData(){if(!this.statisticsData)return;const t=this.metadata||await this._getStatisticsMetaData(Object.keys(this.statisticsData));let e=0;const a=Object.entries(this.statisticsData),s=[],i=[],r=[];let o,n;if(0===a.length)return;o=this.endTime||new Date(Math.max(...a.map(([t,e])=>new Date(e[e.length-1].start).getTime()))),o>new Date&&(o=new Date);const h=this.names||{};a.forEach(([a,o])=>{const l=t?.[a];let c=h[a];void 0===c&&(c=(0,g.$O)(this.hass,a,l)),this.unit||(void 0===n?n=(0,g.JE)(this.hass,a,l):null!==n&&n!==(0,g.JE)(this.hass,a,l)&&(n=null));let p,m=null;const u=[],y=[],f=(t,e,a)=>{a.length&&(t>e||(u.forEach((e,s)=>{"line"===this.chartType&&p&&m&&p.getTime()!==t.getTime()&&(e.data.push(this._transformDataValue([p,...m[s]])),e.data.push([p,null])),e.data.push(this._transformDataValue([t,...a[s]]))}),m=a,p=e))},v=(0,d.fI)(e,this._computedStyle||getComputedStyle(this));e++;const _=[],b=this.statTypes.includes("mean")&&(0,g.iY)(o,"mean"),x=this.statTypes.includes("max")&&(0,g.iY)(o,"max"),w=this.statTypes.includes("min")&&(0,g.iY)(o,"min"),D=[b,x,w].filter(Boolean).length>1,T=this.statTypes.includes("state"),M=x?"max":"mean",S=w?"min":"mean",C=D?[...this.statTypes].sort((t,e)=>"min"===t||"max"===e?-1:"max"===t||"min"===e?1:0):this.statTypes;let A=!1;C.forEach(t=>{if((0,g.iY)(o,t)){const e=D&&(t===M||t===S);_.push(t);const s=e&&w&&x&&b||T&&["change","sum"].includes(t)?v+(this.hideLegend?"00":"7F"):v,i=e?v+"3F":v+"7F",o={id:`${a}-${t}`,type:this.chartType,smooth:"line"===this.chartType&&.4,smoothMonotone:"x",cursor:"default",data:[],name:c?`${c} (${this.hass.localize(`ui.components.statistics_charts.statistic_types.${t}`)})`:this.hass.localize(`ui.components.statistics_charts.statistic_types.${t}`),symbol:"none",sampling:e&&D?"lttb":"minmax",animationDurationUpdate:0,lineStyle:{width:1.5},itemStyle:"bar"===this.chartType?{borderRadius:[4,4,0,0],borderColor:s,borderWidth:1.5}:void 0,color:"bar"===this.chartType?i:s};if(e&&"line"===this.chartType&&(o.stack=`band-${a}`,o.stackStrategy="all",this._hiddenStats.has(`${a}-${S}`)?(o.stackOrder="seriesDesc",o.areaStyle=void 0):(o.stackOrder="seriesAsc",D&&t===M&&(o.areaStyle={color:v+"3F"}))),!this.hideLegend){const e=b?"mean"===t:!1===A;e&&y.push({id:a,name:c,color:o.color,borderColor:o.itemStyle?.borderColor}),A=A||e}u.push(o),r.push(a)}});let $=null,k=null;o.forEach(t=>{const e=new Date(t.start);if($===e)return;$=e;const s=[];_.forEach(e=>{const i=[];if("sum"===e)null==k?(i.push(0),k=t.sum):i.push((t.sum||0)-k);else if(e===M&&"line"===this.chartType&&D&&!this._hiddenStats.has(`${a}-${S}`)){const e=t[M]||0;i.push(Math.abs(e-(t[S]||0))),i.push(e)}else i.push(t[e]??null);s.push(i)}),this._hiddenStats.has(a)||f(e,new Date(t.end),s)}),Array.prototype.push.apply(s,u),Array.prototype.push.apply(i,y)}),n&&(this.unit=n),i.forEach(({id:t,name:e,color:a,borderColor:i})=>{s.push({id:t,name:e,color:a,itemStyle:{borderColor:i},type:this.chartType,data:[],xAxisIndex:1})}),this._chartData=s,i.length!==this._legendData?.length&&(this._legendData=i.length>1?i.map(({id:t,name:e})=>({id:t,name:e})):void 0),this._statisticIds=r}_transformDataValue(t){return"bar"===this.chartType&&t[1]&&t[1]<0?{value:t,itemStyle:{borderRadius:[0,0,4,4]}}:t}_clampYAxis(t){if(this.logarithmicScale){if("number"==typeof t)return Math.max(t,Number.EPSILON);if("function"==typeof t)return e=>Math.max(t(e),Number.EPSILON)}return t}_roundYAxis(t,e){return Math.abs(t)<1?t:e(t)}constructor(...t){super(...t),this.statTypes=["sum","min","mean","max"],this.chartType="line",this.fitYData=!1,this.hideLegend=!1,this.logarithmicScale=!1,this.isLoadingData=!1,this.clickForMoreInfo=!0,this._chartData=[],this._statisticIds=[],this._hiddenStats=new Set,this._previousYAxisLabelValue=0,this._renderTooltip=t=>{const e={},a=this.unit?`${(0,m.A)(this.unit,this.hass.locale)}${this.unit}`:"";return t.map((t,s)=>{if(e[t.seriesIndex])return"";e[t.seriesIndex]=!0;const i=this._statisticIds[t.seriesIndex],r=this.hass.states[i],o=this.hass.entities[i],n=String(t.value[2]??t.value[1]),h=(0,p.ZQ)(r,o)??{maximumFractionDigits:2},d=`${(0,p.ZV)(n,this.hass.locale,h)}${a}`;return`${0===s?(0,c.yg)(new Date(t.value[0]),this.hass.locale,this.hass.config)+"<br>":""}${t.marker} ${t.seriesName}: ${d}`}).filter(Boolean).join("<br>")},this._getStatisticsMetaData=(0,h.A)(async t=>{const e=await(0,g.Wr)(this.hass,t),a={};return e.forEach(t=>{a[t.statistic_id]=t}),a}),this._formatYAxisLabel=t=>{const e=Math.max(1,-Math.floor(Math.log10(Math.abs(t-this._previousYAxisLabelValue||1)))),a=(0,p.ZV)(t,this.hass.locale,{maximumFractionDigits:e});return this._previousYAxisLabelValue=t,a}}}_.styles=r.AH`:host{display:block;min-height:60px}.info{text-align:center;line-height:60px;color:var(--secondary-text-color)}`,(0,i.Cg)([(0,o.MZ)({attribute:!1})],_.prototype,"hass",void 0),(0,i.Cg)([(0,o.MZ)({attribute:!1})],_.prototype,"statisticsData",void 0),(0,i.Cg)([(0,o.MZ)({attribute:!1})],_.prototype,"metadata",void 0),(0,i.Cg)([(0,o.MZ)({attribute:!1})],_.prototype,"names",void 0),(0,i.Cg)([(0,o.MZ)()],_.prototype,"unit",void 0),(0,i.Cg)([(0,o.MZ)({attribute:!1})],_.prototype,"startTime",void 0),(0,i.Cg)([(0,o.MZ)({attribute:!1})],_.prototype,"endTime",void 0),(0,i.Cg)([(0,o.MZ)({attribute:!1,type:Array})],_.prototype,"statTypes",void 0),(0,i.Cg)([(0,o.MZ)({attribute:!1})],_.prototype,"chartType",void 0),(0,i.Cg)([(0,o.MZ)({attribute:!1,type:Number})],_.prototype,"minYAxis",void 0),(0,i.Cg)([(0,o.MZ)({attribute:!1,type:Number})],_.prototype,"maxYAxis",void 0),(0,i.Cg)([(0,o.MZ)({attribute:"fit-y-data",type:Boolean})],_.prototype,"fitYData",void 0),(0,i.Cg)([(0,o.MZ)({attribute:"hide-legend",type:Boolean})],_.prototype,"hideLegend",void 0),(0,i.Cg)([(0,o.MZ)({attribute:"logarithmic-scale",type:Boolean})],_.prototype,"logarithmicScale",void 0),(0,i.Cg)([(0,o.MZ)({attribute:"is-loading-data",type:Boolean})],_.prototype,"isLoadingData",void 0),(0,i.Cg)([(0,o.MZ)({attribute:"click-for-more-info",type:Boolean})],_.prototype,"clickForMoreInfo",void 0),(0,i.Cg)([(0,o.MZ)()],_.prototype,"period",void 0),(0,i.Cg)([(0,o.MZ)({attribute:"days-to-show",type:Number})],_.prototype,"daysToShow",void 0),(0,i.Cg)([(0,o.MZ)({type:String})],_.prototype,"height",void 0),(0,i.Cg)([(0,o.MZ)({attribute:"expand-legend",type:Boolean})],_.prototype,"expandLegend",void 0),(0,i.Cg)([(0,o.wk)()],_.prototype,"_chartData",void 0),(0,i.Cg)([(0,o.wk)()],_.prototype,"_legendData",void 0),(0,i.Cg)([(0,o.wk)()],_.prototype,"_statisticIds",void 0),(0,i.Cg)([(0,o.wk)()],_.prototype,"_chartOptions",void 0),(0,i.Cg)([(0,o.wk)()],_.prototype,"_hiddenStats",void 0),_=(0,i.Cg)([(0,o.EM)("statistics-chart")],_),s()}catch(t){s(t)}})},5745(t,e,a){var s=a(62826),i=a(4720),r=a(44457);class o extends i.Y{}o=(0,s.Cg)([(0,r.EM)("ha-chip-set")],o)},99611(t,e,a){a.a(t,async function(t,s){try{a.d(e,{r:()=>p});var i=a(62826),r=a(1126),o=a(96196),n=a(44457),h=a(60353),d=a(59992),l=a(14503),c=t([r]);r=(c.then?(await c)():c)[0];const p=300;class m extends((0,d.V)(o.WF)){get scrollableElement(){return this._bodyElement}_handleAfterHide(t){t.stopPropagation(),this.open=!1;const e=new Event("closed",{bubbles:!0,composed:!0});this.dispatchEvent(e)}updated(t){super.updated(t),t.has("open")&&(this._drawerOpen=this.open)}render(){return o.qy` <wa-drawer id="drawer" placement="bottom" .open="${this._drawerOpen}" @wa-after-hide="${this._handleAfterHide}" without-header @touchstart="${this._handleTouchStart}"> <slot name="header"></slot> <div class="content-wrapper"> <div id="body" class="body ha-scrollbar"> <slot></slot> </div> ${this.renderScrollableFades()} </div> <slot name="footer"></slot> </wa-drawer> `}_startResizing(t){document.addEventListener("touchmove",this._handleTouchMove,{passive:!1}),document.addEventListener("touchend",this._handleTouchEnd),document.addEventListener("touchcancel",this._handleTouchEnd),this._gestureRecognizer.start(t)}_animateSnapBack(){this.style.setProperty("--dialog-transition",`transform ${p}ms ease-out`),this.style.removeProperty("--dialog-transform"),setTimeout(()=>{this.style.removeProperty("--dialog-transition")},p)}disconnectedCallback(){super.disconnectedCallback(),this._unregisterResizeHandlers(),this._isDragging=!1}static get styles(){return[...super.styles,l.dp,o.AH`wa-drawer{--wa-color-surface-raised:transparent;--spacing:0;--size:var(--ha-bottom-sheet-height, auto);--show-duration:${p}ms;--hide-duration:${p}ms}wa-drawer::part(dialog){max-height:var(--ha-bottom-sheet-max-height,90vh);align-items:center;transform:var(--dialog-transform);transition:var(--dialog-transition)}wa-drawer::part(body){max-width:var(--ha-bottom-sheet-max-width);width:100%;border-top-left-radius:var(--ha-bottom-sheet-border-radius,var(--ha-dialog-border-radius,var(--ha-border-radius-2xl)));border-top-right-radius:var(--ha-bottom-sheet-border-radius,var(--ha-dialog-border-radius,var(--ha-border-radius-2xl)));background-color:var(--ha-bottom-sheet-surface-background,var(--ha-dialog-surface-background,var(--mdc-theme-surface,#fff)));padding:var(--ha-bottom-sheet-padding,0 var(--safe-area-inset-right) var(--safe-area-inset-bottom) var(--safe-area-inset-left))}:host([flexcontent]) wa-drawer::part(body){display:flex;flex-direction:column}.content-wrapper{position:relative;flex:1;display:flex;flex-direction:column;min-height:0}:host([flexcontent]) .body{flex:1;max-width:100%;display:flex;flex-direction:column;padding:var(--ha-bottom-sheet-padding,0 var(--safe-area-inset-right) var(--safe-area-inset-bottom) var(--safe-area-inset-left))}slot[name=footer]{display:block;padding:0}::slotted([slot=footer]){display:flex;padding:var(--ha-space-3) var(--ha-space-4) var(--ha-space-4) var(--ha-space-4);gap:var(--ha-space-3);justify-content:flex-end;align-items:center;width:100%;box-sizing:border-box}:host([flexcontent]) slot[name=footer]{flex-shrink:0}`]}constructor(...t){super(...t),this.open=!1,this.flexContent=!1,this._drawerOpen=!1,this._gestureRecognizer=new h.u,this._isDragging=!1,this._handleTouchStart=t=>{for(const e of t.composedPath()){const t=e;if(t===this._drawer)break;if(t.scrollTop>0)return}this._startResizing(t.touches[0].clientY)},this._handleTouchMove=t=>{const e=t.touches[0].clientY,a=this._gestureRecognizer.move(e);a<0&&(t.preventDefault(),this._isDragging=!0,requestAnimationFrame(()=>{this._isDragging&&this.style.setProperty("--dialog-transform",`translateY(${-1*a}px)`)}))},this._handleTouchEnd=()=>{this._unregisterResizeHandlers(),this._isDragging=!1;const t=this._gestureRecognizer.end();if(t.isSwipe)return void(t.isDownwardSwipe?this._drawerOpen=!1:this._animateSnapBack());const e=this._drawer.shadowRoot?.querySelector('[part="body"]'),a=e?.offsetHeight||0;a>0&&t.delta<0&&Math.abs(t.delta)>.5*a?this._drawerOpen=!1:this._animateSnapBack()},this._unregisterResizeHandlers=()=>{document.removeEventListener("touchmove",this._handleTouchMove),document.removeEventListener("touchend",this._handleTouchEnd),document.removeEventListener("touchcancel",this._handleTouchEnd)}}}(0,i.Cg)([(0,n.MZ)({type:Boolean})],m.prototype,"open",void 0),(0,i.Cg)([(0,n.MZ)({type:Boolean,reflect:!0,attribute:"flexcontent"})],m.prototype,"flexContent",void 0),(0,i.Cg)([(0,n.wk)()],m.prototype,"_drawerOpen",void 0),(0,i.Cg)([(0,n.P)("#drawer")],m.prototype,"_drawer",void 0),(0,i.Cg)([(0,n.P)("#body")],m.prototype,"_bodyElement",void 0),m=(0,i.Cg)([(0,n.EM)("ha-bottom-sheet")],m),s()}catch(t){s(t)}})},2846(t,e,a){a.d(e,{G:()=>d,J:()=>h});var s=a(62826),i=a(97154),r=a(82553),o=a(96196),n=a(44457);a(54276);const h=[r.R,o.AH`:host{--ha-icon-display:block;--md-sys-color-primary:var(--primary-text-color);--md-sys-color-secondary:var(--secondary-text-color);--md-sys-color-surface:var(--card-background-color);--md-sys-color-on-surface:var(--primary-text-color);--md-sys-color-on-surface-variant:var(--secondary-text-color)}md-item{overflow:var(--md-item-overflow,hidden);align-items:var(--md-item-align-items,center);gap:var(--ha-md-list-item-gap,16px)}`];class d extends i.n{renderRipple(){return"text"===this.type?o.s6:o.qy`<ha-ripple part="ripple" for="item" ?disabled="${this.disabled&&"link"!==this.type}"></ha-ripple>`}}d.styles=h,d=(0,s.Cg)([(0,n.EM)("ha-md-list-item")],d)},22348(t,e,a){a.d(e,{V:()=>i});var s=a(37177);const i=t=>!!t.auth.external&&s.n},37177(t,e,a){a.d(e,{n:()=>s});const s=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}};
//# sourceMappingURL=59648.f2e677190855424a.js.map