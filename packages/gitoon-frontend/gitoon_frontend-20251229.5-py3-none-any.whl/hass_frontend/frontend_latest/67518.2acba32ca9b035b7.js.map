{"version":3,"file":"67518.2acba32ca9b035b7.js","sources":["https://raw.githubusercontent.com/home-assistant/frontend/20251229.5/src/panels/lovelace/cards/energy/hui-power-sankey-card.ts"],"names":["DEFAULT_CONFIG","group_by_floor","group_by_area","MIN_POWER_THRESHOLD","HuiPowerSankeyCard","SubscribeMixin","MobileAwareMixin","LitElement","setConfig","config","this","_config","hassSubscribe","getEnergyDataCollection","hass","key","collection_key","subscribe","data","_data","getCardSize","getGridOptions","columns","min_columns","rows","min_rows","shouldUpdate","changedProps","has","oldHass","get","_entities","size","entityId","states","render","nothing","html","localize","prefs","powerData","_computePowerData","computedStyle","getComputedStyle","nodes","links","homeNode","id","label","value","Math","max","used_total","color","getPropertyValue","trim","index","push","from_battery","source","target","to_battery","grid_to_battery","solar_to_battery","from_grid","solar","to_grid","battery_to_grid","solar_to_grid","untrackedConsumption","deviceNodes","parentLinks","deviceMap","Map","device_consumption","forEach","device","set","stat_consumption","stat_rate","included_in_stat","renderedStatRates","Set","_getCurrentPower","add","idx","effectiveParent","includedInStat","currentParent","parentDevice","findEffectiveParent","node","name","_getEntityLabel","getGraphColorByIndex","parent","devicesWithoutParent","filter","areas","floors","_groupByFloorAndArea","Object","keys","sort","a","b","level","Infinity","floorId","floorNodeId","areaId","targetNodeId","areaNodeId","devices","deviceNode","deviceSections","_getDeviceSections","section","length","hasData","some","vertical","layout","_isMobileSize","title","classMap","_valueFormatter","clear","energy_sources","type","power","powerSource","abs","solar_remaining","grid_remaining","battery_remaining","to_battery_remaining","to_grid_remaining","used_total_remaining","used_solar","used_battery","used_grid","excess_grid_in_after_consumption","min","grid_to_battery_2","no_area","no_floor","entity","area","floor","getEntityContext","entities","area_id","floor_id","includes","unshift","parentSection","childSection","parentIds","values","remainingLinks","isChild","entries","child","getPowerFromState","stateObj","attributes","friendly_name","args","hassSubscribeRequiredHostProps","formatPowerShort","styles","css","attribute"],"mappings":"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"}