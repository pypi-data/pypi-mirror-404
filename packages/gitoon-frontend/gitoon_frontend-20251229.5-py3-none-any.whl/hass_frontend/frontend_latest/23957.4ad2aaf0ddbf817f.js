/*! For license information please see 23957.4ad2aaf0ddbf817f.js.LICENSE.txt */
export const __rspack_esm_id="23957";export const __rspack_esm_ids=["23957"];export const __webpack_modules__={29781(e,t,s){s.d(t,{$:()=>u});var a=s(62826),i=s(96592),r=s(44457),o=s(12451),n=s(12130),c=s(84730),l=s(96196),h=s(94333);const d=n.QQ?{passive:!0}:void 0;class p extends o.O{get scrollTarget(){return this._scrollTarget||window}set scrollTarget(e){this.unregisterScrollListener();const t=this.scrollTarget;this._scrollTarget=e,this.updateRootPosition(),this.requestUpdate("scrollTarget",t),this.registerScrollListener()}updateRootPosition(){if(this.mdcRoot){const e=this.scrollTarget===window;this.mdcRoot.style.position=e?"":"absolute"}}render(){let e=l.qy`<span class="mdc-top-app-bar__title"><slot name="title"></slot></span>`;return this.centerTitle&&(e=l.qy`<section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-center">${e}</section>`),l.qy` <header class="mdc-top-app-bar ${(0,h.H)(this.barClasses())}"> <div class="mdc-top-app-bar__row"> <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start" id="navigation"> <slot name="navigationIcon" @click="${this.handleNavigationClick}"></slot> ${this.centerTitle?null:e} </section> ${this.centerTitle?e:null} <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end" id="actions" role="toolbar"> <slot name="actionItems"></slot> </section> </div> </header> <div class="${(0,h.H)(this.contentClasses())}"> <slot></slot> </div> `}createAdapter(){return Object.assign(Object.assign({},(0,o.i)(this.mdcRoot)),{setStyle:(e,t)=>this.mdcRoot.style.setProperty(e,t),getTopAppBarHeight:()=>this.mdcRoot.clientHeight,notifyNavigationIconClicked:()=>{this.dispatchEvent(new Event(c.P$.NAVIGATION_EVENT,{bubbles:!0,cancelable:!0}))},getViewportScrollY:()=>this.scrollTarget instanceof Window?this.scrollTarget.pageYOffset:this.scrollTarget.scrollTop,getTotalActionItems:()=>this._actionItemsSlot.assignedNodes({flatten:!0}).length})}registerListeners(){this.registerScrollListener()}unregisterListeners(){this.unregisterScrollListener()}registerScrollListener(){this.scrollTarget.addEventListener("scroll",this.handleTargetScroll,d)}unregisterScrollListener(){this.scrollTarget.removeEventListener("scroll",this.handleTargetScroll)}firstUpdated(){super.firstUpdated(),this.updateRootPosition(),this.registerListeners()}disconnectedCallback(){super.disconnectedCallback(),this.unregisterListeners()}constructor(){super(...arguments),this.centerTitle=!1,this.handleTargetScroll=()=>{this.mdcFoundation.handleTargetScroll()},this.handleNavigationClick=()=>{this.mdcFoundation.handleNavigationClick()}}}(0,a.Cg)([(0,r.P)(".mdc-top-app-bar")],p.prototype,"mdcRoot",void 0),(0,a.Cg)([(0,r.P)('slot[name="actionItems"]')],p.prototype,"_actionItemsSlot",void 0),(0,a.Cg)([(0,r.MZ)({type:Boolean})],p.prototype,"centerTitle",void 0),(0,a.Cg)([(0,r.MZ)({type:Object})],p.prototype,"scrollTarget",null);class g extends p{barClasses(){return{"mdc-top-app-bar--dense":this.dense,"mdc-top-app-bar--prominent":this.prominent,"center-title":this.centerTitle}}contentClasses(){return{"mdc-top-app-bar--fixed-adjust":!this.dense&&!this.prominent,"mdc-top-app-bar--dense-fixed-adjust":this.dense&&!this.prominent,"mdc-top-app-bar--prominent-fixed-adjust":!this.dense&&this.prominent,"mdc-top-app-bar--dense-prominent-fixed-adjust":this.dense&&this.prominent}}registerListeners(){super.registerListeners(),window.addEventListener("resize",this.handleResize,d)}unregisterListeners(){super.unregisterListeners(),window.removeEventListener("resize",this.handleResize)}constructor(){super(...arguments),this.mdcFoundationClass=i.A,this.prominent=!1,this.dense=!1,this.handleResize=()=>{this.mdcFoundation.handleWindowResize()}}}(0,a.Cg)([(0,r.MZ)({type:Boolean,reflect:!0})],g.prototype,"prominent",void 0),(0,a.Cg)([(0,r.MZ)({type:Boolean,reflect:!0})],g.prototype,"dense",void 0);var _=s(23665);class u extends g{barClasses(){return Object.assign(Object.assign({},super.barClasses()),{"mdc-top-app-bar--fixed":!0})}registerListeners(){this.scrollTarget.addEventListener("scroll",this.handleTargetScroll,d)}unregisterListeners(){this.scrollTarget.removeEventListener("scroll",this.handleTargetScroll)}constructor(){super(...arguments),this.mdcFoundationClass=_.A}}},27330(e,t,s){var a=s(62826),i=s(29781),r=s(71467),o=s(96196),n=s(44457);class c extends i.${constructor(...e){super(...e),this.narrow=!1}}c.styles=[r.R,o.AH`header{padding-top:var(--safe-area-inset-top)}.mdc-top-app-bar__row{height:var(--header-height);border-bottom:var(--app-header-border-bottom)}.mdc-top-app-bar--fixed-adjust{padding-top:calc(var(--header-height,0px) + var(--safe-area-inset-top,0px));padding-bottom:var(--safe-area-inset-bottom);padding-right:var(--safe-area-inset-right)}:host([narrow]) .mdc-top-app-bar--fixed-adjust{padding-left:var(--safe-area-inset-left)}.mdc-top-app-bar{--mdc-typography-headline6-font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,var(--mdc-theme-on-primary,#fff));background-color:var(--app-header-background-color,var(--mdc-theme-primary));padding-top:var(--safe-area-inset-top);padding-right:var(--safe-area-inset-right)}:host([narrow]) .mdc-top-app-bar{padding-left:var(--safe-area-inset-left)}.mdc-top-app-bar__title{font-size:var(--ha-font-size-xl);padding-inline-start:24px;padding-inline-end:initial}`],(0,a.Cg)([(0,n.MZ)({type:Boolean,reflect:!0})],c.prototype,"narrow",void 0),c=(0,a.Cg)([(0,n.EM)("ha-top-app-bar-fixed")],c)},4203(e,t,s){s.a(e,async function(e,a){try{s.r(t),s.d(t,{DEFAULT_ENERGY_COLLECTION_KEY:()=>y});s(44114),s(18111),s(22489),s(20116),s(7588),s(61701),s(13579),s(17642),s(58004),s(33853),s(45876),s(32475),s(15024),s(31698),s(14603),s(47566),s(98721);var i=s(62826),r=s(96196),o=s(44457),n=s(94333),c=s(91926),l=(s(38962),s(90248),s(2054),s(27330),s(38114)),h=s(91984),d=s(14503),p=s(30039),g=s(73887),_=s(29994),u=s(75400),m=(s(87778),e([g,_,u,l]));[g,_,u,l]=m.then?(await m)():m;const f="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z",y="energy_dashboard",v={energy_sources:[],device_consumption:[],device_consumption_water:[]},b={path:"overview",strategy:{type:"energy-overview",collection_key:y,show_period_selector:!0}},w={path:"electricity",strategy:{type:"energy",collection_key:y,show_period_selector:!0}},x={path:"water",strategy:{type:"water",collection_key:y,show_period_selector:!0}},k={path:"gas",strategy:{type:"gas",collection_key:y,show_period_selector:!0}},C={path:"now",strategy:{type:"power",collection_key:"energy_dashboard_now"}},D={type:"panel",path:"setup",cards:[{type:"custom:energy-setup-wizard-card"}]};class $ extends r.WF{get _extraActionItems(){return[{icon:f,labelKey:"ui.panel.energy.download_data",action:this._dumpCSV}]}willUpdate(e){if(super.willUpdate(e),!this.hasUpdated)return this.hass.loadFragmentTranslation("lovelace"),void this._loadConfig();if(!e.has("hass"))return;const t=e.get("hass");t&&t.localize!==this.hass.localize&&this._setLovelace()}async _loadConfig(){try{this._error=void 0;const e=await this._fetchEnergyPrefs();this._prefs=e||v}catch(e){console.error("Failed to load prefs:",e),this._prefs=v,this._error=e.message||"Unknown error"}await this._setLovelace();const e=(this._lovelace.config?.views||[]).map(e=>e.path),t=this.route.path.split("/")[1];t&&e.includes(t)?this.route={...this.route}:(0,c.o)(`${this.route.prefix}/${e[0]}`,{replace:!0})}async _setLovelace(){const e=await this._generateLovelaceConfig();this._lovelace={config:e,rawConfig:e,editMode:!1,urlPath:"energy",mode:"generated",locale:this.hass.locale,enableFullEditMode:()=>{},saveConfig:async()=>{},deleteConfig:async()=>{},setEditMode:()=>this._navigateConfig(),showToast:()=>{}}}render(){if(this._error)return r.qy` <div class="centered"> <ha-alert alert-type="error"> An error occurred loading energy preferences: ${this._error} </ha-alert> </div> `;if(!this._prefs)return r.qy` <div class="centered"> <ha-spinner size="large"></ha-spinner> </div> `;if(!this._lovelace)return r.s6;const e=this.route?.path?.split("/")[1]||"",t=this._lovelace.config.views.find(t=>t.path===e),s=t&&(0,h.R)(t)&&t.strategy?.show_period_selector;return r.qy` <hui-root .hass="${this.hass}" .narrow="${this.narrow}" .lovelace="${this._lovelace}" .route="${this.route}" .panel="${this.panel}" .extraActionItems="${this._extraActionItems}" @reload-energy-panel="${this._reloadConfig}" class="${(0,n.H)({"has-period-selector":s})}"> </hui-root> ${s?r.qy` <ha-card class="period-selector"> <hui-energy-period-selector .hass="${this.hass}" .collectionKey="${y}" vertical-opening-direction="up"></hui-energy-period-selector> </ha-card> `:r.s6} `}async _generateLovelaceConfig(){if(!this._prefs||0===this._prefs.device_consumption.length&&0===this._prefs.energy_sources.length)return await Promise.all([s.e("71380"),s.e("86236")]).then(s.bind(s,97431)),{views:[D]};const e=this._prefs.energy_sources.some(e=>["grid","solar","battery"].includes(e.type)),t=this._prefs.energy_sources.some(e=>"solar"===e.type&&e.stat_rate||"battery"===e.type&&e.stat_rate||"grid"===e.type&&e.power?.length)||this._prefs.device_consumption.some(e=>e.stat_rate),a=this._prefs.energy_sources.some(e=>"water"===e.type)||this._prefs.device_consumption_water?.length>0,i=this._prefs.energy_sources.some(e=>"gas"===e.type),r=this._prefs.device_consumption.length>0,o=[];return(e||r)&&o.push(w),i&&o.push(k),a&&o.push(x),t&&o.push(C),o.length>1&&o.unshift(b),{views:o.map(e=>({...e,title:e.title||this.hass.localize(`ui.panel.energy.title.${e.path}`)}))}}_navigateConfig(e){e?.stopPropagation(),(0,c.o)("/config/energy?historyBack=1")}_reloadConfig(){this._loadConfig()}static get styles(){return[d.RF,r.AH`:host{--ha-view-sections-column-max-width:100%;-ms-user-select:none;-webkit-user-select:none;-moz-user-select:none}.centered{width:100%;height:100%;display:flex;align-items:center;justify-content:center}hui-root.has-period-selector{--view-container-padding-bottom:var(--ha-space-18)}.period-selector{position:fixed;z-index:4;bottom:max(var(--ha-space-4),var(--safe-area-inset-bottom,0px));left:max(var(--mdc-drawer-width,0px),var(--safe-area-inset-left,0px));right:var(--safe-area-inset-right,0);inset-inline-start:max(var(--mdc-drawer-width,0px),var(--safe-area-inset-left,0px));inset-inline-end:var(--safe-area-inset-right,0);margin:0 auto;max-width:calc(min(450px,100% - var(--ha-space-4)));box-sizing:border-box;padding-left:var(--ha-space-2);padding-right:0;padding-inline-start:var(--ha-space-4);padding-inline-end:0;--ha-card-box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2),0px 6px 10px 0px rgba(0, 0, 0, 0.14),0px 1px 18px 0px rgba(0, 0, 0, 0.12);--ha-card-border-color:var(--divider-color);--ha-card-border-width:var(--ha-card-border-width, 1px)}@media all and (max-width:450px),all and (max-height:500px){hui-root.has-period-selector{--view-container-padding-bottom:var(--ha-space-14)}.period-selector{bottom:max(var(--ha-space-2),var(--safe-area-inset-bottom,0px))}}`]}constructor(...e){super(...e),this.narrow=!1,this._fetchEnergyPrefs=async()=>{const e=(0,l.tb)(this.hass,{key:y});try{await e.refresh()}catch(e){if("not_found"===e.code)return;throw e}return e.prefs},this._dumpCSV=async()=>{const e=(0,l.tb)(this.hass,{key:"energy_dashboard"});if(!e.prefs||!e.state.stats)return;const t=e.state.gasUnit,s="kWh",a=e.prefs.energy_sources,i=e.prefs.device_consumption,r=e.prefs.device_consumption_water,o=e.state.stats,n=new Set;Object.values(o).forEach(e=>{e.forEach(e=>{n.add(e.start)})});const c=Array.from(n).sort(),h="entity_id,type,unit,"+c.map(e=>new Date(e).toISOString()).join(",")+"\n",d=[];d[0]=h;const g=function(e,t,s,a){let i=0;const r=[];r.push(e),r.push(t),r.push(s.normalize("NFKD")),c.forEach(e=>{i<a.length&&a[i].start===e?(r.push((a[i].change??"").toString()),i++):r.push("")}),d.push(r.join(",")+"\n")},_=function(e,t,s){o[e]&&g(e,t,s,o[e])},u=this.hass.config.currency,m=function(e,t,s,a,i){t.length&&(t.forEach(t=>_(t,e,s)),a&&i&&i.forEach(e=>_(e,a,u)))},f=[],y=[],v=[],b=[];a.filter(e=>"grid"===e.type).forEach(t=>{t.flow_from.forEach(t=>{const s=t.stat_energy_from;f.push(s);const a=t.stat_cost||e.state.info.cost_sensors[s];a&&v.push(a)}),t.flow_to.forEach(t=>{const s=t.stat_energy_to;y.push(s);const a=t.stat_compensation||e.state.info.cost_sensors[s];a&&b.push(a)})}),m("grid_consumption",f,s,"grid_consumption_cost",v),m("grid_return",y,s,"grid_return_compensation",b);const w=[],x=[];a.filter(e=>"battery"===e.type).forEach(e=>{w.push(e.stat_energy_to),x.push(e.stat_energy_from)}),m("battery_in",w,s),m("battery_out",x,s);const k=[];a.filter(e=>"solar"===e.type).forEach(e=>{k.push(e.stat_energy_from)}),m("solar_production",k,s);const C=[],D=[];a.filter(e=>"gas"===e.type).forEach(t=>{const s=t.stat_energy_from;C.push(s);const a=t.stat_cost||e.state.info.cost_sensors[s];a&&D.push(a)}),m("gas_consumption",C,t,"gas_consumption_cost",D);const $=[],E=[];a.filter(e=>"water"===e.type).forEach(t=>{const s=t.stat_energy_from;$.push(s);const a=t.stat_cost||e.state.info.cost_sensors[s];a&&E.push(a)}),m("water_consumption",$,e.state.waterUnit,"water_consumption_cost",E);const T=[];if(i.forEach(e=>{T.push(e.stat_consumption)}),m("device_consumption",T,s),r){const t=[];r.forEach(e=>{t.push(e.stat_consumption)}),m("device_consumption_water",t,e.state.waterUnit)}const{summedData:O,compareSummedData:z}=(0,l.gv)(e.state),{consumption:L,compareConsumption:S}=(0,l.DR)(O,void 0),A=function(e,t,s){const a=[];Object.entries(s).forEach(([e,t])=>{a.push({start:Number(e),end:NaN,change:t})}),g("",e,t,a)},R=!!k.length,M=!!w.length,P=!!y.length,N=!!f.length;N&&(A("calculated_consumed_grid",s,L.used_grid),M&&A("calculated_grid_to_battery",s,L.grid_to_battery)),P&&M&&A("calculated_battery_to_grid",s,L.battery_to_grid),M&&A("calculated_consumed_battery",s,L.used_battery),R&&(A("calculated_consumed_solar",s,L.used_solar),M&&A("calculated_solar_to_battery",s,L.solar_to_battery),P&&A("calculated_solar_to_grid",s,L.solar_to_grid)),(N?1:0)+(R?1:0)+(M?1:0)>1&&A("calculated_total_consumption",s,L.used_total);const j=new Blob(d,{type:"text/csv"}),U=window.URL.createObjectURL(j);(0,p.R)(U,"energy.csv")}}}(0,i.Cg)([(0,o.MZ)({attribute:!1})],$.prototype,"hass",void 0),(0,i.Cg)([(0,o.MZ)({type:Boolean,reflect:!0})],$.prototype,"narrow",void 0),(0,i.Cg)([(0,o.MZ)({attribute:!1})],$.prototype,"panel",void 0),(0,i.Cg)([(0,o.wk)()],$.prototype,"_lovelace",void 0),(0,i.Cg)([(0,o.MZ)({attribute:!1})],$.prototype,"route",void 0),(0,i.Cg)([(0,o.wk)()],$.prototype,"_prefs",void 0),(0,i.Cg)([(0,o.wk)()],$.prototype,"_error",void 0),$=(0,i.Cg)([(0,o.EM)("ha-panel-energy")],$),a()}catch(e){a(e)}})},73887(e,t,s){s.a(e,async function(e,t){try{var a=s(62826),i=s(35932),r=s(73983),o=s(52640),n=s(69137),c=s(6946),l=s(55144),h=s(40600),d=s(78016),p=s(31810),g=s(49134),_=s(96196),u=s(44457),m=s(22786),f=s(94333),y=s(91069),v=s(380),b=s(72487),w=s(9899),x=(s(13416),s(18350)),k=(s(58349),s(15397)),C=(s(25440),s(45100),s(38114)),D=s(54706),$=s(46223),E=e([x,k,b,$,C,y]);[x,k,b,$,C,y]=E.then?(await E)():E;const T="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",O=["today","yesterday","this_week","this_month","this_quarter","this_year","now-7d","now-30d","now-12m"];class z extends((0,D.E)(_.WF)){hassSubscribe(){return[(0,C.tb)(this.hass,{key:this.collectionKey}).subscribe(e=>this._updateDates(e))]}_measure(){this.narrow=this.offsetWidth<450}async _attachObserver(){this._resizeObserver||(this._resizeObserver=new ResizeObserver((0,w.s)(()=>this._measure(),250,!1))),this._resizeObserver.observe(this)}firstUpdated(){this._attachObserver()}connectedCallback(){super.connectedCallback(),this.updateComplete.then(()=>this._attachObserver())}disconnectedCallback(){super.disconnectedCallback(),this._resizeObserver&&this._resizeObserver.disconnect()}willUpdate(e){super.willUpdate(e),this.hasUpdated||this._measure(),(!this.hasUpdated||e.has("hass")&&this.hass?.localize!==e.get("hass")?.localize)&&(this._ranges={},O.forEach(e=>{this._ranges[this.hass.localize(`ui.components.date-range-picker.ranges.${e}`)]=(0,$.b)(this.hass,e)}))}render(){if(!this.hass||!this._startDate)return _.s6;const e=this._simpleRange(this._startDate,this._endDate,this.hass.locale,this.hass.config);return _.qy` <div class="${(0,f.H)({row:!0,"datepicker-open":this._datepickerOpen})}"> <div class="backdrop"></div> <div class="label"> ${"day"===e?this.narrow?(0,b.kz)(this._startDate,this.hass.locale,this.hass.config):(0,b.Yq)(this._startDate,this.hass.locale,this.hass.config):"month"===e?(0,b.fr)(this._startDate,this.hass.locale,this.hass.config):"year"===e?(0,b.Pm)(this._startDate,this.hass.locale,this.hass.config):`${(0,b.sl)(this._startDate,this.hass.locale,this.hass.config)} â€“ ${(0,b.sl)(this._endDate||new Date,this.hass.locale,this.hass.config)}`} </div> <div class="time-handle"> <ha-icon-button-prev .label="${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.previous")}" @click="${this._pickPrevious}"></ha-icon-button-prev> <ha-icon-button-next .label="${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.next")}" @click="${this._pickNext}"></ha-icon-button-next> <ha-date-range-picker .hass="${this.hass}" .startDate="${this._startDate}" .endDate="${this._endDate||new Date}" .ranges="${this._ranges}" @value-changed="${this._dateRangeChanged}" @preset-selected="${this._presetSelected}" @toggle="${this._handleDatepickerToggle}" minimal header-position .verticalOpeningDirection="${this.verticalOpeningDirection}"></ha-date-range-picker> </div> ${this.narrow?_.s6:_.qy`<ha-button appearance="filled" size="small" @click="${this._pickNow}"> ${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.now")} </ha-button>`} <ha-button-menu> <ha-icon-button slot="trigger" .label="${this.hass.localize("ui.common.menu")}" .path="${T}"></ha-icon-button> ${this.allowCompare?_.qy`<ha-check-list-item left @request-selected="${this._toggleCompare}" .selected="${this._compare}"> ${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.compare")} </ha-check-list-item>`:_.s6} <slot name="overflow-menu"></slot> </ha-button-menu> </div> `}_updateCollectionPeriod(){const e=(0,C.tb)(this.hass,{key:this.collectionKey});e.setPeriod(this._startDate,this._endDate),e.refresh()}_dateRangeChanged(e){this._startDate=(0,y.ol)(e.detail.value.startDate,i.o,this.hass.locale,this.hass.config),this._endDate=(0,y.ol)(e.detail.value.endDate,r.D,this.hass.locale,this.hass.config),this._updateCollectionPeriod()}_presetSelected(e){localStorage.setItem(`energy-default-period-_${this.collectionKey||"energy"}`,O[e.detail.index])}_pickNow(){if(!this._startDate)return;const e=this._simpleRange(this._startDate,this._endDate,this.hass.locale,this.hass.config),t=new Date;if("month"===e)[this._startDate,this._endDate]=(0,$.b)(this.hass,"this_month");else if("quarter"===e)[this._startDate,this._endDate]=(0,$.b)(this.hass,"this_quarter");else if("year"===e)[this._startDate,this._endDate]=(0,$.b)(this.hass,"this_year");else{const e=(0,v.P)(this.hass.locale),s=(0,y.ol)(this._endDate,o.k,this.hass.locale,this.hass.config,{weekStartsOn:e}),a=(0,y.ol)(this._endDate,n.$,this.hass.locale,this.hass.config,{weekStartsOn:e});if(this._startDate.getTime()===s.getTime()&&this._endDate.getTime()===a.getTime())[this._startDate,this._endDate]=(0,$.b)(this.hass,"this_week");else{const s=(0,y.EO)(this._endDate,this._startDate,c.c,this.hass.locale,this.hass.config);this._startDate=(0,y.ol)((0,y.ol)(t,l.e,this.hass.locale,this.hass.config,s),i.o,this.hass.locale,this.hass.config,{weekStartsOn:e}),this._endDate=(0,y.ol)(t,r.D,this.hass.locale,this.hass.config,{weekStartsOn:e})}}this._updateCollectionPeriod()}_pickPrevious(){this._shift(!1)}_pickNext(){this._shift(!0)}_shift(e){if(!this._startDate)return;const{start:t,end:s}=(0,y.eE)(this._startDate,this._endDate,e,this.hass.locale,this.hass.config);this._startDate=t,this._endDate=s,this._updateCollectionPeriod()}_updateDates(e){this._compare=void 0!==e.startCompare,this._startDate=e.start,this._endDate=e.end||(0,h.o)()}_handleDatepickerToggle(e){this._datepickerOpen=e.detail.open}_toggleCompare(e){if("interaction"!==e.detail.source)return;this._compare=e.detail.selected;const t=(0,C.tb)(this.hass,{key:this.collectionKey});t.setCompare(this._compare?C.lh.PREVIOUS:C.lh.NONE),t.refresh()}constructor(...e){super(...e),this.allowCompare=!0,this._datepickerOpen=!1,this._ranges={},this._compare=!1,this._simpleRange=(0,m.A)((e,t,s,a)=>{if(0===(0,c.c)(t,e))return"day";if((0,y.xo)(e,d.e,s,a)&&(0,y.xo)(t,p.c,s,a)){if(0===(0,y.EO)(t,e,g.W,s,a))return"month";if(2===(0,y.EO)(t,e,g.W,s,a)&&e.getMonth()%3==0)return"quarter"}return(0,y.xo)(e,d.e,s,a)&&(0,y.xo)(t,p.c,s,a)&&11===(0,y.EO)(t,e,g.W,s,a)?"year":"other"})}}z.styles=_.AH`.row{display:flex;align-items:center}:host .time-handle{display:flex;justify-content:flex-end;align-items:center}:host([narrow]) .time-handle{margin-left:auto;margin-inline-start:auto;margin-inline-end:initial}.label{display:flex;align-items:center;justify-content:flex-end;font-size:var(--ha-font-size-xl);margin-left:auto;margin-inline-start:auto;margin-inline-end:initial}:host([narrow]) .label{margin-left:unset;margin-inline-start:unset;margin-inline-end:initial}ha-button{margin-left:8px;margin-inline-start:8px;margin-inline-end:initial;flex-shrink:0;--ha-button-theme-color:currentColor}.backdrop{position:fixed;top:0;left:0;right:0;bottom:0;z-index:var(--dialog-z-index,8);-webkit-backdrop-filter:var(--ha-dialog-scrim-backdrop-filter,var(--dialog-backdrop-filter));backdrop-filter:var(--ha-dialog-scrim-backdrop-filter,var(--dialog-backdrop-filter));pointer-events:none;opacity:0;transition:opacity var(--ha-animation-base-duration) ease-in-out}.datepicker-open .backdrop{opacity:1;pointer-events:auto}`,(0,a.Cg)([(0,u.MZ)({attribute:!1})],z.prototype,"hass",void 0),(0,a.Cg)([(0,u.MZ)({attribute:"collection-key"})],z.prototype,"collectionKey",void 0),(0,a.Cg)([(0,u.MZ)({type:Boolean,reflect:!0})],z.prototype,"narrow",void 0),(0,a.Cg)([(0,u.MZ)({type:Boolean,attribute:"allow-compare"})],z.prototype,"allowCompare",void 0),(0,a.Cg)([(0,u.MZ)({attribute:"vertical-opening-direction"})],z.prototype,"verticalOpeningDirection",void 0),(0,a.Cg)([(0,u.wk)()],z.prototype,"_datepickerOpen",void 0),(0,a.Cg)([(0,u.wk)()],z.prototype,"_startDate",void 0),(0,a.Cg)([(0,u.wk)()],z.prototype,"_endDate",void 0),(0,a.Cg)([(0,u.wk)()],z.prototype,"_ranges",void 0),(0,a.Cg)([(0,u.wk)()],z.prototype,"_compare",void 0),z=(0,a.Cg)([(0,u.EM)("hui-energy-period-selector")],z),t()}catch(e){t(e)}})},30039(e,t,s){s.d(t,{R:()=>i,h:()=>r});var a=s(22348);const i=(e,t="")=>{const s=document.createElement("a");s.target="_blank",s.href=e,s.download=t,s.style.display="none",document.body.appendChild(s),s.dispatchEvent(new MouseEvent("click")),document.body.removeChild(s)},r=e=>!(0,a.V)(e)||!!e.auth.external?.config.downloadFileSupported},22348(e,t,s){s.d(t,{V:()=>i});var a=s(37177);const i=e=>!!e.auth.external&&a.n},37177(e,t,s){s.d(t,{n:()=>a});const a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},56434(e,t,s){s.d(t,{e:()=>i});var a=s(81977);function i(e,t,s){return(0,a.P)(e,12*t,s)}},40600(e,t,s){s.d(t,{o:()=>i});var a=s(73983);function i(e){return(0,a.D)(Date.now(),e)}}};
//# sourceMappingURL=23957.4ad2aaf0ddbf817f.js.map