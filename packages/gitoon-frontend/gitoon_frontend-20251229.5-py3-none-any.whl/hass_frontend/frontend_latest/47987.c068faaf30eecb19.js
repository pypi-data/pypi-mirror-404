export const __rspack_esm_id="47987";export const __rspack_esm_ids=["47987"];export const __webpack_modules__={44010(t,a,i){var e=i(62826),n=i(4042),s=i(44457);class o extends n.A{constructor(...t){super(...t),this.name="fadeIn",this.fill="both",this.play=!0,this.iterations=1}}(0,e.Cg)([(0,s.MZ)()],o.prototype,"name",void 0),(0,e.Cg)([(0,s.MZ)()],o.prototype,"fill",void 0),(0,e.Cg)([(0,s.MZ)({type:Boolean})],o.prototype,"play",void 0),(0,e.Cg)([(0,s.MZ)({type:Number})],o.prototype,"iterations",void 0),o=(0,e.Cg)([(0,s.EM)("ha-fade-in")],o)},70074(t,a,i){i(44114),i(18111),i(22489),i(61701),i(18237);var e=i(62826),n=i(96196),s=i(44457),o=i(22786),r=i(36312),l=i(1087),c=i(52943),d=(i(9503),i(6),i(89859)),h=i(53580);i(76127),i(27826);const p="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z",u={config:"M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z",database:"M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M9 17H7V10H9V17M13 17H11V7H13V17M17 17H15V13H17V17Z",media:"M4,6H2V20A2,2 0 0,0 4,22H18V20H4V6M20,2H8A2,2 0 0,0 6,4V16A2,2 0 0,0 8,18H20A2,2 0 0,0 22,16V4A2,2 0 0,0 20,2M12,14.5V5.5L18,10L12,14.5Z",share:p,ssl:"M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1Z"};class g extends n.WF{firstUpdated(t){super.firstUpdated(t),this.hass&&(0,r.x)(this.hass,"hassio")&&this._fetchAddonInfo()}async _fetchAddonInfo(){const{addons:t}=await(0,d.b3)(this.hass);this._addonIcons=t.reduce((t,a)=>({...t,[a.slug]:a.icon}),{})}_localizeFolder(t){const a=this.localize||this.hass.localize;switch(t){case"media":return a(`ui.panel.${this.translationKeyPanel}.data_picker.media`);case"share":return a(`ui.panel.${this.translationKeyPanel}.data_picker.share_folder`);case"ssl":return a(`ui.panel.${this.translationKeyPanel}.data_picker.ssl`);case"addons/local":return a(`ui.panel.${this.translationKeyPanel}.data_picker.local_addons`)}return(0,c.Z)(t)}_homeassistantChanged(t){const a=this._parseValue(this.value),i=t.currentTarget;i.checked?a.homeassistant.push(i.id):a.homeassistant=a.homeassistant.filter(t=>t!==i.id);const e=this._formatValue(a,this.data);(0,l.r)(this,"value-changed",{value:e})}_addonsChanged(t){t.stopPropagation();const a=this._parseValue(this.value),i=t.detail.value;a.addons=i;const e=this._formatValue(a,this.data);(0,l.r)(this,"value-changed",{value:e})}_sectionChanged(t){const a=this._parseValue(this.value),i=this._parseValue(this.data),e=t.currentTarget,n=e.id;e.checked?a[n]=i[n]:a[n]=[];const s=this._formatValue(a,this.data);(0,l.r)(this,"value-changed",{value:s})}render(){const t=this.localize||this.hass.localize,a=this._homeAssistantItems(this.data,t),i=this._addonsItems(this.data,t,this._addonIcons),e=this._parseValue(this.value);return n.qy` ${a.length?n.qy` <div class="section"> <ha-formfield> <ha-backup-formfield-label slot="label" label="GiToon" .iconPath="${h.mdiHomeAssistant}"> </ha-backup-formfield-label> <ha-checkbox .id="${"homeassistant"}" .checked="${e.homeassistant.length===a.length}" .indeterminate="${e.homeassistant.length>0&&e.homeassistant.length<a.length}" @change="${this._sectionChanged}" ?disabled="${this.requiredItems.length>0}"></ha-checkbox> </ha-formfield> <div class="items"> ${a.map(t=>n.qy` <ha-formfield> <ha-backup-formfield-label slot="label" .label="${t.label}" .version="${t.version}" .iconPath="${u[t.id]||p}"> </ha-backup-formfield-label> <ha-checkbox .id="${t.id}" .checked="${e.homeassistant.includes(t.id)}" @change="${this._homeassistantChanged}" .disabled="${this.requiredItems.includes(t.id)}"></ha-checkbox> </ha-formfield> `)} </div> </div> `:n.s6} ${i.length?n.qy` <div class="section"> <ha-formfield> <ha-backup-formfield-label slot="label" .label="${t(`ui.panel.${this.translationKeyPanel}.data_picker.addons`)}" .iconPath="${"M20.5,11H19V7C19,5.89 18.1,5 17,5H13V3.5A2.5,2.5 0 0,0 10.5,1A2.5,2.5 0 0,0 8,3.5V5H4A2,2 0 0,0 2,7V10.8H3.5C5,10.8 6.2,12 6.2,13.5C6.2,15 5,16.2 3.5,16.2H2V20A2,2 0 0,0 4,22H7.8V20.5C7.8,19 9,17.8 10.5,17.8C12,17.8 13.2,19 13.2,20.5V22H17A2,2 0 0,0 19,20V16H20.5A2.5,2.5 0 0,0 23,13.5A2.5,2.5 0 0,0 20.5,11Z"}"> </ha-backup-formfield-label> <ha-checkbox .id="${"addons"}" .checked="${e.addons.length===i.length}" .indeterminate="${e.addons.length>0&&e.addons.length<i.length}" @change="${this._sectionChanged}" .disabled="${this.addonsDisabled}"></ha-checkbox> </ha-formfield> <ha-backup-addons-picker .hass="${this.hass}" .value="${e.addons}" @value-changed="${this._addonsChanged}" .addons="${i}" .disabled="${this.addonsDisabled}"> </ha-backup-addons-picker> </div> `:n.s6} `}constructor(...t){super(...t),this.requiredItems=[],this.translationKeyPanel="config.backup",this.addonsDisabled=!1,this._addonIcons={},this._homeAssistantItems=(0,o.A)((t,a)=>{const i=[];return t.homeassistant_included&&i.push({label:a(`ui.panel.${this.translationKeyPanel}.data_picker.${t.database_included?"settings_and_history":"settings"}`),id:"config",version:t.homeassistant_version}),i.push(...t.folders.map(t=>({label:this._localizeFolder(t),id:t}))),i}),this._addonsItems=(0,o.A)((t,a,i)=>t.addons.map(t=>({name:t.name,slug:t.slug,version:t.version,icon:i[t.slug]}))),this._parseValue=(0,o.A)(t=>{if(!t)return{homeassistant:[],addons:[]};const a=[],i=[];t.homeassistant_included&&a.push("config");const e=t.folders;a.push(...e);const n=t.addons.map(t=>t.slug);return i.push(...n),{homeassistant:a,addons:i}}),this._formatValue=(0,o.A)((t,a)=>({homeassistant_version:a.homeassistant_version,homeassistant_included:t.homeassistant.includes("config"),database_included:a.database_included&&t.homeassistant.includes("config"),addons:a.addons.filter(a=>t.addons.includes(a.slug)),folders:a.folders.filter(a=>t.homeassistant.includes(a))}))}}g.styles=n.AH`.section{margin-left:-16px;margin-inline-start:-16px;margin-inline-end:initial}.items{padding-left:40px;padding-inline-start:40px;padding-inline-end:initial;display:flex;flex-direction:column}ha-backup-addons-picker{display:block;padding-left:40px;padding-inline-start:40px;padding-inline-end:initial}`,(0,e.Cg)([(0,s.MZ)({attribute:!1})],g.prototype,"hass",void 0),(0,e.Cg)([(0,s.MZ)({attribute:!1})],g.prototype,"data",void 0),(0,e.Cg)([(0,s.MZ)({attribute:!1})],g.prototype,"value",void 0),(0,e.Cg)([(0,s.MZ)({attribute:!1})],g.prototype,"localize",void 0),(0,e.Cg)([(0,s.MZ)({type:Array,attribute:"required-items"})],g.prototype,"requiredItems",void 0),(0,e.Cg)([(0,s.MZ)({attribute:"translation-key-panel"})],g.prototype,"translationKeyPanel",void 0),(0,e.Cg)([(0,s.MZ)({type:Boolean,attribute:!1})],g.prototype,"addonsDisabled",void 0),(0,e.Cg)([(0,s.wk)()],g.prototype,"_addonIcons",void 0),g=(0,e.Cg)([(0,s.EM)("ha-backup-data-picker")],g)},14878(t,a,i){i.a(t,async function(t,e){try{i.r(a);i(18111),i(20116);var n=i(62826),s=i(96196),o=i(44457),r=i(1087),l=(i(38962),i(18350)),c=(i(13416),i(76776),i(44010),i(26300),i(17308),i(2846),i(65829)),d=(i(59646),i(31420)),h=(i(81310),i(33963)),p=(i(78391),i(70074),t([l,c,d,h]));[l,c,d,h]=p.then?(await p)():p;class u extends s.WF{willUpdate(t){t.has("agentId")&&(this.agentId?this._fetchAgent():this._error="Agent id not defined")}render(){if(!this.hass)return s.s6;const t=this._isEncryptionTurnedOn(),a=this._agent&&(0,d.q7)(this.hass.localize,this.agentId,this.agents)||this.hass.localize("ui.panel.config.backup.location.header");return s.qy` <hass-subpage back-path="/config/backup/settings" .hass="${this.hass}" .narrow="${this.narrow}" .header="${a}"> <div class="content"> ${this._error&&s.qy`<ha-alert alert-type="error">${this._error}</ha-alert>`} ${null===this._agent?s.qy` <ha-alert alert-type="warning" .title="${this.hass.localize("ui.panel.config.backup.location.not_found")}"> ${this.hass.localize("ui.panel.config.backup.location.not_found_description",{agentId:this.agentId})} </ha-alert> `:this.agentId?s.qy` <ha-card> <div class="card-header"> ${this.hass.localize("ui.panel.config.backup.location.configuration.title")} </div> ${d.oJ===this.agentId?s.qy` <div class="card-content"> <p> ${this.hass.localize("ui.panel.config.backup.location.configuration.cloud_description")} </p> </div> `:s.qy`<ha-backup-config-retention location-specific .headline="${this.hass.localize("ui.panel.config.backup.location.retention_for_"+((0,d.Bi)(this.agentId)?"this_system":"location"),{location:a})}" .hass="${this.hass}" .retention="${this.config?this.config.agents[this.agentId]?.retention||null:void 0}" @value-changed="${this._retentionChanged}"></ha-backup-config-retention>`} </ha-card> <ha-card> <div class="card-header"> ${this.hass.localize("ui.panel.config.backup.location.encryption.title")} </div> <div class="card-content"> <p> ${this.hass.localize("ui.panel.config.backup.location.encryption.description")} </p> <ha-md-list> ${d.oJ===this.agentId?s.qy` <ha-md-list-item> <span slot="headline"> ${this.hass.localize("ui.panel.config.backup.location.encryption.location_encrypted")} </span> <span slot="supporting-text"> ${this.hass.localize("ui.panel.config.backup.location.encryption.location_encrypted_cloud_description")} </span> <ha-button href="https://www.nabucasa.com/config/backups/" target="_blank" slot="end" rel="noreferrer noopener" appearance="plain" size="small"> ${this.hass.localize("ui.panel.config.backup.location.encryption.location_encrypted_cloud_learn_more")} </ha-button> </ha-md-list-item> `:t?s.qy` <ha-md-list-item> <span slot="headline"> ${this.hass.localize("ui.panel.config.backup.location.encryption.location_encrypted")} </span> <span slot="supporting-text"> ${this.hass.localize("ui.panel.config.backup.location.encryption.location_encrypted_description")} </span> <ha-button slot="end" @click="${this._turnOffEncryption}" variant="danger"> ${this.hass.localize("ui.panel.config.backup.location.encryption.encryption_turn_off")} </ha-button> </ha-md-list-item> `:s.qy` <ha-alert alert-type="warning" .title="${this.hass.localize("ui.panel.config.backup.location.encryption.warning_encryption_turn_off")}"> ${this.hass.localize("ui.panel.config.backup.location.encryption.warning_encryption_turn_off_description")} </ha-alert> <ha-md-list-item> <span slot="headline"> ${this.hass.localize("ui.panel.config.backup.location.encryption.location_unencrypted")} </span> <span slot="supporting-text"> ${this.hass.localize("ui.panel.config.backup.location.encryption.location_unencrypted_description")} </span> <ha-button slot="end" @click="${this._turnOnEncryption}"> ${this.hass.localize("ui.panel.config.backup.location.encryption.encryption_turn_on")} </ha-button> </ha-md-list-item> `} </ha-md-list> </div> </ha-card> `:s.qy`<ha-fade-in .delay="${1e3}"><ha-spinner></ha-spinner></ha-fade-in>`} </div> </hass-subpage> `}_isEncryptionTurnedOn(){const t=this.config?.agents[this.agentId];return!t||t.protected}async _fetchAgent(){try{const{agents:t}=await(0,d.P_)(this.hass),a=t.find(t=>t.agent_id===this.agentId);if(!a)throw new Error("Agent not found");this._agent=a}catch(t){this._error=t?.message||this.hass.localize("ui.panel.config.backup.details.error")}}async _updateAgentConfig(t){try{const a=this.config?.agents||{};a[this.agentId]={...a[this.agentId]||{},...t},await(0,d.gb)(this.hass,{agents:a}),(0,r.r)(this,"ha-refresh-backup-config")}catch(t){this._error=this.hass.localize("ui.panel.config.backup.location.save_error",{error:t.message})}}_retentionChanged(t){const a=t.detail.value;this._updateAgentConfig({retention:a})}async _updateAgentEncryption(t){this._updateAgentConfig({protected:t})}_turnOnEncryption(){this._updateAgentEncryption(!0)}async _turnOffEncryption(){await(0,h.showConfirmationDialog)(this,{title:this.hass.localize("ui.panel.config.backup.location.encryption.encryption_turn_off_confirm_title"),text:this.hass.localize("ui.panel.config.backup.location.encryption.encryption_turn_off_confirm_text"),confirmText:this.hass.localize("ui.panel.config.backup.location.encryption.encryption_turn_off_confirm_action"),dismissText:this.hass.localize("ui.common.cancel"),destructive:!0})&&this._updateAgentEncryption(!1)}constructor(...t){super(...t),this.narrow=!1,this.agents=[]}}u.styles=s.AH`.content{padding:28px 20px 0;max-width:690px;margin:0 auto;gap:var(--ha-space-6);display:grid;margin-bottom:24px}.card-content{padding:0 20px}.card-actions{display:flex;justify-content:flex-end}ha-md-list{background:0 0;padding:0}ha-md-list-item{--md-list-item-leading-space:0;--md-list-item-trailing-space:0;--md-list-item-two-line-container-height:64px}ha-md-list-item img{width:48px}ha-md-list-item ha-svg-icon[slot=start]{--mdc-icon-size:48px;color:var(--primary-text-color)}ha-md-list.summary ha-md-list-item{--md-list-item-supporting-text-size:1rem;--md-list-item-label-text-size:0.875rem;--md-list-item-label-text-color:var(--secondary-text-color);--md-list-item-supporting-text-color:var(--primary-text-color)}.warning{color:var(--error-color)}.warning ha-svg-icon{color:var(--error-color)}ha-button.danger{--mdc-theme-primary:var(--error-color)}ha-backup-data-picker{display:block}ha-md-list-item [slot=supporting-text]{display:flex;align-items:center;flex-direction:row;gap:var(--ha-space-2);line-height:var(--ha-line-height-condensed)}.dot{display:block;position:relative;width:8px;height:8px;background-color:var(--disabled-color);border-radius:var(--ha-border-radius-circle);flex:none}.dot.success{background-color:var(--success-color)}.dot.error{background-color:var(--error-color)}.card-header{padding-bottom:8px}ha-spinner{margin:24px auto}ha-backup-config-retention{display:block;padding:16px}`,(0,n.Cg)([(0,o.MZ)({attribute:!1})],u.prototype,"hass",void 0),(0,n.Cg)([(0,o.MZ)({type:Boolean})],u.prototype,"narrow",void 0),(0,n.Cg)([(0,o.MZ)({attribute:"agent-id"})],u.prototype,"agentId",void 0),(0,n.Cg)([(0,o.MZ)({attribute:!1})],u.prototype,"config",void 0),(0,n.Cg)([(0,o.MZ)({attribute:!1})],u.prototype,"agents",void 0),(0,n.Cg)([(0,o.wk)()],u.prototype,"_agent",void 0),(0,n.Cg)([(0,o.wk)()],u.prototype,"_error",void 0),u=(0,n.Cg)([(0,o.EM)("ha-config-backup-location")],u),e()}catch(t){e(t)}})}};
//# sourceMappingURL=47987.c068faaf30eecb19.js.map