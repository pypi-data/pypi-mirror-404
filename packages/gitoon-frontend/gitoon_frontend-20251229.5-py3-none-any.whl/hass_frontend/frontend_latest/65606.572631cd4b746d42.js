export const __rspack_esm_id="65606";export const __rspack_esm_ids=["65606"];export const __webpack_modules__={34296(e,t,i){var a=i(62826),s=i(96229),o=i(26069),r=i(91735),n=i(42034),l=i(96196),c=i(44457);class h extends s.k{renderOutline(){return this.filled?l.qy`<span class="filled"></span>`:super.renderOutline()}getContainerClasses(){return{...super.getContainerClasses(),active:this.active}}renderPrimaryContent(){return l.qy` <span class="leading icon" aria-hidden="true"> ${this.renderLeadingIcon()} </span> <span class="label">${this.label}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${this.renderTrailingIcon()} </span> `}renderTrailingIcon(){return l.qy`<slot name="trailing-icon"></slot>`}constructor(...e){super(...e),this.filled=!1,this.active=!1}}h.styles=[r.R,n.R,o.R,l.AH`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`],(0,a.Cg)([(0,c.MZ)({type:Boolean,reflect:!0})],h.prototype,"filled",void 0),(0,a.Cg)([(0,c.MZ)({type:Boolean})],h.prototype,"active",void 0),h=(0,a.Cg)([(0,c.EM)("ha-assist-chip")],h)},31580(e,t,i){i.d(t,{J8:()=>s,Rr:()=>r,b9:()=>a,iV:()=>o});const a=e=>{let t=e;return"string"==typeof e&&(t=parseInt(e,16)),"0x"+t.toString(16).padStart(4,"0")},s=(e,t)=>{const i=e.user_given_name?e.user_given_name:e.name,a=t.user_given_name?t.user_given_name:t.name;return i.localeCompare(a)},o=(e,t)=>{const i=e.name,a=t.name;return i.localeCompare(a)},r=e=>`${e.name} (Endpoint id: ${e.endpoint_id}, Id: ${a(e.id)}, Type: ${e.type})`},94728(e,t,i){i.a(e,async function(e,a){try{i.r(t),i.d(t,{ZHANetworkVisualizationPage:()=>y});i(44114),i(18111),i(20116),i(7588);var s=i(62826),o=i(96196),r=i(44457),n=i(76774),l=i(91926),c=i(7358),h=i(84621),d=(i(31168),i(31580)),p=i(63670),u=e([c,p]);[c,p]=u.then?(await u)():u;const g="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z";class y extends o.WF{firstUpdated(e){super.firstUpdated(e),this.hass&&this._fetchData()}render(){return o.qy` <hass-tabs-subpage .tabs="${p.zhaTabs}" .hass="${this.hass}" .narrow="${this.narrow}" .isWide="${this.isWide}" .route="${this.route}" header="${this.hass.localize("ui.panel.config.zha.visualization.header")}"> <ha-network-graph .hass="${this.hass}" .data="${this._networkData}" .tooltipFormatter="${this._tooltipFormatter}" @chart-click="${this._handleChartClick}"> <ha-icon-button slot="button" class="refresh-button" .path="${g}" @click="${this._refreshTopology}" label="${this.hass.localize("ui.panel.config.zha.visualization.refresh_topology")}"></ha-icon-button> </ha-network-graph> </hass-tabs-subpage> `}async _fetchData(){this._devices=await(0,h.Uc)(this.hass),this._networkData=this._createChartData(this._devices)}async _refreshTopology(){await(0,h.xU)(this.hass),await this._fetchData()}_handleChartClick(e){if("node"===e.detail.dataType&&"pointer"===e.detail.event.target.cursor){const{id:t}=e.detail.data,i=this._devices.find(e=>e.ieee===t);i&&(0,l.o)(`/config/devices/device/${i.device_reg_id}`)}}static get styles(){return[o.AH`ha-network-graph{height:100%}`]}_createChartData(e){const t=getComputedStyle(this),i=t.getPropertyValue("--primary-color"),a=t.getPropertyValue("--cyan-color"),s=t.getPropertyValue("--teal-color"),o=t.getPropertyValue("--error-color"),r=[],l=[],c=[{name:this.hass.localize("ui.panel.config.zha.visualization.coordinator"),symbol:"roundRect",itemStyle:{color:i}},{name:this.hass.localize("ui.panel.config.zha.visualization.router"),symbol:"circle",itemStyle:{color:a}},{name:this.hass.localize("ui.panel.config.zha.visualization.end_device"),symbol:"circle",itemStyle:{color:s}},{name:this.hass.localize("ui.panel.config.zha.visualization.offline"),symbol:"circle",itemStyle:{color:o}}];return e.forEach(c=>{const h="Coordinator"===c.device_type;let d;d=c.available?h?0:"Router"===c.device_type?1:2:3;const p=this.hass.devices[c.device_reg_id],u=p?(0,n.w)(p,this.hass).area:void 0;r.push({id:c.ieee,name:c.user_given_name||c.name||c.ieee,context:u?.name,category:d,value:h?3:"Router"===c.device_type?2:1,symbolSize:h?40:"Router"===c.device_type?30:20,symbol:h?"roundRect":"circle",itemStyle:{color:c.available?h?i:"Router"===c.device_type?a:s:o},polarDistance:0===d?0:1===d?.5:.9,fixed:h});const g=l.filter(e=>e.source===c.ieee||e.target===c.ieee);if(c.routes&&c.routes.length>0)c.routes.forEach(e=>{const a=c.neighbors.find(t=>t.nwk===e.next_hop);if(!a)return;const s=g.find(e=>e.source===a.ieee||e.target===a.ieee);if(s){s.source===c.ieee?s.value=Math.max(s.value,parseInt(a.lqi)):s.reverseValue=Math.max(s.reverseValue??0,parseInt(a.lqi));const t=this._getLQIWidth(parseInt(a.lqi));s.symbolSize=t/4*6+3,s.lineStyle={...s.lineStyle,width:t,color:"Active"===e.route_status?i:s.lineStyle.color,type:["Child","Parent"].includes(a.relationship)?"solid":s.lineStyle.type}}else{const s=this._getLQIWidth(parseInt(a.lqi)),o={source:c.ieee,target:a.ieee,value:parseInt(a.lqi),lineStyle:{width:s,color:"Active"===e.route_status?i:t.getPropertyValue("--dark-primary-color"),type:["Child","Parent"].includes(a.relationship)?"solid":"dotted"},symbolSize:s/4*6+3,ignoreForceLayout:"0x0000"!==e.dest_nwk};l.push(o),g.push(o)}});else if(0===g.length){const i=c.neighbors??[];0===i.length&&e.forEach(e=>{if(e.neighbors&&e.neighbors.length>0){const t=e.neighbors.find(e=>e.ieee===c.ieee);t&&i.push({ieee:e.ieee,lqi:t.lqi})}});const a=i.sort((e,t)=>parseInt(t.lqi)-parseInt(e.lqi))[0];a&&l.push({source:c.ieee,target:a.ieee,value:parseInt(a.lqi),symbolSize:5,lineStyle:{width:1,color:t.getPropertyValue("--dark-primary-color"),type:"dotted"},ignoreForceLayout:!0})}}),e.forEach(e=>{if("Coordinator"===e.device_type)l.forEach(t=>{t.source!==e.ieee&&t.target!==e.ieee||(t.ignoreForceLayout=!1)});else{let t;!l.some(i=>{if(i.source===e.ieee||i.target===e.ieee){if(!i.ignoreForceLayout)return!0;i.value>(t?.value??-1)&&(t=i)}return!1})&&t&&(t.ignoreForceLayout=!1)}}),{nodes:r,links:l,categories:c}}_getLQIWidth(e){return e>200?3:e>100?2:1}constructor(...e){super(...e),this.narrow=!1,this.isWide=!1,this._networkData={nodes:[],links:[],categories:[]},this._devices=[],this._tooltipFormatter=e=>{const{dataType:t,data:i,name:a}=e;if("edge"===t){const{source:e,target:t,value:a}=i,s=this._networkData.nodes.find(e=>e.id===t).name,o=this._networkData.nodes.find(t=>t.id===e).name,r=`${o} → ${s}${a?` <b>LQI:</b> ${a}`:""}`,n=this._networkData.links.find(i=>i.source===e&&i.target===t)?.reverseValue;return n?`${r}<br>${s} → ${o} <b>LQI:</b> ${n}`:r}const s=this._devices.find(e=>e.ieee===i.id);if(!s)return a;let o=`<b>IEEE: </b>${s.ieee}`;o+=`<br><b>${this.hass.localize("ui.panel.config.zha.visualization.device_type")}: </b>${s.device_type.replace("_"," ")}`,null!=s.nwk&&(o+=`<br><b>NWK: </b>${(0,d.b9)(s.nwk)}`),null!=s.manufacturer&&null!=s.model?o+=`<br><b>${this.hass.localize("ui.panel.config.zha.visualization.device")}: </b>${s.manufacturer} ${s.model}`:o+=`<br><b>${this.hass.localize("ui.panel.config.zha.visualization.device_not_in_db")}</b>`;const r=this.hass.devices[s.device_reg_id];if(r){const e=(0,n.w)(r,this.hass).area;e&&(o+=`<br><b>${this.hass.localize("ui.panel.config.zha.visualization.area")}: </b>${e.name}`)}return o}}}(0,s.Cg)([(0,r.MZ)({attribute:!1})],y.prototype,"hass",void 0),(0,s.Cg)([(0,r.MZ)({attribute:!1})],y.prototype,"route",void 0),(0,s.Cg)([(0,r.MZ)({type:Boolean,reflect:!0})],y.prototype,"narrow",void 0),(0,s.Cg)([(0,r.MZ)({attribute:"is-wide",type:Boolean})],y.prototype,"isWide",void 0),(0,s.Cg)([(0,r.wk)()],y.prototype,"_networkData",void 0),(0,s.Cg)([(0,r.wk)()],y.prototype,"_devices",void 0),y=(0,s.Cg)([(0,r.EM)("zha-network-visualization-page")],y),a()}catch(e){a(e)}})}};
//# sourceMappingURL=65606.572631cd4b746d42.js.map