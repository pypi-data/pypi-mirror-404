export const __rspack_esm_id="93505";export const __rspack_esm_ids=["93505"];export const __webpack_modules__={23528(e,t,a){a.d(t,{$3:()=>m,$O:()=>C,$j:()=>y,ED:()=>l,JE:()=>k,OQ:()=>x,PU:()=>S,Ph:()=>u,Uf:()=>v,W1:()=>g,Wr:()=>i,Z:()=>n,gF:()=>p,iY:()=>b,jU:()=>o,nN:()=>w,p3:()=>d,pJ:()=>h,r_:()=>c,sz:()=>_});a(18111),a(13579);var r=a(28978),s=a(380),l=function(e){return e[e.NONE=0]="NONE",e[e.ARITHMETIC=1]="ARITHMETIC",e[e.CIRCULAR=2]="CIRCULAR",e}({});const o=["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"],c=["L","gal","ft³","m³","CCF","MCF"],n=e=>e.sendMessagePromise({type:"recorder/info"}),d=(e,t)=>e.callWS({type:"recorder/list_statistic_ids",statistic_type:t}),i=(e,t)=>e.callWS({type:"recorder/get_statistics_metadata",statistic_ids:t}),_=(e,t,a,r,s="hour",l,o)=>e.callWS({type:"recorder/statistics_during_period",start_time:t.toISOString(),end_time:a?.toISOString(),statistic_ids:r,period:s,units:l,types:o}),h=(e,t,a,r)=>e.callWS({type:"recorder/statistic_during_period",statistic_id:t,units:r,fixed_period:a.fixed_period?{start_time:a.fixed_period.start instanceof Date?a.fixed_period.start.toISOString():a.fixed_period.start,end_time:a.fixed_period.end instanceof Date?a.fixed_period.end.toISOString():a.fixed_period.end}:void 0,calendar:a.calendar?{..."week"===a.calendar.period?{first_weekday:(0,s.D)(e.locale).substring(0,3)}:{},...a.calendar}:void 0,rolling_window:a.rolling_window}),u=e=>e.callWS({type:"recorder/validate_statistics"}),g=(e,t,a,r)=>e.callWS({type:"recorder/update_statistics_metadata",statistic_id:t,unit_of_measurement:a,unit_class:r}),m=(e,t)=>e.callWS({type:"recorder/clear_statistics",statistic_ids:t}),y=e=>{let t=null;if(!e)return null;for(const a of e)null!==a.change&&void 0!==a.change&&(null===t?t=a.change:t+=a.change);return t},p=(e,t)=>{let a=null;for(const r of t){if(!(r in e))continue;const t=y(e[r]);null!==t&&(null===a?a=t:a+=t)}return a},b=(e,t)=>e.some(e=>void 0!==e[t]&&null!==e[t]),f=["mean","min","max"],$=["sum","state","change"],w=(e,t)=>!(!f.includes(t)||0===e.mean_type)||!(!$.includes(t)||!e.has_sum),v=(e,t,a,r,s)=>{const l=new Date(a).toISOString();return e.callWS({type:"recorder/adjust_sum_statistics",statistic_id:t,start_time:l,adjustment:r,adjustment_unit_of_measurement:s})},C=(e,t,a)=>{const s=e.states[t];return s?(0,r.u)(s):a?.name||t},k=(e,t,a)=>{let r;return t&&(r=e.states[t]?.attributes.unit_of_measurement),void 0===r?a?.statistics_unit_of_measurement:r},x=e=>e.includes(":"),S=e=>e.callWS({type:"recorder/update_statistics_issues"})},18427(e,t,a){a.d(t,{g:()=>l});var r=a(79468),s=a(39274);function l(e,t,a,l,o,c){const n=e.getPropertyValue(o+"-"+c).trim(),d=n.length>0?n:e.getPropertyValue(o).trim();let i=(0,r.RQ)(d);return 0===n.length&&c&&(i=(0,r.v2)((0,r.BE)(t?(0,s.T)((0,r.Nc)((0,r.xp)(i)),c):(0,s.d)((0,r.Nc)((0,r.xp)(i)),c)))),l?i+=a?"32":"7F":a&&(i+="7F"),i}},24408(e,t,a){a.a(e,async function(e,r){try{a.r(t),a.d(t,{HuiEnergySourcesTableCard:()=>f});a(18111),a(22489),a(61701),a(13579);var s=a(62826),l=a(68560),o=a(96196),c=a(44457),n=a(94333),d=a(6415),i=a(20058),_=a(18427),h=(a(76776),a(38114)),u=a(23528),g=a(54706),m=a(784),y=a(1087),p=e([i,h]);[i,h]=p.then?(await p)():p;const b={grid_return:"--energy-grid-return-color",grid_consumption:"--energy-grid-consumption-color",battery_in:"--energy-battery-in-color",battery_out:"--energy-battery-out-color",solar:"--energy-solar-color",gas:"--energy-gas-color",water:"--energy-water-color"};class f extends((0,g.E)(o.WF)){hassSubscribe(){return[(0,h.tb)(this.hass,{key:this._config?.collection_key}).subscribe(e=>{this._data=e})]}getCardSize(){return 3}setConfig(e){this._config=e}shouldUpdate(e){return(0,m.xP)(this,e)||e.size>1||!e.has("hass")}_renderRow(e,t,a,r,s,l,c,h,g,m,y){return o.qy`<tr class="mdc-data-table__row ${(0,n.H)({clickable:!(0,u.OQ)(a)})}" @click="${this._handleMoreInfo}" .entity="${a}"> <td class="mdc-data-table__cell cell-bullet"> <div class="bullet" style="${(0,d.W)({borderColor:(0,_.g)(e,this.hass.themes.darkMode,!1,!1,b[t],r),backgroundColor:(0,_.g)(e,this.hass.themes.darkMode,!0,!1,b[t],r)})}"></div> </td> <th class="mdc-data-table__cell" scope="row"> ${(0,u.$O)(this.hass,a,this._data?.statsMetadata[a])} </th> ${y?o.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${(0,i.ZV)(l,this.hass.locale)} ${c} </td> ${m?o.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null!==g?(0,i.ZV)(g,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""} </td>`:""}`:""} <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${(0,i.ZV)(s,this.hass.locale)} ${c} </td> ${m?o.qy` <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null!==h?(0,i.ZV)(h,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""} </td>`:""} </tr>`}_renderTotalRow(e,t,a,r,s,l,c,n,_,h){return o.qy` <tr class="mdc-data-table__row ${_&&!h?"":"total"}"> <td class="mdc-data-table__cell cell-bullet"> ${_?o.qy`<div class="bullet" style="${(0,d.W)({borderColor:_.border,backgroundColor:_.background})}"></div>`:o.s6} </td> <th class="mdc-data-table__cell" scope="row">${e}</th> ${n?o.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null===a?"":`${(0,i.ZV)(a,this.hass.locale)} ${r}`} </td> ${c?o.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null!==l?(0,i.ZV)(l,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""} </td>`:""}`:""} <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null===t?"":`${(0,i.ZV)(t,this.hass.locale)} ${r}`} </td> ${c?o.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null!==s?(0,i.ZV)(s,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""} </td>`:""} </tr>`}render(){if(!this.hass||!this._config)return o.s6;if(!this._data)return o.qy`${this.hass.localize("ui.panel.lovelace.cards.energy.loading")}`;let e=0,t=0,a=0,r=!1,s=0,l=0,c=0;const n={gas:0,water:0,solar:0},d={gas:0,water:0,solar:0},i={gas:0,water:0},g={gas:0,water:0},m={gas:!1,water:!1},y=(0,h.E$)(this._data.prefs),p=this._config?.types,f=p?Object.fromEntries(Object.entries(y).filter(([e])=>p.includes(e))):y,$=getComputedStyle(this),w=!!(f.grid?.[0].flow_from.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)||f.grid?.[0].flow_to.some(e=>e.stat_compensation||e.entity_energy_price||e.number_energy_price)||f.gas?.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)||f.water?.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)),v={solar:"kWh",gas:this._data.gasUnit,water:this._data.waterUnit},C=void 0!==this._data.statsCompare,k=(e,t)=>{const a=(0,u.$j)(this._data.stats[e]),r=C&&(0,u.$j)(this._data.statsCompare[e]),s=t&&(0,u.$j)(this._data.stats[t])||0,l=C&&t&&(0,u.$j)(this._data.statsCompare[t])||0;return null!==a||C&&null!==r?{hasData:!0,energy:a||0,energyCompare:r||0,cost:s,costCompare:l}:{hasData:!1,energy:a||0,energyCompare:r||0,cost:s,costCompare:l}},x=this._config.show_only_totals,S=e=>o.qy` ${f[e]?.map((t,a)=>{const r=e in m&&(t.stat_cost||this._data.info.cost_sensors[t.stat_energy_from]),{hasData:s,energy:l,energyCompare:c,cost:_,costCompare:h}=k(t.stat_energy_from,r||null);return s||_||h?(n[e]+=l,d[e]+=c,r&&(m[e]=!0,i[e]+=_,g[e]+=h),x?o.s6:this._renderRow($,e,t.stat_energy_from,a,l,c,v[e],r?_:null,r?h:null,w,C)):o.s6})} ${f[e]?this._renderTotalRow(this.hass.localize(`ui.panel.lovelace.cards.energy.energy_sources_table.${e}_total`),n[e],d[e],v[e],m[e]?i[e]:null,m[e]?g[e]:null,w,C,x?{border:(0,_.g)($,this.hass.themes.darkMode,!1,!1,b[e],0),background:(0,_.g)($,this.hass.themes.darkMode,!0,!1,b[e],0)}:void 0):""}`;return o.qy` <ha-card> ${this._config.title?o.qy`<h1 class="card-header">${this._config.title}</h1>`:""} <div class="mdc-data-table"> <div class="mdc-data-table__table-container"> <table class="mdc-data-table__table" aria-label="Energy sources"> <thead> <tr class="mdc-data-table__header-row"> <th class="mdc-data-table__header-cell"></th> <th class="mdc-data-table__header-cell" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.source")} </th> ${C?o.qy`<th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.previous_energy")} </th> ${w?o.qy`<th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.previous_cost")} </th>`:""}`:""} <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.energy")} </th> ${w?o.qy` <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.cost")} </th>`:""} </tr> </thead> <tbody class="mdc-data-table__content"> ${S("solar")} ${f.battery?.map((e,t)=>{const{hasData:r,energy:s,energyCompare:l}=k(e.stat_energy_from,null),{hasData:n,energy:d,energyCompare:i}=k(e.stat_energy_to,null);return r||n?(a+=s-d,c+=l-i,x?o.s6:o.qy` ${this._renderRow($,"battery_out",e.stat_energy_from,t,s,l,"kWh",null,null,w,C)}${this._renderRow($,"battery_in",e.stat_energy_to,t,-d,-i,"kWh",null,null,w,C)}`):o.s6})} ${f.battery?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.battery_total"),a,c,"kWh",null,null,w,C,x?{border:(0,_.g)($,this.hass.themes.darkMode,!1,!1,b.battery_out,0),background:(0,_.g)($,this.hass.themes.darkMode,!0,!1,b.battery_out,0)}:void 0):""} ${f.grid?.map(a=>o.qy`${a.flow_from.map((a,c)=>{const n=a.stat_cost||this._data.info.cost_sensors[a.stat_energy_from],{hasData:d,energy:i,energyCompare:_,cost:h,costCompare:u}=k(a.stat_energy_from,n||null);return d||h||u?(e+=i,s+=_,n&&(r=!0,t+=h,l+=u),x?o.s6:this._renderRow($,"grid_consumption",a.stat_energy_from,c,i,_,"kWh",h,u,w,C)):o.s6})} ${a.flow_to.map((a,c)=>{const n=a.stat_compensation||this._data.info.cost_sensors[a.stat_energy_to],{hasData:d,energy:i,energyCompare:_,cost:h,costCompare:u}=k(a.stat_energy_to,n||null);return d||h||u?(e-=i,s-=_,null!==n&&(r=!0,t-=h,l-=u),x?o.s6:this._renderRow($,"grid_return",a.stat_energy_to,c,-i,-_,"kWh",-h,-u,w,C)):o.s6})}`)} ${f.grid&&(f.grid?.[0].flow_from?.length||f.grid?.[0].flow_to?.length)?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.grid_total"),e,s,"kWh",r?t:null,r?l:null,w,C,x?{border:(0,_.g)($,this.hass.themes.darkMode,!1,!1,b.grid_consumption,0),background:(0,_.g)($,this.hass.themes.darkMode,!0,!1,b.grid_consumption,0)}:void 0):""} ${S("gas")} ${S("water")} ${[m.gas,m.water,r].filter(Boolean).length>1?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.total_costs"),null,null,"",i.gas+t+i.water,g.gas+l+g.water,w,C,void 0,!0):""} </tbody> </table> </div> </div> </ha-card>`}_handleMoreInfo(e){const t=e.currentTarget?.entity;t&&!(0,u.OQ)(t)&&(0,y.r)(this,"hass-more-info",{entityId:t})}static get styles(){return o.AH`${(0,o.iz)(l)} .mdc-data-table{width:100%;border:0}.mdc-data-table__cell,.mdc-data-table__header-cell{color:var(--primary-text-color);border-bottom-color:var(--divider-color);text-align:var(--float-start)}.mdc-data-table__row:not(.mdc-data-table__row--selected):hover{background-color:rgba(var(--rgb-primary-text-color),.04)}.clickable{cursor:pointer}.total{--mdc-typography-body2-font-weight:var(--ha-font-weight-medium)}.total .mdc-data-table__cell{border-top:1px solid var(--divider-color)}ha-card{max-height:100%;overflow:auto}.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}.cell-bullet{width:32px;padding-right:0;padding-inline-end:0;padding-inline-start:16px;direction:var(--direction)}.bullet{border-width:1px;border-style:solid;border-radius:var(--ha-border-radius-sm);height:16px;width:32px}.mdc-data-table__cell--numeric{direction:ltr}`}constructor(...e){super(...e),this.hassSubscribeRequiredHostProps=["_config"]}}(0,s.Cg)([(0,c.MZ)({attribute:!1})],f.prototype,"hass",void 0),(0,s.Cg)([(0,c.wk)()],f.prototype,"_config",void 0),(0,s.Cg)([(0,c.wk)()],f.prototype,"_data",void 0),f=(0,s.Cg)([(0,c.EM)("hui-energy-sources-table-card")],f),r()}catch(e){r(e)}})}};
//# sourceMappingURL=93505.c528a032d7694aef.js.map