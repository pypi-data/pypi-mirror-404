<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vLLM-Playground - Server Management & Chat Interface</title>
    <link rel="icon" type="image/png" href="/assets/vllm_only.png">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/mcp.css">
    <link rel="stylesheet" href="/static/css/guidellm.css">
    <link rel="stylesheet" href="/static/css/claudecode.css">
    <link rel="stylesheet" href="/static/css/omni.css">
    <!-- xterm.js for Claude Code terminal -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.css">
    <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.8.0/lib/xterm-addon-fit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm-addon-web-links@0.9.0/lib/xterm-addon-web-links.min.js"></script>
</head>
<body>
    <div class="app-layout">
        <!-- Left Navigation Sidebar -->
        <nav class="nav-sidebar" id="nav-sidebar">
            <div class="nav-brand">
                <img src="/assets/vllm-logo.svg" alt="vLLM-Playground" class="nav-logo" onerror="this.style.display='none'">
                <span class="nav-title">vLLM-Playground</span>
            </div>

            <div class="nav-items">
                <!-- vLLM Projects Section -->
                <div class="nav-section-label">vLLM Projects</div>
                <button class="nav-item active" data-view="vllm-server" title="vLLM Server">
                    <img src="/assets/vllm-logo.svg" alt="" class="nav-item-logo" onerror="this.style.display='none'">
                    <span class="nav-label" data-i18n="nav.vllmServer">vLLM Server</span>
                </button>
                <button class="nav-item" data-view="guidellm" title="GuideLLM Benchmark">
                    <img src="/assets/guidellm-logo.svg" alt="" class="nav-item-logo" onerror="this.style.display='none'">
                    <span class="nav-label" data-i18n="nav.guidellm">GuideLLM</span>
                </button>
                <button class="nav-item" data-view="vllm-omni" title="vLLM-Omni" id="nav-omni">
                    <img src="/assets/vllm-omni-logo.svg" alt="" class="nav-item-logo" onerror="this.style.display='none'">
                    <span class="nav-label">vLLM-Omni</span>
                </button>

                <!-- Divider -->
                <div class="nav-divider">
                    <span class="nav-divider-label">Integrations</span>
                </div>

                <!-- Integrations Section -->
                <button class="nav-item" data-view="mcp-config" title="MCP Servers" id="nav-mcp">
                    <span class="nav-item-icon icon-mcp-nav"></span>
                    <span class="nav-label">MCP Servers</span>
                    <span class="nav-badge" id="mcp-servers-badge" style="display: none;">0</span>
                </button>
                <button class="nav-item" data-view="claude-code" title="Claude Code" id="nav-claude-code">
                    <img src="/assets/Claude.png" alt="" class="nav-item-logo" onerror="this.style.display='none'">
                    <span class="nav-label">Claude Code</span>
                </button>
            </div>

            <div class="nav-footer">
                <div class="nav-status">
                    <span id="nav-status-dot" class="status-dot"></span>
                    <span id="nav-status-text" class="nav-status-text" data-i18n="status.offline">Offline</span>
                    <span id="nav-version" class="nav-version"></span>
                </div>
                <button class="nav-collapse-btn" id="nav-collapse-btn" title="Collapse sidebar">
                    <span class="collapse-icon">‚óÄ</span>
                </button>
            </div>
        </nav>

        <!-- Sidebar Resize Handle -->
        <div class="nav-resize-handle" id="nav-resize-handle"></div>

        <!-- Main App Container -->
        <div class="app-container">
            <!-- App Header -->
            <header class="app-header">
                <div class="header-content">
                    <div class="header-title">
                        <h1 id="view-title"><img src="/assets/vllm-logo.svg" alt="vLLM" class="view-title-logo"> vLLM Server</h1>
                    </div>
                    <div class="header-right">
                        <div id="container-runtime-status" class="header-feature-status" title="Container Runtime">
                            <span class="feature-status-dot"></span>
                            <span class="feature-status-text">Checking...</span>
                        </div>
                        <div class="status-indicator">
                            <span id="status-dot" class="status-dot"></span>
                            <span id="status-text">Disconnected</span>
                            <span id="uptime" class="uptime"></span>
                        </div>
                        <button id="theme-toggle" class="theme-toggle-btn" title="Toggle dark/light mode">
                            <span class="theme-icon">‚óê</span>
                            <span class="theme-label">Dark</span>
                        </button>
                        <!-- Language selector will be inserted here by i18n.js -->
                        <div id="language-selector-container"></div>
                    </div>
                </div>
            </header>

            <!-- vLLM Server View -->
            <div class="view-content active" id="vllm-server-view">
                <!-- Main Content - Two Row Layout -->
                <div class="main-content-wrapper">
                    <!-- Row 1: Config | Chat | Metrics -->
                    <div class="main-content-row">
                    <!-- Left Sidebar - Configuration -->
                    <aside class="sidebar resizable" id="config-panel">
                        <div class="panel">
                            <h2 data-i18n="serverConfig.title">‚öôÔ∏è Server Configuration</h2>

                            <!-- Model Source Toggle -->
                            <div class="form-group mode-toggle-group">
                                <label data-i18n="serverConfig.modelSource.label">Model Source</label>
                                <div class="mode-toggle-buttons">
                                    <label class="mode-button active" id="model-source-hub-label">
                                        <input type="radio" name="model-source" id="model-source-hub" value="hub" checked>
                                        <span class="mode-button-content"><span class="mode-icon">ü§ó</span><span class="mode-label" data-i18n="serverConfig.modelSource.huggingface">HuggingFace</span></span>
                                    </label>
                                    <label class="mode-button" id="model-source-modelscope-label">
                                        <input type="radio" name="model-source" id="model-source-modelscope" value="modelscope">
                                        <span class="mode-button-content"><span class="mode-icon">üîÆ</span><span class="mode-label" data-i18n="serverConfig.modelSource.modelscope">ModelScope</span></span>
                                    </label>
                                    <label class="mode-button" id="model-source-local-label">
                                        <input type="radio" name="model-source" id="model-source-local" value="local">
                                        <span class="mode-button-content"><span class="mode-icon">üìÇ</span><span class="mode-label" data-i18n="serverConfig.modelSource.local">Local</span></span>
                                    </label>
                                </div>
                                <small class="form-help" id="model-source-help-text" data-i18n="serverConfig.modelSource.help">Select model from HuggingFace, ModelScope, or local directory</small>
                            </div>

                            <!-- HuggingFace Hub Model Selection (default visible) -->
                            <div id="hub-model-section" class="form-group">
                                <label for="model-select" data-i18n="serverConfig.model.label">Model</label>
                                <select id="model-select" class="form-control">
                                    <!-- CPU-Optimized Models (Recommended for macOS) -->
                                    <optgroup label="üñ•Ô∏è CPU-Friendly Models">
                                        <option value="TinyLlama/TinyLlama-1.1B-Chat-v1.0" selected>TinyLlama 1.1B Chat (Fast, No token)</option>
                                        <option value="meta-llama/Llama-3.2-1B-Instruct">Llama 3.2 1B Instruct (Gated, needs HF token)</option>
                                    </optgroup>
                                    <!-- Larger Models (Slower on CPU) -->
                                    <optgroup label="üéÆ GPU-Optimized Models (Slow on CPU)">
                                        <option value="Qwen/Qwen2.5-3B-Instruct">Qwen 2.5 3B Instruct</option>
                                        <option value="mistralai/Mistral-7B-Instruct-v0.2">Mistral 7B Instruct</option>
                                        <option value="RedHatAI/Llama-3.2-1B-Instruct-FP8">Llama 3.2 1B Instruct FP8 (Gated, needs HF token)</option>
                                        <option value="RedHatAI/Llama-3.1-8B-Instruct">Llama 3.1 8B Instruct (Gated, needs HF token)</option>
                                    </optgroup>
                                </select>
                                <small class="form-help">All models support chat interface. Gated models require HF token below.</small>
                                <input type="text" id="custom-model" class="form-control" placeholder="Or enter custom model name">

                                <!-- Community Recipes Button -->
                                <button id="browse-recipes-btn" class="btn btn-secondary btn-sm browse-recipes-btn" data-i18n="serverConfig.model.browseRecipes">
                                    üìö Browse Community Recipes
                                </button>
                            </div>

                            <!-- ModelScope Model Selection (hidden by default) -->
                            <div id="modelscope-model-section" class="form-group" style="display: none;">
                                <label for="modelscope-model-select" data-i18n="serverConfig.model.label">Model</label>
                                <select id="modelscope-model-select" class="form-control">
                                    <!-- Popular Models on ModelScope -->
                                    <optgroup label="üñ•Ô∏è CPU-Friendly Models">
                                        <option value="Qwen/Qwen2.5-0.5B-Instruct" selected>Qwen 2.5 0.5B Instruct (Fast)</option>
                                        <option value="Qwen/Qwen2.5-1.5B-Instruct">Qwen 2.5 1.5B Instruct</option>
                                    </optgroup>
                                    <optgroup label="üéÆ GPU-Optimized Models">
                                        <option value="Qwen/Qwen2.5-3B-Instruct">Qwen 2.5 3B Instruct</option>
                                        <option value="Qwen/Qwen2.5-Coder-7B-Instruct">Qwen 2.5 Coder 7B Instruct</option>
                                        <option value="deepseek-ai/DeepSeek-R1-Distill-Qwen-7B">DeepSeek R1 Distill Qwen 7B</option>
                                    </optgroup>
                                </select>
                                <small class="form-help" data-i18n="serverConfig.modelscope.help">Models from ModelScope (È≠îÊê≠Á§æÂå∫) - optimized for China region access.</small>
                                <input type="text" id="custom-modelscope-model" class="form-control" placeholder="Or enter custom ModelScope model ID">
                            </div>

                            <!-- Local Model Path Section (hidden by default) -->
                            <div id="local-model-section" class="form-group" style="display: none;">
                                <label for="local-model-path">Local Model Directory Path</label>
                                <input type="text" id="local-model-path" class="form-control" placeholder="~/models/my-model or /absolute/path/to/model">
                                <div class="local-path-buttons">
                                    <button id="browse-folder-btn" class="btn btn-secondary btn-sm" title="Browse for folder">
                                        üìÅ Browse
                                    </button>
                                    <button id="validate-path-btn" class="btn btn-secondary btn-sm" title="Validate path">
                                        Validate
                                    </button>
                                </div>
                                <small class="form-help">Enter absolute path to directory containing model files (config.json, weights, etc.). Supports ~ for home directory.</small>

                                <!-- Validation Status -->
                                <div id="local-model-validation" class="validation-status" style="display: none; margin-top: 8px;">
                                    <span id="validation-icon"></span>
                                    <span id="validation-message"></span>
                                </div>

                                <!-- Model Info Display -->
                                <div id="local-model-info" class="model-info-box" style="display: none; margin-top: 10px; padding: 10px; background: #1e293b; border-radius: 6px; border-left: 3px solid #10b981;">
                                    <div class="info-row">
                                        <span class="info-label">Model Name:</span>
                                        <span id="info-model-name" class="info-value">-</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="info-label">Model Type:</span>
                                        <span id="info-model-type" class="info-value">-</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="info-label">Size:</span>
                                        <span id="info-model-size" class="info-value">-</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="info-label">Has Tokenizer:</span>
                                        <span id="info-has-tokenizer" class="info-value">-</span>
                                    </div>
                                </div>
                            </div>

                            <!-- HuggingFace Token for Gated Models -->
                            <div class="form-group" id="hf-token-section">
                                <label for="hf-token" data-i18n="serverConfig.hfToken.label">HuggingFace Token (Optional)</label>
                                <input type="password" id="hf-token" class="form-control" placeholder="hf_xxxxxxxxxxxxx">
                                <small class="form-help" data-i18n-html="serverConfig.hfToken.help">Required for gated models (Llama 3.1, Llama 3.2). Get token from <a href="https://huggingface.co/settings/tokens" target="_blank">HuggingFace Settings</a></small>
                            </div>

                            <!-- ModelScope Token (hidden by default) -->
                            <div class="form-group" id="modelscope-token-section" style="display: none;">
                                <label for="modelscope-token" data-i18n="serverConfig.modelscopeToken.label">ModelScope Token (Optional)</label>
                                <input type="password" id="modelscope-token" class="form-control" placeholder="Your ModelScope SDK token">
                                <small class="form-help" data-i18n-html="serverConfig.modelscopeToken.help">Required for some models. Get token from <a href="https://www.modelscope.cn/my/myaccesstoken" target="_blank">ModelScope Settings</a></small>
                                <small class="form-help" id="modelscope-install-hint" style="display: none; color: var(--warning-color);" data-i18n-html="serverConfig.modelscopeToken.installHint">‚ö†Ô∏è Requires: <code>pip install modelscope>=1.18.1</code></small>
                            </div>

                            <!-- Run Mode Toggle -->
                            <div class="form-group mode-toggle-group">
                                <label data-i18n="serverConfig.runMode.label">Run Mode</label>
                                <div class="mode-toggle-buttons">
                                    <label class="mode-button" id="run-mode-subprocess-label">
                                        <input type="radio" name="run-mode" id="run-mode-subprocess" value="subprocess">
                                        <span data-i18n="serverConfig.runMode.subprocess">‚ö° Subprocess</span>
                                    </label>
                                    <label class="mode-button active" id="run-mode-container-label">
                                        <input type="radio" name="run-mode" id="run-mode-container" value="container" checked>
                                        <span data-i18n="serverConfig.runMode.container">üì¶ Container</span>
                                    </label>
                                </div>
                                <small class="form-help" id="run-mode-help-text" data-i18n="serverConfig.runMode.help">Container: Isolated (recommended), Subprocess: Direct (requires vLLM installed)</small>
                                <div class="subprocess-tip" data-i18n="serverConfig.runMode.subprocessTip">
                                    üí° Tip: Use subprocess mode for additional accelerators (Huawei Ascend, Intel Gaudi, AWS Neuron) with vLLM + hardware plugin installed on the host.
                                </div>
                            </div>

                            <!-- Virtual Environment Path (optional) - Only for Subprocess mode -->
                            <div class="form-group" id="venv-path-group" style="display: none;">
                                <label for="venv-path" data-i18n="serverConfig.venvPath.label">Custom Virtual Environment Path (Optional)</label>
                                <input
                                    type="text"
                                    id="venv-path"
                                    class="form-control"
                                    placeholder="~/.venv-vllm-metal"
                                    data-i18n-placeholder="serverConfig.venvPath.placeholder"
                                >
                                <small class="form-help" data-i18n="serverConfig.venvPath.help">Specify path to a virtual environment containing vLLM or vLLM-Metal. Leave empty to use system Python.</small>
                            </div>

                            <!-- CPU/GPU Mode Toggle -->
                            <div class="form-group mode-toggle-group">
                                <label data-i18n="serverConfig.computeMode.label">Compute Mode</label>
                                <div class="mode-toggle-buttons">
                                    <label class="mode-button active" id="mode-cpu-label">
                                        <input type="radio" name="compute-mode" id="mode-cpu" value="cpu" checked>
                                        <span data-i18n="serverConfig.computeMode.cpu">üñ•Ô∏è CPU</span>
                                    </label>
                                    <label class="mode-button" id="mode-gpu-label">
                                        <input type="radio" name="compute-mode" id="mode-gpu" value="gpu">
                                        <span data-i18n="serverConfig.computeMode.gpu">üéÆ GPU</span>
                                    </label>
                                    <label class="mode-button" id="mode-metal-label">
                                        <input type="radio" name="compute-mode" id="mode-metal" value="metal">
                                        <span data-i18n="serverConfig.computeMode.metal">‚ö° Metal</span>
                                    </label>
                                </div>
                                <!-- Accelerator Selection (separate line, shown when GPU mode selected) -->
                                <div class="accelerator-row" id="accelerator-row" style="display: none;">
                                    <label for="accelerator-select" data-i18n="serverConfig.accelerator.label">Accelerator</label>
                                    <select id="accelerator-select" class="form-control">
                                        <option value="nvidia" data-i18n="serverConfig.accelerator.nvidia">NVIDIA (CUDA)</option>
                                        <option value="amd" data-i18n="serverConfig.accelerator.amd">AMD (ROCm)</option>
                                        <option value="tpu" data-i18n="serverConfig.accelerator.tpu">Google TPU</option>
                                    </select>
                                </div>
                                <small class="form-help" id="mode-help-text" data-i18n="serverConfig.computeMode.help">CPU mode is recommended for macOS</small>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="host" data-i18n="serverConfig.host.label">Host</label>
                                    <input type="text" id="host" class="form-control" value="0.0.0.0">
                                </div>
                                <div class="form-group">
                                    <label for="port" data-i18n="serverConfig.port.label">Port</label>
                                    <input type="number" id="port" class="form-control" value="8000">
                                </div>
                            </div>

                            <!-- GPU-specific settings (hidden in CPU mode) -->
                            <div id="gpu-settings">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="tensor-parallel">Tensor Parallel Size</label>
                                        <input type="number" id="tensor-parallel" class="form-control" value="1" min="1">
                                    </div>
                                    <div class="form-group">
                                        <label for="gpu-memory">GPU Memory (%)</label>
                                        <input type="number" id="gpu-memory" class="form-control" value="90" min="10" max="100" step="5">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="gpu-device">GPU Device (optional)</label>
                                    <input type="text" id="gpu-device" class="form-control" placeholder="0, 1, 0,1 (leave empty for auto)">
                                    <small class="form-help">Specify GPU device ID(s): 0, 1, 0,1, etc. Leave empty for auto-selection.</small>
                                </div>

                                <!-- GPU Status Display -->
                                <div id="gpu-status-display" class="gpu-status-panel" style="display: none;">
                                    <div class="panel-header">
                                        <h3>üéÆ GPU Status</h3>
                                        <span id="gpu-status-refresh" class="refresh-indicator" title="Auto-refresh every 5 seconds">üîÑ</span>
                                    </div>
                                    <div id="gpu-status-content" class="gpu-status-content">
                                        <div class="gpu-loading">Loading GPU status...</div>
                                    </div>
                                </div>
                            </div>

                            <!-- CPU-specific settings (shown in CPU mode) -->
                            <div id="cpu-settings" style="display: block;">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="cpu-kvcache" data-i18n="serverConfig.cpuSettings.kvcache">CPU KV Cache Space (GB)</label>
                                        <input type="number" id="cpu-kvcache" class="form-control" value="4" min="1" max="200">
                                        <small class="form-help" data-i18n="serverConfig.cpuSettings.kvcacheHelp">Memory allocated for KV cache (start with 4GB)</small>
                                    </div>
                                    <div class="form-group">
                                        <label for="cpu-threads" data-i18n="serverConfig.cpuSettings.threads">CPU Thread Binding</label>
                                        <select id="cpu-threads" class="form-control">
                                            <option value="auto" data-i18n="serverConfig.cpuSettings.threadsAuto">Auto (Recommended)</option>
                                            <option value="cores" data-i18n="serverConfig.cpuSettings.threadsCores">Cores</option>
                                            <option value="none" data-i18n="serverConfig.cpuSettings.threadsNone">None</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="dtype" data-i18n="serverConfig.dtype.label">Data Type</label>
                                <select id="dtype" class="form-control">
                                    <option value="auto" data-i18n="serverConfig.dtype.auto">Auto</option>
                                    <option value="float16" data-i18n="serverConfig.dtype.float16">Float16</option>
                                    <option value="bfloat16" selected data-i18n="serverConfig.dtype.bfloat16">BFloat16</option>
                                    <option value="float32" data-i18n="serverConfig.dtype.float32">Float32</option>
                                </select>
                                <small class="form-help" id="dtype-help-text" data-i18n="serverConfig.dtype.help">BFloat16 recommended for CPU</small>
                            </div>

                            <div class="form-group">
                                <label for="max-model-len" data-i18n="serverConfig.maxModelLen.label">Max Model Length (optional)</label>
                                <input type="number" id="max-model-len" class="form-control" placeholder="2048 (CPU/Metal) / 8192 (GPU)">
                                <small class="form-help" data-i18n="serverConfig.maxModelLen.help">Leave empty to use safe defaults: 2048 (CPU/Metal) or 8192 (GPU)</small>
                            </div>

                            <!-- Advanced: Chat Template Settings -->
                            <div class="template-settings-section">
                                <div class="template-settings-header" id="template-settings-toggle">
                                    <h3>Chat Template Reference (Advanced)</h3>
                                    <span class="toggle-icon">‚ñº</span>
                                </div>
                                <div class="template-settings-content" id="template-settings-content" style="display: none;">
                                    <div class="info-box" style="background: #1e40af20; border-left: 3px solid #1e40af; padding: 10px; margin-bottom: 15px; border-radius: 4px;">
                                        <strong>‚ÑπÔ∏è Note:</strong> vLLM automatically loads chat templates and stop tokens from each model's tokenizer config. The fields below show reference templates for documentation purposes only. Modern models (2023+) all have built-in templates that work correctly.
                                    </div>

                                    <div class="form-group">
                                        <label for="chat-template">Chat Template (Jinja2) <span style="color: #10b981; font-size: 0.85em;">üîÑ Reference Only</span></label>
                                        <textarea id="chat-template" class="form-control template-textarea" rows="4" spellcheck="false" placeholder="Will be loaded from model's tokenizer config..." readonly></textarea>
                                        <small class="form-help">vLLM automatically uses the model's chat template from tokenizer config. Shown for reference only.</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="stop-tokens">Stop Tokens (comma-separated) <span style="color: #10b981; font-size: 0.85em;">üîÑ Reference Only</span></label>
                                        <input type="text" id="stop-tokens" class="form-control" placeholder="Will be loaded from model's tokenizer config..." readonly>
                                        <small class="form-help">vLLM automatically handles stop tokens via chat template. Shown for reference only. Use 'custom_stop_tokens' in server config to override.</small>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group checkbox-group">
                                <label>
                                    <input type="checkbox" id="trust-remote-code">
                                    <span data-i18n="serverConfig.checkboxes.trustRemoteCode">Trust Remote Code</span>
                                </label>
                            </div>

                            <div class="form-group checkbox-group">
                                <label>
                                    <input type="checkbox" id="enable-prefix-caching">
                                    <span data-i18n="serverConfig.checkboxes.enablePrefixCaching">Enable Prefix Caching</span>
                                </label>
                            </div>

                            <!-- Tool Calling Server Settings -->
                            <div class="form-group checkbox-group">
                                <label>
                                    <input type="checkbox" id="enable-tool-calling">
                                    <span data-i18n="serverConfig.checkboxes.enableToolCalling">Enable Tool Calling</span>
                                </label>
                            </div>

                            <div class="form-group" id="tool-parser-group">
                                <label>Tool Call Parser</label>
                                <select id="tool-call-parser" class="form-control">
                                    <option value="">Auto-detect</option>
                                    <option value="llama3_json">Llama 3.x (llama3_json)</option>
                                    <option value="mistral">Mistral</option>
                                    <option value="hermes">Hermes / Qwen</option>
                                    <option value="internlm">InternLM</option>
                                    <option value="granite-20b-fc">IBM Granite</option>
                                    <option value="pythonic">Pythonic (experimental)</option>
                                </select>
                                <small class="form-hint">Parser for model tool call output. Auto-detect uses model name.</small>
                            </div>

                            <!-- Served Model Name (for Claude Code) -->
                            <div class="form-group" id="served-model-name-group">
                                <label for="served-model-name">Served Model Name (Optional)</label>
                                <input type="text" id="served-model-name" class="form-control" placeholder="e.g., my-model">
                                <small class="form-help">Alias for the model in API calls. <strong>Required for Claude Code</strong> (cannot contain '/').</small>
                            </div>

                            <!-- Command Preview Section -->
                            <div class="command-preview-section">
                                <div class="command-preview-header">
                                    <h3 data-i18n="serverConfig.commandPreview.title">Command Preview</h3>
                                    <button id="copy-command-btn" class="btn btn-secondary btn-sm" title="Copy command" data-i18n="serverConfig.commandPreview.copy">Copy</button>
                                </div>
                                <textarea id="command-text" class="command-preview-textarea" rows="8" spellcheck="false">python -m vllm.entrypoints.openai.api_server --model facebook/opt-125m</textarea>
                                <small class="command-help" data-i18n="serverConfig.commandPreview.help">Editable for customization. Copy to run manually. "Start Server" uses settings above.</small>
                            </div>

                            <div class="button-group">
                                <button id="start-btn" class="btn btn-primary" data-i18n="serverConfig.buttons.start">Start Server</button>
                                <button id="stop-btn" class="btn btn-danger" disabled data-i18n="serverConfig.buttons.stop">Stop Server</button>
                            </div>
                        </div>
                        <div class="resize-handle resize-handle-vertical" data-direction="horizontal"></div>
                    </aside>

                    <!-- Center - Chat Interface -->
                    <main class="chat-section resizable" id="chat-panel">
                        <div class="panel">
                            <div class="panel-header">
                                <h2 data-i18n="chat.title">üí¨ Chat Interface</h2>
                                <div class="chat-header-actions">
                                    <button id="export-chat-btn" class="btn btn-secondary btn-sm" style="min-width: 80px; padding: 6px 16px;" data-i18n="chat.export">Export</button>
                                    <button id="clear-chat-btn" class="btn btn-secondary btn-sm" style="min-width: 80px; padding: 6px 16px;" data-i18n="chat.clear">Clear</button>
                                </div>
                            </div>

                            <div id="chat-container" class="chat-container">
                                <div class="chat-message system">
                                    <div class="message-content">
                                        <span class="message-text" data-i18n="chat.welcomeMessage">Welcome! Try different options in the toolbar to customize your chat experience.</span>
                                    </div>
                                </div>
                            </div>

                            <div class="chat-input-area">
                                <!-- Main Input Group -->
                                <div class="input-group">
                                    <textarea id="chat-input" class="chat-input" data-i18n-placeholder="chat.inputPlaceholder" placeholder="Type your message here..." rows="1"></textarea>
                                    <button id="send-btn" class="btn btn-primary" disabled data-i18n="chat.send">Send</button>
                                </div>

                                <!-- Inline Expandable Panels -->
                                <div class="inline-panels">
                                    <!-- System Settings Panel -->
                                    <div class="inline-panel" id="panel-settings" style="display: none;">
                                        <div class="inline-panel-header">
                                            <span class="inline-panel-title"><span class="panel-icon icon-settings"></span> Chat Settings</span>
                                            <button class="inline-panel-close" data-panel="settings">‚úï</button>
                                        </div>
                                        <div class="inline-panel-content">
                                            <div class="param-row">
                                                <div class="param-group">
                                                    <label>Temperature: <input type="number" id="temp-value" class="param-value-input" min="0" max="2" step="0.05" value="0.7"></label>
                                                    <input type="range" id="temperature" min="0" max="2" step="0.05" value="0.7">
                                                    <small class="form-help">Lower = focused, Higher = creative</small>
                                                </div>
                                                <div class="param-group">
                                                    <label>Max Tokens: <input type="number" id="tokens-value" class="param-value-input" min="1" max="4096" step="1" value="256"></label>
                                                    <input type="range" id="max-tokens" min="1" max="4096" step="1" value="256">
                                                    <small class="form-help">Maximum response length</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- System Prompt Panel -->
                                    <div class="inline-panel" id="panel-prompt" style="display: none;">
                                        <div class="inline-panel-header">
                                            <span class="inline-panel-title"><span class="panel-icon icon-prompt"></span> System Prompt</span>
                                            <button class="inline-panel-close" data-panel="prompt">‚úï</button>
                                        </div>
                                        <div class="inline-panel-content panel-grid">
                                            <textarea id="system-prompt" class="system-prompt-input" rows="3" placeholder="Set system prompt (e.g., 'You are a helpful coding assistant')">You are a helpful assistant.</textarea>
                                            <div class="panel-btn-stack">
                                                <button id="clear-system-prompt-btn" class="btn btn-secondary">Clear</button>
                                                <select id="system-prompt-template" class="btn btn-secondary">
                                                    <option value="">Templates ‚ñº</option>
                                                    <option value="default">Default</option>
                                                    <option value="helpful">Helpful Assistant</option>
                                                    <option value="coder">Code Assistant</option>
                                                    <option value="writer">Creative Writer</option>
                                                    <option value="teacher">Teacher</option>
                                                    <option value="translator">Translator</option>
                                                    <option value="analyst">Data Analyst</option>
                                                    <option value="concise">Concise</option>
                                                </select>
                                            </div>
                                            <small class="form-help panel-grid-full">Sent with every message to set behavior</small>
                                        </div>
                                    </div>

                                    <!-- Structured Outputs Panel -->
                                    <div class="inline-panel" id="panel-structured" style="display: none;">
                                        <div class="inline-panel-header">
                                            <span class="inline-panel-title"><span class="panel-icon icon-structured"></span> Structured Outputs</span>
                                            <a href="https://docs.vllm.ai/en/latest/features/structured_outputs/" target="_blank" class="panel-doc-link" title="Open vLLM Docs">üìñ Docs</a>
                                            <button class="inline-panel-close" data-panel="structured">‚úï</button>
                                        </div>
                                        <div class="inline-panel-content inline-panel-scrollable">
                                            <div class="form-group checkbox-group">
                                                <label><input type="checkbox" id="structured-enabled"><span>Enable Structured Outputs</span></label>
                                            </div>
                                            <div id="structured-options" style="display: none;">
                                                <div class="panel-warning-tip">
                                                    <span class="warning-icon">‚ö†Ô∏è</span>
                                                    <span class="warning-text"><strong>CPU Mode:</strong> Requires <code>dtype=float32</code>. Using bfloat16/float16 on CPU will cause errors.</span>
                                                </div>
                                                <div class="form-group">
                                                    <label>Output Type:</label>
                                                    <div class="output-type-buttons">
                                                        <button class="output-type-btn active" data-type="choice">Choice</button>
                                                        <button class="output-type-btn" data-type="regex">Regex</button>
                                                        <button class="output-type-btn" data-type="json">JSON</button>
                                                        <button class="output-type-btn" data-type="grammar">Grammar</button>
                                                    </div>
                                                </div>
                                                <div id="structured-choice-config" class="structured-config">
                                                    <div class="form-group">
                                                        <label>Choices (comma-separated):</label>
                                                        <input type="text" id="structured-choices" class="form-control" placeholder="positive, negative, neutral">
                                                    </div>
                                                    <div class="preset-buttons">
                                                        <button class="btn btn-secondary btn-xs structured-preset-btn" data-preset="sentiment">Sentiment</button>
                                                        <button class="btn btn-secondary btn-xs structured-preset-btn" data-preset="yesno">Yes/No</button>
                                                        <button class="btn btn-secondary btn-xs structured-preset-btn" data-preset="rating">Rating</button>
                                                    </div>
                                                </div>
                                                <div id="structured-regex-config" class="structured-config" style="display: none;">
                                                    <div class="form-group">
                                                        <label>Regex Pattern:</label>
                                                        <input type="text" id="structured-regex" class="form-control" placeholder="\w+@\w+\.com">
                                                    </div>
                                                    <div class="preset-buttons">
                                                        <button class="btn btn-secondary btn-xs structured-preset-btn" data-preset="email">Email</button>
                                                        <button class="btn btn-secondary btn-xs structured-preset-btn" data-preset="phone">Phone</button>
                                                        <button class="btn btn-secondary btn-xs structured-preset-btn" data-preset="date">Date</button>
                                                    </div>
                                                </div>
                                                <div id="structured-json-config" class="structured-config" style="display: none;">
                                                    <div class="form-group">
                                                        <label>Schema Name:</label>
                                                        <input type="text" id="structured-json-name" class="form-control" placeholder="response">
                                                    </div>
                                                    <div class="form-group">
                                                        <label>JSON Schema:</label>
                                                        <textarea id="structured-json-schema" class="form-control code-textarea" rows="4" placeholder='{"type": "object", "properties": {...}}'></textarea>
                                                    </div>
                                                    <div class="preset-buttons">
                                                        <button class="btn btn-secondary btn-xs structured-preset-btn" data-preset="person">Person</button>
                                                        <button class="btn btn-secondary btn-xs structured-preset-btn" data-preset="product">Product</button>
                                                        <button class="btn btn-secondary btn-xs structured-preset-btn" data-preset="api">API</button>
                                                    </div>
                                                </div>
                                                <div id="structured-grammar-config" class="structured-config" style="display: none;">
                                                    <div class="form-group">
                                                        <label>EBNF Grammar:</label>
                                                        <textarea id="structured-grammar" class="form-control code-textarea" rows="4" placeholder="root ::= expression..."></textarea>
                                                    </div>
                                                    <div class="preset-buttons">
                                                        <button class="btn btn-secondary btn-xs structured-preset-btn" data-preset="sql">SQL</button>
                                                        <button class="btn btn-secondary btn-xs structured-preset-btn" data-preset="arithmetic">Math</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Tool Calling Panel -->
                                    <div class="inline-panel" id="panel-tools" style="display: none;">
                                        <div class="inline-panel-header">
                                            <span class="inline-panel-title"><span class="panel-icon icon-tools"></span> Tool Calling</span>
                                            <a href="https://docs.vllm.ai/en/latest/features/tool_calling/" target="_blank" class="panel-doc-link" title="Open vLLM Docs">üìñ Docs</a>
                                            <button class="inline-panel-close" data-panel="tools">‚úï</button>
                                        </div>
                                        <div class="inline-panel-content inline-panel-scrollable">
                                            <!-- Server tool calling status banner -->
                                            <div id="tool-server-warning" class="tool-server-warning" style="display: none;">
                                                <span class="warning-icon">‚ö†Ô∏è</span>
                                                <span class="warning-text">Tool calling is disabled on the server. Enable it in Server Configuration and restart.</span>
                                            </div>
                                            <div id="tool-server-status" class="tool-server-status" style="display: none;">
                                                <span class="status-icon">‚úì</span>
                                                <span class="status-text">Server ready for tool calling (<span id="tool-parser-display">auto</span>)</span>
                                            </div>
                                            <div class="tool-choice-row">
                                                <div class="form-group" style="flex: 1;">
                                                    <label>Tool Choice:</label>
                                                    <select id="tool-choice" class="form-control">
                                                        <option value="">None</option>
                                                        <option value="auto" selected>Auto (recommended)</option>
                                                    </select>
                                                </div>
                                                <div class="form-group checkbox-group">
                                                    <label><input type="checkbox" id="parallel-tool-calls"><span>Parallel</span></label>
                                                </div>
                                            </div>
                                            <div class="tool-presets-row">
                                                <label>Presets:</label>
                                                <div class="preset-buttons">
                                                    <button class="btn btn-secondary btn-xs tool-preset-btn" data-preset="weather">üå§Ô∏è Weather</button>
                                                    <button class="btn btn-secondary btn-xs tool-preset-btn" data-preset="calculator">üî¢ Calc</button>
                                                    <button class="btn btn-secondary btn-xs tool-preset-btn" data-preset="search">üîç Search</button>
                                                </div>
                                            </div>
                                            <div class="tools-list-container">
                                                <div class="tools-list-header">
                                                    <span>Tools (<span id="tools-count">0</span>)</span>
                                                    <div class="tools-list-actions">
                                                        <button id="add-tool-btn" class="btn btn-primary btn-xs">+ Add</button>
                                                        <button id="clear-tools-btn" class="btn btn-secondary btn-xs">Clear</button>
                                                    </div>
                                                </div>
                                                <div id="tools-list" class="tools-list">
                                                    <div class="tools-empty-state"><span>No tools defined</span></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- MCP Panel -->
                                    <div class="inline-panel" id="panel-mcp" style="display: none;">
                                        <div class="inline-panel-header">
                                            <span class="inline-panel-title"><span class="panel-icon icon-mcp"></span> MCP</span>
                                            <div class="mcp-enable-toggle">
                                                <span class="toggle-label">Enable</span>
                                                <label class="toggle-switch">
                                                    <input type="checkbox" id="mcp-chat-enabled" disabled>
                                                    <span class="toggle-slider"></span>
                                                </label>
                                            </div>
                                            <button class="inline-panel-close" data-panel="mcp"><span class="icon-mcp-close"></span></button>
                                        </div>
                                        <div class="inline-panel-content">
                                            <!-- MCP Not Available Message -->
                                            <div class="mcp-chat-unavailable" id="mcp-chat-unavailable">
                                                <div class="unavailable-icon"><span class="icon-mcp-warning icon-xl"></span></div>
                                                <p>MCP not installed</p>
                                                <code>pip install vllm-playground[mcp]</code>
                                                <a href="#" id="mcp-chat-goto-config" class="link-btn">Configure MCP ‚Üí</a>
                                            </div>

                                            <!-- MCP Disabled View -->
                                            <div class="mcp-chat-disabled" id="mcp-chat-disabled" style="display: none;">
                                                <p>Enable MCP to use tools from configured servers</p>
                                                <a href="#" id="mcp-chat-goto-config-2" class="link-btn">Configure MCP Servers ‚Üí</a>
                                            </div>

                                            <!-- MCP Enabled View -->
                                            <div class="mcp-chat-enabled" id="mcp-chat-enabled-view" style="display: none;">
                                                <!-- Info Tips -->
                                                <div class="mcp-info-tip">
                                                    <span class="info-icon">üí°</span>
                                                    <span>Start vLLM with Tool Calling enabled. Set Max Model Length to 8192+. Use a larger model with tool calling capability (e.g., Qwen 2.5 7B+, Llama 3.1 8B+) for better results.</span>
                                                </div>

                                                <!-- No Servers Configured -->
                                                <div class="mcp-no-servers" id="mcp-chat-no-servers" style="display: none;">
                                                    <p>No MCP servers configured</p>
                                                    <a href="#" id="mcp-chat-goto-config-3" class="link-btn">Add MCP Server ‚Üí</a>
                                                </div>

                                                <!-- Server Selection -->
                                                <div class="mcp-server-selection" id="mcp-chat-server-selection">
                                                    <div class="selection-header">
                                                        <span>Select servers to use:</span>
                                                        <div class="selection-actions">
                                                            <button class="btn-link" id="mcp-select-all">All</button>
                                                            <button class="btn-link" id="mcp-select-none">None</button>
                                                        </div>
                                                    </div>
                                                    <div class="server-checkboxes" id="mcp-chat-server-checkboxes">
                                                        <!-- Dynamically populated by JavaScript -->
                                                    </div>
                                                </div>

                                                <!-- Tools Summary -->
                                                <div class="mcp-tools-summary" id="mcp-chat-tools-summary">
                                                    <span class="tools-icon"><span class="icon-mcp-tools"></span></span>
                                                    <span id="mcp-active-tools-count">0 tools</span>
                                                    <span>from</span>
                                                    <span id="mcp-active-servers-count">0 servers</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- RAG Panel -->
                                    <div class="inline-panel" id="panel-rag" style="display: none;">
                                        <div class="inline-panel-header">
                                            <span class="inline-panel-title"><span class="panel-icon icon-rag"></span> RAG</span>
                                            <a href="https://docs.vllm.ai/en/latest/deployment/frameworks/retrieval_augmented_generation/" target="_blank" class="panel-doc-link" title="Open vLLM Docs">üìñ Docs</a>
                                            <span class="coming-soon-badge">Coming Soon</span>
                                            <button class="inline-panel-close" data-panel="rag">‚úï</button>
                                        </div>
                                        <div class="inline-panel-content">
                                            <div class="mcp-placeholder">
                                                <p>Retrieval-Augmented Generation is under development.</p>
                                                <p>Upload documents and enhance responses with relevant context.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Icon Toolbar -->
                                <div class="chat-toolbar">
                                    <div class="toolbar-icons">
                                        <button class="toolbar-icon-btn" id="toolbar-settings" data-panel="settings">
                                            <span class="toolbar-icon icon-settings"></span>
                                            <span class="toolbar-tooltip">Chat Settings</span>
                                        </button>
                                        <button class="toolbar-icon-btn" id="toolbar-prompt" data-panel="prompt">
                                            <span class="toolbar-icon icon-prompt"></span>
                                            <span class="toolbar-tooltip">System Prompt</span>
                                        </button>
                                        <button class="toolbar-icon-btn" id="toolbar-structured" data-panel="structured">
                                            <span class="toolbar-icon icon-structured"></span>
                                            <span class="toolbar-tooltip">Structured Outputs</span>
                                        </button>
                                        <button class="toolbar-icon-btn" id="toolbar-tools" data-panel="tools">
                                            <span class="toolbar-icon icon-tools"></span>
                                            <span class="toolbar-tooltip">Tool Calling</span>
                                        </button>
                                        <button class="toolbar-icon-btn" id="toolbar-mcp" data-panel="mcp">
                                            <span class="toolbar-icon icon-mcp"></span>
                                            <span class="toolbar-tooltip">MCP Servers</span>
                                        </button>
                                        <button class="toolbar-icon-btn" id="toolbar-rag" data-panel="rag">
                                            <span class="toolbar-icon icon-rag"></span>
                                            <span class="toolbar-tooltip">RAG</span>
                                        </button>
                                    </div>
                                    <div class="toolbar-right">
                                        <select id="message-templates" class="message-templates">
                                            <option value="">Quick messages...</option>
                                            <option value="Hello!">Hello!</option>
                                            <option value="Hi, how are you?">Hi, how are you?</option>
                                            <option value="Can you help me with something?">Can you help me with something?</option>
                                            <option value="Thank you!">Thank you!</option>
                                            <option value="What can you do?">What can you do?</option>
                                            <option value="Tell me more about this.">Tell me more about this.</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Tool Editor Modal -->
                                <div id="tool-editor-modal" class="tool-editor-modal" style="display: none;">
                                    <div class="tool-editor-content">
                                        <div class="tool-editor-header">
                                            <h4 id="tool-editor-title">Add New Tool</h4>
                                            <button id="tool-editor-close" class="modal-close-btn" title="Close">‚úï</button>
                                        </div>
                                        <div class="tool-editor-body">
                                            <div class="form-group">
                                                <label for="tool-name"><span>Function Name</span><span class="required">*</span></label>
                                                <input type="text" id="tool-name" class="form-control" placeholder="e.g., get_weather" spellcheck="false" autocomplete="off">
                                                <small class="form-help">Use snake_case (letters, numbers, underscores)</small>
                                            </div>
                                            <div class="form-group">
                                                <label for="tool-description"><span>Description</span><span class="required">*</span></label>
                                                <textarea id="tool-description" class="form-control" rows="2" placeholder="What does this function do?"></textarea>
                                            </div>
                                            <div class="form-group">
                                                <div class="params-header">
                                                    <label><span>Parameters</span><span class="param-count" id="param-count">(0)</span></label>
                                                    <button type="button" id="add-param-btn" class="btn btn-secondary btn-xs">+ Add</button>
                                                </div>
                                                <div id="params-list" class="params-list">
                                                    <div class="params-empty">No parameters defined</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tool-editor-footer">
                                            <button id="tool-editor-cancel" class="btn btn-secondary">Cancel</button>
                                            <button id="tool-editor-save" class="btn btn-primary">Save</button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Parameter Template -->
                                <template id="param-template">
                                    <div class="param-item" data-param-index="">
                                        <div class="param-item-header">
                                            <div class="param-required-toggle">
                                                <input type="checkbox" class="param-required" title="Required">
                                                <span class="required-label">Required</span>
                                            </div>
                                            <button type="button" class="param-delete-btn" title="Remove">‚úï</button>
                                        </div>
                                        <div class="param-row">
                                            <div class="param-field param-name-field">
                                                <label>Name</label>
                                                <input type="text" class="form-control param-name" placeholder="param_name" spellcheck="false">
                                            </div>
                                            <div class="param-field param-type-field">
                                                <label>Type</label>
                                                <select class="form-control param-type">
                                                    <option value="string">String</option>
                                                    <option value="number">Number</option>
                                                    <option value="integer">Integer</option>
                                                    <option value="boolean">Boolean</option>
                                                    <option value="array">Array</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="param-field">
                                            <label>Description</label>
                                            <input type="text" class="form-control param-description" placeholder="What is this parameter for?">
                                        </div>
                                        <div class="param-field param-enum-field" style="display: none;">
                                            <label>Allowed Values <span class="optional">(comma-separated)</span></label>
                                            <input type="text" class="form-control param-enum" placeholder="e.g., celsius, fahrenheit">
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="resize-handle resize-handle-vertical" data-direction="horizontal"></div>
                    </main>

                    <!-- Right Panel - Metrics -->
                    <aside class="metrics-section resizable" id="metrics-panel">
                        <div class="panel">
                            <div class="panel-header">
                                <h2 data-i18n="metrics.title">üìä Response Metrics</h2>
                            </div>
                            <div id="chat-metrics" class="chat-metrics-grid">
                                <div class="chat-metric-item">
                                    <span class="metric-label" data-i18n="metrics.promptTokens">Prompt Tokens:</span>
                                    <span class="metric-value" id="metric-prompt-tokens">-</span>
                                </div>
                                <div class="chat-metric-item">
                                    <span class="metric-label" data-i18n="metrics.completionTokens">Completion Tokens:</span>
                                    <span class="metric-value" id="metric-completion-tokens">-</span>
                                </div>
                                <div class="chat-metric-item">
                                    <span class="metric-label" data-i18n="metrics.totalTokens">Total Tokens:</span>
                                    <span class="metric-value" id="metric-total-tokens">-</span>
                                </div>
                                <div class="chat-metric-item">
                                    <span class="metric-label" data-i18n="metrics.timeTaken">Time Taken:</span>
                                    <span class="metric-value" id="metric-time-taken">-</span>
                                </div>
                                <div class="chat-metric-item">
                                    <span class="metric-label" data-i18n="metrics.tokensPerSec">Tokens/sec:</span>
                                    <span class="metric-value" id="metric-tokens-per-sec">-</span>
                                </div>
                                <div class="chat-metric-item">
                                    <span class="metric-label" data-i18n="metrics.avgPromptThroughput">Avg Prompt Throughput:</span>
                                    <span class="metric-value" id="metric-prompt-throughput">-</span>
                                </div>
                                <div class="chat-metric-item">
                                    <span class="metric-label" data-i18n="metrics.avgGenerationThroughput">Avg Generation Throughput:</span>
                                    <span class="metric-value" id="metric-generation-throughput">-</span>
                                </div>
                                <div class="chat-metric-item">
                                    <span class="metric-label" data-i18n="metrics.gpuKvCacheUsage">GPU KV Cache Usage:</span>
                                    <span class="metric-value" id="metric-kv-cache-usage">-</span>
                                </div>
                                <div class="chat-metric-item">
                                    <span class="metric-label" data-i18n="metrics.prefixCacheHitRate">Prefix Cache Hit Rate:</span>
                                    <span class="metric-value" id="metric-prefix-cache-hit">-</span>
                                </div>
                            </div>
                        </div>
                    </aside>
                    </div>

                    <!-- Row 2: Server Logs (full width, collapsible) -->
                    <div class="logs-row" id="logs-row">
                        <div class="logs-row-header" id="logs-row-toggle">
                            <div class="logs-row-title">
                                <span class="logs-toggle-icon">‚ñº</span>
                                <h2 data-i18n="logs.title">üìã Server Logs</h2>
                            </div>
                            <div class="logs-row-controls">
                                <label class="auto-scroll-label">
                                    <input type="checkbox" id="auto-scroll" checked>
                                    <span data-i18n="logs.autoScroll">Auto-scroll</span>
                                </label>
                                <button id="save-logs-btn" class="btn btn-secondary btn-sm" data-i18n="logs.save">Save</button>
                                <button id="clear-logs-btn" class="btn btn-secondary btn-sm" data-i18n="logs.clear">Clear</button>
                            </div>
                        </div>
                        <div class="logs-row-content" id="logs-row-content">
                            <div id="logs-container" class="logs-container">
                                <div class="log-entry info">Waiting for connection...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GuideLLM View -->
            <div class="view-content" id="guidellm-view" style="display: none;">
                <div class="guidellm-layout">
                    <div class="panel guidellm-panel">
                        <div class="panel-header">
                            <h2><img src="/assets/guidellm-logo-light.png" alt="GuideLLM" class="panel-header-logo"> <span data-i18n="benchmark.title">Performance Benchmarking</span></h2>
                            <div class="guidellm-status-indicator" id="guidellm-status">
                                <span>Checking...</span>
                            </div>
                            <div class="metrics-controls" id="benchmark-controls">
                                <button id="run-benchmark-btn" class="btn btn-primary btn-sm" disabled data-i18n="benchmark.runBenchmark">Run Benchmark</button>
                                <button id="stop-benchmark-btn" class="btn btn-danger btn-sm" disabled style="display: none;" data-i18n="benchmark.stop">Stop</button>
                            </div>
                        </div>

                        <!-- GuideLLM Not Installed Warning -->
                        <div class="guidellm-install-warning" id="guidellm-install-warning" style="display: none;">
                            <div class="warning-icon"><span class="icon-guidellm-warning icon-lg"></span></div>
                            <h3>GuideLLM Not Installed</h3>
                            <p>Install GuideLLM to enable advanced benchmarking features:</p>
                            <div class="install-commands">
                                <code class="primary-cmd">pip install "vllm-playground[benchmark]"</code>
                                <span class="cmd-divider">or</span>
                                <code class="alt-cmd">pip install guidellm</code>
                            </div>
                            <p class="feature-note">Built-in benchmarking is still available without GuideLLM.</p>
                        </div>

                        <div id="metrics-section-content">
                            <!-- Server Status Banner -->
                            <div class="benchmark-server-status" id="benchmark-server-status">
                                <div class="server-status-content">
                                    <span class="status-icon">‚ö†Ô∏è</span>
                                    <span class="status-message" data-i18n="benchmark.startServerFirst">Start the vLLM server first to run benchmarks</span>
                                    <button class="btn btn-primary btn-sm" onclick="window.vllmUI.switchView('vllm-server')" data-i18n="benchmark.goToServer">Go to Server ‚Üí</button>
                                </div>
                            </div>

                            <!-- Benchmark Configuration -->
                            <div class="benchmark-config">
                                <!-- Benchmark Method Selection -->
                                <div class="config-row" style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #2a3142;">
                                    <div class="config-item" style="flex: 1;">
                                        <label style="font-weight: 600; margin-bottom: 8px; display: block;" data-i18n="benchmark.method.label">Benchmark Method:</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label style="display: flex; align-items: center; cursor: pointer;">
                                                <input type="radio" name="benchmark-method" id="benchmark-method-builtin" value="builtin" checked style="margin-right: 8px;">
                                                <span data-i18n="benchmark.method.builtin">Built-in (Fast)</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer;">
                                                <input type="radio" name="benchmark-method" id="benchmark-method-guidellm" value="guidellm" style="margin-right: 8px;">
                                                <span data-i18n="benchmark.method.guidellm">GuideLLM (Advanced)</span>
                                            </label>
                                        </div>
                                        <small class="form-help" style="display: block; margin-top: 5px;" data-i18n="benchmark.method.help">Built-in: Fast & simple. GuideLLM: More detailed metrics & HTML reports</small>
                                    </div>
                                </div>

                                <div class="config-row">
                                    <div class="config-item">
                                        <label for="benchmark-requests" data-i18n="benchmark.config.totalRequests">Total Requests:</label>
                                        <input type="number" id="benchmark-requests" class="form-control-sm" value="100" min="10" max="1000">
                                    </div>
                                    <div class="config-item">
                                        <label for="benchmark-rate" data-i18n="benchmark.config.requestRate">Request Rate (req/s):</label>
                                        <input type="number" id="benchmark-rate" class="form-control-sm" value="5" min="1" max="50">
                                    </div>
                                    <div class="config-item">
                                        <label for="benchmark-prompt-tokens" data-i18n="benchmark.config.promptTokens">Prompt Tokens:</label>
                                        <input type="number" id="benchmark-prompt-tokens" class="form-control-sm" value="100" min="10" max="2048">
                                    </div>
                                    <div class="config-item">
                                        <label for="benchmark-output-tokens" data-i18n="benchmark.config.outputTokens">Output Tokens:</label>
                                        <input type="number" id="benchmark-output-tokens" class="form-control-sm" value="100" min="10" max="2048">
                                    </div>
                                </div>
                            </div>

                            <!-- Command Preview Section -->
                            <div class="command-preview-section" style="margin-top: 15px;">
                                <div class="command-preview-header">
                                    <h3 data-i18n="benchmark.commandPreview.title">Command Preview</h3>
                                    <button id="copy-benchmark-command-btn" class="btn btn-secondary btn-sm" title="Copy command" data-i18n="benchmark.commandPreview.copy">Copy</button>
                                </div>
                                <textarea id="benchmark-command-text" class="command-preview-textarea" rows="6" spellcheck="false" readonly>guidellm --target http://localhost:8000/v1 --rate 5 --max-requests 100</textarea>
                                <small class="command-help" data-i18n="benchmark.commandPreview.help">Equivalent GuideLLM command for this benchmark configuration</small>
                            </div>

                            <!-- Raw GuideLLM Output Section -->
                            <div class="command-preview-section" id="guidellm-raw-output-section" style="margin-top: 15px; display: none;">
                                <div class="command-preview-header">
                                    <h3>GuideLLM Raw Output</h3>
                                    <div style="display: flex; gap: 8px;">
                                        <button id="toggle-raw-output-btn" class="btn btn-secondary btn-sm" title="Hide/Show raw output">Hide</button>
                                        <button id="copy-guidellm-output-btn" class="btn btn-secondary btn-sm" title="Copy output">Copy</button>
                                    </div>
                                </div>
                                <div id="guidellm-raw-output-content">
                                    <textarea id="guidellm-raw-output" class="command-preview-textarea" rows="15" spellcheck="false" readonly style="font-family: monospace; font-size: 11px;"></textarea>
                                    <small class="command-help">Complete output from GuideLLM benchmark</small>
                                </div>
                            </div>

                            <!-- GuideLLM JSON Output Section -->
                            <div class="command-preview-section" id="guidellm-json-output-section" style="margin-top: 15px; display: none;">
                                <div class="command-preview-header">
                                    <h3>üìä GuideLLM Benchmark Results (JSON)</h3>
                                    <div style="display: flex; gap: 8px;">
                                        <button id="toggle-json-output-btn" class="btn btn-secondary btn-sm" title="Hide/Show JSON output">Hide</button>
                                        <button id="copy-guidellm-json-btn" class="btn btn-secondary btn-sm" title="Copy JSON">Copy</button>
                                    </div>
                                </div>
                                <div id="guidellm-json-output-content">
                                    <pre id="guidellm-json-output" class="json-display" style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 6px; max-height: 500px; overflow: auto; font-family: 'Monaco', 'Menlo', 'Courier New', monospace; font-size: 12px; line-height: 1.5; margin: 0;"></pre>
                                    <small class="command-help">Structured benchmark data in JSON format</small>
                                </div>
                            </div>

                            <!-- GuideLLM Table View Section -->
                            <div class="benchmark-table-section" id="guidellm-table-section" style="margin-top: 15px; display: none;">
                                <div class="command-preview-header">
                                    <h3>üìà Benchmark Summary Table</h3>
                                </div>
                                <div id="guidellm-table-content" class="table-container">
                                    <!-- Tables will be populated here by JavaScript -->
                                </div>
                            </div>

                            <!-- Metrics Display -->
                            <div id="metrics-display" class="metrics-display">
                                <div class="metrics-placeholder">
                                    <p data-i18n="benchmark.noData">No benchmark data available</p>
                                    <p class="metrics-help" data-i18n="benchmark.noDataHelp">Start the vLLM server and click "Run Benchmark" to test performance</p>
                                </div>
                            </div>

                            <!-- Metrics Grid -->
                            <div id="metrics-grid" class="metrics-grid" style="display: none;">
                                <!-- Throughput Metrics -->
                                <div class="metric-card">
                                    <div class="metric-icon">üöÄ</div>
                                    <div class="metric-label">Throughput</div>
                                    <div class="metric-value" id="metric-throughput">-- req/s</div>
                                    <div class="metric-subtext">Requests per second</div>
                                </div>

                                <!-- Latency Metrics -->
                                <div class="metric-card">
                                    <div class="metric-icon">‚è±Ô∏è</div>
                                    <div class="metric-label">Avg Latency</div>
                                    <div class="metric-value" id="metric-latency">-- ms</div>
                                    <div class="metric-subtext">Mean response time</div>
                                </div>

                                <!-- Tokens per Second -->
                                <div class="metric-card">
                                    <div class="metric-icon">üìù</div>
                                    <div class="metric-label">Token Throughput</div>
                                    <div class="metric-value" id="benchmark-tokens-per-sec">-- tok/s</div>
                                    <div class="metric-subtext">Output tokens per second</div>
                                </div>

                                <!-- P50 Latency -->
                                <div class="metric-card">
                                    <div class="metric-icon">üìä</div>
                                    <div class="metric-label">P50 Latency</div>
                                    <div class="metric-value" id="metric-p50">-- ms</div>
                                    <div class="metric-subtext">50th percentile</div>
                                </div>

                                <!-- P95 Latency -->
                                <div class="metric-card">
                                    <div class="metric-icon">üìà</div>
                                    <div class="metric-label">P95 Latency</div>
                                    <div class="metric-value" id="metric-p95">-- ms</div>
                                    <div class="metric-subtext">95th percentile</div>
                                </div>

                                <!-- P99 Latency -->
                                <div class="metric-card">
                                    <div class="metric-icon">‚ö°</div>
                                    <div class="metric-label">P99 Latency</div>
                                    <div class="metric-value" id="metric-p99">-- ms</div>
                                    <div class="metric-subtext">99th percentile</div>
                                </div>

                                <!-- Total Tokens -->
                                <div class="metric-card">
                                    <div class="metric-icon">üí¨</div>
                                    <div class="metric-label">Total Tokens</div>
                                    <div class="metric-value" id="benchmark-total-tokens">--</div>
                                    <div class="metric-subtext">Input + Output tokens</div>
                                </div>

                                <!-- Success Rate -->
                                <div class="metric-card">
                                    <div class="metric-icon">‚úÖ</div>
                                    <div class="metric-label">Success Rate</div>
                                    <div class="metric-value" id="metric-success-rate">-- %</div>
                                    <div class="metric-subtext">Successful requests</div>
                                </div>
                            </div>

                            <!-- Benchmark Progress -->
                            <div id="benchmark-progress" class="benchmark-progress" style="display: none;">
                                <div class="progress-bar">
                                    <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                                </div>
                                <div class="progress-text">
                                    <span id="progress-status">Running benchmark...</span>
                                    <span id="progress-percent">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- vLLM-Omni View (template loaded dynamically from static/templates/vllm-omni.html) -->
            <div class="view-content" id="vllm-omni-view" style="display: none;">
                <div class="view-loading" id="omni-view-loading">
                    <span class="loading-spinner"></span>
                    <span>Loading vLLM-Omni...</span>
                </div>
            </div>

            <!-- MCP Configuration View -->
            <div class="view-content" id="mcp-config-view" style="display: none;">
                <div class="mcp-config-layout">
                    <div class="mcp-config-container">
                        <!-- Header -->
                        <div class="mcp-config-header">
                            <div class="mcp-header-title">
                                <span class="mcp-header-icon icon-mcp-large"></span>
                                <div>
                                    <h2>MCP Server Configuration</h2>
                                    <p class="mcp-header-subtitle">Configure Model Context Protocol servers to extend LLM capabilities with external tools</p>
                                </div>
                            </div>
                            <div class="mcp-header-status" id="mcp-availability-status">
                                <span class="status-checking">Checking MCP availability...</span>
                            </div>
                        </div>

                        <!-- MCP Not Installed Warning -->
                        <div class="mcp-install-warning" id="mcp-install-warning" style="display: none;">
                            <div class="warning-icon"><span class="icon-mcp-warning icon-lg"></span></div>
                            <h3>MCP Not Installed</h3>
                            <p>Install the MCP package to enable this feature:</p>
                            <div class="install-commands">
                                <code class="primary-cmd">pip install vllm-playground[mcp]</code>
                                <span class="cmd-divider">or</span>
                                <code class="alt-cmd">pip install mcp</code>
                            </div>
                        </div>

                        <!-- MCP Available Content -->
                        <div class="mcp-content-wrapper" id="mcp-content-wrapper">
                            <!-- Server List Section -->
                            <div class="mcp-section">
                                <div class="mcp-section-header">
                                    <h3>Configured Servers</h3>
                                    <button class="btn btn-primary btn-sm" id="mcp-add-server-btn">
                                        <span class="add-icon">+</span> Add Server
                                    </button>
                                </div>

                                <!-- Server Cards Grid -->
                                <div class="mcp-servers-grid" id="mcp-servers-grid">
                                    <!-- Server cards will be rendered here by JavaScript -->
                                    <div class="mcp-empty-state" id="mcp-empty-state">
                                        <div class="empty-icon"><span class="icon-mcp-server icon-xl"></span></div>
                                        <p>No MCP servers configured</p>
                                        <p class="empty-hint">Add a server to get started, or choose from presets below</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Add/Edit Server Form (Initially Hidden) -->
                            <div class="mcp-server-form" id="mcp-server-form" style="display: none;">
                                <div class="form-header">
                                    <h3 id="mcp-form-title">Add New Server</h3>
                                    <button class="btn-icon" id="mcp-form-close" title="Close"><span class="icon-mcp-close"></span></button>
                                </div>
                                <div class="form-body">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="mcp-server-name">Server Name <span class="required">*</span></label>
                                            <input type="text" id="mcp-server-name" class="form-control" placeholder="e.g., my-filesystem" autocomplete="off">
                                            <small class="form-help">Unique identifier for this server</small>
                                        </div>
                                        <div class="form-group">
                                            <label for="mcp-server-transport">Transport Type</label>
                                            <select id="mcp-server-transport" class="form-control">
                                                <option value="stdio">Stdio (Local Command)</option>
                                                <option value="sse">SSE (HTTP Endpoint)</option>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- Stdio Transport Options -->
                                    <div class="transport-options stdio-options" id="stdio-options">
                                        <div class="form-group">
                                            <label for="mcp-server-command">Command <span class="required">*</span></label>
                                            <input type="text" id="mcp-server-command" class="form-control" placeholder="e.g., npx, python, node">
                                            <small class="form-help">The executable to run</small>
                                        </div>
                                        <div class="form-group">
                                            <label for="mcp-server-args">Arguments</label>
                                            <input type="text" id="mcp-server-args" class="form-control" placeholder="e.g., -y @modelcontextprotocol/server-filesystem /home">
                                            <small class="form-help">Space-separated command arguments</small>
                                        </div>
                                    </div>

                                    <!-- SSE Transport Options -->
                                    <div class="transport-options sse-options" id="sse-options" style="display: none;">
                                        <div class="form-group">
                                            <label for="mcp-server-url">Server URL <span class="required">*</span></label>
                                            <input type="text" id="mcp-server-url" class="form-control" placeholder="http://localhost:8080/sse">
                                            <small class="form-help">The SSE endpoint URL</small>
                                        </div>
                                    </div>

                                    <!-- Environment Variables -->
                                    <div class="form-group">
                                        <label>Environment Variables</label>
                                        <div class="env-vars-container" id="mcp-env-vars">
                                            <!-- Env var rows will be added here -->
                                        </div>
                                        <button class="btn btn-secondary btn-sm" id="mcp-add-env-var">+ Add Variable</button>
                                    </div>

                                    <!-- Description -->
                                    <div class="form-group">
                                        <label for="mcp-server-description">Description</label>
                                        <input type="text" id="mcp-server-description" class="form-control" placeholder="Optional description">
                                    </div>

                                    <!-- Options -->
                                    <div class="form-row options-row">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="mcp-server-enabled" checked>
                                            <span>Enabled</span>
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="mcp-server-auto-connect">
                                            <span>Auto-connect on startup</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="form-footer">
                                    <button class="btn btn-secondary" id="mcp-form-cancel">Cancel</button>
                                    <button class="btn btn-primary" id="mcp-form-save">Save Server</button>
                                </div>
                            </div>

                            <!-- Security Notice -->
                            <div class="mcp-security-warning">
                                <div class="warning-icon">‚ö†Ô∏è</div>
                                <div class="warning-content">
                                    <strong>Security Notice</strong>
                                    <ul>
                                        <li>MCP requires Python 3.10 or higher</li>
                                        <li>MCP integration is experimental/demo only</li>
                                        <li>Only use trusted MCP servers</li>
                                        <li>Review each tool call before executing</li>
                                    </ul>
                                    <strong>STDIO Transport Dependencies</strong>
                                    <ul>
                                        <li><code>npx</code> (Node.js) - Required for Filesystem server</li>
                                        <li><code>uvx</code> (uv) - Required for Git, Fetch, Time servers</li>
                                        <li>SSE transport connects to remote URLs, no local dependencies needed</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Presets Section -->
                            <div class="mcp-section mcp-presets-section">
                                <div class="mcp-section-header">
                                    <h3>Quick Start with Presets</h3>
                                </div>
                                <div class="mcp-presets-grid" id="mcp-presets-grid">
                                    <!-- Preset cards will be rendered here by JavaScript -->
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <!-- Claude Code View -->
            <div class="view-content" id="claude-code-view" style="display: none;">
                <div class="claude-code-layout">
                    <div class="claude-code-container">
                        <!-- Header -->
                        <div class="claude-code-header">
                            <div class="claude-header-title">
                                <img src="/assets/Claude.png" alt="Claude Code" class="claude-header-icon">
                                <div>
                                    <h2>Claude Code</h2>
                                    <p class="claude-header-subtitle">AI-powered coding assistant connected to your vLLM server</p>
                                </div>
                            </div>
                            <div class="claude-header-status" id="claude-status">
                                <span class="status-checking">Checking status...</span>
                            </div>
                        </div>

                        <!-- Not Available Warning (shown when ttyd not installed) -->
                        <div class="claude-install-warning" id="claude-pty-warning" style="display: none;">
                            <div class="warning-icon">‚ö†Ô∏è</div>
                            <h3>Terminal Support Not Available</h3>
                            <p>Install <strong>ttyd</strong> to enable the Claude Code terminal:</p>
                            <div class="install-commands">
                                <code class="primary-cmd">brew install ttyd</code>
                                <span class="cmd-divider">(macOS)</span>
                            </div>
                            <div class="install-commands" style="margin-top: 8px;">
                                <code class="alt-cmd">sudo apt install ttyd</code>
                                <span class="cmd-divider">(Ubuntu/Debian)</span>
                            </div>
                            <p class="warning-hint" style="margin-top: 12px;">Note: You also need to install Claude Code CLI. See <a href="https://code.claude.com/docs/en/setup" target="_blank" rel="noopener">official setup guide</a> for installation options.</p>
                            <p class="warning-hint" style="margin-top: 8px;">Or run Claude Code manually in your terminal with the vLLM environment variables shown in <a href="#" id="claude-show-manual-instructions">manual setup</a>.</p>
                        </div>

                        <!-- Claude Not Installed Warning -->
                        <div class="claude-install-warning" id="claude-not-installed" style="display: none;">
                            <div class="warning-icon">üì¶</div>
                            <h3>Claude Code Not Installed</h3>
                            <p>Install Claude Code CLI to use this feature.</p>
                            <p class="warning-hint">Recommended (native install):</p>
                            <div class="install-commands">
                                <code class="primary-cmd">curl -fsSL https://claude.ai/install.sh | bash</code>
                            </div>
                            <p class="warning-hint" style="margin-top: 8px;">See <a href="https://code.claude.com/docs/en/setup" target="_blank" rel="noopener">official setup guide</a> for all installation options (Homebrew, WinGet, npm).</p>
                        </div>

                        <!-- vLLM Not Running Warning -->
                        <div class="claude-install-warning" id="claude-vllm-warning" style="display: none;">
                            <div class="warning-icon"><img src="/assets/vllm-logo.svg" alt="vLLM" class="warning-logo"></div>
                            <h3>vLLM Server Not Running</h3>
                            <p>Start a vLLM server first to use Claude Code.</p>

                            <div class="claude-model-tip">
                                <h4>Recommended Configuration</h4>
                                <div class="tip-model">
                                    <strong>Model:</strong> <code>meta-llama/Llama-3.1-8B-Instruct</code>
                                </div>
                                <div class="tip-args">
                                    <strong>Required Settings:</strong>
                                    <ul>
                                        <li>Max Model Length: <code>65536</code> (Claude Code needs 32K+ for responses)</li>
                                        <li>Enable Tool Calling: <code>‚úì</code></li>
                                        <li>Tool Call Parser: <code>llama3_json</code></li>
                                        <li>Served Model Name: Set a simple name (e.g., <code>my-code</code>)</li>
                                    </ul>
                                </div>
                                <p class="tip-note">Requires vLLM v0.12.0+ for Anthropic API support. See setup tips below terminal for GPU memory guide.</p>
                            </div>

                            <a href="#" id="claude-goto-vllm" class="btn btn-primary">Go to vLLM Server</a>
                        </div>

                        <!-- Served Model Name Required Warning -->
                        <div class="claude-install-warning" id="claude-served-name-warning" style="display: none;">
                            <div class="warning-icon">‚ö†Ô∏è</div>
                            <h3>Served Model Name Required</h3>
                            <p>Claude Code cannot use model names containing "/".</p>
                            <p class="warning-hint">Set a <strong>Served Model Name</strong> (e.g., "my-model") in the vLLM Server configuration panel, then restart the server.</p>
                            <a href="#" id="claude-goto-vllm-config" class="btn btn-primary">Configure vLLM Server</a>
                        </div>

                        <!-- Tool Calling Warning -->
                        <div class="claude-install-warning" id="claude-tool-warning" style="display: none;">
                            <div class="warning-icon">üîß</div>
                            <h3>Tool Calling Not Enabled</h3>
                            <p>Claude Code requires tool calling to be enabled.</p>
                            <p class="warning-hint">Enable <strong>Tool Calling</strong> in the vLLM Server configuration panel, then restart the server.</p>
                            <a href="#" id="claude-goto-vllm-tools" class="btn btn-primary">Configure vLLM Server</a>
                        </div>

                        <!-- Terminal Container (shown when ready) -->
                        <div class="claude-terminal-wrapper" id="claude-terminal-wrapper" style="display: none;">
                            <!-- Requirements Note -->
                            <div class="claude-requirements-note">
                                <div class="note-icon">üí°</div>
                                <div class="note-content">
                                    <strong>Requirements for Claude Code:</strong>
                                    <ul>
                                        <li><strong>Served Model Name</strong> must be set (e.g., "my-model") - model names with "/" don't work</li>
                                        <li><strong>Tool Calling</strong> must be enabled in vLLM server configuration</li>
                                        <li>Use a <strong>larger model</strong> (7B+ parameters) with strong tool calling capabilities</li>
                                        <li>Set <strong>Max Model Length</strong> to 8192+ for longer context</li>
                                        <li>Recommended models: Qwen 2.5 7B+, Llama 3.1 8B+, Mistral 7B+</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Connection Info Bar -->
                            <div class="claude-connection-bar">
                                <div class="connection-info">
                                    <span class="connection-label">Connected to:</span>
                                    <code id="claude-endpoint">http://localhost:8000</code>
                                    <span class="connection-model" id="claude-model-name">Model: -</span>
                                </div>
                                <div class="terminal-controls">
                                    <button class="btn btn-sm btn-secondary" id="claude-reconnect-btn" title="Reconnect terminal">
                                        üîÑ Reconnect
                                    </button>
                                    <button class="btn btn-sm btn-secondary" id="claude-clear-btn" title="Clear terminal">
                                        üóëÔ∏è Clear
                                    </button>
                                </div>
                            </div>

                            <!-- Terminal -->
                            <div class="claude-terminal" id="claude-terminal" tabindex="0"></div>

                            <!-- Help Text -->
                            <div class="claude-help-text">
                                <p>üí° Claude Code is running with your vLLM server as the backend. Type your coding questions or requests above.</p>
                                <p>Press <kbd>Ctrl+C</kbd> to interrupt, <kbd>Ctrl+D</kbd> to exit.</p>
                            </div>

                            <!-- Claude Code Setup Tips -->
                            <div class="claude-local-note">
                                <details>
                                    <summary>üìã Setup Requirements & Tips</summary>
                                    <div class="claude-tips-content">
                                        <h4>Requirements</h4>
                                        <ul>
                                            <li><strong>vLLM v0.12.0+</strong> - Required for the Anthropic Messages API (<code>/v1/messages</code> endpoint)</li>
                                            <li><strong>Native 65K+ context</strong> - Claude Code requests 32K max_tokens, so you need at least 65K total context (32K output + input tokens)</li>
                                            <li><strong>Tool calling support</strong> - Model must support function/tool calling with appropriate parser</li>
                                        </ul>

                                        <h4>Recommended Model</h4>
                                        <p><strong>Meta Llama 3.1 8B Instruct</strong> - Best balance of context, tool calling, and GPU memory:</p>
                                        <pre><code>Model: meta-llama/Llama-3.1-8B-Instruct
Args:  --max-model-len 65536 --enable-auto-tool-choice --tool-call-parser llama3_json --gpu-memory-utilization 0.9</code></pre>

                                        <h4>Why These Settings?</h4>
                                        <ul>
                                            <li><strong>Native 128K context</strong> - No rope scaling hacks needed</li>
                                            <li><strong>65536 max-model-len</strong> - Fits 32K output + 33K input on ~44GB GPU</li>
                                            <li><strong>llama3_json parser</strong> - Built-in tool calling support</li>
                                        </ul>

                                        <h4>GPU Memory Guide</h4>
                                        <table class="claude-tips-table">
                                            <tr><th>GPU VRAM</th><th>Recommended Model</th><th>Max Context</th></tr>
                                            <tr><td>24GB (L4)</td><td>Llama-3.1-8B-Instruct</td><td>32K-48K</td></tr>
                                            <tr><td>40-48GB (A6000)</td><td>Llama-3.1-8B-Instruct</td><td>65K</td></tr>
                                            <tr><td>80GB (A100/H100)</td><td>Llama-3.1-70B-Instruct</td><td>128K</td></tr>
                                        </table>

                                        <h4>Troubleshooting</h4>
                                        <ul>
                                            <li><strong>404 on /init</strong> - Upgrade to vLLM v0.12.0+</li>
                                            <li><strong>max_tokens too large</strong> - Increase <code>--max-model-len</code> or use <code>/clear</code> to reset context</li>
                                            <li><strong>CUDA OOM</strong> - Reduce <code>--max-model-len</code> or use quantized model (AWQ/GPTQ)</li>
                                        </ul>
                                    </div>
                                </details>
                            </div>

                            <!-- Local Terminal Note -->
                            <div class="claude-local-note">
                                <details>
                                    <summary>üíª Prefer to run in your local terminal?</summary>
                                    <p>You can always run Claude Code directly in your terminal with these environment variables:</p>
                                    <pre><code>export ANTHROPIC_BASE_URL=http://localhost:<span class="env-port">8000</span>
export ANTHROPIC_API_KEY=vllm-playground
claude --model <span class="env-model">your-model-name</span></code></pre>
                                    <p class="note-hint">Replace the port and model name with your vLLM server settings.</p>
                                </details>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MCP Server Details Modal (Simple) -->
    <div id="mcp-details-modal" class="modal" style="display: none;">
        <div class="modal-overlay" id="mcp-details-overlay"></div>
        <div class="modal-content mcp-details-content">
            <div class="modal-header">
                <h2><span class="icon-mcp-header"></span> Server Details</h2>
                <button id="mcp-details-close" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Server Info -->
                <div class="details-server-info" id="details-server-info">
                    <div class="server-name-badge" id="details-server-name">Server</div>
                    <div class="connection-status" id="details-connection-status">
                        <span class="status-dot"></span>
                        <span class="status-text">Checking...</span>
                    </div>
                </div>

                <!-- Tools List -->
                <div class="details-section">
                    <h3><span class="icon-mcp-tools"></span> Available Tools <span class="count-badge" id="details-tools-count">0</span></h3>
                    <div class="details-list" id="details-tools-list">
                        <div class="list-loading">Loading tools...</div>
                    </div>
                </div>

                <!-- Resources Summary -->
                <div class="details-section">
                    <h3><span class="icon-mcp-resources"></span> Resources <span class="count-badge" id="details-resources-count">0</span></h3>
                    <p class="details-summary" id="details-resources-summary">No resources available</p>
                </div>

                <!-- Prompts Summary -->
                <div class="details-section">
                    <h3><span class="icon-mcp-prompts"></span> Prompts <span class="count-badge" id="details-prompts-count">0</span></h3>
                    <p class="details-summary" id="details-prompts-summary">No prompts available</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Community Recipes Modal -->
    <div id="recipes-modal" class="modal" style="display: none;">
        <div class="modal-overlay" id="recipes-modal-overlay"></div>
        <div class="modal-content recipes-modal-content">
            <div class="modal-header">
                <h2>üìö vLLM Community Recipes</h2>
                <button id="recipes-modal-close" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p class="recipes-intro">
                    Optimized configurations from the
                    <a href="https://github.com/vllm-project/recipes" target="_blank">vLLM Recipes Repository</a>.
                    Select a recipe to auto-configure the playground.
                </p>

                <!-- Sync Controls -->
                <div class="sync-controls-section">
                    <button id="sync-recipes-btn" class="btn btn-secondary btn-sm" title="Sync recipes from GitHub">
                        üîÑ Sync
                    </button>
                    <button id="add-recipe-btn" class="btn btn-primary btn-sm" onclick="window.vllmUI.openAddRecipeModal()" title="Add a new recipe manually">
                        <span class="add-icon">+</span> Add
                    </button>
                    <div class="github-token-inline">
                        <input type="password" id="github-token-input" class="form-control"
                               placeholder="GitHub Token (optional, for higher rate limits)">
                        <a href="https://github.com/settings/tokens" target="_blank" class="token-help-link" title="Get a token">?</a>
                    </div>
                </div>

                <!-- Search/Filter -->
                <div class="recipes-search">
                    <input type="text" id="recipes-search-input" class="form-control" placeholder="Search models...">
                    <div class="recipes-filter-tags" id="recipes-filter-tags">
                        <button class="tag-btn active" data-tag="all">All</button>
                        <button class="tag-btn" data-tag="single-gpu">Single GPU</button>
                        <button class="tag-btn" data-tag="multi-gpu">Multi GPU</button>
                        <button class="tag-btn" data-tag="cpu">CPU</button>
                        <button class="tag-btn" data-tag="vision">Vision</button>
                        <button class="tag-btn" data-tag="reasoning">Reasoning</button>
                    </div>
                </div>

                <!-- Categories List -->
                <div id="recipes-categories" class="recipes-categories">
                    <div class="recipes-loading">Loading recipes...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Reusable Confirm Modal Dialog -->
    <div id="confirm-modal" class="modal confirm-modal" style="display: none;">
        <div class="modal-overlay" id="confirm-modal-overlay"></div>
        <div class="modal-content confirm-modal-content">
            <div class="confirm-modal-icon" id="confirm-modal-icon">‚ö†Ô∏è</div>
            <h3 class="confirm-modal-title" id="confirm-modal-title">Confirm Action</h3>
            <p class="confirm-modal-message" id="confirm-modal-message">Are you sure?</p>
            <div class="confirm-modal-actions">
                <button class="btn btn-secondary" id="confirm-modal-cancel">Cancel</button>
                <button class="btn btn-danger" id="confirm-modal-confirm">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Export Chat Modal -->
    <div id="export-modal" class="modal confirm-modal" style="display: none;">
        <div class="modal-overlay" id="export-modal-overlay"></div>
        <div class="modal-content confirm-modal-content">
            <div class="confirm-modal-icon">üì§</div>
            <h3 class="confirm-modal-title">Export Chat</h3>
            <p class="confirm-modal-message">Choose export format:</p>
            <div class="confirm-modal-actions" style="flex-direction: column; gap: 10px;">
                <button class="btn btn-primary" id="export-json-btn" style="width: 100%;">
                    JSON Format
                </button>
                <button class="btn btn-secondary" id="export-markdown-btn" style="width: 100%;">
                    Markdown Format
                </button>
                <button class="btn btn-secondary" id="export-cancel-btn" style="width: 100%; margin-top: 5px;">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Clear Chat Confirmation Modal -->
    <div id="clear-chat-modal" class="modal confirm-modal" style="display: none;">
        <div class="modal-overlay" id="clear-chat-modal-overlay"></div>
        <div class="modal-content confirm-modal-content">
            <div class="confirm-modal-icon">üóëÔ∏è</div>
            <h3 class="confirm-modal-title">Clear Chat</h3>
            <p class="confirm-modal-message">Are you sure you want to clear all messages? This action cannot be undone.
            </p>
            <div class="confirm-modal-actions">
                <button class="btn btn-secondary" id="clear-chat-cancel-btn">Cancel</button>
                <button class="btn btn-danger" id="clear-chat-confirm-btn">Clear</button>
            </div>
        </div>
    </div>

    <!-- i18n System -->
    <script src="/static/js/i18n.js"></script>
    <script src="/static/js/locales/en.js"></script>
    <script src="/static/js/locales/zh-CN.js"></script>

    <!-- Main App -->
    <script type="module" src="/static/js/app.js"></script>
</body>
</html>
