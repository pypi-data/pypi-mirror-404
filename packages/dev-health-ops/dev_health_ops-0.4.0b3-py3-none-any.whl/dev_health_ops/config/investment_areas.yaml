rules:
  # --- Synthetic Data Mappings (Specific Labels -> Project Streams) ---

  # Security
  - id: "sec_auth"
    priority: 10
    match: { label: ["auth"] }
    output: { investment_area: "security", project_stream: "auth" }
  - id: "sec_vuln"
    priority: 10
    match: { label: ["vulnerability"] }
    output: { investment_area: "security", project_stream: "vulnerability" }
  - id: "sec_comp"
    priority: 10
    match: { label: ["compliance"] }
    output: { investment_area: "security", project_stream: "compliance" }
  - id: "sec_audit"
    priority: 10
    match: { label: ["audit"] }
    output: { investment_area: "security", project_stream: "audit" }
  - id: "sec_enc"
    priority: 10
    match: { label: ["encryption"] }
    output: { investment_area: "security", project_stream: "encryption" }
  - id: "sec_ac"
    priority: 10
    match: { label: ["access-control"] }
    output: { investment_area: "security", project_stream: "access-control" }
  - id: "sec_general"
    priority: 20
    match: { label: ["security", "sec"] }
    output: { investment_area: "security", project_stream: "general" }

  # Infrastructure
  - id: "infra_k8s"
    priority: 10
    match: { label: ["k8s", "kubernetes"] }
    output: { investment_area: "infra", project_stream: "k8s" }
  - id: "infra_tf"
    priority: 10
    match: { label: ["terraform"] }
    output: { investment_area: "infra", project_stream: "terraform" }
  - id: "infra_cicd"
    priority: 10
    match: { label: ["ci-cd", "cicd"] }
    output: { investment_area: "infra", project_stream: "ci-cd" }
  - id: "infra_mon"
    priority: 10
    match: { label: ["monitoring"] }
    output: { investment_area: "infra", project_stream: "monitoring" }
  - id: "infra_cost"
    priority: 10
    match: { label: ["cost"] }
    output: { investment_area: "infra", project_stream: "cost" }
  - id: "infra_net"
    priority: 10
    match: { label: ["network"] }
    output: { investment_area: "infra", project_stream: "network" }
  - id: "infra_db"
    priority: 10
    match: { label: ["database", "db"] }
    output: { investment_area: "infra", project_stream: "database" }
  # Path rules for Infra
  - id: "infra_path"
    priority: 30
    match:
      path_prefix: ["infra/", "terraform/", "deploy/", "k8s/", "docker/", ".github/workflows/"]
    output:
      investment_area: "infra"
      project_stream: "platform"

  # Quality
  - id: "qual_test"
    priority: 10
    match: { label: ["testing", "test"] }
    output: { investment_area: "quality", project_stream: "testing" }
  - id: "qual_flake"
    priority: 10
    match: { label: ["flake"] }
    output: { investment_area: "quality", project_stream: "reliability" }
  - id: "qual_cov"
    priority: 10
    match: { label: ["coverage"] }
    output: { investment_area: "quality", project_stream: "testing" }
  - id: "qual_perf"
    priority: 10
    match: { label: ["perf", "performance"] }
    output: { investment_area: "quality", project_stream: "performance" }
  - id: "qual_rel"
    priority: 10
    match: { label: ["reliability"] }
    output: { investment_area: "quality", project_stream: "reliability" }
  - id: "qual_auto"
    priority: 10
    match: { label: ["automation"] }
    output: { investment_area: "quality", project_stream: "automation" }
  # Path rules for Quality
  - id: "test_path"
    priority: 35
    match:
      path_prefix: ["tests/", "testing/"]
    output:
      investment_area: "quality"
      project_stream: "testing"

  # Docs
  - id: "docs_api"
    priority: 10
    match: { label: ["api-docs"] }
    output: { investment_area: "docs", project_stream: "api-docs" }
  - id: "docs_user"
    priority: 10
    match: { label: ["user-guide"] }
    output: { investment_area: "docs", project_stream: "user-guide" }
  - id: "docs_tut"
    priority: 10
    match: { label: ["tutorial"] }
    output: { investment_area: "docs", project_stream: "tutorial" }
  - id: "docs_readme"
    priority: 10
    match: { label: ["readme"] }
    output: { investment_area: "docs", project_stream: "readme" }
  - id: "docs_rn"
    priority: 10
    match: { label: ["release-notes"] }
    output: { investment_area: "docs", project_stream: "release-notes" }
  # Path rules for Docs
  - id: "docs_path"
    priority: 30
    match:
      path_prefix: ["docs/", "README.md", "CONTRIBUTING.md"]
    output:
      investment_area: "docs"
      project_stream: "documentation"

  # Data
  - id: "data_pipe"
    priority: 10
    match: { label: ["pipeline"] }
    output: { investment_area: "data", project_stream: "pipeline" }
  - id: "data_schema"
    priority: 10
    match: { label: ["schema"] }
    output: { investment_area: "data", project_stream: "schema" }
  - id: "data_ana"
    priority: 10
    match: { label: ["analytics"] }
    output: { investment_area: "data", project_stream: "analytics" }
  - id: "data_wh"
    priority: 10
    match: { label: ["warehouse"] }
    output: { investment_area: "data", project_stream: "warehouse" }
  - id: "data_etl"
    priority: 10
    match: { label: ["etl"] }
    output: { investment_area: "data", project_stream: "etl" }
  - id: "data_viz"
    priority: 10
    match: { label: ["visualization"] }
    output: { investment_area: "data", project_stream: "visualization" }
  - id: "data_label"
    priority: 38
    match:
      label: ["data"]
    output:
      investment_area: "data"
      project_stream: "platform"
  - id: "data_component"
    priority: 40
    match:
      component: ["Data Platform", "Analytics"]
    output:
      investment_area: "data"
      project_stream: "platform"

  # Product (Default fallbacks and specific streams)
  - id: "prod_feat"
    priority: 10
    match: { label: ["feature"] }
    output: { investment_area: "product", project_stream: "feature" }
  - id: "prod_ux"
    priority: 10
    match: { label: ["ux"] }
    output: { investment_area: "product", project_stream: "ux" }
  - id: "prod_onboard"
    priority: 10
    match: { label: ["onboarding"] }
    output: { investment_area: "product", project_stream: "onboarding" }
  - id: "prod_mob"
    priority: 10
    match: { label: ["mobile"] }
    output: { investment_area: "product", project_stream: "mobile" }
  - id: "prod_api"
    priority: 10
    match: { label: ["api"] }
    output: { investment_area: "product", project_stream: "api" }
  - id: "prod_growth"
    priority: 10
    match: { label: ["growth"] }
    output: { investment_area: "product", project_stream: "growth" }
  - id: "prod_mon"
    priority: 10
    match: { label: ["monetization"] }
    output: { investment_area: "product", project_stream: "monetization" }

  # Catch-all
  - id: "product_default"
    priority: 999
    match:
      always: true
    output:
      investment_area: "product"
      project_stream: "general"