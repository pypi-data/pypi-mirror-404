{
  "annotations": {
    "list": []
  },
  "editable": true,
  "panels": [
    {
      "title": "Delivery Units Daily",
      "type": "barchart",
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "clickhouse"
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 0
      },
      "targets": [
        {
          "rawSql": "SELECT day AS time, 'Delivery Units' AS metric, delivery_units AS value FROM stats.user_metrics_daily WHERE identity_id = '$identity_id' AND day >= toDate(toDateTime(intDiv($__from, 1000))) AND day < toDate(toDateTime(intDiv($__to, 1000))) ORDER BY day",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "displayName": "${__field.labels.metric}"
        },
        "overrides": []
      }
    },
    {
      "title": "LOC Touched",
      "type": "timeseries",
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "clickhouse"
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 0
      },
      "targets": [
        {
          "rawSql": "SELECT day AS time, 'LOC Touched' AS metric, loc_touched AS value FROM stats.user_metrics_daily WHERE identity_id = '$identity_id' AND day >= toDate(toDateTime(intDiv($__from, 1000))) AND day < toDate(toDateTime(intDiv($__to, 1000))) ORDER BY day",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "displayName": "${__field.labels.metric}"
        },
        "overrides": []
      }
    },
    {
      "title": "Cycle Time P50 (Hours)",
      "type": "timeseries",
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "clickhouse"
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 8
      },
      "targets": [
        {
          "rawSql": "SELECT day AS time, 'Cycle Time P50 (Hours)' AS metric, cycle_p50_hours AS value FROM stats.user_metrics_daily WHERE identity_id = '$identity_id' AND day >= toDate(toDateTime(intDiv($__from, 1000))) AND day < toDate(toDateTime(intDiv($__to, 1000))) ORDER BY day",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "displayName": "${__field.labels.metric}"
        },
        "overrides": []
      }
    },
    {
      "title": "WIP Active",
      "type": "timeseries",
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "clickhouse"
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 8
      },
      "targets": [
        {
          "rawSql": "SELECT day AS time, 'WIP Active' AS metric, work_items_active AS value FROM stats.user_metrics_daily WHERE identity_id = '$identity_id' AND day >= toDate(toDateTime(intDiv($__from, 1000))) AND day < toDate(toDateTime(intDiv($__to, 1000))) ORDER BY day",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "displayName": "${__field.labels.metric}"
        },
        "overrides": []
      }
    },
    {
      "title": "Churn vs Throughput",
      "type": "devhealth-ops-panel",
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "clickhouse"
      },
      "gridPos": {
        "h": 12,
        "w": 24,
        "x": 0,
        "y": 16
      },
      "targets": [
        {
          "format": 1,
          "rawQuery": true,
          "rawSql": "SELECT max(v.as_of_day) as as_of_day, map_name, ifNull(nullIf(team_id, ''), 'unassigned') AS team_id, identity_id, argMax(x_raw, v.as_of_day) as x_raw, argMax(y_raw, v.as_of_day) as y_raw, argMax(x_norm, v.as_of_day) as x_norm, argMax(y_norm, v.as_of_day) as y_norm FROM stats.v_ic_landscape_points AS v WHERE map_name = 'churn_throughput' AND v.as_of_day >= toDate(toDateTime(intDiv($__from, 1000))) AND v.as_of_day < toDate(toDateTime(intDiv($__to, 1000))) AND ifNull(nullIf(team_id, ''), 'unassigned') IN (SELECT ifNull(nullIf(team_id, ''), 'unassigned') FROM stats.v_ic_landscape_points WHERE identity_id = '$identity_id') GROUP BY map_name, team_id, identity_id ORDER BY team_id, identity_id",
          "refId": "A"
        }
      ],
      "options": {
        "mode": "developerLandscape",
        "developerLandscape": {
          "mapName": "churn_throughput",
          "showLabels": true,
          "colorByTeam": false,
          "focusIdentity": "$identity_id"
        }
      }
    }
  ],
  "templating": {
    "list": [
      {
        "name": "identity_id",
        "label": "Identity",
        "type": "query",
        "datasource": {
          "type": "grafana-clickhouse-datasource",
          "uid": "clickhouse"
        },
        "refresh": 1,
        "query": "SELECT DISTINCT identity_id AS __text, identity_id AS __value FROM stats.user_metrics_daily ORDER BY 1"
      }
    ]
  },
  "title": "IC Drilldown",
  "uid": "ic-drilldown",
  "version": 1
}
