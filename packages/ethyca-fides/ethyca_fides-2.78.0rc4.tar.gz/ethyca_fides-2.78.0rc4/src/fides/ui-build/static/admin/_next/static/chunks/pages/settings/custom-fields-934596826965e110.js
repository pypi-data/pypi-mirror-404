(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4065],{1770:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/custom-fields",function(){return i(5810)}])},30952:function(e,t,i){"use strict";i.d(t,{f:function(){return r}});var a=i(24246),n=i(26917);let r=e=>{let{...t}=e;return(0,a.jsx)(n.Z,{debounce:!0,...t})}},94799:function(e,t,i){"use strict";i.d(t,{k:function(){return r}});var a=i(76649);let n=e=>(0,a.Ln)({id:"string"},e),r=e=>(null!=e?e:[]).filter(n)},30320:function(e,t,i){"use strict";i.d(t,{m:function(){return o}});var a=i(27378),n=i(25980),r=i(17245),s=i(32885),l=i(94799);let o=e=>{let{resourceFidesKey:t,resourceType:i}=e,{errorAlert:o}=(0,r.VY)(),{plus:d}=(0,n.hz)(),c=(0,a.useMemo)(()=>null!=t?t:"",[]),u=(0,s.YU)(!0,{skip:!d}),m=(0,s.VN)(i,{skip:!d}),{data:p,isLoading:f,error:h,isError:x}=(0,s.PV)(null!=t?t:"",{skip:""!==c&&!(d&&c)}),[y]=(0,s._D)(),g=u.isLoading||m.isLoading||f,v=(0,a.useMemo)(()=>new Map((0,l.k)(u.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[u.data]),_=(0,a.useMemo)(()=>{var e;return null===(e=m.data)||void 0===e?void 0:e.filter(e=>e.active)},[m.data]),j=(0,a.useMemo)(()=>new Map((0,l.k)(_).map(e=>[e.id,e])),[_]),T=(0,a.useMemo)(()=>x&&h&&"status"in h&&404===h.status?new Map:new Map((0,l.k)(p).map(e=>[e.custom_field_definition_id,e])),[p,x,h]),S=(0,a.useMemo)(()=>{let e=[...j.keys()];return e.sort(),e},[j]),b=(0,a.useMemo)(()=>{let e={};return _&&T&&_.forEach(t=>{let i=T.get(t.id||"");i&&(t.allow_list_id&&"string[]"===t.field_type?e[i.custom_field_definition_id]=i.value:e[i.custom_field_definition_id]=i.value.toString())}),e},[_,T]),E=(0,a.useCallback)(async e=>{if(!d)return;let a="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!a)return;let{customFieldValues:n}=e;if(!n||0===Object.keys(n).length)return;let r=[],s=[];S.forEach(e=>{let t=T.get(e),i=n[e];void 0===i||""===i||Array.isArray(i)&&0===i.length?(null==t?void 0:t.id)&&s.push(t.id):r.push({custom_field_definition_id:e,resource_id:a,id:null==t?void 0:t.id,value:i})});try{await y({resource_type:i,resource_id:a,upsert:r,delete:s})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,T,o,t,S,y,i]);return{customFieldValues:b,definitionIdToCustomField:T,idToAllowListWithOptions:v,idToCustomFieldDefinition:j,isEnabled:d,isLoading:g,sortedCustomFieldDefinitionIds:S,upsertCustomFields:E}}},33162:function(e,t,i){"use strict";i.d(t,{uc:function(){return u},JY:function(){return s.J},mZ:function(){return c.m}});var a=i(24246),n=i(36010),r=i(34090),s=i(20987),l=i(30234),o=i(97181),d=i(40324),c=i(30320);let u=e=>{let{resourceFidesKey:t,resourceType:i}=e,{idToAllowListWithOptions:u,idToCustomFieldDefinition:m,isEnabled:p,isLoading:f,sortedCustomFieldDefinitionIds:h}=(0,c.m)({resourceFidesKey:t,resourceType:i});return p&&0!==h.length?(0,a.jsx)(l.Z,{heading:"Custom fields",children:(0,a.jsx)(n.ad9,{flexDir:"column","data-testid":"custom-fields-list",children:(0,a.jsx)(n.ad9,{flexDir:"column",gap:"24px",children:f?(0,a.jsx)(n.w4_,{children:(0,a.jsx)(n.Y6B,{})}):h.length>0&&(0,a.jsx)(n.ad9,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:h.map(e=>{let t=m.get(e);if(!t)return null;let i="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===s.H.STRING)return(0,a.jsx)(r.gN,{name:i,children:e=>{let{field:i}=e;return(0,a.jsx)(d.j0,{...i,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let n=u.get(t.allow_list_id);if(!n)return null;let{options:l}=n;return(0,a.jsx)(o.d,{name:i,allowClear:!0,mode:t.field_type!==s.H.STRING?"multiple":void 0,label:t.name,options:l,tooltip:t.description,layout:"stacked",className:"w-full"},e)})})})})}):null};i(94799)},59849:function(e,t,i){"use strict";i.d(t,{Z:function(){return c}});var a=i(24246),n=i(36010),r=i(86677),s=i(88340);let l="/images/errors";var o=e=>{let{status:t}=e;return 404===t?(0,a.jsx)(n.Eep,{src:"".concat(l,"/404.svg"),alt:"Error 404",preview:!1}):500===t?(0,a.jsx)(n.Eep,{src:"".concat(l,"/500.svg"),alt:"Error 500",preview:!1}):(0,a.jsx)(n.Eep,{src:"".concat(l,"/unknown.svg"),alt:"Error Unknown",preview:!1})},d=i(812),c=e=>{let{error:t,defaultMessage:i="An unexpected error occurred.  Please try again",actions:l,showReload:c=!0}=e,u=(0,d.e$)(t,i),m="data"in t&&t.data?JSON.stringify(t.data):JSON.stringify(t),p="status"in t&&t.status?t.status:void 0,f=(0,r.useRouter)(),h=l&&l.length>0||c;return(0,a.jsx)(n.kCb,{vertical:!0,align:"center",justify:"center",className:"h-screen","data-testid":"error-page-result",children:(0,a.jsx)(n.x4B,{status:"error",icon:(0,a.jsx)(o,{status:p}),title:"Error ".concat(p),subTitle:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Typography.Paragraph,{type:"secondary",children:u}),(0,a.jsx)(n.kCb,{justify:"start",className:"max-w-96",children:(0,a.jsx)(n.UO1,{ghost:!0,size:"small",items:[{key:"1",label:"Show details",classNames:{header:"w-fit"},children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Typography.Text,{type:"secondary",children:m}),(0,a.jsx)(s.Z,{copyText:m})]})}]})})]}),extra:h&&(0,a.jsxs)(n.kCb,{gap:"small",justify:"center",children:[null==l?void 0:l.map((e,t)=>(0,a.jsx)(n.zxk,{...e,children:e.label},t)),c&&(0,a.jsx)(n.zxk,{onClick:()=>f.reload(),type:"primary",children:"Reload"})]})})})}},97181:function(e,t,i){"use strict";i.d(t,{d:function(){return d}});var a=i(24246),n=i(36010),r=i(34090),s=i(27378),l=i(46238),o=i(40324);let d=e=>{let{name:t,label:i,labelProps:d,tooltip:c,isRequired:u,layout:m="inline",helperText:p,...f}=e,[h,x,{setValue:y}]=(0,r.U$)(t),g=!!(x.touched&&x.error),[v,_]=(0,s.useState)("");h.value||"tags"!==f.mode&&"multiple"!==f.mode||(h.value=[]),"tags"===f.mode&&"string"==typeof h.value&&(h.value=[h.value]);let j="tags"===f.mode?(e,t)=>e?e.value!==v||h.value.includes(v)?f.optionRender?f.optionRender(e,t):e.label:'Create "'.concat(v,'"'):void 0:f.optionRender||void 0,T=e=>{_(e),f.onSearch&&f.onSearch(e)},S=(e,t)=>{y(e),f.onChange&&f.onChange(e,t)};return"inline"===m?(0,a.jsx)(n.DTt,{isInvalid:g,isRequired:u,children:(0,a.jsxs)(n.MoG,{templateColumns:i?"1fr 3fr":"1fr",children:[i?(0,a.jsx)(o.__,{htmlFor:f.id||t,...d,children:i}):null,(0,a.jsxs)(n.kCb,{align:"center",children:[(0,a.jsxs)(n.kCb,{vertical:!0,flex:1,className:"mr-2",children:[(0,a.jsx)(n.PhF,{...h,id:f.id||t,"data-testid":"controlled-select-".concat(h.name),...f,optionRender:j,onSearch:"tags"===f.mode?T:void 0,onChange:S,value:h.value||void 0,status:g?"error":void 0}),p&&(0,a.jsx)(n.Kug,{children:p}),(0,a.jsx)(o.Bc,{isInvalid:g,message:x.error,fieldName:h.name})]}),(0,a.jsx)(l.b,{label:c,className:g?"mt-2 self-start":void 0})]})]})}):(0,a.jsx)(n.DTt,{isInvalid:g,isRequired:u,children:(0,a.jsxs)(n.s_g,{alignItems:"start",children:[(0,a.jsxs)(n.kCb,{align:"center",children:[i?(0,a.jsx)(o.__,{htmlFor:f.id||t,fontSize:"xs",my:0,mr:1,...d,children:i}):null,(0,a.jsx)(l.b,{label:c})]}),(0,a.jsx)(n.PhF,{...h,id:f.id||t,"data-testid":"controlled-select-".concat(h.name),...f,optionRender:j,onSearch:"tags"===f.mode?T:void 0,onChange:S,value:h.value||void 0,status:g?"error":void 0}),p&&(0,a.jsx)(n.Kug,{style:{marginTop:0},children:p}),(0,a.jsx)(o.Bc,{isInvalid:g,message:x.error,fieldName:h.name})]})})}},94770:function(e,t,i){"use strict";i.d(t,{r:function(){return r}});var a=i(24246),n=i(36010);let r=e=>{let{children:t,...i}=e;return t&&"string"==typeof t?(0,a.jsx)(n.Typography.Text,{ellipsis:{tooltip:t},...i,children:t}):t}},8917:function(e,t,i){"use strict";i.d(t,{Fb:function(){return o},P3:function(){return u},TY:function(){return c},Un:function(){return m},Uv:function(){return n},mJ:function(){return d},uP:function(){return l}});var a,n,r=i(20987),s=i(59001);let l=new Map([[r.J.SYSTEM,"system:information"],[r.J.DATA_USE,"taxonomy:data use"],[r.J.DATA_CATEGORY,"taxonomy:data category"],[r.J.DATA_SUBJECT,"taxonomy:data subject"],[r.J.PRIVACY_DECLARATION,"system:data use"]]),o={[s.ac.DATA_CATEGORY]:"taxonomy:data category",[s.ac.DATA_USE]:"taxonomy:data use",[s.ac.DATA_SUBJECT]:"taxonomy:data subject",[s.ac.SYSTEM_GROUP]:"taxonomy:system group"},d={[s.ac.DATA_CATEGORY]:r.J.DATA_CATEGORY,[s.ac.DATA_USE]:r.J.DATA_USE,[s.ac.DATA_SUBJECT]:r.J.DATA_SUBJECT,[s.ac.SYSTEM_GROUP]:"system group"};(a=n||(n={})).SINGLE_SELECT="singleSelect",a.MULTIPLE_SELECT="multipleSelect",a.OPEN_TEXT="openText";let c=[{label:"Single select",value:"singleSelect"},{label:"Multiple select",value:"multipleSelect"},{label:"Open text",value:"openText"}],u={singleSelect:"Single-value select",multipleSelect:"Multi-value select",openText:"Open text"},m={[s.ac.DATA_CATEGORY]:"Data category",[s.ac.DATA_USE]:"Data use field",[s.ac.DATA_SUBJECT]:"Data subject",[s.ac.SYSTEM_GROUP]:"System group"}},66236:function(e,t,i){"use strict";i.d(t,{S:function(){return s},_:function(){return r}});var a=i(20987),n=i(8917);let r=e=>e.field_type===a.H.STRING_ARRAY?n.Uv.MULTIPLE_SELECT:e.allow_list_id?n.Uv.SINGLE_SELECT:e.field_type===a.H.STRING?n.Uv.OPEN_TEXT:e.field_type,s=e=>{let t=r(e);return t in n.P3?n.P3[t]:t in n.Un?n.Un[t]:t}},30234:function(e,t,i){"use strict";var a=i(24246),n=i(36010);t.Z=e=>{let{heading:t,HeadingButton:i,children:r}=e;return(0,a.jsx)(n.EO$,{spacing:4,children:(0,a.jsxs)(n.TJV,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,a.jsxs)(n.TJV,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,a.jsx)(n.y_b,{as:"h3",size:"xs",children:t}),i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.s3C,{}),i]})]}),(0,a.jsx)(n.EO$,{spacing:4,px:6,py:6,children:r})]})})}},5810:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return C}});var a=i(24246),n=i(77213),r=i(36010),s=i(27378),l=i(59849),o=i(58754),d=i(30952),c=i(86677),u=i(33162),m=i(77830),p=i(19904),f=i(94770),h=i(99640),x=i(84450),y=i(8125),g=i(72625),v=i(32885),_=e=>{var t;let{field:i,isDisabled:n}=e,[r,{isLoading:s}]=(0,v.yM)(),l=async e=>r({...i,active:e});return(0,a.jsx)(g.S1,{enabled:null!==(t=i.active)&&void 0!==t&&t,onToggle:l,title:"Disable custom field",message:"Are you sure you want to disable this custom field?",isDisabled:n,"aria-label":i.active?"Disable custom field":"Enable custom field",loading:s})},j=i(66236),T=i(39864),S=i(60240);let b={[u.JY.SYSTEM]:"System",[u.JY.DATA_USE]:"Taxonomy data use",[u.JY.DATA_CATEGORY]:"Data category",[u.JY.DATA_SUBJECT]:"Data subject",[u.JY.PRIVACY_DECLARATION]:"System data use","system group":"System group"};var E=()=>{let e=(0,y.o)({pagination:{defaultPageSize:25,pageSizeOptions:[10,25,50]},search:{defaultSearchQuery:""}}),t=(0,c.useRouter)(),{data:i,isLoading:n}=(0,v.GH)(),{data:l}=(0,T.MU)(),{tableProps:o}=(0,y.V)(e,{dataSource:i||[],totalRows:(null==i?void 0:i.length)||0,isLoading:n,customTableProps:{layout:"fixed",sticky:{offsetHeader:40}}}),d=(0,p.Tg)([S.Sh.CUSTOM_FIELD_UPDATE]);return{tableProps:o,columns:(0,s.useMemo)(()=>[{title:"Name",dataIndex:"name",key:"name",filteredValue:e.searchQuery?[e.searchQuery]:null,onFilter:(e,t)=>t.name.toLowerCase().includes(e.toString().toLowerCase()),render:(e,t)=>{let{id:i,name:n}=t;return(0,a.jsx)(h.Z,{href:"".concat(m.WC,"/").concat(i),children:n})}},{title:"Description",dataIndex:"description",key:"description",render:e=>(0,a.jsx)(f.r,{className:"w-96",children:e}),width:384},{title:"Type",dataIndex:"field_type",key:"field_type",render:(e,t)=>{var i;let n=null==l?void 0:l.find(e=>e.fides_key===t.field_type),r=null!==(i=null==n?void 0:n.name)&&void 0!==i?i:(0,j.S)(t);return(0,a.jsx)(x.Z,{value:r})}},{title:"Applies to",dataIndex:"resource_type",key:"resource_type",render:(e,t)=>{let i,{resource_type:n}=t;if(n in b)i=b[n];else{var r,s;i=null!==(s=null==l?void 0:null===(r=l.find(e=>e.fides_key===n))||void 0===r?void 0:r.name)&&void 0!==s?s:n}return(0,a.jsx)(x.Z,{value:i})}},{title:"Enabled",dataIndex:"active",key:"active",hidden:!d,render:(e,t)=>(0,a.jsx)(_,{field:t,isDisabled:!d}),width:96},{title:"Actions",key:"actions",render:(e,i)=>(0,a.jsx)(r.kCb,{gap:"middle",children:(0,a.jsx)(r.zxk,{size:"small",onClick:()=>t.push("".concat(m.WC,"/").concat(i.id)),"data-testid":"edit-btn",children:"Edit"})}),hidden:!d,width:96}],[l,t,d,e.searchQuery,d]),searchQuery:e.searchQuery,updateSearch:e.updateSearch,onAddClick:()=>t.push("".concat(m.WC,"/new"))}},A=()=>{let{tableProps:e,columns:t,searchQuery:i,updateSearch:n,onAddClick:s}=E();return(0,a.jsxs)(r.kCb,{vertical:!0,gap:"middle","data-testid":"custom-fields-management",children:[(0,a.jsxs)(r.kCb,{justify:"space-between",className:"sticky -top-6 z-10 bg-white py-4",children:[(0,a.jsx)(d.f,{value:i,onChange:n,placeholder:"Search custom fields..."}),(0,a.jsx)(r.zxk,{onClick:s,type:"primary","data-testid":"add-custom-field-btn",children:"Add custom field"})]}),(0,a.jsx)(r.iA_,{...e,columns:t,className:"-mt-4"})]})},C=()=>{let{error:e}=(0,v.GH)();return e?(0,a.jsx)(l.Z,{error:e,defaultMessage:"A problem occurred while fetching custom fields"}):(0,a.jsxs)(n.Z,{title:"Custom fields",children:[(0,a.jsx)(o.Z,{heading:"Custom fields",isSticky:!1,className:"pb-0",children:(0,a.jsx)(r.Typography.Paragraph,{className:"max-w-screen-md",children:"Custom fields provide organizations with the capability to capture metrics that are unique to their specific needs, allowing them to create customized reports. These fields can be added to either systems or elements within a taxonomy, and once added, they become reportable fields that are visible on the data map."})}),(0,a.jsx)(A,{})]})}}},function(e){e.O(0,[431,7245,7552,4899,2888,9774,179],function(){return e(e.s=1770)}),_N_E=e.O()}]);