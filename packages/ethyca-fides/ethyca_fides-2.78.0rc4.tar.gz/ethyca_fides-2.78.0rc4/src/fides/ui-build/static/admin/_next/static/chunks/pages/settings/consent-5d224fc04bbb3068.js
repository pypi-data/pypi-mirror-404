(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[210],{53748:function(e,i,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/consent",function(){return n(96236)}])},56358:function(e,i,n){"use strict";n.d(i,{q:function(){return s}});var t=n(24246);let s=(0,n(36010).G1m)({displayName:"TrashCanOutlineIcon",viewBox:"0 0 11 12",path:(0,t.jsx)("path",{d:"M4.5166 1.60859L4.1084 2.21875H7.22363L6.81543 1.60859C6.7832 1.56133 6.72949 1.53125 6.67148 1.53125H4.6584C4.60039 1.53125 4.54668 1.55918 4.51445 1.60859H4.5166ZM7.6748 1.03711L8.46328 2.21875H8.75977H9.79102H9.96289C10.2486 2.21875 10.4785 2.44863 10.4785 2.73438C10.4785 3.02012 10.2486 3.25 9.96289 3.25H9.79102V9.78125C9.79102 10.7309 9.02188 11.5 8.07227 11.5H3.25977C2.31016 11.5 1.54102 10.7309 1.54102 9.78125V3.25H1.36914C1.0834 3.25 0.853516 3.02012 0.853516 2.73438C0.853516 2.44863 1.0834 2.21875 1.36914 2.21875H1.54102H2.57227H2.86875L3.65723 1.03496C3.88066 0.701953 4.25664 0.5 4.6584 0.5H6.67148C7.07324 0.5 7.44922 0.701953 7.67266 1.03496L7.6748 1.03711ZM2.57227 3.25V9.78125C2.57227 10.1615 2.87949 10.4688 3.25977 10.4688H8.07227C8.45254 10.4688 8.75977 10.1615 8.75977 9.78125V3.25H2.57227ZM4.29102 4.625V9.09375C4.29102 9.28281 4.13633 9.4375 3.94727 9.4375C3.7582 9.4375 3.60352 9.28281 3.60352 9.09375V4.625C3.60352 4.43594 3.7582 4.28125 3.94727 4.28125C4.13633 4.28125 4.29102 4.43594 4.29102 4.625ZM6.00977 4.625V9.09375C6.00977 9.28281 5.85508 9.4375 5.66602 9.4375C5.47695 9.4375 5.32227 9.28281 5.32227 9.09375V4.625C5.32227 4.43594 5.47695 4.28125 5.66602 4.28125C5.85508 4.28125 6.00977 4.43594 6.00977 4.625ZM7.72852 4.625V9.09375C7.72852 9.28281 7.57383 9.4375 7.38477 9.4375C7.1957 9.4375 7.04102 9.28281 7.04102 9.09375V4.625C7.04102 4.43594 7.1957 4.28125 7.38477 4.28125C7.57383 4.28125 7.72852 4.43594 7.72852 4.625Z",fill:"currentColor"})})},77213:function(e,i,n){"use strict";n.d(i,{Z:function(){return g}});var t=n(24246),s=n(36010),l=n(88038),r=n.n(l),a=n(86677);n(27378);var o=n(25980),d=n(90867),c=n(42478),u=n(77830),p=()=>{let e=(0,a.useRouter)();return(0,t.jsx)(s.TJV,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,t.jsxs)(s.TJV,{children:[(0,t.jsxs)(s.EO$,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,t.jsx)(s.Bjg,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,t.jsx)(s.zxk,{onClick:()=>{e.push(u.AD)},children:"Configure"})]}),(0,t.jsxs)(s.Bjg,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},g=e=>{let{children:i,title:n,padded:l=!0,mainProps:u}=e,g=(0,o.hz)(),_=(0,a.useRouter)(),h="/privacy-requests"===_.pathname||"/datastore-connection"===_.pathname,v=!(g.flags.messagingConfiguration&&h),{data:m}=(0,c.JE)(void 0,{skip:v}),{data:b}=(0,d.PW)(void 0,{skip:v}),f=g.flags.messagingConfiguration&&(!m||!b)&&h;return(0,t.jsxs)(s.ad9,{"data-testid":n,direction:"column",h:"100vh",children:[(0,t.jsxs)(r(),{children:[(0,t.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,t.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsxs)(s.ad9,{as:"main",direction:"column",py:l?6:0,px:l?10:0,h:l?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...u,children:[f?(0,t.jsx)(p,{}):null,i]})]})}},19904:function(e,i,n){"use strict";n.d(i,{Tg:function(){return r}});var t=n(24246),s=n(16134),l=n(31793);let r=e=>(0,s.C)(l.uu).filter(i=>e.includes(i)).length>0;i.ZP=e=>{let{scopes:i,children:n}=e;return r(i)?(0,t.jsx)(t.Fragment,{children:n}):null}},42478:function(e,i,n){"use strict";n.d(i,{FU:function(){return d},JE:function(){return s},Ki:function(){return u},SU:function(){return p},W:function(){return g},h9:function(){return l},jc:function(){return t},qt:function(){return o},sn:function(){return c}});let{useGetEmailInviteStatusQuery:t,useGetActiveMessagingProviderQuery:s,useCreateMessagingConfigurationMutation:l,useCreateMessagingConfigurationSecretsMutation:r,useGetMessagingConfigurationDetailsQuery:a,useGetMessagingConfigurationsQuery:o,useGetMessagingConfigurationByKeyQuery:d,useUpdateMessagingConfigurationByKeyMutation:c,useUpdateMessagingConfigurationSecretsByKeyMutation:u,useCreateTestConnectionMessageMutation:p,useDeleteMessagingConfigurationByKeyMutation:g}=n(78780).u.injectEndpoints({endpoints:e=>({getEmailInviteStatus:e.query({query:()=>({url:"/messaging/email-invite/status"}),providesTags:()=>["Email Invite Status"]}),createMessagingConfiguration:e.mutation({query:e=>({url:"messaging/config",method:"POST",body:e}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getActiveMessagingProvider:e.query({queryFn:async(e,i,n,t)=>{let s=await t({url:"messaging/default/active"});return s.error&&404===s.error.status?{data:null}:s},providesTags:["Messaging Config"]}),createMessagingConfigurationSecrets:e.mutation({query:e=>({url:"messaging/default/".concat(e.service_type,"/secret"),method:"PUT",body:e.details}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getMessagingConfigurationDetails:e.query({query:e=>({url:"messaging/default/".concat(e.type)}),providesTags:["Messaging Config"]}),getMessagingConfigurations:e.query({query:()=>({url:"messaging/config"}),providesTags:["Messaging Config"]}),getMessagingConfigurationByKey:e.query({query:e=>({url:"messaging/config/".concat(e.key)}),providesTags:["Messaging Config"]}),createTestConnectionMessage:e.mutation({query:e=>({url:"messaging/test/".concat(e.service_type),method:"POST",body:e.details}),invalidatesTags:["Messaging Config"]}),updateMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"PATCH",body:e.config}),invalidatesTags:["Messaging Config","Configuration Settings"]}),updateMessagingConfigurationSecretsByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key,"/secret"),method:"PUT",body:e.secrets}),invalidatesTags:["Messaging Config","Configuration Settings"]}),deleteMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"DELETE"}),invalidatesTags:["Messaging Config","Configuration Settings"]})})})},60325:function(e,i,n){"use strict";n.d(i,{DD:function(){return a},Go:function(){return o},TK:function(){return s},Uv:function(){return c},k1:function(){return l},y3:function(){return u}});var t=n(60240);let s=e=>{var i;return null!==(i=null==e?void 0:e.filter(e=>e.selected).map(e=>e.id))&&void 0!==i?i:[]},l=e=>{var i;return null!==(i=null==e?void 0:e.filter(e=>e.selected))&&void 0!==i?i:[]},r=[{language:t.eU.EN,is_default:!0,title:"Title",description:"Description",accept_button_label:"Accept",reject_button_label:"Reject",save_button_label:"Save",acknowledge_button_label:"OK",privacy_preferences_link_label:"Privacy Preferences"}],a={name:"",disabled:!1,dismissable:!0,allow_language_selection:!1,show_layer1_notices:!1,layer1_button_options:t.Of.OPT_IN_OPT_OUT,regions:[],translations:r,auto_detect_language:!0,auto_subdomain_cookie_deletion:!0,cookie_deletion_based_on_host_domain:!0,allow_vendor_asset_disclosure:!1,asset_disclosure_include_types:[]},o=(e,i)=>{let n=i.find(i=>i.id===e.language);return n?n.name:e.language},d=e=>{var i,n,t,s,l,r,a,o,d,c,u,p,g,_;let{language:h,is_default:v,accept_button_label:m,reject_button_label:b}=e;return{language:h,is_default:v,accept_button_label:m,reject_button_label:b,title:e.title,description:e.description,acknowledge_button_label:null!==(i=e.acknowledge_button_label)&&void 0!==i?i:void 0,banner_title:null!==(n=e.banner_title)&&void 0!==n?n:void 0,banner_description:null!==(t=e.banner_description)&&void 0!==t?t:void 0,gpc_label:null!==(s=e.gpc_label)&&void 0!==s?s:void 0,gpc_title:null!==(l=e.gpc_title)&&void 0!==l?l:void 0,gpc_description:null!==(r=e.gpc_description)&&void 0!==r?r:void 0,gpc_status_applied_label:null!==(a=e.gpc_status_applied_label)&&void 0!==a?a:void 0,gpc_status_overridden_label:null!==(o=e.gpc_status_overridden_label)&&void 0!==o?o:void 0,purpose_header:null!==(d=e.purpose_header)&&void 0!==d?d:void 0,privacy_policy_link_label:null!==(c=e.privacy_policy_link_label)&&void 0!==c?c:void 0,privacy_policy_url:null!==(u=e.privacy_policy_url)&&void 0!==u?u:void 0,privacy_preferences_link_label:null!==(p=e.privacy_preferences_link_label)&&void 0!==p?p:void 0,save_button_label:null!==(g=e.save_button_label)&&void 0!==g?g:void 0,modal_link_label:null!==(_=e.modal_link_label)&&void 0!==_?_:void 0}},c=e=>{let{created_at:i,updated_at:n,privacy_notices:s,origin:l,id:r,...a}=e,o={...a,privacy_notice_ids:s?s.map(e=>e.id):[],translations:e.translations?e.translations.map(e=>d(e)):[]};return(o.component===t.re.BANNER_AND_MODAL||o.component===t.re.MODAL)&&o.allow_vendor_asset_disclosure&&(!o.asset_disclosure_include_types||0===o.asset_disclosure_include_types.length)&&(o.allow_vendor_asset_disclosure=!1),o},u=e=>e===t.re.PRIVACY_CENTER?{title:{included:!0,required:!0},description:{included:!0,required:!0},save_button_label:{included:!0,required:!0},accept_button_label:{included:!0,required:!0},reject_button_label:{included:!0,required:!0},privacy_policy_link_label:{included:!0},privacy_policy_url:{included:!0},modal_link_label:{included:!0}}:e===t.re.MODAL?{title:{included:!0,required:!0},description:{included:!0,required:!0},accept_button_label:{included:!0,required:!0},reject_button_label:{included:!0,required:!0},save_button_label:{included:!0,required:!0},acknowledge_button_label:{included:!0,required:!0},privacy_policy_link_label:{included:!0},privacy_policy_url:{included:!0},privacy_preferences_link_label:{included:!0},modal_link_label:{included:!0},gpc_label:{included:!0},gpc_title:{included:!0},gpc_description:{included:!0},gpc_status_applied_label:{included:!0},gpc_status_overridden_label:{included:!0}}:e===t.re.BANNER_AND_MODAL?{title:{included:!0,required:!0},banner_title:{included:!0},description:{included:!0,required:!0},banner_description:{included:!0},accept_button_label:{included:!0,required:!0},reject_button_label:{included:!0,required:!0},save_button_label:{included:!0,required:!0},acknowledge_button_label:{included:!0,required:!0},privacy_policy_link_label:{included:!0},privacy_policy_url:{included:!0},privacy_preferences_link_label:{included:!0,required:!0},modal_link_label:{included:!0},gpc_label:{included:!0},gpc_title:{included:!0},gpc_description:{included:!0},gpc_status_applied_label:{included:!0},gpc_status_overridden_label:{included:!0}}:e===t.re.TCF_OVERLAY?{title:{included:!0,required:!0},banner_title:{included:!0},description:{included:!0,required:!0},banner_description:{included:!0},purpose_header:{included:!0},accept_button_label:{included:!0,required:!0},reject_button_label:{included:!0,required:!0},save_button_label:{included:!0,required:!0},acknowledge_button_label:{included:!0,required:!0},privacy_policy_link_label:{included:!0},privacy_policy_url:{included:!0},privacy_preferences_link_label:{included:!0,required:!0},modal_link_label:{included:!0}}:{title:{included:!0,required:!0},description:{included:!0,required:!0},accept_button_label:{included:!0,required:!0},reject_button_label:{included:!0,required:!0},save_button_label:{included:!0,required:!0},acknowledge_button_label:{included:!0,required:!0},privacy_policy_link_label:{included:!0},privacy_policy_url:{included:!0},privacy_preferences_link_label:{included:!0,required:!0},modal_link_label:{included:!0}}},96236:function(e,i,n){"use strict";n.r(i),n.d(i,{default:function(){return Q}});var t=n(24246),s=n(36010),l=n(34090),r=n(27378),a=n(16134),o=n(25980),d=n(812),c=n(77213),u=n(58754),p=n(6675),g=n(46628),_=n(7426),h=n(40324);let v=[1,3,4,5,6];var m=()=>{let{values:e,setFieldValue:i}=(0,l.u6)(),{purposes:n}=(0,a.C)(p.ZS),o=(0,r.useMemo)(()=>e.purposeOverrides.map((e,i)=>({...e,index:i})),[e.purposeOverrides]),d=(0,r.useMemo)(()=>[{title:"TCF purpose",key:"purpose",render:(e,i)=>{var s;return(0,t.jsxs)(t.Fragment,{children:["Purpose ",i.purpose,": ",null===(s=n[i.purpose])||void 0===s?void 0:s.name]})}},{title:"Allowed",key:"allowed",width:100,align:"center",render:(e,n)=>(0,t.jsx)(h.w8,{name:"purposeOverrides[".concat(n.index,"].is_included"),onChange:e=>{e||(i("purposeOverrides[".concat(n.index,"].is_consent"),!1),i("purposeOverrides[".concat(n.index,"].is_legitimate_interest"),!1))}})},{title:"Consent",key:"consent",width:100,align:"center",render:(i,n)=>v.includes(n.purpose)?null:(0,t.jsx)(h.w8,{isDisabled:!e.purposeOverrides[n.index].is_included||e.purposeOverrides[n.index].is_legitimate_interest,name:"purposeOverrides[".concat(n.index,"].is_consent")})},{title:"Legitimate interest",key:"legitimate_interest",width:150,align:"center",render:(i,n)=>v.includes(n.purpose)?null:(0,t.jsx)(h.w8,{isDisabled:!e.purposeOverrides[n.index].is_included||e.purposeOverrides[n.index].is_consent,name:"purposeOverrides[".concat(n.index,"].is_legitimate_interest")})}],[n,e.purposeOverrides,i]);return(0,t.jsx)(l.F2,{name:"purposeOverrides",render:()=>(0,t.jsx)(s.iA_,{dataSource:o,columns:d,rowKey:"purpose",pagination:!1,size:"small",bordered:!0,"data-testid":"deprecated-purpose-overrides-table"})})},b=n(59301),f=e=>{let{name:i,enabled:n}=e;return(0,t.jsxs)(s.EO$,{spacing:2,fontSize:"sm",lineHeight:"5",fontWeight:"medium",color:"gray.700",children:[(0,t.jsxs)(s.Bjg,{children:[i," status"," ",n?(0,t.jsx)(s.Vp9,{color:"success",children:"Enabled"}):(0,t.jsx)(s.Vp9,{color:"error",children:"Disabled"})]}),(0,t.jsxs)(s.Bjg,{children:["To ",n?"disable":"enable"," ",i,", please contact your Fides administrator or"," ",(0,t.jsx)(b.Z,{href:"mailto:support@ethyca.com",children:"Ethyca support"}),"."]})]})},x=n(46238),y=e=>{var i,n;let{label:r,options:a,layout:o,defaultFirstSelected:d=!0,...c}=e,[u,p]=(0,l.U$)(c),g={...u,value:null!==(i=u.value)&&void 0!==i?i:""},_=!!(p.touched&&p.error),v=d?a[0]:void 0,m=null!==(n=a.find(e=>e.value===g.value))&&void 0!==n?n:v,b=e=>{g.onChange(c.name)(e.target.value)};return"stacked"===o?(0,t.jsxs)(s.DTt,{isInvalid:_,children:[(0,t.jsxs)(s.kCb,{className:"w-fit",children:[r?(0,t.jsx)(h.__,{children:r}):null,(0,t.jsx)(s.Y8K.Group,{onChange:b,value:null==m?void 0:m.value,"data-testid":"input-".concat(g.name),children:(0,t.jsx)(s.kCb,{className:"flex-col gap-3",children:a.map(e=>{let{value:i,label:n,tooltip:l}=e;return(0,t.jsx)(s.Y8K,{value:i,"data-testid":"option-".concat(i),children:(0,t.jsxs)(s.kCb,{className:"items-center gap-2",children:[(0,t.jsx)(s.Bjg,{fontSize:"sm",fontWeight:"medium",children:n}),l?(0,t.jsx)(x.b,{label:l}):null]})},i)})})})]}),(0,t.jsx)(h.Bc,{isInvalid:_,message:p.error,fieldName:g.name})]}):(0,t.jsxs)(s.DTt,{isInvalid:_,children:[(0,t.jsxs)(s.MoG,{templateColumns:"1fr 3fr",children:[(0,t.jsx)(h.__,{children:r}),(0,t.jsx)(s.Y8K.Group,{onChange:b,value:null==m?void 0:m.value,"data-testid":"input-".concat(g.name),children:(0,t.jsx)(s.kCb,{children:a.map(e=>(0,t.jsx)(s.Y8K,{value:e.value,"data-testid":"option-".concat(e.value),children:e.label},e.value))})})]}),(0,t.jsx)(h.Bc,{isInvalid:_,message:p.error,fieldName:g.name})]})},j=n(60240),C=n(51263);let w=e=>{let{name:i,label:n,tooltip:r,onChange:a}=e,[o]=(0,l.U$)({name:i,type:"checkbox"});return(0,t.jsx)(s.l09.Item,{tooltip:r,children:(0,t.jsx)(s.XZJ,{name:o.name,checked:o.checked,onChange:e=>{o.onChange(e),null==a||a(e.target.checked)},onBlur:o.onBlur,"data-testid":"input-".concat(o.name),children:n})})},T=e=>{let{title:i,children:n}=e;return(0,t.jsxs)(s.EO$,{spacing:3,mb:3,"data-testid":"section-".concat(i),children:[(0,t.jsx)(s.Bjg,{fontSize:"sm",fontWeight:"bold",lineHeight:5,color:"gray.700",children:i}),n]})};var k=()=>{let{tcf:e}=(0,o.hz)(),i=!!(0,a.C)(_.D2).enabled,{values:n,setFieldValue:r}=(0,l.u6)(),d=!!n.gpp.us_approach;return(0,t.jsx)(C.Z,{title:"Global Privacy Platform",children:(0,t.jsxs)(s.EO$,{spacing:6,children:[(0,t.jsx)(f,{name:"GPP",enabled:i}),i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T,{title:"GPP U.S.",children:(0,t.jsx)(y,{name:"gpp.us_approach",layout:"stacked",defaultFirstSelected:!1,options:[{label:"Enable U.S. National",value:j.en.NATIONAL,tooltip:"When US National is selected, Fides will present the same privacy notices to all consumers located anywhere in the United States."},{label:"Enable U.S. State-by-State",value:j.en.STATE,tooltip:"When state-by-state is selected, Fides will only present consent to consumers and save their preferences if they are located in a state that is supported by the GPP. The consent options presented to consumers will vary depending on the regulations in each state."},{label:"Enable US National and State-by-State notices",value:j.en.ALL,tooltip:"When enabled, Fides can be configured to serve the National and U.S. state notices. This mode is intended to provide consent coverage to U.S. states with new privacy laws where GPP support lags behind the effective date of state laws."}]})}),d?(0,t.jsxs)(T,{title:"MSPA",children:[(0,t.jsx)("div",{className:"font-medium",children:(0,t.jsx)(w,{name:"gpp.mspa_covered_transactions",label:"All transactions covered by MSPA",tooltip:"When selected, the Fides CMP will communicate to downstream vendors that all preferences are covered under the MSPA.",onChange:e=>{e||(r("gpp.mspa_service_provider_mode",!1),r("gpp.mspa_opt_out_option_mode",!1))}})}),(0,t.jsx)(h.w8,{label:"Enable MSPA service provider mode",name:"gpp.mspa_service_provider_mode",variant:"switchFirst",tooltip:"Enable service provider mode if you do not engage in any sales or sharing of personal information.",isDisabled:!!n.gpp.mspa_opt_out_option_mode||!n.gpp.mspa_covered_transactions}),(0,t.jsx)(h.w8,{label:"Enable MSPA opt-out option mode",name:"gpp.mspa_opt_out_option_mode",variant:"switchFirst",tooltip:"Enable opt-out option mode if you engage or may engage in the sales or sharing of personal information, or process any information for the purpose of targeted advertising.",isDisabled:!!n.gpp.mspa_service_provider_mode||!n.gpp.mspa_covered_transactions})]}):null]}):null,e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.KMv,{color:"gray.200"}),(0,t.jsxs)(T,{title:"GPP Europe",children:[(0,t.jsx)(s.Bjg,{fontSize:"sm",fontWeight:"medium",children:"Configure TCF string for Global Privacy Platform"}),(0,t.jsx)(h.w8,{label:"Enable TC string",name:"gpp.enable_tcfeu_string",variant:"switchFirst",tooltip:"When enabled, the GPP API will include a TCF EU consent string for users who are in regions where TCF applies."})]})]}):null]})})},S=n(64781),E=n(60325),N=()=>{var e,i,n;let{tcf:r}=(0,o.hz)(),{values:a,setFieldValue:d}=(0,l.u6)(),{data:c,isLoading:u}=(0,S.gT)(),p=[...(0,E.k1)(null!==(i=null==c?void 0:c.locations)&&void 0!==i?i:[]),...(0,E.k1)(null!==(n=null==c?void 0:c.location_groups)&&void 0!==n?n:[])].sort((e,i)=>e.name<i.name?-1:1);return r?(0,t.jsxs)(C.Z,{title:"Publisher settings",children:[(0,t.jsx)(s.Typography.Paragraph,{className:"mb-3",children:"Specify the country in which your organization operates for TCF compliance. This setting will determine the 'Publisher Country Code ' transmitted in the Transparency and Consent (TC) Data."}),(0,t.jsx)(s.l09.Item,{label:"Publisher country",htmlFor:"publisher_country_code",children:(0,t.jsx)(s.AOh,{"data-testid":"input-publisher_settings.publisher_country_code",id:"publisher_country_code",loading:u,allowClear:!0,options:(0,s.Ky_)(null==p?void 0:p.map(e=>e.id)),placeholder:"Select a country",value:null===(e=a.tcfPublisherSettings.publisher_country_code)||void 0===e?void 0:e.replace("_","-").toUpperCase(),onChange:e=>d("tcfPublisherSettings.publisher_country_code",null==e?void 0:e.toLowerCase()),className:"!w-80"})})]}):null},q=n(52955),P=n(71795),O=n(59512),M=n(55484),I=n(8133),F=n(31883);let A=M.Ry().shape({name:M.Z_().required().label("Name")}),z=e=>{let{isOpen:i,onClose:n,onSuccess:r}=e,a=(0,s.p8r)(),[o]=(0,q.LK)(),c=async e=>{let i=await o({name:e.name});(0,F.D4)(i)?a((0,g.Vo)((0,d.e$)(i.error))):(a((0,g.t5)("Successfully created TCF configuration")),null==r||r(i.data.id),n())};return(0,t.jsx)(I.Z,{title:"Create a new TCF configuration",isOpen:i,onClose:n,children:(0,t.jsx)(l.J9,{initialValues:{name:""},onSubmit:c,validationSchema:A,children:e=>{let{isValid:i,dirty:r}=e;return(0,t.jsx)(l.l0,{children:(0,t.jsxs)(s.TaI,{direction:"vertical",size:"small",className:"w-full",children:[(0,t.jsx)(s.Bjg,{children:"TCF configurations allow you to define unique sets of publisher restrictions. These configurations can be added to privacy experiences."}),(0,t.jsx)(h.j0,{id:"name",name:"name",label:"Name",isRequired:!0,variant:"stacked"}),(0,t.jsxs)(s.TaI,{className:"w-full justify-end pt-6",children:[(0,t.jsx)(s.zxk,{onClick:n,children:"Cancel"}),(0,t.jsx)(s.zxk,{type:"primary",htmlType:"submit",disabled:!i||!r,"data-testid":"save-config-button",children:"Save"})]})]})})}})})};var L=n(79894),B=n.n(L),D=n(24813);let{Text:V}=s.Typography,R=e=>{let{className:i,config:n,isLoading:l}=e,{purposes:o}=(0,a.C)(p.ZS),d=(0,r.useMemo)(()=>Object.values(o),[o]),c=(0,r.useMemo)(()=>[{title:"TCF purpose",key:"purpose",render:(e,i)=>(0,t.jsxs)(t.Fragment,{children:["Purpose ",i.id,": ",i.name]})},{title:(0,t.jsx)(D.ED,{value:"Restrictions",tooltip:"Restrictions control how vendors are permitted to process data for specific purposes. Fides supports three restriction types: Purpose Restriction to completely disallow data processing for a purpose, Require Consent to allow processing only with explicit user consent, and Require Legitimate Interest to allow processing based on legitimate business interest unless the user objects."}),key:"restrictions",dataIndex:"id",render:e=>{var i,r;if(l)return(0,t.jsx)(s.OdW,{paragraph:!1,active:!0});let a=null!==(r=null==n?void 0:null===(i=n.restriction_types_per_purpose)||void 0===i?void 0:i[e])&&void 0!==r?r:[];return 0===a.length?"none":1===a.length?(0,t.jsx)(V,{className:"whitespace-nowrap",children:O.fj[a[0]]}):(0,t.jsxs)(V,{className:"whitespace-nowrap",children:[a.length," restrictions"]})},onCell:e=>({"data-testid":"restriction-type-cell-".concat(e.id)})},{title:(0,t.jsx)(D.ED,{value:"Flexible",tooltip:'Indicates whether the legal basis for this purpose can be overridden by publisher restrictions. If marked "No," the purpose has a fixed legal basis defined by the TCF and cannot be changed.'}),key:"flexible",dataIndex:"id",width:100,render:e=>O.Py.includes(e)?(0,t.jsx)(s.Vp9,{color:"error","data-testid":"flexibility-tag-".concat(e),children:"No"}):(0,t.jsx)(s.Vp9,{color:"success","data-testid":"flexibility-tag-".concat(e),children:"Yes"})},{title:"Actions",key:"actions",width:100,render:(e,i)=>(0,t.jsx)(B(),{href:"/settings/consent/".concat(null==n?void 0:n.id,"/").concat(i.id),passHref:!0,legacyBehavior:!0,children:(0,t.jsx)(s.zxk,{size:"small","data-testid":"edit-restriction-btn-".concat(i.id),children:"Edit"})})}],[n,l]);return(0,t.jsx)(s.iA_,{className:i,dataSource:d,columns:c,rowKey:"id",pagination:!1,size:"small",bordered:!0,"data-testid":"publisher-restrictions-table"})};var Z=n(56358),U=n(19904);let H=()=>(0,t.jsxs)(s.TaI,{direction:"vertical",size:"small",children:[(0,t.jsx)(s.ug1,{width:"100%",className:"h-4"}),(0,t.jsx)(s.ug1,{width:"100%",className:"h-4"}),(0,t.jsx)(s.ug1,{width:"100%",className:"h-4"})]}),$=e=>{let{searchResults:i,selectedConfigId:n,handleSelection:l,userCanDeleteConfigs:r,onDeleteOpen:a,setConfigToDelete:o}=e;return(0,t.jsx)(s.Y8K.Group,{onChange:e=>l(e.target.value),value:n,className:"flex flex-col gap-2",children:i.map(e=>(0,t.jsxs)(s.kCb,{className:r?"justify-between":"justify-start","data-testid":"tcf-config-item-".concat(e.id),children:[(0,t.jsx)(s.Y8K,{value:e.id,name:"tcf-config-id","data-testid":"tcf-config-item",children:(0,t.jsx)(s.Bjg,{className:"text-sm",children:e.name})}),r&&(0,t.jsx)(s.zxk,{type:"text",size:"small","aria-label":"Delete",icon:(0,t.jsx)(Z.q,{fontSize:16}),onClick:i=>{i.stopPropagation(),o(e),a()},"data-testid":"delete-config-button"})]},e.id))})},K=e=>{let i,{searchTerm:n,setSearchTerm:l,searchResults:a,selectedConfigId:o,handleSelection:d,userCanCreateConfigs:c,userCanDeleteConfigs:u,modalOnOpen:p,onDeleteOpen:g,setConfigToDelete:_,isLoading:h,setDropdownOpen:v,configurations:m}=e,[b,f]=(0,r.useState)(o);return(0,r.useEffect)(()=>{f(o)},[o]),i=h?(0,t.jsx)(H,{}):0===a.length?(0,t.jsx)(s.Bjg,{className:"text-center",children:"No configurations found."}):(0,t.jsx)($,{searchResults:a,selectedConfigId:b,handleSelection:e=>{f(e)},userCanDeleteConfigs:u,onDeleteOpen:g,setConfigToDelete:_}),(0,t.jsxs)(s.Zbd,{title:"TCF configurations",className:"min-w-[300px]",extra:(0,t.jsx)(s.zxk,{type:"text",size:"small","aria-label":"Close",icon:(0,t.jsx)(s.j_w,{}),onClick:()=>v(!1),"data-testid":"close-config-dropdown"}),style:{boxShadow:"var(--ant-box-shadow)"},children:[m.length>10&&(0,t.jsx)(s.sPr,{size:"sm",children:(0,t.jsx)(s.IIB,{className:"mb-4",placeholder:"Search...",onChange:e=>l(e.target.value),value:n})}),i,(0,t.jsxs)(s.kCb,{gap:"small",className:"mt-4",children:[c&&(0,t.jsx)(s.zxk,{size:"small",onClick:()=>{p(),v(!1)},className:"flex-1","data-testid":"create-config-button",children:"+ Create"}),(0,t.jsx)(s.zxk,{size:"small",onClick:()=>d(b),className:"flex-1","data-testid":"apply-config-button",disabled:b===o,children:"Apply"})]})]})},G=e=>(0,t.jsx)(K,{...e}),W=e=>{var i;let{selectedConfigId:n,configurations:l,isLoading:a=!1,onConfigurationSelect:o,onConfigurationDelete:c}=e,u=(0,U.Tg)([j.Sh.PRIVACY_EXPERIENCE_CREATE]),p=(0,U.Tg)([j.Sh.PRIVACY_EXPERIENCE_CREATE]),g=(0,s.p8r)({id:"tcf-config-toast"}),[_]=(0,q.Cm)(),{isOpen:h,onOpen:v,onClose:m}=(0,s.E2M)(),{isOpen:b,onOpen:f,onClose:x}=(0,s.E2M)(),[y,C]=(0,r.useState)(""),[w,T]=(0,r.useState)(),[k,S]=(0,r.useState)(!1),E=(0,r.useMemo)(()=>y?l.filter(e=>e.name.toLowerCase().includes(y.toLowerCase())):l,[l,y]),N=(0,r.useMemo)(()=>l.find(e=>e.id===n),[l,n]),P=null!==(i=null==N?void 0:N.name)&&void 0!==i?i:"Select Configuration",O=e=>{o(e),S(!1)},M=async e=>{try{await _(e).unwrap(),null==c||c(e),T(void 0),x(),g({status:"success",description:'Configuration "'.concat(null==w?void 0:w.name,'" was successfully deleted.')})}catch(e){g({status:"error",description:(0,d.e$)(e,"A problem occurred while deleting the configuration.")})}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Ltx,{open:k,onOpenChange:S,trigger:["click"],overlayStyle:{zIndex:999},dropdownRender:()=>G({searchTerm:y,setSearchTerm:C,searchResults:E,selectedConfigId:n,handleSelection:O,userCanCreateConfigs:u,userCanDeleteConfigs:p,modalOnOpen:v,onDeleteOpen:f,setConfigToDelete:T,isLoading:a,setDropdownOpen:S,configurations:l}),children:(0,t.jsx)(s.zxk,{icon:(0,t.jsx)(s.tMo,{}),iconPosition:"end","data-testid":"tcf-config-dropdown-trigger",children:P})}),(0,t.jsx)(z,{isOpen:h,onClose:m,onSuccess:e=>{o(e)}}),(0,t.jsx)(s.cVQ,{isOpen:b,onClose:()=>{T(void 0),x()},onConfirm:()=>{w&&M(w.id)},title:"Delete configuration",message:"Are you sure you want to delete this configuration? This action cannot be undone."})]})};var Y=n(32885);let J=e=>{let{defaultChecked:i,onChange:n,...l}=e,a=(0,s.p8r)(),[o,c]=(0,r.useState)(i),[u,p]=(0,r.useState)(!1),{isLoading:h}=(0,Y.x8)(),[v,{isLoading:m}]=(0,_.L)(),[b]=(0,Y.M7)(),{data:f}=(0,Y.n3)(void 0,{skip:h}),y=async e=>{let i=await v({consent:{override_vendor_purposes:e}});e&&f&&await b(f.map(e=>({...e,is_included:!0,required_legal_basis:void 0}))),(i=>{if(a.closeAll(),null==n||n(e),(0,F.D4)(i)){let e=(0,d.e$)(i.error,"An unexpected error occurred while saving vendor override settings. Please try again.");null==n||n(!1),a((0,g.Vo)(e))}})(i)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.TaI,{direction:"vertical",size:"small",children:[(0,t.jsx)(s.Bjg,{children:"Configure overrides for TCF related purposes."}),(0,t.jsxs)(s.TaI,{size:"small",children:[(0,t.jsx)(s.rsf,{size:"small",disabled:m,loading:m,...l,checked:o,defaultChecked:i,onClick:e=>{e?(c(e),y(e)):p(!0)},"data-testid":"tcf-override-toggle"}),(0,t.jsx)(s.Bjg,{children:"Override vendor purposes"}),(0,t.jsx)(x.b,{label:"Toggle on if you want to globally change any flexible legal bases or remove TCF purposes from your CMP"})]})]}),(0,t.jsx)(s.cVQ,{isOpen:u,onClose:()=>p(!1),onConfirm:()=>{c(!1),y(!1),p(!1)},title:"Disable Vendor Overrides",message:"Are you sure you want to disable vendor overrides? Clicking 'Continue' will immediately remove any custom configurations you have set for TCF purposes for all experiences."})]})},X=e=>{var i;let{isTCFOverrideEnabled:n}=e,[l,a]=(0,r.useState)(n),[o,d]=(0,r.useState)(!1),[c,u]=(0,P._)("selectedTCFConfigId",null),{data:p,isLoading:g}=(0,q.LS)({page:1,size:50},{skip:!n}),{data:_,isFetching:h}=(0,q.NZ)(c||"",{skip:!c});return(0,r.useEffect)(()=>{var e,i;!g&&(null==p?void 0:null===(e=p.items)||void 0===e?void 0:e.length)&&!c&&u(p.items[0].id),g||!c||(null==p?void 0:null===(i=p.items)||void 0===i?void 0:i.length)||u(null)},[g,null==p?void 0:p.items,c,u]),(0,t.jsxs)(C.Z,{title:"Publisher restrictions",fontSize:"sm",children:[(0,t.jsxs)(s.TaI,{direction:"vertical",size:"small",style:{width:"100%"},children:[(0,t.jsx)(J,{defaultChecked:l,onChange:e=>a(e)}),l&&(0,t.jsxs)(t.Fragment,{children:[g&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.ug1,{height:"20px"}),(0,t.jsx)(s.ug1,{height:"20px"}),(0,t.jsx)(s.ug1,{height:"32px",width:"200px"})]}),!g&&(null==p?void 0:null===(i=p.items)||void 0===i?void 0:i.length)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Bjg,{children:"The table below allows you to adjust which TCF purposes you allow as part of your user facing notices and business activities."}),(0,t.jsxs)(s.Bjg,{children:["To configure this section, select a TCF purpose to edit the restriction type and vendors."," ",(0,t.jsx)(b.Z,{href:O.uh,children:"Learn more about publisher restrictions"})," ","in our docs."]}),(0,t.jsx)(W,{selectedConfigId:c||"",configurations:(null==p?void 0:p.items)||[],onConfigurationSelect:u})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.Bjg,{children:['To define custom publisher restrictions select "create configuration" below.'," ",(0,t.jsx)(b.Z,{href:O.uh,children:"Learn more about publisher restrictions"})," ","in our docs."]}),(0,t.jsx)(s.zxk,{onClick:()=>d(!0),"data-testid":"create-config-button",children:"Create configuration +"})]})]})]}),(0,t.jsx)(z,{isOpen:o,onClose:()=>d(!1),onSuccess:e=>{u(e)}}),l&&c&&(0,t.jsx)(R,{className:"mt-3",config:_,isLoading:h})]})};var Q=()=>{var e,i;let{isLoading:n}=(0,Y.x8)(),{tcf:h}=(0,o.hz)(),{data:v,isLoading:b}=(0,Y.n3)(void 0,{skip:n||!h}),[x,{isLoading:y}]=(0,Y.M7)(),{data:w,isLoading:T}=(0,_.tB)({api_set:!0}),{data:S,isLoading:E}=(0,_.tB)({api_set:!1}),[q]=(0,_.L)(),P=(0,a.C)(_.D2),O=(0,a.C)(_.Yh),M=(0,r.useMemo)(()=>w&&(null==w?void 0:w.consent)&&"override_vendor_purposes"in w.consent?w.consent.override_vendor_purposes:!!S&&null!=S&&!!S.consent&&"override_vendor_purposes"in S.consent&&S.consent.override_vendor_purposes,[w,S]),{isLoading:I}=(0,p.a4)(),F=(0,s.p8r)(),A=async e=>{var i;let n=e=>{if(F.closeAll(),(0,d.D4)(e)){let i=(0,d.e$)(e.error,"An unexpected error occurred while saving. Please try again.");F((0,g.Vo)(i))}else F((0,g.t5)("Settings saved successfully"))},t=[...e.purposeOverrides.map(e=>{let i;return e.is_consent&&(i=j.I$.CONSENT),e.is_legitimate_interest&&(i=j.I$.LEGITIMATE_INTERESTS),{purpose:e.purpose,is_included:e.is_included,required_legal_basis:i}})];if(M){let e=await x(t);if((0,d.D4)(e)){n(e);return}}let{enabled:s,...l}=e.gpp;n(await q({gpp:l,plus_consent_settings:{tcf_publisher_country_code:null!==(i=e.tcfPublisherSettings.publisher_country_code)&&void 0!==i?i:null}}))},z=(0,r.useMemo)(()=>({purposeOverrides:v?v.map(e=>({purpose:e.purpose,is_included:e.is_included,is_consent:e.required_legal_basis===j.I$.CONSENT,is_legitimate_interest:e.required_legal_basis===j.I$.LEGITIMATE_INTERESTS})):[],gpp:P,tcfPublisherSettings:{publisher_country_code:O.tcf_publisher_country_code}}),[v,P,O]),L=(0,r.useMemo)(()=>(null==v?void 0:v.some(e=>!e.is_included||e.required_legal_basis===j.I$.CONSENT||e.required_legal_basis===j.I$.LEGITIMATE_INTERESTS))||!1,[v]),B=null===(i=(0,o.hz)())||void 0===i?void 0:null===(e=i.flags)||void 0===e?void 0:e.publisherRestrictions;return(0,t.jsx)(c.Z,{title:"Consent Configuration",children:n||I||b||T||E?(0,t.jsx)(s.ad9,{justifyContent:"center",alignItems:"center",height:"100%",children:(0,t.jsx)(s.Y6B,{})}):(0,t.jsxs)(s.TJV,{"data-testid":"consent-configuration",children:[(0,t.jsx)(u.Z,{heading:"Consent settings"}),(0,t.jsxs)(s.EO$,{spacing:3,mb:3,children:[(0,t.jsx)(C.Z,{title:"Transparency & Consent Framework settings",children:(0,t.jsx)(f,{name:"TCF",enabled:h})}),h&&!L&&B&&(0,t.jsx)(X,{isTCFOverrideEnabled:M})]}),(0,t.jsx)(l.J9,{initialValues:z,enableReinitialize:!0,onSubmit:A,children:e=>{let{dirty:i,isValid:n,isSubmitting:r}=e;return(0,t.jsx)(l.l0,{children:(0,t.jsxs)(s.EO$,{spacing:6,children:[h&&(L||!B)&&(0,t.jsxs)(C.Z,{title:"Vendor overrides",fontSize:"sm",children:[(0,t.jsx)(J,{defaultChecked:M,disabled:y}),M&&(0,t.jsxs)(s.EO$,{mt:2,spacing:2,children:[(0,t.jsx)(s.Bjg,{children:"The table below allows you to adjust which TCF purposes you allow as part of your user facing notices and business activites."}),(0,t.jsx)(s.Bjg,{children:"To configure this section, select the purposes you allow and where available, the appropriate legal bases (either Consent or Legitimate Interest)."}),(0,t.jsx)(m,{})]})]}),(0,t.jsx)(N,{}),(0,t.jsx)(k,{}),(0,t.jsx)(s.zxk,{htmlType:"submit",type:"primary",disabled:!i||!n,loading:r,"data-testid":"save-btn",className:"self-start",children:"Save"})]})})}})]})})}},31883:function(e,i,n){"use strict";n.d(i,{Bw:function(){return t.Bw},D4:function(){return t.D4}});var t=n(19043)}},function(e){e.O(0,[494,2888,9774,179],function(){return e(e.s=53748)}),_N_E=e.O()}]);