"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4729],{30952:function(e,s,n){n.d(s,{f:function(){return a}});var t=n(24246),i=n(26917);let a=e=>{let{...s}=e;return(0,t.jsx)(i.Z,{debounce:!0,...s})}},24729:function(e,s,n){n.d(s,{D:function(){return C}});var t=n(24246),i=n(36010),a=n(27378),l=n(16394),o=n(30952),r=n(17245),c=n(9270),d=n(67359),u=n(37059);let p=e=>{var s;let{filters:n}=e,{resetPagination:l,pageIndex:o,pageSize:p,paginationProps:m}=(0,c.S)(),{searchQuery:f,updateSearch:x}=(0,r.Rx)(),y=(0,a.useMemo)(()=>[d.n.PENDING,d.n.IN_PROCESSING,d.n.PAUSED,d.n.RETRYING,d.n.ERROR],[]),[g,h]=(0,a.useState)(y),[v,j]=(0,a.useState)(!1),[_,k]=(0,a.useState)(y),[C,N]=(0,a.useState)(!1),S=(0,a.useCallback)(e=>{x(e),l()},[x,l]),I=(0,a.useCallback)(e=>{k(e)},[]),E=(0,a.useCallback)(e=>{N(e)},[]),w=(0,a.useCallback)(()=>{h(_),j(C),l()},[_,C,l]),b=(0,a.useCallback)(()=>{k(y),N(!1),h(y),j(!1),l()},[y,l]),z=[d.n.PENDING,d.n.IN_PROCESSING,d.n.COMPLETE,d.n.ERROR,d.n.PAUSED,d.n.RETRYING,d.n.SKIPPED],{data:D,isLoading:R,isFetching:T}=(0,u.$h)({page:o,size:p,search:null!==(s=null==n?void 0:n.monitorId)&&void 0!==s?s:f,statuses:g.length>0?g:void 0,return_dismissed:v},{pollingInterval:3e3,refetchOnFocus:!0,refetchOnReconnect:!0});return{searchQuery:f,updateSearch:S,statusFilters:_,updateStatusFilters:I,showDismissed:C,updateShowDismissed:E,applyFilters:w,resetAndApplyFilters:b,availableStatuses:z,listProps:(0,a.useMemo)(()=>({dataSource:(null==D?void 0:D.items)||[],loading:R,locale:{emptyText:(0,t.jsx)(i.HYy,{image:i.HYy.PRESENTED_IMAGE_SIMPLE,description:"No tasks in progress"})}}),[null==D?void 0:D.items,R]),paginationProps:{...m,total:null==D?void 0:D.total},isLoading:R,isFetching:T}};var m=n(40262),f=n(88340),x=n(41337),y=n(60240);let{Paragraph:g,Text:h,Title:v}=i.Typography,j=e=>"paused"===e?"Awaiting Processing":e.split("_").map(l.kC).join(" "),_=e=>{var s,n,a,o,r,c,d,p,_,k;let{task:C,...N}=e,S=(0,i.p8r)(),[I,{isLoading:E}]=(0,u.mL)(),[w,{isLoading:b}]=(0,u.QC)(),z=!!C.dismissed,D="error"===C.status&&C.action_type!==y.K8.DETECTION,{data:R}=(0,u.Ud)({page:1,size:1e3}),T=C.monitor_config_id?null==R?void 0:null===(s=R.items)||void 0===s?void 0:s.find(e=>e.key===C.monitor_config_id):void 0,P=T?(0,x.AZ)({connection_type:T.connection_type,name:null!==(o=T.name)&&void 0!==o?o:null,key:null!==(r=T.key)&&void 0!==r?r:null,saas_config:T.saas_config?{type:null!==(c=T.saas_config.type)&&void 0!==c?c:null,name:null!==(d=T.saas_config.name)&&void 0!==d?d:null,fides_key:null!==(p=T.saas_config.fides_key)&&void 0!==p?p:null}:null,secrets:(null===(a=T.secrets)||void 0===a?void 0:a.url)?{url:T.secrets.url}:null}):C.connection_type?(0,x.AZ)({connection_type:C.connection_type,name:null!==(_=C.connection_name)&&void 0!==_?_:C.connection_type?C.connection_type.toString():null,key:null,saas_config:null,secrets:null}):void 0,A=(null===(n=C.staged_resource_urns)||void 0===n?void 0:n.length)||0,O=["pending","in_processing","paused","retrying"].includes((C.status||"").toLowerCase()),M=C.field_count||A,U=(()=>{if(C.action_type===y.K8.CLASSIFICATION||C.action_type===y.K8.LLM_CLASSIFICATION){let e="complete"===C.status?"Classified":"Classifying";return"".concat(e," ").concat(M," ").concat((0,l._6)(M,"field","fields"))}if(C.action_type===y.K8.DETECTION)return"complete"===C.status?"Monitor scanned":"Monitor scanning";if(C.action_type===y.K8.PROMOTION){let e="complete"===C.status?"Approved":"Approving";return"".concat(e," ").concat(M," ").concat((0,l._6)(M,"field","fields"))}return C.action_type?C.action_type.replace(/_/g," "):"Task"})(),J=C.monitor_name||"Unknown monitor",L=async()=>{try{await I({taskId:C.id}).unwrap(),S({status:"success",description:"Task retry initiated successfully"})}catch(n){var e;let s=(null==n?void 0:null===(e=n.data)||void 0===e?void 0:e.detail)||(null==n?void 0:n.message)||"Unknown error occurred";S({status:"error",description:"Failed to retry task: ".concat(s)})}},F=async()=>{try{await w({taskId:C.id}).unwrap(),S({status:"success",description:"Task dismissed successfully"})}catch(n){var e;let s=(null==n?void 0:null===(e=n.data)||void 0===e?void 0:e.detail)||(null==n?void 0:n.message)||"Unknown error occurred";S({status:"error",description:"Failed to dismiss task: ".concat(s)})}};return(0,t.jsx)("div",{...N,className:"w-full",children:(0,t.jsxs)(i.X2j,{gutter:12,className:"w-full",children:[(0,t.jsx)(i.JXS,{span:14,className:"align-middle",children:(0,t.jsxs)(i.TaI,{direction:"vertical",size:4,children:[(0,t.jsxs)(i.TaI,{align:"center",size:8,wrap:!0,children:[P&&(0,t.jsx)(x.ZP,{data:P,size:24}),(0,t.jsx)(v,{level:5,className:"m-0",children:U}),!O&&(0,t.jsx)(i.Vp9,{color:(e=>{switch(e){case"pending":case"retrying":case"skipped":default:return i.tAb.DEFAULT;case"in_processing":return i.tAb.INFO;case"complete":return i.tAb.SUCCESS;case"error":return i.tAb.ERROR;case"paused":return i.tAb.MARBLE}})(C.status),children:(k=C.status)?j(k):"Unknown"})]}),"error"===C.status&&(0,t.jsxs)(i.TaI,{children:[(0,t.jsx)(g,{type:"secondary",size:"sm",ellipsis:{rows:1,expandable:!0,symbol:"more",tooltip:!0},children:C.message||"Unknown error"}),C.message&&(0,t.jsx)(f.Z,{copyText:C.message,size:"small",className:"ml-1"})]})]})}),(0,t.jsx)(i.JXS,{span:4,className:"flex items-center justify-end",children:(0,t.jsx)(h,{type:"secondary",size:"sm",children:J})}),(0,t.jsx)(i.JXS,{span:3,className:"flex items-center justify-end",children:O?(0,t.jsx)(i.yCA,{size:"small"}):(0,t.jsx)(h,{type:"secondary",size:"sm",children:(0,m.H)(new Date(C.updated_at),new Date,{addSuffix:!0})})}),(0,t.jsx)(i.JXS,{span:3,className:"flex items-center justify-end",children:"error"===C.status&&(0,t.jsxs)(i.TaI,{size:0,split:(0,t.jsx)(i.izJ,{type:"vertical"}),children:[D&&(0,t.jsx)(i.zxk,{type:"link",size:"small",loading:E,onClick:L,className:"p-0",children:"Retry"}),!z&&(0,t.jsx)(i.zxk,{type:"link",size:"small",loading:b,onClick:F,className:"p-0",children:"Dismiss"})]})})]})})},k=e=>"paused"===e?"Awaiting Processing":e.split("_").map(l.kC).join(" "),C=e=>{var s,n,l,r;let{filters:c}=e,[d,u]=(0,a.useState)(!1),{searchQuery:m,updateSearch:f,statusFilters:x,updateStatusFilters:y,showDismissed:g,updateShowDismissed:h,applyFilters:v,resetAndApplyFilters:j,availableStatuses:C,listProps:N,paginationProps:S}=p({filters:c}),I=(0,a.useCallback)(e=>{y(e)},[y]),E=(0,a.useCallback)(()=>{v(),u(!1)},[v]),w=(0,a.useCallback)(()=>{j(),u(!1)},[j]),b=(0,t.jsxs)(i.kCb,{vertical:!0,className:"min-w-[220px]",children:[(0,t.jsxs)(i.kCb,{vertical:!0,className:"gap-1.5 px-4 py-2",children:[(0,t.jsx)(i.XZJ.Group,{value:x,onChange:I,className:"flex flex-col gap-1.5",children:C.map(e=>(0,t.jsx)(i.XZJ,{value:e,children:k(e)},e))}),(0,t.jsx)(i.XZJ,{checked:g,onChange:e=>h(e.target.checked),children:"Dismissed"})]}),(0,t.jsx)(i.izJ,{className:"m-0"}),(0,t.jsxs)(i.kCb,{justify:"space-between",className:"px-4 py-2",children:[(0,t.jsx)(i.zxk,{size:"small",type:"text",onClick:w,className:"-ml-2",children:"Reset"}),(0,t.jsx)(i.zxk,{size:"small",type:"primary",onClick:E,children:"Apply"})]})]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.kCb,{justify:"space-between",align:"center",children:[(0,t.jsx)("div",{className:"min-w-[300px]",children:(0,t.jsx)(o.f,{hidden:!!(null==c?void 0:c.monitorId),value:null!==(r=null!==(l=null==c?void 0:c.monitorId)&&void 0!==l?l:m)&&void 0!==r?r:"",onChange:f,placeholder:"Search by monitor name..."})}),(0,t.jsx)(i.J2e,{content:b,trigger:"click",placement:"bottomRight",open:d,onOpenChange:u,children:(0,t.jsx)(i.zxk,{icon:(0,t.jsx)(i.PJP._ME,{}),iconPosition:"end",children:"Filter"})})]}),(0,t.jsx)(i.aVo,{...N,className:"h-full overflow-y-auto overflow-x-clip",renderItem:e=>(0,t.jsx)(i.aVo.Item,{children:(0,t.jsx)(_,{task:e})})}),(0,t.jsx)(i.tlE,{...S,showSizeChanger:{suffixIcon:(0,t.jsx)(i.PJP._ME,{})},hideOnSinglePage:(null===(s=S.pageSize)||void 0===s?void 0:s.toString())===(null===(n=S.pageSizeOptions)||void 0===n?void 0:n[0])})]})}},40262:function(e,s,n){n.d(s,{H:function(){return d}});var t=n(10969),i=n(60145),a=n(11558),l=n(70641),o=n(7317),r=n(85302),c=n(64892);function d(e,s,n){let d;let u=(0,i.j)(),p=n?.locale??u.locale??t._,m=(0,r.U)(e,s);if(isNaN(m))throw RangeError("Invalid time value");let f=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:m}),[x,y]=(0,o.d)(n?.in,...m>0?[s,e]:[e,s]),g=(0,a.u)(n?.roundingMethod??"round"),h=y.getTime()-x.getTime(),v=h/c.yJ,j=(h-((0,l.D)(y)-(0,l.D)(x)))/c.yJ,_=n?.unit;if("second"===(d=_||(v<1?"second":v<60?"minute":v<c.H_?"hour":j<c.fH?"day":j<c.UU?"month":"year"))){let e=g(h/1e3);return p.formatDistance("xSeconds",e,f)}if("minute"===d){let e=g(v);return p.formatDistance("xMinutes",e,f)}if("hour"===d){let e=g(v/60);return p.formatDistance("xHours",e,f)}if("day"===d){let e=g(j/c.H_);return p.formatDistance("xDays",e,f)}if("month"===d){let e=g(j/c.fH);return 12===e&&"month"!==_?p.formatDistance("xYears",1,f):p.formatDistance("xMonths",e,f)}{let e=g(j/c.UU);return p.formatDistance("xYears",e,f)}}}}]);