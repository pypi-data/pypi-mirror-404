(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5979],{23663:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/privacy-requests/configure/storage",function(){return i(64665)}])},77213:function(e,t,i){"use strict";i.d(t,{Z:function(){return m}});var s=i(24246),a=i(36010),n=i(88038),r=i.n(n),l=i(86677);i(27378);var o=i(25980),d=i(90867),c=i(42478),u=i(77830),g=()=>{let e=(0,l.useRouter)();return(0,s.jsx)(a.TJV,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,s.jsxs)(a.TJV,{children:[(0,s.jsxs)(a.EO$,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,s.jsx)(a.Bjg,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,s.jsx)(a.zxk,{onClick:()=>{e.push(u.AD)},children:"Configure"})]}),(0,s.jsxs)(a.Bjg,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},m=e=>{let{children:t,title:i,padded:n=!0,mainProps:u}=e,m=(0,o.hz)(),h=(0,l.useRouter)(),p="/privacy-requests"===h.pathname||"/datastore-connection"===h.pathname,x=!(m.flags.messagingConfiguration&&p),{data:f}=(0,c.JE)(void 0,{skip:x}),{data:j}=(0,d.PW)(void 0,{skip:x}),v=m.flags.messagingConfiguration&&(!f||!j)&&p;return(0,s.jsxs)(a.ad9,{"data-testid":i,direction:"column",h:"100vh",children:[(0,s.jsxs)(r(),{children:[(0,s.jsxs)("title",{children:["Fides Admin UI - ",i]}),(0,s.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)(a.ad9,{as:"main",direction:"column",py:n?6:0,px:n?10:0,h:n?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...u,children:[v?(0,s.jsx)(g,{}):null,t]})]})}},58754:function(e,t,i){"use strict";var s=i(24246),a=i(36010),n=i(70788);t.Z=e=>{let{heading:t,breadcrumbItems:i,isSticky:r=!0,children:l,rightContent:o,style:d,...c}=e;return(0,s.jsxs)("div",{...c,style:r?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,s.jsxs)(a.kCb,{justify:"space-between",children:["string"==typeof t?(0,s.jsx)(a.Dxz,{className:i||l?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,s.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!i&&(0,s.jsx)(n.m,{className:l?"pb-4":void 0,items:i,"data-testid":"page-breadcrumb"}),l]})}},97181:function(e,t,i){"use strict";i.d(t,{d:function(){return d}});var s=i(24246),a=i(36010),n=i(34090),r=i(27378),l=i(46238),o=i(40324);let d=e=>{let{name:t,label:i,labelProps:d,tooltip:c,isRequired:u,layout:g="inline",helperText:m,...h}=e,[p,x,{setValue:f}]=(0,n.U$)(t),j=!!(x.touched&&x.error),[v,y]=(0,r.useState)("");p.value||"tags"!==h.mode&&"multiple"!==h.mode||(p.value=[]),"tags"===h.mode&&"string"==typeof p.value&&(p.value=[p.value]);let _="tags"===h.mode?(e,t)=>e?e.value!==v||p.value.includes(v)?h.optionRender?h.optionRender(e,t):e.label:'Create "'.concat(v,'"'):void 0:h.optionRender||void 0,b=e=>{y(e),h.onSearch&&h.onSearch(e)},k=(e,t)=>{f(e),h.onChange&&h.onChange(e,t)};return"inline"===g?(0,s.jsx)(a.DTt,{isInvalid:j,isRequired:u,children:(0,s.jsxs)(a.MoG,{templateColumns:i?"1fr 3fr":"1fr",children:[i?(0,s.jsx)(o.__,{htmlFor:h.id||t,...d,children:i}):null,(0,s.jsxs)(a.kCb,{align:"center",children:[(0,s.jsxs)(a.kCb,{vertical:!0,flex:1,className:"mr-2",children:[(0,s.jsx)(a.PhF,{...p,id:h.id||t,"data-testid":"controlled-select-".concat(p.name),...h,optionRender:_,onSearch:"tags"===h.mode?b:void 0,onChange:k,value:p.value||void 0,status:j?"error":void 0}),m&&(0,s.jsx)(a.Kug,{children:m}),(0,s.jsx)(o.Bc,{isInvalid:j,message:x.error,fieldName:p.name})]}),(0,s.jsx)(l.b,{label:c,className:j?"mt-2 self-start":void 0})]})]})}):(0,s.jsx)(a.DTt,{isInvalid:j,isRequired:u,children:(0,s.jsxs)(a.s_g,{alignItems:"start",children:[(0,s.jsxs)(a.kCb,{align:"center",children:[i?(0,s.jsx)(o.__,{htmlFor:h.id||t,fontSize:"xs",my:0,mr:1,...d,children:i}):null,(0,s.jsx)(l.b,{label:c})]}),(0,s.jsx)(a.PhF,{...p,id:h.id||t,"data-testid":"controlled-select-".concat(p.name),...h,optionRender:_,onSearch:"tags"===h.mode?b:void 0,onChange:k,value:p.value||void 0,status:j?"error":void 0}),m&&(0,s.jsx)(a.Kug,{style:{marginTop:0},children:m}),(0,s.jsx)(o.Bc,{isInvalid:j,message:x.error,fieldName:p.name})]})})}},70788:function(e,t,i){"use strict";i.d(t,{m:function(){return d}});var s=i(24246),a=i(36010),n=i(79894),r=i.n(n),l=i(27378);let{Text:o}=a.Typography,d=e=>{let{items:t,...i}=e,n=(0,l.useMemo)(()=>null==t?void 0:t.map((e,i)=>{let n=i===t.length-1,l={...e},d=l.onClick&&!l.href;return("string"==typeof l.title&&(l.title=(0,s.jsx)(o,{style:{color:"inherit",maxWidth:n?void 0:400},ellipsis:!n,id:n?"breadcrumb-current-page":void 0,children:l.title})),d)?l.title=(0,s.jsx)(a.zxk,{type:"text",size:"small",icon:l.icon,onClick:l.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:l.title}):(l.icon&&(l.title=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"anticon align-text-bottom",children:l.icon}),l.title]})),l.href&&l.title&&(l.title=(0,s.jsx)(r(),{href:l.href,className:"ant-breadcrumb-link",children:l.title}),delete l.href)),l}),[t]);return(0,s.jsx)(a.aGc,{items:n,...i})}},42478:function(e,t,i){"use strict";i.d(t,{FU:function(){return d},JE:function(){return a},Ki:function(){return u},SU:function(){return g},W:function(){return m},h9:function(){return n},jc:function(){return s},qt:function(){return o},sn:function(){return c}});let{useGetEmailInviteStatusQuery:s,useGetActiveMessagingProviderQuery:a,useCreateMessagingConfigurationMutation:n,useCreateMessagingConfigurationSecretsMutation:r,useGetMessagingConfigurationDetailsQuery:l,useGetMessagingConfigurationsQuery:o,useGetMessagingConfigurationByKeyQuery:d,useUpdateMessagingConfigurationByKeyMutation:c,useUpdateMessagingConfigurationSecretsByKeyMutation:u,useCreateTestConnectionMessageMutation:g,useDeleteMessagingConfigurationByKeyMutation:m}=i(78780).u.injectEndpoints({endpoints:e=>({getEmailInviteStatus:e.query({query:()=>({url:"/messaging/email-invite/status"}),providesTags:()=>["Email Invite Status"]}),createMessagingConfiguration:e.mutation({query:e=>({url:"messaging/config",method:"POST",body:e}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getActiveMessagingProvider:e.query({queryFn:async(e,t,i,s)=>{let a=await s({url:"messaging/default/active"});return a.error&&404===a.error.status?{data:null}:a},providesTags:["Messaging Config"]}),createMessagingConfigurationSecrets:e.mutation({query:e=>({url:"messaging/default/".concat(e.service_type,"/secret"),method:"PUT",body:e.details}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getMessagingConfigurationDetails:e.query({query:e=>({url:"messaging/default/".concat(e.type)}),providesTags:["Messaging Config"]}),getMessagingConfigurations:e.query({query:()=>({url:"messaging/config"}),providesTags:["Messaging Config"]}),getMessagingConfigurationByKey:e.query({query:e=>({url:"messaging/config/".concat(e.key)}),providesTags:["Messaging Config"]}),createTestConnectionMessage:e.mutation({query:e=>({url:"messaging/test/".concat(e.service_type),method:"POST",body:e.details}),invalidatesTags:["Messaging Config"]}),updateMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"PATCH",body:e.config}),invalidatesTags:["Messaging Config","Configuration Settings"]}),updateMessagingConfigurationSecretsByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key,"/secret"),method:"PUT",body:e.secrets}),invalidatesTags:["Messaging Config","Configuration Settings"]}),deleteMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"DELETE"}),invalidatesTags:["Messaging Config","Configuration Settings"]})})})},64665:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return y}});var s=i(24246),a=i(36010),n=i(27378),r=i(812),l=i(17245),o=i(77213),d=i(77830),c=i(58754),u=i(7426),g=i(71784),m=i(90867),h=i(34090),p=i(97181),x=i(40324),f=e=>{var t,i,o,d,c;let{storageDetails:u}=e,[f,j]=(0,n.useState)(""),[v]=(0,m.gC)(),[y]=(0,m.cf)(),{handleError:_}=(0,l.HK)(),{successAlert:b}=(0,l.VY)(),k={type:g.DE.gcs,auth_method:null!==(o=null==u?void 0:null===(t=u.details)||void 0===t?void 0:t.auth_method)&&void 0!==o?o:"",bucket:null!==(d=null==u?void 0:null===(i=u.details)||void 0===i?void 0:i.bucket)&&void 0!==d?d:"",format:null!==(c=null==u?void 0:u.format)&&void 0!==c?c:""},C=async e=>{let t=await v({type:g.DE.gcs,details:{auth_method:e.auth_method,bucket:e.bucket},format:e.format});(0,r.D4)(t)?_(t.error):(j(e.auth_method),b("Google Cloud Storage credentials successfully updated."))},S=async e=>{let t=e.private_key.trim();t.includes("\\n")&&(t=t.replace(/\\n/g,"\n"));let i=await y({details:{type:e.type,project_id:e.project_id,private_key_id:e.private_key_id,private_key:t,client_email:e.client_email,client_id:e.client_id,auth_uri:e.auth_uri,token_uri:e.token_uri,auth_provider_x509_cert_url:e.auth_provider_x509_cert_url,client_x509_cert_url:e.client_x509_cert_url,universe_domain:e.universe_domain},type:g.DE.gcs});(0,r.D4)(i)?_(i.error):b("Google Cloud Storage secrets successfully updated.")};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.y_b,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Google Cloud Storage configuration"}),(0,s.jsx)(a.EO$,{children:(0,s.jsx)(h.J9,{initialValues:k,onSubmit:C,enableReinitialize:!0,children:e=>{let{isSubmitting:t,handleReset:i}=e;return(0,s.jsxs)(h.l0,{children:[(0,s.jsxs)(a.EO$,{mt:5,spacing:5,children:[(0,s.jsx)(p.d,{name:"format",label:"Format",options:[{label:"json",value:"json"},{label:"csv",value:"csv"}],"data-testid":"format",isRequired:!0}),(0,s.jsx)(p.d,{name:"auth_method",label:"Auth method",options:[{label:"Service Account Keys",value:"service_account_keys"},{label:"Application Default Credentials",value:"adc"}],"data-testid":"auth_method",isRequired:!0}),(0,s.jsx)(x.j0,{"data-testid":"bucket",name:"bucket",label:"Bucket",isRequired:!0})]}),(0,s.jsx)(a.zxk,{onClick:()=>i(),className:"mr-2 mt-5",children:"Cancel"}),(0,s.jsx)(a.zxk,{htmlType:"submit",className:"mt-5",disabled:t,type:"primary","data-testid":"save-btn",children:"Save"})]})}})}),"service_account_keys"===f&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.KMv,{mt:5}),(0,s.jsx)(a.y_b,{fontSize:"md",fontWeight:"semibold",mt:5,children:"Storage destination"}),(0,s.jsx)(a.EO$,{children:(0,s.jsx)(h.J9,{initialValues:{type:"",project_id:"",private_key_id:"",private_key:"",client_email:"",client_id:"",auth_uri:"",token_uri:"",auth_provider_x509_cert_url:"",client_x509_cert_url:"",universe_domain:""},onSubmit:S,children:e=>{let{isSubmitting:t,handleReset:i}=e;return(0,s.jsxs)(h.l0,{children:[(0,s.jsxs)(a.EO$,{mt:5,spacing:5,children:[(0,s.jsx)(x.j0,{name:"type",label:"Type"}),(0,s.jsx)(x.j0,{name:"project_id",label:"Project ID"}),(0,s.jsx)(x.j0,{name:"private_key_id",label:"Private key ID",type:"password"}),(0,s.jsx)(x.j0,{name:"private_key",label:"Private key",type:"password"}),(0,s.jsx)(x.j0,{name:"client_email",label:"Client email"}),(0,s.jsx)(x.j0,{name:"client_id",label:"Client ID"}),(0,s.jsx)(x.j0,{name:"auth_uri",label:"Auth URI"}),(0,s.jsx)(x.j0,{name:"token_uri",label:"Token URI"}),(0,s.jsx)(x.j0,{name:"auth_provider_x509_cert_url",label:"Auth provider x509 cert URL"}),(0,s.jsx)(x.j0,{name:"client_x509_cert_url",label:"Client x509 cert URL"}),(0,s.jsx)(x.j0,{name:"universe_domain",label:"Universe domain"})]}),(0,s.jsxs)(a.TJV,{mt:10,children:[(0,s.jsx)(a.zxk,{onClick:()=>i(),className:"mr-2 mt-5",children:"Cancel"}),(0,s.jsx)(a.zxk,{disabled:t,htmlType:"submit",type:"primary",className:"mt-5","data-testid":"save-btn",children:"Save"})]})]})}})})]})]})},j=e=>{var t,i,o,d,c;let{storageDetails:u}=e,[f,j]=(0,n.useState)(""),[v]=(0,m.gC)(),[y]=(0,m.cf)(),{handleError:_}=(0,l.HK)(),{successAlert:b}=(0,l.VY)(),k={type:g.DE.s3,auth_method:null!==(o=null==u?void 0:null===(t=u.details)||void 0===t?void 0:t.auth_method)&&void 0!==o?o:"",bucket:null!==(d=null==u?void 0:null===(i=u.details)||void 0===i?void 0:i.bucket)&&void 0!==d?d:"",format:null!==(c=null==u?void 0:u.format)&&void 0!==c?c:""},C=async e=>{let t=await v({type:g.DE.s3,details:{auth_method:e.auth_method,bucket:e.bucket},format:e.format});(0,r.D4)(t)?_(t.error):(j(e.auth_method),b("S3 storage credentials successfully updated."))},S=async e=>{let t=await y({details:{aws_access_key_id:e.aws_access_key_id,aws_secret_access_key:e.aws_secret_access_key},type:g.DE.s3});(0,r.D4)(t)?_(t.error):b("S3 storage secrets successfully updated.")};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.y_b,{fontSize:"md",fontWeight:"semibold",mt:10,children:"S3 storage configuration"}),(0,s.jsx)(a.EO$,{children:(0,s.jsx)(h.J9,{initialValues:k,onSubmit:C,enableReinitialize:!0,children:e=>{let{isSubmitting:t,handleReset:i}=e;return(0,s.jsxs)(h.l0,{children:[(0,s.jsxs)(a.EO$,{mt:5,spacing:5,children:[(0,s.jsx)(p.d,{name:"format",label:"Format",options:[{label:"json",value:"json"},{label:"csv",value:"csv"}],"data-testid":"format",isRequired:!0}),(0,s.jsx)(p.d,{name:"auth_method",label:"Auth method",options:[{label:"secret_keys",value:"secret_keys"},{label:"automatic",value:"automatic"}],"data-testid":"auth_method",isRequired:!0}),(0,s.jsx)(x.j0,{"data-testid":"bucket",name:"bucket",label:"Bucket",isRequired:!0})]}),(0,s.jsx)(a.zxk,{onClick:()=>i(),className:"mr-2 mt-5",children:"Cancel"}),(0,s.jsx)(a.zxk,{htmlType:"submit",className:"mt-5",disabled:t,type:"primary","data-testid":"save-btn",children:"Save"})]})}})}),"secret_keys"===f?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.KMv,{mt:5}),(0,s.jsx)(a.y_b,{fontSize:"md",fontWeight:"semibold",mt:5,children:"Storage destination"}),(0,s.jsx)(a.EO$,{children:(0,s.jsx)(h.J9,{initialValues:{aws_access_key_id:"",aws_secret_access_key:""},onSubmit:S,children:e=>{let{isSubmitting:t,handleReset:i}=e;return(0,s.jsxs)(h.l0,{children:[(0,s.jsxs)(a.EO$,{mt:5,spacing:5,children:[(0,s.jsx)(x.j0,{name:"aws_access_key_id",label:"AWS access key ID"}),(0,s.jsx)(x.j0,{name:"aws_secret_access_key",label:"AWS secret access key",type:"password"})]}),(0,s.jsxs)(a.TJV,{mt:10,children:[(0,s.jsx)(a.zxk,{onClick:()=>i(),className:"mr-2 mt-5",children:"Cancel"}),(0,s.jsx)(a.zxk,{disabled:t,htmlType:"submit",type:"primary",className:"mt-5","data-testid":"save-btn",children:"Save"})]})]})}})})]}):null]})},v=()=>{let{successAlert:e}=(0,l.VY)(),{handleError:t}=(0,l.HK)(),[i,h]=(0,n.useState)(""),{data:p}=(0,m.PW)(),{data:x}=(0,m.Au)({type:i}),[v,{isLoading:y}]=(0,m.gC)(),[_]=(0,u.L)();(0,n.useEffect)(()=>{p&&h(p.type)},[p]);let b=async i=>{if(i===g.DE.local){let s=await v({type:i,details:{},format:"json"});(0,r.D4)(s)?t(s.error):e("Configured storage details successfully.")}let s=await _({storage:{active_default_storage_type:i}});(0,r.D4)(s)?t(s.error):h(i)},k={s3:j,gcs:f}[i];return(0,s.jsxs)(o.Z,{title:"Configure Privacy Requests - Storage",children:[(0,s.jsx)(c.Z,{heading:"Privacy Requests",breadcrumbItems:[{title:"All requests",href:d.Jw},{title:"Configure requests",href:d.fz},{title:"Storage"}]}),(0,s.jsx)(a.y_b,{mb:5,fontSize:"md",fontWeight:"semibold",children:"Configure storage"}),(0,s.jsxs)(a.TJV,{display:"flex",flexDirection:"column",width:"50%",children:[(0,s.jsx)(a.TJV,{mb:5,children:"Fides requires a storage destination to store and share the results of privacy requests. For a production setup, it is highly recommended to have S3 as a storage destination. Ensure you have completed the setup for the storage destination and have the details handy prior to the following steps."}),(0,s.jsxs)(a.TJV,{children:["To configure a Storage destination, first choose a method to store your results. Fides currently supports"," ",(0,s.jsx)(a.Bjg,{as:"span",color:"complimentary.500",children:"Local"}),", ",(0,s.jsx)(a.Bjg,{as:"span",color:"complimentary.500",children:"S3"})," ","and"," ",(0,s.jsx)(a.Bjg,{as:"span",color:"complimentary.500",children:"GCS"})," ","storage methods."]}),(0,s.jsx)(a.y_b,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Choose storage type to configure"}),(0,s.jsx)(a.Y8K.Group,{disabled:y,onChange:e=>b(e.target.value),value:i,"data-testid":"privacy-requests-storage-selection",className:"p-3",children:(0,s.jsxs)(a.kCb,{children:[(0,s.jsx)(a.Y8K,{value:"local","data-testid":"option-local",children:"Local"},"local"),(0,s.jsx)(a.Y8K,{value:"s3","data-testid":"option-s3",children:"S3"},"s3"),(0,s.jsx)(a.Y8K,{value:"gcs","data-testid":"option-gcs",children:"GCS"},"gcs")]})}),k&&x&&(0,s.jsx)(k,{storageDetails:x})]})]})},y=()=>(0,s.jsx)(v,{})}},function(e){e.O(0,[431,7245,2888,9774,179],function(){return e(e.s=23663)}),_N_E=e.O()}]);