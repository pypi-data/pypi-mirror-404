(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8922],{58095:function(e,t,n){var s=n(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&s(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,n){for(var s=-1,a=null==e?0:e.length;++s<a;)if(n(t,e[s]))return!0;return!1}},8817:function(e,t,n){var s=n(95372),a=n(1129),l=n(58263);e.exports=function(e,t,n){return t==t?l(e,t,n):s(e,a,n)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,n){var s=n(52485),a=n(58095),l=n(21796),o=n(65581),i=n(47111),r=n(43735);e.exports=function(e,t,n){var d=-1,c=a,u=e.length,m=!0,h=[],p=h;if(n)m=!1,c=l;else if(u>=200){var y=t?null:i(e);if(y)return r(y);m=!1,c=o,p=new s}else p=t?[]:h;e:for(;++d<u;){var g=e[d],v=t?t(g):g;if(g=n||0!==g?g:0,m&&v==v){for(var f=p.length;f--;)if(p[f]===v)continue e;t&&p.push(v),h.push(g)}else c(p,v,n)||(p!==h&&p.push(v),h.push(g))}return h}},47111:function(e,t,n){var s=n(46151),a=n(50344),l=n(43735),o=s&&1/l(new s([,-0]))[1]==1/0?function(e){return new s(e)}:a;e.exports=o},58263:function(e){e.exports=function(e,t,n){for(var s=n-1,a=e.length;++s<a;)if(e[s]===t)return s;return -1}},50344:function(e){e.exports=function(){}},83766:function(e,t,n){var s=n(92198);e.exports=function(e){return e&&e.length?s(e):[]}},14599:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/website/[monitorId]/[systemId]",function(){return n(26363)}])},35287:function(e,t,n){"use strict";var s=n(24246),a=n(36010),l=n(88038),o=n.n(l);n(27378),t.Z=e=>{let{children:t,title:n,fullHeight:l,fullWidth:i,mainProps:r}=e;return(0,s.jsxs)(a.ad9,{"data-testid":n,direction:"column",height:l?"100vh":"calc(100vh - 48px)",width:i?"100vw":"calc(100vw - 240px)",children:[(0,s.jsxs)(o(),{children:[(0,s.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,s.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsx)(a.ad9,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...r,children:t})]})}},79283:function(e,t,n){"use strict";n.d(t,{l:function(){return c}});var s=n(24246),a=n(36010),l=n(72707),o=n.n(l);let i=e=>{let{data:{formattedTitle:t,description:n,name:l,primaryName:o}}=e;return(0,s.jsxs)(a.kCb,{gap:12,title:"".concat(t," - ").concat(n),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:o||l}),o&&": ".concat(l)]}),(0,s.jsx)("em",{className:"overflow-hidden text-ellipsis",children:n})]})},r=e=>"options"in e&&Array.isArray(e.options),d=e=>({...e,className:o().option,formattedTitle:e.formattedTitle||[e.primaryName,e.name].filter(e=>e).join(": ")}),c=e=>{let{options:t,...n}=e,l=null==t?void 0:t.map(e=>r(e)?{...e,options:e.options.map(d)}:d(e));return(0,s.jsx)(a.PhF,{options:l,filterOption:(e,t)=>{var n,s;return(null==t?void 0:null===(n=t.formattedTitle)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase()))||(null==t?void 0:null===(s=t.value)||void 0===s?void 0:s.toLowerCase().includes(e.toLowerCase()))||!1},optionFilterProp:"label",autoFocus:!0,variant:"borderless",optionRender:i,styles:{popup:{root:{minWidth:"500px"}}},className:"w-full p-0","data-testid":"taxonomy-select",...n})}},45938:function(e,t,n){"use strict";n.d(t,{Gt:function(){return m},eB:function(){return h},oI:function(){return u}});var s=n(24246),a=n(34090),l=n(27378),o=n(16134),i=n(38602),r=n(58452);let d=(0,l.createRef)(),c=(0,l.createRef)(),u=()=>{let e=(0,o.T)(),t=(0,o.C)(i.DB),n=(0,l.useCallback)(()=>{c.current=void 0,d.current=void 0},[]),s=(0,l.useCallback)(()=>{e((0,i.Mr)()),c.current&&(c.current(!0),n())},[e,n]),a=(0,l.useCallback)(()=>{e((0,i.Mr)()),c.current&&(c.current(!1),n())},[e,n]);return{attemptAction:(0,l.useCallback)(()=>t?(e((0,i.h7)()),d.current||(d.current=new Promise(e=>{c.current=e})),d.current):Promise.resolve(!0),[t,e]),onConfirm:s,onClose:a}},m=e=>{let{id:t,name:n}=e,{dirty:s}=(0,a.u6)(),r=(0,o.T)();return(0,l.useEffect)(()=>(r((0,i.Zu)({id:t,name:n})),()=>{r((0,i.dz)({id:t}))}),[r,t,n]),(0,l.useEffect)(()=>{r((0,i.$p)({id:t,isDirty:s}))},[s,r,t]),null},h=()=>{let{onConfirm:e,onClose:t}=u(),n=(0,o.C)(i.uv);return(0,s.jsx)(r.Z,{isOpen:n,onClose:t,onConfirm:e,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},25415:function(e,t,n){"use strict";n.d(t,{a:function(){return l}});var s=n(24246);let{Text:a}=n(36010).Typography,l=e=>{let{count:t}=e;return(0,s.jsx)(a,{size:"sm",strong:!0,"data-testid":"selected-count",children:"".concat(t," selected")})}},94770:function(e,t,n){"use strict";n.d(t,{r:function(){return l}});var s=n(24246),a=n(36010);let l=e=>{let{children:t,...n}=e;return t&&"string"==typeof t?(0,s.jsx)(a.Typography.Text,{ellipsis:{tooltip:t},...n,children:t}):t}},26363:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ec}});var s=n(24246),a=n(86677),l=n(27378),o=n(59849),i=n(35287),r=n(77830),d=n(58754),c=n(37059),u=n(36010),m=n(83766),h=n.n(m),p=n(62165),y=n(812),g=n(8411),v=n(24813),f=n(3110),x=n(8125),b=n(46628),j=n(16394),C=n(60240),k=n(98145),_=n(54762),w=n(9320),S=n(26092),E=n.n(S),T=n(88708),A=e=>!!e&&k.LM.includes(e);let I=e=>{let{asset:t,onTabChange:n,showComplianceIssueDetails:l}=e,{flags:o}=(0,p.hz)(),{assetConsentStatusLabels:i}=o,[d,{isLoading:m}]=(0,c.EY)(),[h,{isLoading:g}]=(0,c.nS)(),[v,{isLoading:f}]=(0,c.Tj)(),x=(0,u.p8r)(),j=(0,a.useRouter)(),k=m||g||f,{urn:_,name:S,resource_type:I,diff_status:N,system_key:D,user_assigned_system_key:L,consent_aggregated:O}=t,P=E()(S||"",{length:50}),R=A(O),z=async()=>{let e=await d({urnList:[_]});if((0,y.D4)(e))x((0,b.Vo)((0,y.e$)(e.error)));else{let e=L||D,t="".concat(r.So,"/configure/").concat(e,"#assets");x((0,b.t5)((0,w._)("".concat(I,' "').concat(P,'" has been added to the system inventory.'),e?()=>j.push(t):void 0)))}},V=async()=>{let e=await h({urnList:[_]});(0,y.D4)(e)?x((0,b.Vo)((0,y.e$)(e.error))):x((0,b.t5)((0,w._)("".concat(I,' "').concat(P,'" has been ignored and will not appear in future scans.'),async()=>{await n(T.A.IGNORED)})))},M=async()=>{let e=await v({urnList:[_]});(0,y.D4)(e)?x((0,b.Vo)((0,y.e$)(e.error))):x((0,b.t5)("".concat(I,' "').concat(P,'" is no longer ignored and will appear in future scans.')))};return(0,s.jsxs)(u.TaI,{children:[N!==C.LL.MUTED&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.ua7,{title:t.system?void 0:"This asset requires a system before you can add it to the inventory.",children:(0,s.jsx)(u.zxk,{"data-testid":"add-btn",size:"small",onClick:z,disabled:!t.system||k,loading:m,children:"Add"})}),(0,s.jsx)(u.zxk,{"data-testid":"ignore-btn",size:"small",onClick:V,disabled:k,loading:g,children:"Ignore"}),R&&i&&(0,s.jsx)(u.zxk,{"data-testid":"view-compliance-details-btn",size:"small",onClick:()=>{null==l||l(t)},disabled:k,loading:f,icon:(0,s.jsx)(u.PJP.OdJ,{style:{color:"var(--fidesui-error)",width:14}}),title:"View compliance issue","aria-label":"View compliance issue"})]}),N===C.LL.MUTED&&(0,s.jsx)(u.zxk,{"data-testid":"restore-btn",size:"small",onClick:M,disabled:k,loading:f,children:"Restore"})]})};var N=n(17245),D=n(34929),L=n(18992),O=n.n(L),P=n(2525),R=n(79283),z=n(78238),V=e=>{let{selectedTaxonomies:t,...n}=e,{getDataUseDisplayNameProps:a,getDataUses:o}=(0,D.Z)(),i=[...o()].filter(e=>!(null==t?void 0:t.includes(e.fides_key))).sort(),r=i.filter(e=>e.active&&z.g.includes(e.fides_key)),d=i.map(e=>{let{name:t,primaryName:n}=a(e.fides_key);return{value:e.fides_key,name:t,primaryName:n,description:e.description||""}}),c=(0,l.useMemo)(()=>{let e=[],t=[];return d.forEach(n=>{r.some(e=>e.fides_key===n.value)?e.push(n):t.push(n)}),{suggested:e,all:t}},[d,r]),m=c.suggested.length?[{label:(0,s.jsxs)(u.TaI,{children:[(0,s.jsx)(u.QMR,{size:14}),(0,s.jsx)("span",{children:"Categories of consent"}),(0,s.jsx)("em",{className:"font-normal",children:"Recommended"})]}),options:c.suggested},{label:(0,s.jsxs)(u.TaI,{children:[(0,s.jsx)(u.PJP.BBB,{}),(0,s.jsx)("span",{children:"Other data uses"})]}),options:c.all}]:c.all;return(0,s.jsx)(R.l,{options:m,...n})},M=n(31883),U=e=>{let{asset:t,readonly:n,columnState:a,onChange:o}=e,[i,r]=(0,l.useState)(!1),[d,m]=(0,l.useState)((null==a?void 0:a.isExpanded)||!1),[h]=(0,c.Ak)(),{successAlert:p,errorAlert:g}=(0,N.VY)(),{getDataUseDisplayName:v}=(0,D.Z)(),f=[...t.preferred_data_uses||[]].sort(),x=E()(t.name||"",{length:50}),b=async e=>{let n=await h({monitorId:t.monitor_config_id,urnList:[t.urn],dataUses:[...f,e]});(0,M.D4)(n)?g((0,y.e$)(n.error)):(p("Consent category added to ".concat(t.resource_type,' "').concat(x,'".'),"Confirmed"),null==o||o([...f,e])),r(!1)},j=async e=>{let n=await h({monitorId:t.monitor_config_id,urnList:[t.urn],dataUses:f.filter(t=>t!==e)});(0,M.D4)(n)?g((0,y.e$)(n.error)):(p("Consent category removed from ".concat(t.resource_type,' "').concat(x,'".'),"Confirmed"),null==o||o(f.filter(t=>t!==e)))};return((0,l.useEffect)(()=>{m((null==a?void 0:a.isExpanded)||!1)},[null==a?void 0:a.isExpanded]),n)?(0,s.jsx)(P.Q,{values:null==f?void 0:f.map(e=>({label:v(e),key:e})),columnState:a,onStateChange:m}):(0,s.jsxs)(s.Fragment,{children:[!i&&(0,s.jsxs)(u.TaI,{align:"start",children:[(0,s.jsx)(u.Vp9,{onClick:()=>r(!0),"data-testid":"taxonomy-add-btn",addable:!0,"aria-label":"Add data use"}),(0,s.jsx)(P.Q,{values:null==f?void 0:f.map(e=>({label:v(e),key:e})),columnState:{...a,isExpanded:d},tagProps:{closable:!0,closeButtonLabel:"Remove data use"},onTagClose:j,onStateChange:m})]}),i&&(0,s.jsx)("div",{className:O().cellBleed,style:{backgroundColor:"var(--fides-color-white)"},children:(0,s.jsx)(V,{selectedTaxonomies:f,onSelect:b,onBlur:()=>r(!1),onKeyDown:e=>{"Escape"===e.key&&r(!1)},open:!0})})]})};let G=e=>{let{consentAggregated:t,stagedResource:n}=e,a=k.LM.includes(t);if(!(a||t===C.lg.UNKNOWN))return null;let l=!!n.data_uses&&n.data_uses.length>0,o=k.Vq[t];return t!==C.lg.UNKNOWN||l||(o="Add a category of consent to this asset to find consent information."),(0,s.jsx)(u.ua7,{title:o,children:(0,s.jsx)(u.Vp9,{color:a?"error":void 0,"data-testid":"status-badge_".concat(t.replace(/_/g,"-")),children:k.X1[t]})})};var Z=n(29850),B=n(70675),K=n(77685);let Y=e=>{let{aggregateSystem:t,monitorConfigId:n,readonly:a,onChange:o}=e,{resource_type:i,name:r,urn:d,system:c,user_assigned_system_key:m,system_key:h}=t,p=E()(r||"",{length:50}),[g,v]=(0,l.useState)(!1),[f,x]=(0,l.useState)(!1),[b,{isLoading:j}]=(0,B.NA)(),{successAlert:C,errorAlert:k}=(0,N.VY)(),_=(0,l.useCallback)(e=>{e.preventDefault(),x(!0)},[]),w=async(e,t,s)=>{let a=await b({staged_resource_urn:d,monitor_config_id:n,user_assigned_system_key:e}),l=E()(t,{length:50});(0,y.D4)(a)?k((0,y.e$)(a.error)):(C(s?"".concat(l," has been added to your system inventory and the ").concat(i,' "').concat(p,'" has been assigned to that system.'):"".concat(i,' "').concat(p,'" has been assigned to ').concat(l,"."),"Confirmed"),null==o||o(e)),v(!1)};return a?c?(0,s.jsx)(u.Vp9,{"data-testid":"system-badge",color:"white",children:c}):null:(0,s.jsxs)(s.Fragment,{children:[!g&&(c?(0,s.jsxs)(u.Vp9,{onClick:()=>v(!0),"data-testid":"system-badge",children:[c,(0,s.jsx)(u.PJP.I8b,{})]}):(0,s.jsx)(u.Vp9,{onClick:()=>v(!0),"data-testid":"add-system-btn",addable:!0})),!!g&&(0,s.jsx)("div",{className:O().cellBleed,children:(0,s.jsx)(Z.R,{variant:"borderless",autoFocus:!0,defaultOpen:!0,defaultValue:m||h,onBlur:e=>{var t;(null===(t=e.relatedTarget)||void 0===t?void 0:t.getAttribute("id"))!=="add-new-system"&&v(!1)},onAddSystem:_,onSelect:(e,t)=>w(e,t.label),loading:j})}),f&&(0,s.jsx)(K.i,{isOpen:!0,onClose:()=>{x(!1)},onSuccessfulSubmit:(e,t)=>w(e,t,!0)})]})},$=e=>{let{monitorId:t,systemId:n,consentStatus:o,onShowComplianceIssueDetails:i}=e,d=(0,a.useRouter)(),m=(0,u.p8r)(),[S,E]=(0,l.useState)(n),[A,N]=(0,l.useState)(!1),[D,L]=(0,l.useState)(!1),[O,P]=(0,l.useState)(!1),[R,V]=(0,l.useState)(0),[M,Z]=(0,l.useState)(0),[B,K]=(0,l.useState)(0),{flags:$}=(0,p.hz)(),{assetConsentStatusLabels:F}=$,{filterTabs:W,activeTab:q,onTabChange:J,activeParams:Q,actionsDisabled:X}=(0,T.Z)(n),H=(0,x.o)({sorting:{validColumns:Object.values(k.r6)}}),{columnFilters:ee,pageIndex:et,pageSize:en,resetState:es,sortKey:ea,sortOrder:el,searchQuery:eo,updateSearch:ei,updateFilters:er,updateSorting:ed,updatePageIndex:ec,updatePageSize:eu}=H,{data:em,error:eh,isLoading:ep,isFetching:ey}=(0,c.WJ)({key:t,page:et,size:en,search:eo,sort_by:ea?[ea]:[k.r6.NAME],sort_asc:"descend"!==el,...Q,...ee}),[eg,{isLoading:ev}]=(0,c.EY)(),[ef,{isLoading:ex}]=(0,c.nS)(),[eb,{isLoading:ej}]=(0,c.rs)(),[eC,{isLoading:ek}]=(0,c.sX)(),[e_,{isLoading:ew}]=(0,c.Vr)(),[eS,{isLoading:eE}]=(0,c.Tj)(),eT=ev||ex||ej||ek||eE||ew,eA=eT||n===r.Kl,{data:eI}=(0,c.ut)({monitor_config_id:t,resolved_system_id:n,diff_status:null==Q?void 0:Q.diff_status,search:eo,...ee}),eN=(0,l.useMemo)(()=>({enableSelection:q!==T.A.ADDED,getRowKey:e=>e.urn,isLoading:ep,isFetching:ey,dataSource:(null==em?void 0:em.items)||[],totalRows:(null==em?void 0:em.total)||0,sortBy:[k.r6.NAME],sortAsc:!0,customTableProps:{locale:{emptyText:(0,s.jsx)("div",{children:(0,s.jsx)("div",{children:"All caught up!"})})},sticky:{offsetHeader:40}}}),[q,ep,ey,null==em?void 0:em.items,null==em?void 0:em.total]),eD=(0,x.V)(H,eN),{selectedKeys:eL,selectedRows:eO,resetSelections:eP}=eD,eR=(0,l.useMemo)(()=>{var e;let t=[{title:"Asset",dataIndex:k.r6.NAME,key:k.r6.NAME,sorter:!0,sortOrder:ea===k.r6.NAME?el:null,render:e=>(0,s.jsx)(u.xvT,{ellipsis:{tooltip:!0},style:{maxWidth:300},children:e}),fixed:"left",width:200},{title:"Type",dataIndex:k.r6.RESOURCE_TYPE,key:k.r6.RESOURCE_TYPE,sorter:!0,sortOrder:ea===k.r6.RESOURCE_TYPE?el:null,filters:(0,j.nZ)(null==eI?void 0:eI.resource_type),filteredValue:(null==ee?void 0:ee.resource_type)||null},{title:"System",dataIndex:k.r6.SYSTEM,key:k.r6.SYSTEM,render:(e,t)=>!!t.monitor_config_id&&(0,s.jsx)(Y,{aggregateSystem:t,monitorConfigId:t.monitor_config_id,readonly:X||q===T.A.IGNORED,onChange:()=>{eP()}}),width:200},{title:"Categories of consent",key:k.r6.DATA_USES,menu:{items:f.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?(P(!0),K(e=>e+1)):"collapse-all"===e.key&&(P(!1),K(e=>e+1))}},filters:(0,j.nZ)(null==eI?void 0:null===(e=eI.data_uses)||void 0===e?void 0:e.filter(e=>(0,z.Z)(e))),filteredValue:(null==ee?void 0:ee.data_uses)||null,render:(e,t)=>(0,s.jsx)(U,{asset:t,readonly:X||q===T.A.IGNORED,columnState:{isExpanded:O,version:B},onChange:()=>{eP()}}),width:200},{title:"Locations",dataIndex:k.r6.LOCATIONS,key:k.r6.LOCATIONS,menu:{items:f.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?(N(!0),V(e=>e+1)):"collapse-all"===e.key&&(N(!1),V(e=>e+1))}},filters:(0,j.nZ)(null==eI?void 0:eI.locations,e=>{var t;let n=(0,u.QCN)(e);return n?(0,u.c1K)({isoEntry:n}):null!==(t=g.Z8[e])&&void 0!==t?t:e}),filteredValue:(null==ee?void 0:ee.locations)||null,render:e=>{var t;return(0,s.jsx)(v.Q3,{values:null!==(t=null==e?void 0:e.map(e=>{var t;let n=(0,u.QCN)(e);return{label:n?(0,u.c1K)({isoEntry:n}):null!==(t=g.Z8[e])&&void 0!==t?t:e,key:e}}))&&void 0!==t?t:[],columnState:{isExpanded:A,version:R}})}},{title:"Domain",dataIndex:k.r6.DOMAIN,key:k.r6.DOMAIN},{title:"Detected on",dataIndex:k.r6.PAGE,menu:{items:f.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?(L(!0),Z(e=>e+1)):"collapse-all"===e.key&&(L(!1),Z(e=>e+1))}},key:k.r6.PAGE,render:e=>(0,s.jsx)(v.vx,{values:e,valueSuffix:"pages",columnState:{isExpanded:D,version:M}})}];return F&&t.push({title:()=>(0,s.jsxs)(u.TaI,{children:[(0,s.jsx)("div",{children:"Compliance"}),(null==o?void 0:o.status)===C.pF.ALERT&&(0,s.jsx)(_.l,{consentStatus:o})]}),dataIndex:k.r6.CONSENT_AGGREGATED,key:k.r6.CONSENT_AGGREGATED,sorter:!0,sortOrder:ea===k.r6.CONSENT_AGGREGATED?el:null,filters:(0,j.nZ)(null==eI?void 0:eI[k.r6.CONSENT_AGGREGATED],e=>{var t;return null!==(t=k.X1[e])&&void 0!==t?t:e}),filteredValue:(null==ee?void 0:ee[k.r6.CONSENT_AGGREGATED])||null,render:(e,t)=>(0,s.jsx)(G,{consentAggregated:null!=e?e:C.lg.UNKNOWN,stagedResource:t}),width:160}),X||t.push({title:"Actions",key:k.r6.ACTIONS,fixed:"right",render:(e,t)=>(0,s.jsx)(I,{asset:t,onTabChange:J,showComplianceIssueDetails:i})}),t},[ea,el,eI,ee,F,X,q,O,B,eP,A,R,D,M,o,J,i]);(0,l.useEffect)(()=>{if(em){var e;E((null===(e=em.items[0])||void 0===e?void 0:e.system)||S||n||"")}},[em,n,S]);let ez=(0,l.useCallback)(async()=>{var e,t;let n=await eg({urnList:eL}),s=(null===(e=eO[0])||void 0===e?void 0:e.user_assigned_system_key)||(null===(t=eO[0])||void 0===t?void 0:t.system_key),a=eO.every(e=>(e.user_assigned_system_key||e.system_key)===s)?s:void 0;(0,y.D4)(n)?m((0,b.Vo)((0,y.e$)(n.error))):(m((0,b.t5)((0,w._)("".concat(eL.length," assets from ").concat(S," have been added to the system inventory."),a?()=>d.push("".concat(r.So,"/configure/").concat(a,"#assets")):()=>d.push(r.So)))),eP())},[eg,eL,eO,S,m,d,eP]),eV=(0,l.useCallback)(async e=>{if("string"==typeof(null==e?void 0:e.value)){let n=await eC({monitorId:t,urnList:eL,systemKey:e.value});(0,y.D4)(n)?m((0,b.Vo)((0,y.e$)(n.error))):(m((0,b.t5)("".concat(eL.length," assets have been assigned to ").concat(e.label,"."),"Confirmed")),eP())}},[eC,t,eL,m,eP]),eM=(0,l.useCallback)(async e=>{if(!eO.length)return;let n=eO.map(t=>{let n=h()([...t.preferred_data_uses||[],...e]);return{urn:t.urn,user_assigned_data_uses:n}}),s=await e_({monitorId:t,assets:n});(0,y.D4)(s)?m((0,b.Vo)((0,y.e$)(s.error))):(m((0,b.t5)("Consent categories added to ".concat(eL.length," assets").concat(S?" from ".concat(S):"","."),"Confirmed")),eP())},[eO,e_,t,eL,S,m,eP]),eU=(0,l.useCallback)(async()=>{let e=await ef({urnList:eL});(0,y.D4)(e)?m((0,b.Vo)((0,y.e$)(e.error))):(m((0,b.t5)(S===r.Kl?"".concat(eL.length," uncategorized assets have been ignored and will not appear in future scans."):"".concat(eL.length," assets from ").concat(S," have been ignored and will not appear in future scans."),"Confirmed")),eP())},[ef,eL,S,m,eP]),eG=(0,l.useCallback)(async()=>{let e=await eS({urnList:eL});(0,y.D4)(e)?m((0,b.Vo)((0,y.e$)(e.error))):(m((0,b.t5)("".concat(eL.length," assets have been restored and will appear in future scans."),"Confirmed")),eP())},[eS,eL,m,eP]),eZ=(0,l.useCallback)(async()=>{let e=(null==em?void 0:em.items.length)||0,s=await eb({monitor_config_key:t,resolved_system_ids:[n]});(0,y.D4)(s)?m((0,b.Vo)((0,y.e$)(s.error))):(d.push({pathname:r.lA,query:{monitorId:encodeURIComponent(t)}}),m((0,b.t5)("".concat(e," assets from ").concat(S," have been added to the system inventory."),"Confirmed")),eP())},[null==em?void 0:em.items.length,eb,t,n,d,m,S,eP]),eB=(0,l.useCallback)(async e=>{await J(e),es(),eP()},[J,es,eP]);return{columns:eR,data:em,error:eh,isLoading:ep,isFetching:ey,tableState:H,searchQuery:eo,updateSearch:ei,updateFilters:er,updateSorting:ed,updatePageIndex:ec,updatePageSize:eu,resetState:es,tableProps:eD.tableProps,selectionProps:eD.selectionProps,filterTabs:W,activeTab:q,handleTabChange:eB,activeParams:Q,actionsDisabled:X,selectedRows:eO,selectedUrns:eL,hasSelectedRows:eD.hasSelectedRows,resetSelections:eP,systemName:S,consentStatus:o,handleBulkAdd:ez,handleBulkAssignSystem:eV,handleBulkAddDataUse:eM,handleBulkIgnore:eU,handleBulkRestore:eG,handleAddAll:eZ,anyBulkActionIsLoading:eT,isAddingResults:ev,isIgnoringResults:ex,isAddingAllResults:ej,isBulkUpdatingSystem:ek,isBulkAddingDataUses:ew,isRestoringResults:eE,disableAddAll:eA}};var F=n(25415),W=n(30952),q=n(8133);let{Text:J}=u.Typography;var Q=e=>{let{onSave:t,isSaving:n,onClose:a,...o}=e,[i,r]=(0,l.useState)([]),d=()=>{r([]),a()};return(0,s.jsxs)(q.Z,{title:"Add consent category",...o,onClose:d,children:[(0,s.jsxs)(u.kCb,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,s.jsx)(J,{children:"Assign consent categories to selected assets. This configures the system for consent management. Consent categories apply to both individual assets and the system."}),(0,s.jsx)(V,{mode:"tags",onSelect:(e,t)=>r([...i,t.value]),variant:"outlined"})]}),(0,s.jsxs)(u.kCb,{justify:"space-between",children:[(0,s.jsx)(u.zxk,{htmlType:"reset",onClick:d,"data-testid":"cancel-btn",children:"Cancel"}),(0,s.jsx)(u.zxk,{htmlType:"submit",type:"primary",disabled:!i.length,loading:n,onClick:()=>{t(i),d()},"data-testid":"save-btn",children:"Save"})]})]})};let{Text:X}=u.Typography,H=e=>{let{onSave:t,isSaving:n,...a}=e,[o,i]=(0,l.useState)(),[r,d]=(0,l.useState)(!1),c=(0,l.useCallback)(e=>{e.preventDefault(),d(!0)},[]),m=()=>{d(!1)},h=()=>{i(void 0),a.onClose()};return(0,s.jsxs)(q.Z,{title:"Assign system",...a,onClose:h,children:[(0,s.jsxs)(u.kCb,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,s.jsx)(X,{children:"Assign a system to the selected assets. If no system exists, select 'Add new system' to create one."}),(0,s.jsx)(Z.R,{placeholder:"Search or select...",onSelect:(e,t)=>{i(t)},onAddSystem:c,value:o})]})," ",(0,s.jsxs)(u.kCb,{justify:"space-between",children:[(0,s.jsx)(u.zxk,{htmlType:"reset",onClick:h,"data-testid":"cancel-btn",children:"Cancel"}),(0,s.jsx)(u.zxk,{htmlType:"submit",type:"primary",disabled:!o,loading:n,onClick:()=>{t(o),h()},"data-testid":"save-btn",children:"Save"})]}),r&&(0,s.jsx)(K.i,{isOpen:!0,onClose:m,onSuccessfulSubmit:(e,t)=>{m(),i({label:t,value:e})},toastOnSuccess:!0})]})};var ee=n(94770),et=n(32735);let{Link:en}=u.Typography,es=e=>{let{stagedResource:t}=e,n=(0,x.o)({pagination:{defaultPageSize:10,pageSizeOptions:[10,...et.VZ]},disableUrlState:!0}),{pageIndex:a,pageSize:o}=n,{data:i,isFetching:r,isError:d}=(0,c.mi)({stagedResourceUrn:t.urn,statuses:k.LM,page:a,size:o}),{items:m,total:h}=(0,l.useMemo)(()=>i||{items:[],total:0,pages:0,filterOptions:{assigned_users:[],systems:[]}},[i]),p=(0,l.useMemo)(()=>({enableSelection:!1,getRowKey:e=>"".concat(e.location,"-").concat(e.page),isLoading:r,dataSource:m,totalRows:null!=h?h:0,customTableProps:{scroll:{scrollToFirstRowOnChange:!0},tableLayout:"fixed"}}),[r,m,h]),y=(0,x.V)(n,p);return{columns:(0,l.useMemo)(()=>[{title:"Location",dataIndex:k.EI.LOCATION,key:k.EI.LOCATION,render:e=>{var t;let n=(0,u.QCN)(e),a=n?(0,u.c1K)({isoEntry:n,showFlag:!0}):null!==(t=null===g.Z8||void 0===g.Z8?void 0:g.Z8[e])&&void 0!==t?t:e;return(0,s.jsx)(ee.r,{children:a})},width:180},{title:"Page",dataIndex:k.EI.PAGE,key:k.EI.PAGE,render:e=>{let t=(0,j.hL)(e,50);return(0,s.jsx)(en,{href:e,target:"_blank",rel:"noopener noreferrer",variant:"primary",children:(0,s.jsx)(ee.r,{unStyled:!0,children:t})})},minWidth:100},{title:"Compliance",dataIndex:k.EI.STATUS,key:k.EI.STATUS,width:160,render:e=>{let t=k.Vq[e];return(0,s.jsx)(u.ua7,{title:t,children:(0,s.jsx)(u.Vp9,{color:"error","data-testid":"status-badge_".concat(e.replace(/_/g,"-")),children:k.X1[e]})})}}],[]),data:i,isLoading:r,isError:d,totalRows:h,tableProps:y.tableProps,hasData:m.length>0}},{Paragraph:ea,Text:el}=u.Typography,eo=e=>{var t,n,a;let{isOpen:l,stagedResource:o,onCancel:i,onDownload:r}=e,{columns:d,tableProps:c,isError:m}=es({stagedResource:o});return(0,s.jsx)(u.u_l,{title:"Compliance issues",width:768,open:l,onCancel:i,footer:[(0,s.jsx)(u.zxk,{onClick:i,children:"Cancel"},"cancel"),!!r&&(0,s.jsx)(u.zxk,{type:"primary",onClick:r,children:"Download"},"download")],"data-testid":"consent-breakdown-modal",children:(0,s.jsxs)(u.kCb,{vertical:!0,className:"gap-6","data-testid":"consent-breakdown-modal-content",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(ea,{children:"View all instances where this asset was detected with consent compliance issues, organized by location and page. This includes assets loaded without consent, before consent, or when CMP failed."}),(0,s.jsxs)(ea,{children:[(0,s.jsx)(el,{strong:!0,children:"Asset name:"})," ",null!==(t=o.name)&&void 0!==t?t:(0,s.jsx)(el,{italic:!0,children:"Unknown"}),","," ",(0,s.jsx)(el,{strong:!0,children:"System:"})," ",null!==(n=o.system)&&void 0!==n?n:(0,s.jsx)(el,{italic:!0,children:"Unassigned"}),","," ",(0,s.jsx)(el,{strong:!0,children:"Domain:"})," ",null!==(a=o.domain)&&void 0!==a?a:(0,s.jsx)(el,{italic:!0,children:"Unknown"})]})]}),m?(0,s.jsx)(u.bZj,{type:"error",message:"Error fetching data",description:"Please try again later.",showIcon:!0}):(0,s.jsx)(u.iA_,{...c,columns:d,"data-testid":"consent-breakdown-modal-table"})]})})},ei=e=>{var t;let{monitorId:n,systemId:a,consentStatus:o}=e,[i,r]=(0,l.useState)(!1),[d,c]=(0,l.useState)(!1),[m,h]=(0,l.useState)(null),{columns:p,searchQuery:y,updateSearch:g,resetState:v,tableProps:f,selectionProps:x,filterTabs:b,activeTab:j,handleTabChange:k,activeParams:_,actionsDisabled:w,selectedUrns:S,hasSelectedRows:E,resetSelections:T,handleBulkAdd:A,handleBulkAssignSystem:I,handleBulkAddDataUse:N,handleBulkIgnore:D,handleBulkRestore:L,handleAddAll:O,anyBulkActionIsLoading:P,isAddingAllResults:R,isBulkUpdatingSystem:z,isBulkAddingDataUses:V,disableAddAll:M}=$({monitorId:n,systemId:a,consentStatus:o,onShowComplianceIssueDetails:e=>{h(e)}}),U=async e=>{await I(e),r(!1)},G=async e=>{await N(e),c(!1)};return n&&a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.v2r,{"aria-label":"Asset state filter",mode:"horizontal",items:b.map(e=>({key:e.hash,label:e.label})),selectedKeys:[j],onClick:async e=>{await k(e.key)},className:"mb-4","data-testid":"asset-state-filter"}),(0,s.jsxs)(u.kCb,{justify:"space-between",align:"center",className:"sticky -top-6 z-10 mb-4 bg-white py-4",children:[(0,s.jsx)(W.f,{value:y,onChange:g,placeholder:"Search by asset name..."}),(0,s.jsxs)(u.TaI,{size:"large",children:[E&&(0,s.jsx)(F.a,{count:S.length}),(0,s.jsxs)(u.TaI,{size:"small",children:[(0,s.jsx)(u.zxk,{onClick:()=>{v(),T()},"data-testid":"clear-filters",children:"Clear filters"}),(0,s.jsx)(u.Ltx,{overlayClassName:"bulk-actions-menu-dropdown",menu:{items:[...(null==_?void 0:null===(t=_.diff_status)||void 0===t?void 0:t.includes(C.LL.MUTED))?[{key:"restore",label:"Restore",onClick:L}]:[{key:"add",label:"Add",onClick:A},{key:"add-data-use",label:"Add consent category",onClick:()=>c(!0)},{key:"assign-system",label:"Assign system",onClick:()=>r(!0)},{type:"divider"},{key:"ignore",label:"Ignore",onClick:D}]]},trigger:["click"],children:(0,s.jsx)(u.zxk,{icon:(0,s.jsx)(u.PJP._ME,{}),iconPosition:"end",loading:P,"data-testid":"bulk-actions-menu",disabled:!E||P||w,type:"primary",children:"Actions"})}),(0,s.jsx)(u.ua7,{title:M?"These assets require a system before you can add them to the inventory.":void 0,children:(0,s.jsx)(u.zxk,{onClick:O,disabled:M,loading:R,type:"primary",icon:(0,s.jsx)(u.PJP.MCw,{}),iconPosition:"end","data-testid":"add-all",children:"Add all"})})]})]})]}),(0,s.jsx)(u.iA_,{...f,columns:p,rowSelection:x,locale:{emptyText:(0,s.jsx)(u.HYy,{image:u.HYy.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})},"aria-labelledby":"breadcrumb-current-page"}),(0,s.jsx)(H,{isOpen:i,onClose:()=>{r(!1)},onSave:U,isSaving:z}),(0,s.jsx)(Q,{isOpen:d,onClose:()=>{c(!1)},onSave:G,isSaving:V}),m&&(0,s.jsx)(eo,{isOpen:!!m,stagedResource:m,onCancel:()=>{h(null)}})]}):null};var er=n(71985),ed=n(98243),ec=()=>{let e=(0,a.useRouter)(),t=decodeURIComponent(e.query.monitorId),n=decodeURIComponent(e.query.systemId),{data:u}=(0,c.wi)({key:t,page:1,size:1,search:"",diff_status:[ed.L.ADDITION],resolved_system_id:n}),m=null==u?void 0:u.items[0];(0,l.useEffect)(()=>{u&&0===u.items.length&&e.push({pathname:r.lA,query:{monitorId:encodeURIComponent(t)}})},[u,e,t]);let{error:h}=$({monitorId:t,systemId:n});return h?(0,s.jsx)(o.Z,{error:h,defaultMessage:"A problem occurred while fetching your assets"}):(0,s.jsxs)(i.Z,{title:"Action center - Discovered assets",children:[(0,s.jsx)(d.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:r.vi},{title:t,href:"".concat(r.vi,"/").concat(er.w.WEBSITE,"/").concat(t)},{title:n===r.Kl?"Uncategorized assets":null==m?void 0:m.name}],isSticky:!1}),(0,s.jsx)(ei,{monitorId:t,systemId:n,consentStatus:null==m?void 0:m.consent_status})]})}},31883:function(e,t,n){"use strict";n.d(t,{Bw:function(){return s.Bw},D4:function(){return s.D4}});var s=n(19043)},72707:function(e){e.exports={option:"TaxonomySelect_option__vY6v2"}},18992:function(e){e.exports={cellBleed:"Cells_cellBleed__dik43"}}},function(e){e.O(0,[431,7245,9698,401,5022,7879,2888,9774,179],function(){return e(e.s=14599)}),_N_E=e.O()}]);