(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1537],{30890:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/notifications/providers",function(){return i(66605)}])},77213:function(e,t,i){"use strict";i.d(t,{Z:function(){return p}});var s=i(24246),n=i(36010),a=i(88038),r=i.n(a),l=i(86677);i(27378);var o=i(25980),c=i(90867),d=i(42478),u=i(77830),g=()=>{let e=(0,l.useRouter)();return(0,s.jsx)(n.TJV,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,s.jsxs)(n.TJV,{children:[(0,s.jsxs)(n.EO$,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,s.jsx)(n.Bjg,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,s.jsx)(n.zxk,{onClick:()=>{e.push(u.AD)},children:"Configure"})]}),(0,s.jsxs)(n.Bjg,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},p=e=>{let{children:t,title:i,padded:a=!0,mainProps:u}=e,p=(0,o.hz)(),h=(0,l.useRouter)(),f="/privacy-requests"===h.pathname||"/datastore-connection"===h.pathname,m=!(p.flags.messagingConfiguration&&f),{data:x}=(0,d.JE)(void 0,{skip:m}),{data:y}=(0,c.PW)(void 0,{skip:m}),v=p.flags.messagingConfiguration&&(!x||!y)&&f;return(0,s.jsxs)(n.ad9,{"data-testid":i,direction:"column",h:"100vh",children:[(0,s.jsxs)(r(),{children:[(0,s.jsxs)("title",{children:["Fides Admin UI - ",i]}),(0,s.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)(n.ad9,{as:"main",direction:"column",py:a?6:0,px:a?10:0,h:a?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...u,children:[v?(0,s.jsx)(g,{}):null,t]})]})}},129:function(e,t,i){"use strict";var s=i(24246),n=i(36010),a=i(86677),r=i(16134),l=i(25980),o=i(77830),c=i(60240),d=i(31793);t.Z=()=>{let e=(0,a.useRouter)(),t=e.pathname,{plus:i}=(0,l.hz)(),u="providers";t.startsWith(o.AD)?u="providers":t.startsWith(o.Wi)?u="templates":t.startsWith(o.DN)&&(u="digests");let g=[{key:"templates",label:"Templates",requiresPlus:!0,scopes:[c.Sh.MESSAGING_TEMPLATE_UPDATE],path:o.Wi},{key:"digests",label:"Digests",requiresPlus:!0,scopes:[c.Sh.DIGEST_CONFIG_READ],path:o.DN},{key:"providers",label:"Providers",requiresPlus:!1,scopes:[c.Sh.MESSAGING_CREATE_OR_UPDATE],path:o.AD}];i||(g=g.filter(e=>!e.requiresPlus));let p=(0,r.C)(d.uu);g=g.filter(e=>e.scopes.some(e=>p.includes(e)));let h=t=>{let i=g.find(e=>e.key===t);i&&e.push(i.path)},f=g.map(e=>({label:e.label,key:e.key}));return(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)(n.v2r,{mode:"horizontal",selectedKeys:[u],onClick:e=>{let{key:t}=e;return h(t)},items:f})})}},58754:function(e,t,i){"use strict";var s=i(24246),n=i(36010),a=i(70788);t.Z=e=>{let{heading:t,breadcrumbItems:i,isSticky:r=!0,children:l,rightContent:o,style:c,...d}=e;return(0,s.jsxs)("div",{...d,style:r?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...c}:{paddingBottom:"24px",...c},children:[(0,s.jsxs)(n.kCb,{justify:"space-between",children:["string"==typeof t?(0,s.jsx)(n.Dxz,{className:i||l?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,s.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!i&&(0,s.jsx)(a.m,{className:l?"pb-4":void 0,items:i,"data-testid":"page-breadcrumb"}),l]})}},19904:function(e,t,i){"use strict";i.d(t,{Tg:function(){return r}});var s=i(24246),n=i(16134),a=i(31793);let r=e=>(0,n.C)(a.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:i}=e;return r(t)?(0,s.jsx)(s.Fragment,{children:i}):null}},59849:function(e,t,i){"use strict";i.d(t,{Z:function(){return d}});var s=i(24246),n=i(36010),a=i(86677),r=i(88340);let l="/images/errors";var o=e=>{let{status:t}=e;return 404===t?(0,s.jsx)(n.Eep,{src:"".concat(l,"/404.svg"),alt:"Error 404",preview:!1}):500===t?(0,s.jsx)(n.Eep,{src:"".concat(l,"/500.svg"),alt:"Error 500",preview:!1}):(0,s.jsx)(n.Eep,{src:"".concat(l,"/unknown.svg"),alt:"Error Unknown",preview:!1})},c=i(812),d=e=>{let{error:t,defaultMessage:i="An unexpected error occurred.  Please try again",actions:l,showReload:d=!0}=e,u=(0,c.e$)(t,i),g="data"in t&&t.data?JSON.stringify(t.data):JSON.stringify(t),p="status"in t&&t.status?t.status:void 0,h=(0,a.useRouter)(),f=l&&l.length>0||d;return(0,s.jsx)(n.kCb,{vertical:!0,align:"center",justify:"center",className:"h-screen","data-testid":"error-page-result",children:(0,s.jsx)(n.x4B,{status:"error",icon:(0,s.jsx)(o,{status:p}),title:"Error ".concat(p),subTitle:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.Typography.Paragraph,{type:"secondary",children:u}),(0,s.jsx)(n.kCb,{justify:"start",className:"max-w-96",children:(0,s.jsx)(n.UO1,{ghost:!0,size:"small",items:[{key:"1",label:"Show details",classNames:{header:"w-fit"},children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.Typography.Text,{type:"secondary",children:g}),(0,s.jsx)(r.Z,{copyText:g})]})}]})})]}),extra:f&&(0,s.jsxs)(n.kCb,{gap:"small",justify:"center",children:[null==l?void 0:l.map((e,t)=>(0,s.jsx)(n.zxk,{...e,children:e.label},t)),d&&(0,s.jsx)(n.zxk,{onClick:()=>h.reload(),type:"primary",children:"Reload"})]})})})}},70788:function(e,t,i){"use strict";i.d(t,{m:function(){return c}});var s=i(24246),n=i(36010),a=i(79894),r=i.n(a),l=i(27378);let{Text:o}=n.Typography,c=e=>{let{items:t,...i}=e,a=(0,l.useMemo)(()=>null==t?void 0:t.map((e,i)=>{let a=i===t.length-1,l={...e},c=l.onClick&&!l.href;return("string"==typeof l.title&&(l.title=(0,s.jsx)(o,{style:{color:"inherit",maxWidth:a?void 0:400},ellipsis:!a,id:a?"breadcrumb-current-page":void 0,children:l.title})),c)?l.title=(0,s.jsx)(n.zxk,{type:"text",size:"small",icon:l.icon,onClick:l.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:l.title}):(l.icon&&(l.title=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"anticon align-text-bottom",children:l.icon}),l.title]})),l.href&&l.title&&(l.title=(0,s.jsx)(r(),{href:l.href,className:"ant-breadcrumb-link",children:l.title}),delete l.href)),l}),[t]);return(0,s.jsx)(n.aGc,{items:a,...i})}},8125:function(e,t,i){"use strict";i.d(t,{V:function(){return a},o:function(){return c}});var s=i(27378),n=i(32735);let a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{enableSelection:i=!1,getRowKey:a,bulkActions:r,isLoading:l=!1,isFetching:o=!1,dataSource:c=[],totalRows:d=0,currentPage:u,pageSize:g,customTableProps:p={}}=t,h=(0,s.useCallback)(e=>{if(e&&"object"==typeof e){if(e.id)return String(e.id);if(e.key)return String(e.key)}return String(e)},[]),f=a||h,[m,x]=(0,s.useState)([]),[y,v]=(0,s.useState)([]),j=(0,s.useCallback)(()=>{x([]),v([])},[]),b=(0,s.useMemo)(()=>({selectedRowKeys:m,selectedRows:y,resetSelections:j}),[m,y,j]),C=(0,s.useMemo)(()=>{if(i)return{selectedRowKeys:m,onChange:(e,t)=>{x(e),v(t)}}},[i,m]),k=(0,s.useCallback)((t,i,s)=>{var n,a;let r=null!==(n=t.current)&&void 0!==n?n:e.pageIndex,l=null!==(a=t.pageSize)&&void 0!==a?a:e.pageSize,o=r!==e.pageIndex||l!==e.pageSize;o?(t.current&&t.current!==e.pageIndex&&e.updatePageIndex(t.current),t.pageSize&&t.pageSize!==e.pageSize&&e.updatePageSize(t.pageSize)):e.updateFilters(i||{});let c=s&&!Array.isArray(s)?s.field:void 0,d=s&&!Array.isArray(s)&&null!==s.order?s.order:void 0;o||e.updateSorting(c,d)},[e]),S=(0,s.useMemo)(()=>{var t,i,s,a,r;return{current:null!=u?u:e.pageIndex,pageSize:null!=g?g:e.pageSize,total:d,showSizeChanger:null===(a=null===(t=e.paginationConfig)||void 0===t?void 0:t.showSizeChanger)||void 0===a||a,pageSizeOptions:null!==(r=null===(s=e.paginationConfig)||void 0===s?void 0:null===(i=s.pageSizeOptions)||void 0===i?void 0:i.map(String))&&void 0!==r?r:n.VZ}},[u,e.pageIndex,g,e.pageSize,d,e.paginationConfig]),w=(0,s.useMemo)(()=>({dataSource:c,loading:l||o,pagination:S,onChange:k,rowKey:f,scroll:{x:"max-content",scrollToFirstRowOnChange:!0},size:"small",bordered:!0,...p}),[c,l,o,S,k,f,p]),z=m.map(String),_=y.length>0,E=(0,s.useCallback)(e=>{let t=null==r?void 0:r.actions.find(t=>t.key===e);return t?{disabled:!_||!!t.disabled&&t.disabled(y),loading:t.loading||!1,onClick:()=>t.onClick(y)}:{disabled:!0,loading:!1}},[r,_,y]);return(0,s.useMemo)(()=>({tableProps:w,selectionProps:C,selectionState:b,selectedRows:y,selectedKeys:z,hasSelectedRows:_,resetSelections:j,getBulkActionProps:E,isLoadingOrFetching:l||o,hasData:c.length>0}),[w,C,b,y,z,_,j,E,l,o,c.length])};var r=i(40431),l=i(17245);let o=()=>({filters:(0,r.WJ)(e=>e).withDefault({})}),c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{pagination:t={},sorting:i={},search:n={},onStateChange:a,disableUrlState:c=!1}=e,{pageIndex:d,pageSize:u,resetPagination:g,updatePageIndex:p,updatePageSize:h,pageSizeOptions:f,showSizeChanger:m}=(0,l.h0)({...t,disableUrlState:c}),{sortKey:x,sortOrder:y,updateSorting:v,resetSorting:j}=(0,l.rK)({...i,disableUrlState:c}),{searchQuery:b,updateSearch:C,resetSearch:k}=(0,l.Rx)({...n,disableUrlState:c}),[S,w]=(0,s.useState)({}),z=(0,s.useMemo)(()=>c?null:o(),[c]),[_,E]=(0,r.XI)(null!=z?z:{},{history:"push"}),T=(0,s.useMemo)(()=>{var e;return{pageIndex:d,pageSize:u,sortKey:x,sortOrder:y,columnFilters:c?S:null!==(e=_.filters)&&void 0!==e?e:{},searchQuery:b}},[c,S,_,d,u,x,y,b]),M=(0,s.useCallback)((e,t)=>{v(e,t),g()},[v,g]),P=(0,s.useCallback)(e=>{if(c)w(e);else{let t=Object.fromEntries(Object.entries(e).filter(e=>{let[,t]=e;return null!=t}));E({filters:Object.keys(t).length>0?t:null})}g()},[c,E,g]),A=(0,s.useCallback)(e=>{C(e),g()},[C,g]),N=(0,s.useCallback)(()=>{c?w({}):E({filters:null}),g(),j(),k()},[c,E,g,j,k]);return(0,s.useEffect)(()=>{a&&a(T)},[T,a]),{state:T,pageIndex:T.pageIndex,pageSize:T.pageSize,updatePageIndex:p,updatePageSize:h,sortKey:T.sortKey,sortOrder:T.sortOrder,updateSorting:M,columnFilters:T.columnFilters,updateFilters:P,searchQuery:T.searchQuery,updateSearch:A,resetState:N,paginationConfig:{pageSizeOptions:f,showSizeChanger:m}}}},17828:function(e,t,i){"use strict";var s=i(24246);i(27378),t.Z=()=>(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 74.375 85",width:"20",height:"20",fill:"#fff",fillRule:"evenodd",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("use",{xlinkHref:"#A",x:"2.188",y:"2.5"}),(0,s.jsx)("symbol",{id:"A",overflow:"visible",children:(0,s.jsxs)("g",{stroke:"none",children:[(0,s.jsx)("path",{d:"M16.558 12.75L0 38.591l16.558 25.841 13.227-3.324.654-44.869-13.881-3.489z",fill:"#876929"}),(0,s.jsx)("path",{d:"M35.049 59.786l-18.491 4.645V12.75l18.491 4.645v42.391z",fill:"#d9a741"}),(0,s.jsxs)("g",{fill:"#876929",children:[(0,s.jsx)("path",{d:"M32.849 21.614L35.05 80 70 62.867l-.01-43.615-8.914 1.448-28.228.913z"}),(0,s.jsx)("path",{d:"M46.184 33.149l10.906-.632 10.778-19.164L40.612 0 30.439 4.364l15.745 28.785z"})]}),(0,s.jsx)("path",{d:"M40.612 0l27.256 13.353-10.778 19.164L40.612 0z",fill:"#d9a741"}),(0,s.jsx)("path",{d:"M35.049 5.539L57.09 44.742l3.788 22.595L35.049 80l-10.46-5.131V9.64l10.45-4.101h.01z",fill:"#876929"}),(0,s.jsx)("path",{d:"M69.991 19.251L70 62.867 35.05 80V5.539l22.041 39.203 12.899-25.491z",fill:"#d9a741"})]})})]})},44907:function(e,t,i){"use strict";var s=i(24246);i(27378),t.Z=()=>(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",preserveAspectRatio:"xMidYMid",viewBox:"-0.5 0 257 257",children:(0,s.jsx)("path",{fill:"#C02428",d:"M128.418 80.526c-26.51 0-48.884 21.475-48.884 48.728a48.197 48.197 0 0014.187 34.579 48.532 48.532 0 0034.697 14.14c26.511 0 48.875-21.476 48.875-48.719 0-27.253-22.364-48.728-48.875-48.728zm-76.22 47.895c0-41.285 33.968-75.138 75.395-75.138 41.417 0 75.385 33.853 75.385 75.138 0 2.478 0 5.788-.825 8.266-.835 7.422 4.972 13.2 12.43 13.2 12.43 0 14.08-15.678 14.08-21.466 0-55.328-45.573-100.746-101.07-100.746-55.518 0-101.07 45.418-101.07 100.746 0 55.339 45.552 100.747 101.07 100.747 29.822 0 56.333-12.388 74.56-33.03l20.703 17.342c-22.364 26.43-57.158 42.952-94.448 42.952-34.097.105-66.827-13.35-90.932-37.384C13.37 195.016-.118 162.392 0 128.411 0 58.228 57.159.432 128.418.432 198.832.432 256 58.238 256 128.432c0 28.075-13.256 51.205-40.591 51.205-11.605 0-19.053-5.787-23.2-11.565-13.255 21.476-37.29 35.508-64.626 35.508-20.017.068-39.234-7.827-53.388-21.933a74.755 74.755 0 01-22.008-53.205l.01-.02zm76.21-22.297c12.43 0 22.374 9.91 22.374 22.297 0 12.388-9.944 22.298-22.364 22.298a22.322 22.322 0 01-15.848-6.504 22.169 22.169 0 01-6.526-15.794c0-12.387 9.944-22.297 22.374-22.297h-.01z"})})},5144:function(e,t,i){"use strict";var s=i(24246);t.Z=()=>(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 256",children:(0,s.jsx)("path",{fill:"#F12E45",d:"M128 0c70.656 0 128 57.344 128 128s-57.344 128-128 128S0 198.656 0 128 57.344 0 128 0zm0 33.792c-52.224 0-94.208 41.984-94.208 94.208S75.776 222.208 128 222.208s94.208-41.984 94.208-94.208S180.224 33.792 128 33.792zm31.744 99.328c14.704 0 26.624 11.92 26.624 26.624 0 14.704-11.92 26.624-26.624 26.624-14.704 0-26.624-11.92-26.624-26.624 0-14.704 11.92-26.624 26.624-26.624zm-63.488 0c14.704 0 26.624 11.92 26.624 26.624 0 14.704-11.92 26.624-26.624 26.624-14.704 0-26.624-11.92-26.624-26.624 0-14.704 11.92-26.624 26.624-26.624zm63.488-63.488c14.704 0 26.624 11.92 26.624 26.624 0 14.704-11.92 26.624-26.624 26.624-14.704 0-26.624-11.92-26.624-26.624 0-14.704 11.92-26.624 26.624-26.624zm-63.488 0c14.704 0 26.624 11.92 26.624 26.624 0 14.704-11.92 26.624-26.624 26.624-14.704 0-26.624-11.92-26.624-26.624 0-14.704 11.92-26.624 26.624-26.624z"})})},42478:function(e,t,i){"use strict";i.d(t,{FU:function(){return c},JE:function(){return n},Ki:function(){return u},SU:function(){return g},W:function(){return p},h9:function(){return a},jc:function(){return s},qt:function(){return o},sn:function(){return d}});let{useGetEmailInviteStatusQuery:s,useGetActiveMessagingProviderQuery:n,useCreateMessagingConfigurationMutation:a,useCreateMessagingConfigurationSecretsMutation:r,useGetMessagingConfigurationDetailsQuery:l,useGetMessagingConfigurationsQuery:o,useGetMessagingConfigurationByKeyQuery:c,useUpdateMessagingConfigurationByKeyMutation:d,useUpdateMessagingConfigurationSecretsByKeyMutation:u,useCreateTestConnectionMessageMutation:g,useDeleteMessagingConfigurationByKeyMutation:p}=i(78780).u.injectEndpoints({endpoints:e=>({getEmailInviteStatus:e.query({query:()=>({url:"/messaging/email-invite/status"}),providesTags:()=>["Email Invite Status"]}),createMessagingConfiguration:e.mutation({query:e=>({url:"messaging/config",method:"POST",body:e}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getActiveMessagingProvider:e.query({queryFn:async(e,t,i,s)=>{let n=await s({url:"messaging/default/active"});return n.error&&404===n.error.status?{data:null}:n},providesTags:["Messaging Config"]}),createMessagingConfigurationSecrets:e.mutation({query:e=>({url:"messaging/default/".concat(e.service_type,"/secret"),method:"PUT",body:e.details}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getMessagingConfigurationDetails:e.query({query:e=>({url:"messaging/default/".concat(e.type)}),providesTags:["Messaging Config"]}),getMessagingConfigurations:e.query({query:()=>({url:"messaging/config"}),providesTags:["Messaging Config"]}),getMessagingConfigurationByKey:e.query({query:e=>({url:"messaging/config/".concat(e.key)}),providesTags:["Messaging Config"]}),createTestConnectionMessage:e.mutation({query:e=>({url:"messaging/test/".concat(e.service_type),method:"POST",body:e.details}),invalidatesTags:["Messaging Config"]}),updateMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"PATCH",body:e.config}),invalidatesTags:["Messaging Config","Configuration Settings"]}),updateMessagingConfigurationSecretsByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key,"/secret"),method:"PUT",body:e.secrets}),invalidatesTags:["Messaging Config","Configuration Settings"]}),deleteMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"DELETE"}),invalidatesTags:["Messaging Config","Configuration Settings"]})})})},66605:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return P}});var s,n,a=i(24246),r=i(59849),l=i(77213),o=i(129),c=i(58754),d=i(19904),u=i(812),g=i(17245),p=i(36010),h=i(86677),f=i(27378),m=i(77830),x=i(8125),y=i(7426),v=i(60240),j=i(17828),b=i(44907),C=i(5144),k=i(42478),S=i(51980),w=i(16394),z=e=>{let{messagingConfig:t}=e,{last_test_succeeded:i,last_test_timestamp:s}=t;if(!s)return(0,a.jsx)(p.Vp9,{children:"Verify configuration"});let n=new Date(s),r=(0,w.p6)(n),l=(0,S.B)(n,new Date,{addSuffix:!0});return(0,a.jsx)(p.ua7,{title:"Last verified: ".concat(r),children:(0,a.jsxs)(p.Vp9,{color:i?"success":"error","data-testid":i?"test-success":"test-error",children:[i?"Succeeded":"Failed"," ",l]})})};(s=n||(n={})).NAME="name",s.VERIFICATION_STATUS="verification_status",s.ENABLED="enabled",s.ACTIONS="actions";let _=()=>{let e=(0,h.useRouter)(),{handleError:t}=(0,g.HK)(),[i,s]=(0,f.useState)(null),[r]=(0,y.L)(),[l]=(0,k.W)(),o=(0,p.UD8)(),c=(0,d.Tg)([v.Sh.MESSAGING_CREATE_OR_UPDATE]),[S,w]=(0,f.useState)(!1),[_,E]=(0,f.useState)(null),T=(0,x.o)({pagination:{defaultPageSize:25,pageSizeOptions:[25,50,100]},sorting:{validColumns:Object.values(n),defaultSortKey:"name",defaultSortOrder:"ascend"}}),{data:M,isLoading:P}=(0,k.JE)(),{data:A,isLoading:N,error:I}=(0,k.qt)();(0,f.useEffect)(()=>{M?s(M.service_type):s(null)},[M]);let q=(0,f.useCallback)(async e=>{try{let i=await r({notifications:{notification_service_type:e}});(0,u.D4)(i)?t(i.error):(s(e),o.success(e?"Updated active messaging config":"Disabled active messaging config"))}catch(e){t(e)}},[r,t,o]),D=(0,f.useCallback)(t=>{var i,s;let n=m.GE.replace("[key]",t.key);e.push({pathname:n,query:{last_test_succeeded:null!==(i=t.last_test_succeeded)&&void 0!==i?i:"",last_test_timestamp:null!==(s=t.last_test_timestamp)&&void 0!==s?s:""}})},[e]),O=(0,f.useCallback)((e,t)=>{E({key:e,name:t}),w(!0)},[]),R=(0,f.useCallback)(async()=>{if(_)try{let e=await l({key:_.key});(0,u.D4)(e)?t(e.error):o.success("Messaging configuration successfully deleted")}catch(e){t(e)}finally{w(!1),E(null)}},[_,l,t,o]),B=(0,f.useCallback)(()=>{w(!1),E(null)},[]),F=(0,f.useMemo)(()=>({enableSelection:!1,getRowKey:e=>e.key,isLoading:N||P,dataSource:(null==A?void 0:A.items)||[],totalRows:(null==A?void 0:A.total)||0,customTableProps:{size:"small",pagination:{hideOnSinglePage:!0,showSizeChanger:!0,pageSizeOptions:["25","50","100"]}}}),[N,P,null==A?void 0:A.items,null==A?void 0:A.total]),L=(0,x.V)(T,F),Z=(0,f.useMemo)(()=>[{title:"Provider type",dataIndex:"name",key:"name",render:(e,t)=>(0,a.jsxs)(p.Br$,{children:[(()=>{switch(t.service_type){case"mailgun":return(0,a.jsx)(b.Z,{});case"twilio_text":case"twilio_email":default:return(0,a.jsx)(C.Z,{});case"aws_ses":return(0,a.jsx)(j.Z,{})}})(),(0,a.jsx)(p.Bjg,{children:e})]})},{title:"Verification status",key:"verification_status",render:(e,t)=>(0,a.jsx)(z,{messagingConfig:t})},{title:"Enabled",key:"enabled",width:100,render:(e,t)=>{let s=t.service_type===i,n=!!t.last_test_timestamp&&""!==t.last_test_timestamp&&!1===t.last_test_succeeded&&!s,r=(0,a.jsx)(p.rsf,{checked:s,disabled:n,onChange:e=>{e?q(t.service_type):q(null)}});return n?(0,a.jsx)(p.ua7,{title:"This provider cannot be enabled because its last test failed. Please fix the configuration and test again.",children:r}):r}},{title:"Actions",key:"actions",render:(e,t)=>(0,a.jsxs)(p.Br$,{children:[c&&(0,a.jsx)(p.zxk,{onClick:e=>{e.stopPropagation(),D(t)},size:"small",icon:(0,a.jsx)(p.PJP.I8b,{}),title:"Edit","aria-label":"Edit messaging configuration","data-testid":"edit-messaging-config-btn"}),c&&(0,a.jsx)(p.zxk,{onClick:e=>{e.stopPropagation(),O(t.key,t.name)},size:"small",icon:(0,a.jsx)(p.PJP.ZNm,{}),title:"Delete","aria-label":"Delete messaging configuration","data-testid":"delete-messaging-config-btn"})]})}],[c,i,D,O,q]),U=(0,f.useMemo)(()=>(0,a.jsx)(p.u_l,{title:"Delete messaging configuration",open:S,onCancel:B,footer:[(0,a.jsx)(p.zxk,{onClick:B,children:"Cancel"},"cancel"),(0,a.jsx)(p.zxk,{type:"primary",danger:!0,onClick:R,children:"Delete"},"delete")],children:(0,a.jsxs)(p.TaI,{direction:"vertical",children:[(0,a.jsxs)(p.Bjg,{children:['Are you sure you want to delete "',(0,a.jsx)("strong",{children:null==_?void 0:_.name}),'" messaging configuration?']}),(0,a.jsx)(p.Bjg,{children:"This action cannot be undone."})]})}),[S,null==_?void 0:_.name,B,R]);return{columns:Z,error:I,tableProps:L.tableProps,selectionProps:L.selectionProps,userCanUpdate:c,isLoading:N||P,deleteModal:U,handleEditConfiguration:D,handleDeleteConfiguration:O,setActiveServiceType:q}};var E=i(15793);let T=()=>(0,a.jsx)(p.s_g,{mt:6,p:10,spacing:4,borderRadius:"base",maxW:"70%","data-testid":"no-results-notice",alignSelf:"center",margin:"auto",children:(0,a.jsxs)(p.s_g,{children:[(0,a.jsx)(p.Bjg,{fontSize:"md",fontWeight:"600",children:"No messaging providers found."}),(0,a.jsx)(p.Bjg,{fontSize:"sm",children:'Click "Add a messaging provider" to add your first messaging provider to Fides.'})]})}),M=()=>{let{columns:e,tableProps:t,userCanUpdate:i,isLoading:s,deleteModal:n}=_(),r=(0,h.useRouter)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(p.Bjg,{fontSize:"sm",mb:8,width:{base:"100%",lg:"70%"},children:["Fides requires a messaging provider for sending processing notices to privacy request subjects, and allows for Subject Identity Verification in privacy requests. Please follow the"," ",(0,a.jsx)(p.Bjg,{as:"span",color:"complimentary.500",children:"documentation"})," ","to setup a messaging service that Fides supports. Ensure you have completed the setup for the preferred messaging provider and have the details handy prior to the following steps."]}),(0,a.jsxs)(p.ad9,{flex:1,direction:"column",overflow:"auto",children:[i&&(0,a.jsx)(p.TaI,{direction:"horizontal",style:{width:"100%",justifyContent:"flex-end",marginBottom:16},children:(0,a.jsx)(p.zxk,{onClick:()=>{r.push(m.Nu)},role:"link",type:"primary",icon:(0,a.jsx)(p.PJP.mm_,{}),iconPosition:"end","data-testid":"add-messaging-provider-btn",children:"Add a messaging provider"})}),s?(0,a.jsx)(E.I4,{rowHeight:36,numRows:5}):(0,a.jsx)(p.iA_,{...t,columns:e,locale:{emptyText:(0,a.jsx)(T,{})}})]}),n]})};var P=()=>{let{error:e}=_();return e?(0,a.jsx)(r.Z,{error:e,defaultMessage:"A problem occurred while fetching your messaging configurations"}):(0,a.jsx)(l.Z,{title:"Notifications",children:(0,a.jsxs)(d.ZP,{scopes:[v.Sh.MESSAGING_CREATE_OR_UPDATE],children:[(0,a.jsx)(c.Z,{heading:"Notifications"}),(0,a.jsx)(o.Z,{}),(0,a.jsx)(M,{})]})})}}},function(e){e.O(0,[431,7245,2888,9774,179],function(){return e(e.s=30890)}),_N_E=e.O()}]);