"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6954],{58754:function(e,n,t){var a=t(24246),i=t(36010),l=t(70788);n.Z=e=>{let{heading:n,breadcrumbItems:t,isSticky:s=!0,children:r,rightContent:o,style:d,...c}=e;return(0,a.jsxs)("div",{...c,style:s?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,a.jsxs)(i.kCb,{justify:"space-between",children:["string"==typeof n?(0,a.jsx)(i.Dxz,{className:t||r?"pb-4":void 0,level:1,"data-testid":"page-heading",children:n}):n,o&&(0,a.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!t&&(0,a.jsx)(l.m,{className:r?"pb-4":void 0,items:t,"data-testid":"page-breadcrumb"}),r]})}},10342:function(e,n,t){var a=t(24246),i=t(36010),l=t(46238);n.Z=e=>{let{title:n,tooltip:t,children:s,...r}=e;return(0,a.jsxs)(i.TJV,{borderRadius:"md",border:"1px solid",borderColor:"gray.200",...r,children:[(0,a.jsxs)(i.y_b,{as:"h3",fontSize:"sm",fontWeight:"semibold",color:"gray.700",py:4,px:6,backgroundColor:"gray.50",borderRadius:"md",textAlign:"left",children:[n,t?(0,a.jsx)(i.Bjg,{as:"span",mx:1,children:(0,a.jsx)(l.b,{label:t})}):void 0]}),(0,a.jsx)(i.EO$,{p:6,spacing:6,children:s})]})}},70788:function(e,n,t){t.d(n,{m:function(){return d}});var a=t(24246),i=t(36010),l=t(79894),s=t.n(l),r=t(27378);let{Text:o}=i.Typography,d=e=>{let{items:n,...t}=e,l=(0,r.useMemo)(()=>null==n?void 0:n.map((e,t)=>{let l=t===n.length-1,r={...e},d=r.onClick&&!r.href;return("string"==typeof r.title&&(r.title=(0,a.jsx)(o,{style:{color:"inherit",maxWidth:l?void 0:400},ellipsis:!l,id:l?"breadcrumb-current-page":void 0,children:r.title})),d)?r.title=(0,a.jsx)(i.zxk,{type:"text",size:"small",icon:r.icon,onClick:r.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:r.title}):(r.icon&&(r.title=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"anticon align-text-bottom",children:r.icon}),r.title]})),r.href&&r.title&&(r.title=(0,a.jsx)(s(),{href:r.href,className:"ant-breadcrumb-link",children:r.title}),delete r.href)),r}),[n]);return(0,a.jsx)(i.aGc,{items:l,...t})}},34391:function(e,n,t){t.d(n,{Z:function(){return G}});var a=t(24246),i=t(51472),l=t(36010),s=t(34090),r=t(79894),o=t.n(r),d=t(86677),c=t(27378),u=t(16134),m=t(10342),p=t(40324),g=t(812),h=t(46238),v=t(77830),x=t(8411),b=t(46628),j=t(28079),f=t(7426),_=t(34334),y=t(16277);let k=e=>{let{index:n}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.j0,{autoFocus:0!==n,name:"translations.".concat(n,".title"),label:"Title of privacy notice as displayed to user",variant:"stacked"}),(0,a.jsx)(p.Ks,{name:"translations.".concat(n,".description"),label:"Privacy notice displayed to the user",variant:"stacked"})]})},C=e=>{let{languageOptions:n,handleCreateLanguage:t}=e,[i,s]=(0,c.useState)(!1);return i?(0,a.jsx)(l.PhF,{autoFocus:!0,defaultOpen:!0,allowClear:!0,placeholder:"Select a language...","aria-label":"Select a language",options:n,onChange:e=>{t(e),s(!1)},"data-testid":"select-language",className:"w-full",optionFilterProp:"label"}):(0,a.jsx)(l.zxk,{block:!0,icon:(0,a.jsx)(l.PJP.mm_,{}),iconPosition:"end",onClick:()=>s(!0),"data-testid":"add-language-btn",className:"mb-1",children:"Add"})},N=e=>{let{index:n,name:t,isOOB:i}=e;return(0,a.jsxs)(l.ad9,{direction:"column",gap:6,children:[(0,a.jsxs)(l.y_b,{size:"sm",children:["Edit ",t," translation"]}),i?(0,a.jsx)(y.f,{languageName:t}):null,(0,a.jsx)(k,{index:n})]})};var T=e=>{var n,t,i,r;let{availableTranslations:o}=e,{values:d,setFieldValue:p}=(0,s.u6)(),[g,h]=(0,c.useState)(!1),[v,x]=(0,c.useState)(null!==(r=null===(t=d.translations)||void 0===t?void 0:null===(n=t[0])||void 0===n?void 0:n.language)&&void 0!==r?r:""),{data:b}=(0,f.tB)({api_set:!1}),j=null==b?void 0:null===(i=b.plus_consent_settings)||void 0===i?void 0:i.enable_translations,y=(0,u.C)(_.Zp),T=(0,u.C)(_.G1);(0,_.Ah)({page:y,size:T});let w=(0,u.C)(_.fJ).slice().sort((e,n)=>e.name.localeCompare(n.name)),E=w.filter(e=>{var n;return null===(n=d.translations)||void 0===n?void 0:n.every(n=>n.language!==e.id)}).map(e=>({label:e.name,value:e.id})),O=e=>{x(e),h(!1)},P=e=>{let n=null==o?void 0:o.find(n=>n.language===e);h(!!n);let t=null!=n?n:{language:e,title:"",description:""};x(e),p("translations",[...d.translations,t])},S=e=>{var n,t;let a=d.translations?d.translations.slice().filter(n=>n.language!==e):[],i=v===e?null!==(t=null===(n=a[a.length-1])||void 0===n?void 0:n.language)&&void 0!==t?t:"":v;p("translations",a),x(i)},z=e=>{var n,t;return null!==(t=null===(n=w.find(n=>n.id===e))||void 0===n?void 0:n.name)&&void 0!==t?t:e};return j?(0,a.jsx)(m.Z,{title:"Localizations",children:(0,a.jsx)(s.F2,{name:"translations",render:()=>(0,a.jsx)(l.mQc,{activeKey:v,onChange:O,type:"editable-card",tabBarExtraContent:!!E.length&&(0,a.jsx)(C,{languageOptions:E,handleCreateLanguage:P}),hideAdd:!0,onEdit:(e,n)=>{"remove"===n&&S(e)},items:d.translations.map(e=>({key:e.language,label:z(e.language),children:(0,a.jsx)(N,{index:d.translations.findIndex(n=>n.language===e.language),name:z(e.language),isOOB:g}),closable:d.translations.length>1}))})})}):(0,a.jsx)(m.Z,{title:"Notice text",children:(0,a.jsx)(k,{index:0})})},w=t(97181),E=t(55484),O=t(16394),P=t(65063),S=t(60240);let z=(0,O.Jt)(P.ye),F=(0,O.Jt)(P.B8),I=[{language:S.eU.EN,title:"",description:""}],J={name:"",consent_mechanism:S.J7.OPT_IN,data_uses:[],enforcement_level:S.QT.FRONTEND,disabled:!0,translations:I,children:[]},L=e=>{var n,t,a,i;return{name:null!==(n=e.name)&&void 0!==n?n:J.name,consent_mechanism:null!==(t=e.consent_mechanism)&&void 0!==t?t:J.consent_mechanism,data_uses:null!==(a=e.data_uses)&&void 0!==a?a:J.data_uses,enforcement_level:null!==(i=e.enforcement_level)&&void 0!==i?i:J.enforcement_level,notice_key:e.notice_key,disabled:e.disabled,has_gpc_flag:e.has_gpc_flag,id:e.id,internal_description:e.internal_description,translations:e.translations?e.translations.map(e=>{var n;let{privacy_notice_history_id:t,...a}=e;return{...a,title:null!==(n=e.title)&&void 0!==n?n:""}}):I,children:e.children}},R=E.Ry().shape({name:E.Z_().required().label("Title"),consent_mechanism:E.Z_().required().label("Consent mechanism")});var Z=t(14441),B=t.n(Z),q=e=>{let{isEditing:n}=e,{values:t,setFieldValue:i}=(0,s.u6)();return(0,c.useEffect)(()=>{n||i("notice_key",B()(t.name))},[t.name,n,i]),(0,a.jsx)(p.j0,{name:"notice_key",label:"Key used in Fides cookie",variant:"stacked"})},A=t(71922);let{Text:M}=l.Typography,D=e=>{let{regions:n,label:t,tooltip:i}=e;return(0,a.jsxs)(l.s_g,{align:"start",children:[(0,a.jsxs)(l.ad9,{align:"start",children:[t?(0,a.jsx)(l.tLq,{htmlFor:"regions",fontSize:"xs",my:0,mr:1,children:t}):null,(0,a.jsx)(h.b,{label:i})]}),(0,a.jsx)(l.TJV,{w:"100%","data-testid":"notice-locations",children:(0,a.jsxs)(l.TaI,{size:[0,2],wrap:!0,children:[null==n?void 0:n.map(e=>{let n=(0,l.QCN)(e);return(0,a.jsx)(l.Vp9,{children:n?(0,l.c1K)({isoEntry:n,showFlag:!0}):x.Z8[e]},e)}),!(null==n?void 0:n.length)&&(0,a.jsxs)(M,{italic:!0,children:["No locations assigned. Navigate to the"," ",(0,a.jsx)(o(),{href:v.w0,children:"experiences view"})," ","configure."]})]})})]})};var G=e=>{let{privacyNotice:n,availableTranslations:t}=e,r=(0,d.useRouter)(),o=(0,l.p8r)(),h=n?L(n):J;(0,j.fd)();let x=(0,u.C)(j.qv),f=(0,u.C)(A.sX),_=(0,u.C)(A.Zp),y=(0,u.C)(A.G1);(0,A.J6)({page:_,size:y});let k=e=>{var n;let{id:t}=e,a=f.find(e=>e.id===t);return null!==(n=null==a?void 0:a.name)&&void 0!==n?n:t},C=f.some(e=>{var t;return null===(t=e.children)||void 0===t?void 0:t.some(e=>e.id===(null==n?void 0:n.id))}),[N]=(0,A.vL)(),[E]=(0,A.p4)(),O=(0,c.useMemo)(()=>!!n,[n]),P=async e=>{let t;if(O){var a,i;let l={...e,id:n.id,translations:null!==(a=e.translations)&&void 0!==a?a:[],children:null!==(i=e.children)&&void 0!==i?i:[]};t=await N(l)}else t=await E(e);(0,g.D4)(t)?o((0,b.Vo)((0,g.e$)(t.error))):(o((0,b.t5)("Privacy notice ".concat(O?"updated":"created"))),O||r.push(v.IT))};return(0,a.jsx)(s.J9,{initialValues:h,enableReinitialize:!0,onSubmit:P,validationSchema:R,children:e=>{var o,d;let{values:c,setFieldValue:u,dirty:g,isValid:h,isSubmitting:v}=e;return(0,a.jsx)(s.l0,{children:(0,a.jsxs)(l.EO$,{spacing:10,children:[(0,a.jsxs)(l.EO$,{spacing:6,children:[(0,a.jsxs)(m.Z,{title:"Privacy notice details",children:[(0,a.jsx)(p.j0,{label:"Notice title",name:"name",isRequired:!0,variant:"stacked"}),(0,a.jsx)(w.d,{name:"consent_mechanism",label:"Consent mechanism",options:z,isRequired:!0,layout:"stacked"}),(0,a.jsx)(q,{isEditing:O}),(0,a.jsx)(p.w8,{name:"has_gpc_flag",label:"Configure whether this notice conforms to the Global Privacy Control",variant:"stacked"}),(0,a.jsx)(D,{regions:null==n?void 0:n.configured_regions,label:"Locations where privacy notice is shown to visitors",tooltip:"To configure locations, change the privacy experiences where this notice is shown"}),(0,a.jsx)(l.KMv,{}),!C&&(0,a.jsx)(i.Z,{label:"Child notices",addButtonLabel:"Add notice children",allItems:f.map(e=>({id:e.id,name:e.name})),values:null!==(d=null===(o=c.children)||void 0===o?void 0:o.map(e=>({id:e.id,name:e.name})))&&void 0!==d?d:[],setValues:e=>u("children",e),idField:"id",getItemLabel:k,draggable:!0,baseTestId:"children"}),(0,a.jsx)(w.d,{name:"data_uses",label:"Data use",options:x,mode:"multiple",layout:"stacked"}),(0,a.jsx)(w.d,{name:"enforcement_level",label:"Enforcement level",options:F,isRequired:!0,layout:"stacked"})]}),(0,a.jsx)(T,{availableTranslations:t})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(l.zxk,{onClick:()=>{r.back()},children:"Cancel"}),(0,a.jsx)(l.zxk,{htmlType:"submit",type:"primary",disabled:v||!g||!h,loading:v,"data-testid":"save-btn",children:"Save"})]})]})})}})}},65063:function(e,n,t){t.d(n,{B8:function(){return l},Ep:function(){return s},ye:function(){return i}});var a=t(60240);let i=new Map([[a.J7.OPT_IN,"Opt in"],[a.J7.NOTICE_ONLY,"Notice only"],[a.J7.OPT_OUT,"Opt out"]]),l=new Map([[a.QT.SYSTEM_WIDE,"System wide"],[a.QT.FRONTEND,"Front end"],[a.QT.NOT_APPLICABLE,"Not applicable"]]),s=new Map([["gpp_us_national","GPP US National"],["gpp_us_state","GPP US State"]])}}]);