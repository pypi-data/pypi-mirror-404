(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2676],{56141:function(e,t,l){var i=l(32866);e.exports=function(e,t){return i(e,t)}},58754:function(e,t,l){"use strict";var i=l(24246),a=l(36010),n=l(70788);t.Z=e=>{let{heading:t,breadcrumbItems:l,isSticky:r=!0,children:s,rightContent:o,style:d,...u}=e;return(0,i.jsxs)("div",{...u,style:r?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,i.jsxs)(a.kCb,{justify:"space-between",children:["string"==typeof t?(0,i.jsx)(a.Dxz,{className:l||s?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,i.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!l&&(0,i.jsx)(n.m,{className:s?"pb-4":void 0,items:l,"data-testid":"page-breadcrumb"}),s]})}},19904:function(e,t,l){"use strict";l.d(t,{Tg:function(){return r}});var i=l(24246),a=l(16134),n=l(31793);let r=e=>(0,a.C)(n.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:l}=e;return r(t)?(0,i.jsx)(i.Fragment,{children:l}):null}},70788:function(e,t,l){"use strict";l.d(t,{m:function(){return d}});var i=l(24246),a=l(36010),n=l(79894),r=l.n(n),s=l(27378);let{Text:o}=a.Typography,d=e=>{let{items:t,...l}=e,n=(0,s.useMemo)(()=>null==t?void 0:t.map((e,l)=>{let n=l===t.length-1,s={...e},d=s.onClick&&!s.href;return("string"==typeof s.title&&(s.title=(0,i.jsx)(o,{style:{color:"inherit",maxWidth:n?void 0:400},ellipsis:!n,id:n?"breadcrumb-current-page":void 0,children:s.title})),d)?s.title=(0,i.jsx)(a.zxk,{type:"text",size:"small",icon:s.icon,onClick:s.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:s.title}):(s.icon&&(s.title=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"anticon align-text-bottom",children:s.icon}),s.title]})),s.href&&s.title&&(s.title=(0,i.jsx)(r(),{href:s.href,className:"ant-breadcrumb-link",children:s.title}),delete s.href)),s}),[t]);return(0,i.jsx)(a.aGc,{items:n,...l})}},33673:function(e,t,l){"use strict";l.d(t,{Z:function(){return f}});var i=l(24246),a=l(36010),n=l(86677),r=l(27378),s=l(812),o=l(77830),d=l(19904),u=l(8917);let c="create-custom-values";var p=l(67522),m=l(66006),_=l(66236),v=l(32885),y=l(60240),x=l(31883);let T=()=>(0,i.jsxs)(a.OdW,{active:!0,children:[(0,i.jsx)(a.OdW.Input,{}),(0,i.jsx)(a.OdW.Input,{}),(0,i.jsx)(a.OdW.Input,{}),(0,i.jsx)(a.OdW.Input,{}),(0,i.jsx)(a.OdW.Button,{})]}),h=e=>u.uP.has(e)?u.uP.get(e):e.startsWith("taxonomy:")||e.startsWith("system:")?e:"taxonomy:".concat(e);var f=e=>{let{initialField:t,isLoading:l}=e,[f]=a.l09.useForm(),E=a.l09.useWatch("value_type",f),g=a.l09.useWatch("template",f),S=(0,n.useRouter)(),{resource_type:A}=S.query,j=(0,a.UD8)(),b=(0,a.ddY)(),{createOrUpdate:C}=(0,p.Z)(),{data:L,isLoading:U}=(0,v.vA)(null==t?void 0:t.allow_list_id,{skip:!(null==t?void 0:t.allow_list_id)}),[I,{isLoading:D}]=(0,v.UF)(),{data:P,isLoading:w}=(0,v.Az)(),O=(0,r.useMemo)(()=>{var e,t;return E?null!==(t=null==P?void 0:P.filter(e=>e!==u.Fb[E]&&e!=="taxonomy:".concat(E)).map(e=>({label:e,value:e})))&&void 0!==t?t:[]:null!==(e=null==P?void 0:P.map(e=>({label:e,value:e})))&&void 0!==e?e:[]},[P,E]),{valueTypeOptions:R}=(0,m.Z)(),N=(0,d.Tg)([y.Sh.CUSTOM_FIELD_DELETE])&&!!t,k=async()=>{if(!t)return;let{id:e,resource_type:l,field_type:i}=t,a=await I({id:e,resource_type:l,field_type:i});if((0,x.D4)(a)){j.error((0,s.e$)(a.error));return}j.success("Custom field deleted successfully"),S.push(o.WC)},G=async e=>{let{template:l,...i}=e,a=await C(i,t,L);if(!a){j.error("An unexpected error occurred");return}if((0,x.D4)(a)){j.error((0,s.e$)(a.error));return}j.success("Custom field ".concat(t?"updated":"created"," successfully")),S.push(o.WC)},M=(e=>{var t;if(!e)return;let l=(0,_._)(e),i=l===u.Uv.OPEN_TEXT||l===u.Uv.SINGLE_SELECT||l===u.Uv.MULTIPLE_SELECT?c:void 0;return{...e,value_type:e.field_type,template:i,field_type:l,resource_type:h(e.resource_type),options:null!==(t=null==L?void 0:L.allowed_values)&&void 0!==t?t:[]}})(t),Y=A?{...M,resource_type:"taxonomy:".concat(A)}:M;return l||U||w?(0,i.jsx)(T,{}):(0,i.jsxs)(a.l09,{form:f,layout:"vertical",initialValues:Y||{},validateTrigger:["onBlur","onChange"],onFinish:G,children:[(0,i.jsx)(a.l09.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please enter a name"}],children:(0,i.jsx)(a.IIB,{"data-testid":"input-name"})}),(0,i.jsx)(a.l09.Item,{label:"Description",name:"description",children:(0,i.jsx)(a.IIB.TextArea,{rows:2,"data-testid":"input-description"})}),(0,i.jsx)(a.l09.Item,{label:"Template",name:"template",rules:[{required:!0,message:"Select a template"}],children:(0,i.jsx)(a.PhF,{options:[{label:"Custom",value:c},{label:"Taxonomy",title:"Taxonomy",options:R}],onChange:e=>{e===c?f.setFieldValue("value_type",void 0):f.setFieldValue("value_type",e)},"data-testid":"select-template",getPopupContainer:e=>e.parentElement||document.body})}),(0,i.jsx)(a.l09.Item,{name:"value_type",hidden:!0,children:(0,i.jsx)(a.PhF,{options:R,"data-testid":"select-value-type",getPopupContainer:e=>e.parentElement||document.body})}),g===c&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.l09.Item,{label:"Field type",name:"field_type",rules:[{required:!0,message:"Please select a field type"}],children:(0,i.jsx)(a.PhF,{options:u.TY,"data-testid":"select-field-type"})}),(0,i.jsx)(a.l09.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.field_type!==t.field_type,children:e=>{let{getFieldValue:t}=e,l=t("field_type");return(l===u.Uv.SINGLE_SELECT||l===u.Uv.MULTIPLE_SELECT)&&(0,i.jsx)(a.l09.List,{name:"options",rules:[{validator:async(e,t)=>!t||t.length<1?Promise.reject(Error("At least one option is required for selects")):Promise.resolve()}],children:(e,l,n)=>{let{add:r,remove:s}=l,{errors:o}=n;return(0,i.jsxs)(i.Fragment,{children:[e.map((l,n)=>(0,i.jsx)(a.l09.Item,{required:!1,label:0===n?"Options":"","data-testid":"options-form-item",children:(0,i.jsxs)(a.kCb,{gap:"middle",children:[(0,i.jsx)(a.l09.Item,{...l,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Options cannot be empty"},()=>({validator:(e,l)=>t("options").filter(e=>e===l).length>1?Promise.reject(Error("Option values must be unique")):Promise.resolve()})],noStyle:!0,children:(0,i.jsx)(a.IIB,{placeholder:"Enter option value","data-testid":"input-option-".concat(n)})}),e.length>1&&(0,i.jsx)(a.zxk,{icon:(0,i.jsx)(a.PJP.ZNm,{}),onClick:()=>s(l.name),"aria-label":"Remove option"})]})},l.key)),(0,i.jsx)(a.l09.Item,{children:(0,i.jsx)(a.zxk,{type:"dashed",onClick:()=>r(),icon:(0,i.jsx)(a.PJP.mm_,{}),"data-testid":"add-option-btn",children:"Add select option"})}),(0,i.jsx)(a.l09.ErrorList,{errors:o,className:"-mt-4 mb-4"})]})}})}})]}),(0,i.jsx)(a.l09.Item,{label:"Applies to",name:"resource_type",rules:[{required:!0,message:"Please select a location"}],tooltip:"Choose where this field applies, including taxonomies",children:(0,i.jsx)(a.PhF,{options:O,getPopupContainer:e=>e.parentElement||document.body,disabled:!!t,"data-testid":"select-resource-type"})}),(0,i.jsxs)(a.kCb,{justify:"space-between",children:[N&&(0,i.jsx)(a.zxk,{danger:!0,onClick:()=>{var e;b.confirm({title:"Delete custom field?",content:(0,i.jsxs)(a.Typography.Paragraph,{children:["Are you sure you want to delete"," ",(0,i.jsx)("strong",{children:null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"this custom field"}),"? This action cannot be undone."]}),onOk:k,okType:"primary",okText:"Delete",centered:!0})},loading:D,"data-testid":"delete-btn",children:"Delete"}),(0,i.jsx)(a.zxk,{type:"primary",htmlType:"submit","data-testid":"save-btn",children:"Save"})]})]})}},8917:function(e,t,l){"use strict";l.d(t,{Fb:function(){return o},P3:function(){return c},TY:function(){return u},Un:function(){return p},Uv:function(){return a},mJ:function(){return d},uP:function(){return s}});var i,a,n=l(20987),r=l(59001);let s=new Map([[n.J.SYSTEM,"system:information"],[n.J.DATA_USE,"taxonomy:data use"],[n.J.DATA_CATEGORY,"taxonomy:data category"],[n.J.DATA_SUBJECT,"taxonomy:data subject"],[n.J.PRIVACY_DECLARATION,"system:data use"]]),o={[r.ac.DATA_CATEGORY]:"taxonomy:data category",[r.ac.DATA_USE]:"taxonomy:data use",[r.ac.DATA_SUBJECT]:"taxonomy:data subject",[r.ac.SYSTEM_GROUP]:"taxonomy:system group"},d={[r.ac.DATA_CATEGORY]:n.J.DATA_CATEGORY,[r.ac.DATA_USE]:n.J.DATA_USE,[r.ac.DATA_SUBJECT]:n.J.DATA_SUBJECT,[r.ac.SYSTEM_GROUP]:"system group"};(i=a||(a={})).SINGLE_SELECT="singleSelect",i.MULTIPLE_SELECT="multipleSelect",i.OPEN_TEXT="openText";let u=[{label:"Single select",value:"singleSelect"},{label:"Multiple select",value:"multipleSelect"},{label:"Open text",value:"openText"}],c={singleSelect:"Single-value select",multipleSelect:"Multi-value select",openText:"Open text"},p={[r.ac.DATA_CATEGORY]:"Data category",[r.ac.DATA_USE]:"Data use field",[r.ac.DATA_SUBJECT]:"Data subject",[r.ac.SYSTEM_GROUP]:"System group"}},67522:function(e,t,l){"use strict";var i=l(56141),a=l.n(i),n=l(20987),r=l(812),s=l(8917),o=l(32885);let d=()=>Date.now().toString()+Math.random().toString(),u=e=>e.startsWith("taxonomy:")?e.split(":",2)[1]:"system:information"===e?"system":"system:data use"===e?"privacy declaration":e;t.Z=()=>{let[e,{isLoading:t}]=(0,o.Ld)(),[l,{isLoading:i}]=(0,o.yM)(),[c]=(0,o.Nt)();return{createOrUpdate:async function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,p=u(t.resource_type);if(t.field_type===s.Uv.OPEN_TEXT){let a={...t,field_type:n.H.STRING,id:i?i.id:void 0,resource_type:p};return i?await l(a):await e(a)}if(t.field_type===s.Uv.SINGLE_SELECT||t.field_type===s.Uv.MULTIPLE_SELECT){var m,_;let u;if(!i){let{options:l,...i}=t,a={name:d(),allowed_values:null!=l?l:[]},o=await c(a);if((0,r.D4)(o))return o;let u={...i,field_type:t.field_type===s.Uv.SINGLE_SELECT?n.H.STRING:n.H.STRING_ARRAY,allow_list_id:null===(m=o.data)||void 0===m?void 0:m.id,resource_type:p};return await e(u)}let{options:v,...y}=t;if(!a()(null==o?void 0:o.allowed_values,v)){let e={...o,name:null!==(_=null==o?void 0:o.name)&&void 0!==_?_:d(),id:null==o?void 0:o.id,allowed_values:null!=v?v:[]};if(u=await c(e),(0,r.D4)(u))return u}let x={...y,id:i.id,allow_list_id:u&&!(0,r.D4)(u)?u.data.id:i.allow_list_id,resource_type:p,field_type:t.field_type===s.Uv.SINGLE_SELECT?n.H.STRING:n.H.STRING_ARRAY};return await l(x)}let{value_type:v,...y}=t,x={...y,id:i?i.id:void 0,field_type:v,resource_type:p};return i?await l(x):await e(x)},isLoading:t||i}}},66006:function(e,t,l){"use strict";var i=l(25980),a=l(59001),n=l(39864);t.Z=()=>{let{plus:e}=(0,i.hz)(),{data:t,isLoading:l}=(0,n.MU)(void 0,{skip:!e}),r=[{label:a.Lo.DATA_CATEGORIES,value:a.ac.DATA_CATEGORY},{label:a.Lo.DATA_USES,value:a.ac.DATA_USE},{label:a.Lo.DATA_SUBJECTS,value:a.ac.DATA_SUBJECT}];return e&&r.push({label:a.Lo.SYSTEM_GROUPS,value:a.ac.SYSTEM_GROUP}),l||(null==t?void 0:t.length)&&r.push(...t.map(e=>({label:e.name,value:e.fides_key}))),{valueTypeOptions:r}}},66236:function(e,t,l){"use strict";l.d(t,{S:function(){return r},_:function(){return n}});var i=l(20987),a=l(8917);let n=e=>e.field_type===i.H.STRING_ARRAY?a.Uv.MULTIPLE_SELECT:e.allow_list_id?a.Uv.SINGLE_SELECT:e.field_type===i.H.STRING?a.Uv.OPEN_TEXT:e.field_type,r=e=>{let t=n(e);return t in a.P3?a.P3[t]:t in a.Un?a.Un[t]:t}},31883:function(e,t,l){"use strict";l.d(t,{Bw:function(){return i.Bw},D4:function(){return i.D4}});var i=l(19043)}}]);