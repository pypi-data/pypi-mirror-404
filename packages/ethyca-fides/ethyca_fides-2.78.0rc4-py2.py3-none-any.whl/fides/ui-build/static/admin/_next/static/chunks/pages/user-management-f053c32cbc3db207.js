(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[693],{7873:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user-management",function(){return n(32802)}])},30952:function(e,t,n){"use strict";n.d(t,{f:function(){return i}});var r=n(24246),s=n(26917);let i=e=>{let{...t}=e;return(0,r.jsx)(s.Z,{debounce:!0,...t})}},35287:function(e,t,n){"use strict";var r=n(24246),s=n(36010),i=n(88038),a=n.n(i);n(27378),t.Z=e=>{let{children:t,title:n,fullHeight:i,fullWidth:l,mainProps:o}=e;return(0,r.jsxs)(s.ad9,{"data-testid":n,direction:"column",height:i?"100vh":"calc(100vh - 48px)",width:l?"100vw":"calc(100vw - 240px)",children:[(0,r.jsxs)(a(),{children:[(0,r.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,r.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)(s.ad9,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...o,children:t})]})}},58754:function(e,t,n){"use strict";var r=n(24246),s=n(36010),i=n(70788);t.Z=e=>{let{heading:t,breadcrumbItems:n,isSticky:a=!0,children:l,rightContent:o,style:d,...c}=e;return(0,r.jsxs)("div",{...c,style:a?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,r.jsxs)(s.kCb,{justify:"space-between",children:["string"==typeof t?(0,r.jsx)(s.Dxz,{className:n||l?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,r.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!n&&(0,r.jsx)(i.m,{className:l?"pb-4":void 0,items:n,"data-testid":"page-breadcrumb"}),l]})}},19904:function(e,t,n){"use strict";n.d(t,{Tg:function(){return a}});var r=n(24246),s=n(16134),i=n(31793);let a=e=>(0,s.C)(i.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:n}=e;return a(t)?(0,r.jsx)(r.Fragment,{children:n}):null}},59849:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(24246),s=n(36010),i=n(86677),a=n(88340);let l="/images/errors";var o=e=>{let{status:t}=e;return 404===t?(0,r.jsx)(s.Eep,{src:"".concat(l,"/404.svg"),alt:"Error 404",preview:!1}):500===t?(0,r.jsx)(s.Eep,{src:"".concat(l,"/500.svg"),alt:"Error 500",preview:!1}):(0,r.jsx)(s.Eep,{src:"".concat(l,"/unknown.svg"),alt:"Error Unknown",preview:!1})},d=n(812),c=e=>{let{error:t,defaultMessage:n="An unexpected error occurred.  Please try again",actions:l,showReload:c=!0}=e,u=(0,d.e$)(t,n),p="data"in t&&t.data?JSON.stringify(t.data):JSON.stringify(t),h="status"in t&&t.status?t.status:void 0,m=(0,i.useRouter)(),g=l&&l.length>0||c;return(0,r.jsx)(s.kCb,{vertical:!0,align:"center",justify:"center",className:"h-screen","data-testid":"error-page-result",children:(0,r.jsx)(s.x4B,{status:"error",icon:(0,r.jsx)(o,{status:h}),title:"Error ".concat(h),subTitle:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Typography.Paragraph,{type:"secondary",children:u}),(0,r.jsx)(s.kCb,{justify:"start",className:"max-w-96",children:(0,r.jsx)(s.UO1,{ghost:!0,size:"small",items:[{key:"1",label:"Show details",classNames:{header:"w-fit"},children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Typography.Text,{type:"secondary",children:p}),(0,r.jsx)(a.Z,{copyText:p})]})}]})})]}),extra:g&&(0,r.jsxs)(s.kCb,{gap:"small",justify:"center",children:[null==l?void 0:l.map((e,t)=>(0,r.jsx)(s.zxk,{...e,children:e.label},t)),c&&(0,r.jsx)(s.zxk,{onClick:()=>m.reload(),type:"primary",children:"Reload"})]})})})}},70788:function(e,t,n){"use strict";n.d(t,{m:function(){return d}});var r=n(24246),s=n(36010),i=n(79894),a=n.n(i),l=n(27378);let{Text:o}=s.Typography,d=e=>{let{items:t,...n}=e,i=(0,l.useMemo)(()=>null==t?void 0:t.map((e,n)=>{let i=n===t.length-1,l={...e},d=l.onClick&&!l.href;return("string"==typeof l.title&&(l.title=(0,r.jsx)(o,{style:{color:"inherit",maxWidth:i?void 0:400},ellipsis:!i,id:i?"breadcrumb-current-page":void 0,children:l.title})),d)?l.title=(0,r.jsx)(s.zxk,{type:"text",size:"small",icon:l.icon,onClick:l.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:l.title}):(l.icon&&(l.title=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"anticon align-text-bottom",children:l.icon}),l.title]})),l.href&&l.title&&(l.title=(0,r.jsx)(a(),{href:l.href,className:"ant-breadcrumb-link",children:l.title}),delete l.href)),l}),[t]);return(0,r.jsx)(s.aGc,{items:i,...n})}},99640:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(24246),s=n(36010),i=n(79894),a=n.n(i);let{Link:l,Text:o}=s.Typography,d=e=>{let{href:t,children:n,containerProps:i,strong:d=!0,...c}=e;return n&&(0,r.jsx)(s.kCb,{...i,children:t?(0,r.jsx)(a(),{href:t,passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(l,{strong:d,ellipsis:!0,onClick:e=>e.stopPropagation(),variant:"primary",...c,children:(0,r.jsx)(o,{unStyled:!0,ellipsis:{tooltip:n},children:n})})}):(0,r.jsx)(o,{strong:d,ellipsis:!0,...c,children:n})})}},8125:function(e,t,n){"use strict";n.d(t,{V:function(){return i},o:function(){return d}});var r=n(27378),s=n(32735);let i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{enableSelection:n=!1,getRowKey:i,bulkActions:a,isLoading:l=!1,isFetching:o=!1,dataSource:d=[],totalRows:c=0,currentPage:u,pageSize:p,customTableProps:h={}}=t,m=(0,r.useCallback)(e=>{if(e&&"object"==typeof e){if(e.id)return String(e.id);if(e.key)return String(e.key)}return String(e)},[]),g=i||m,[x,f]=(0,r.useState)([]),[v,j]=(0,r.useState)([]),b=(0,r.useCallback)(()=>{f([]),j([])},[]),y=(0,r.useMemo)(()=>({selectedRowKeys:x,selectedRows:v,resetSelections:b}),[x,v,b]),w=(0,r.useMemo)(()=>{if(n)return{selectedRowKeys:x,onChange:(e,t)=>{f(e),j(t)}}},[n,x]),k=(0,r.useCallback)((t,n,r)=>{var s,i;let a=null!==(s=t.current)&&void 0!==s?s:e.pageIndex,l=null!==(i=t.pageSize)&&void 0!==i?i:e.pageSize,o=a!==e.pageIndex||l!==e.pageSize;o?(t.current&&t.current!==e.pageIndex&&e.updatePageIndex(t.current),t.pageSize&&t.pageSize!==e.pageSize&&e.updatePageSize(t.pageSize)):e.updateFilters(n||{});let d=r&&!Array.isArray(r)?r.field:void 0,c=r&&!Array.isArray(r)&&null!==r.order?r.order:void 0;o||e.updateSorting(d,c)},[e]),S=(0,r.useMemo)(()=>{var t,n,r,i,a;return{current:null!=u?u:e.pageIndex,pageSize:null!=p?p:e.pageSize,total:c,showSizeChanger:null===(i=null===(t=e.paginationConfig)||void 0===t?void 0:t.showSizeChanger)||void 0===i||i,pageSizeOptions:null!==(a=null===(r=e.paginationConfig)||void 0===r?void 0:null===(n=r.pageSizeOptions)||void 0===n?void 0:n.map(String))&&void 0!==a?a:s.VZ}},[u,e.pageIndex,p,e.pageSize,c,e.paginationConfig]),C=(0,r.useMemo)(()=>({dataSource:d,loading:l||o,pagination:S,onChange:k,rowKey:g,scroll:{x:"max-content",scrollToFirstRowOnChange:!0},size:"small",bordered:!0,...h}),[d,l,o,S,k,g,h]),E=x.map(String),z=v.length>0,_=(0,r.useCallback)(e=>{let t=null==a?void 0:a.actions.find(t=>t.key===e);return t?{disabled:!z||!!t.disabled&&t.disabled(v),loading:t.loading||!1,onClick:()=>t.onClick(v)}:{disabled:!0,loading:!1}},[a,z,v]);return(0,r.useMemo)(()=>({tableProps:C,selectionProps:w,selectionState:y,selectedRows:v,selectedKeys:E,hasSelectedRows:z,resetSelections:b,getBulkActionProps:_,isLoadingOrFetching:l||o,hasData:d.length>0}),[C,w,y,v,E,z,b,_,l,o,d.length])};var a=n(40431),l=n(17245);let o=()=>({filters:(0,a.WJ)(e=>e).withDefault({})}),d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{pagination:t={},sorting:n={},search:s={},onStateChange:i,disableUrlState:d=!1}=e,{pageIndex:c,pageSize:u,resetPagination:p,updatePageIndex:h,updatePageSize:m,pageSizeOptions:g,showSizeChanger:x}=(0,l.h0)({...t,disableUrlState:d}),{sortKey:f,sortOrder:v,updateSorting:j,resetSorting:b}=(0,l.rK)({...n,disableUrlState:d}),{searchQuery:y,updateSearch:w,resetSearch:k}=(0,l.Rx)({...s,disableUrlState:d}),[S,C]=(0,r.useState)({}),E=(0,r.useMemo)(()=>d?null:o(),[d]),[z,_]=(0,a.XI)(null!=E?E:{},{history:"push"}),T=(0,r.useMemo)(()=>{var e;return{pageIndex:c,pageSize:u,sortKey:f,sortOrder:v,columnFilters:d?S:null!==(e=z.filters)&&void 0!==e?e:{},searchQuery:y}},[d,S,z,c,u,f,v,y]),R=(0,r.useCallback)((e,t)=>{j(e,t),p()},[j,p]),A=(0,r.useCallback)(e=>{if(d)C(e);else{let t=Object.fromEntries(Object.entries(e).filter(e=>{let[,t]=e;return null!=t}));_({filters:Object.keys(t).length>0?t:null})}p()},[d,_,p]),N=(0,r.useCallback)(e=>{w(e),p()},[w,p]),O=(0,r.useCallback)(()=>{d?C({}):_({filters:null}),p(),b(),k()},[d,_,p,b,k]);return(0,r.useEffect)(()=>{i&&i(T)},[T,i]),{state:T,pageIndex:T.pageIndex,pageSize:T.pageSize,updatePageIndex:h,updatePageSize:m,sortKey:T.sortKey,sortOrder:T.sortOrder,updateSorting:R,columnFilters:T.columnFilters,updateFilters:A,searchQuery:T.searchQuery,updateSearch:N,resetState:O,paginationConfig:{pageSizeOptions:g,showSizeChanger:x}}}},61038:function(e,t,n){"use strict";var r=n(24246),s=n(36010),i=n(34090),a=n(86677);n(27378);var l=n(55484),o=n(16134),d=n(40324),c=n(812),u=n(77830),p=n(46628),h=n(65497);let m={username:"",usernameConfirmation:""},g=e=>{let{id:t,username:n,onClose:r}=e,i=(0,s.p8r)(),d=(0,a.useRouter)(),m=(0,o.T)(),[g]=(0,h.I1)();return{handleDeleteUser:async()=>{let e=await g(t);(0,c.D4)(e)?i((0,p.Vo)((0,c.e$)(e.error))):(i((0,p.t5)("Successfully deleted user")),r()),m((0,h.Vv)(void 0)),d.push(u.e3)},validationSchema:l.Ry().shape({usernameConfirmation:l.Z_().required().oneOf([n],"Confirmation input must match the username").label("Username confirmation")})}};t.Z=e=>{let{user:t,...n}=e,{isOpen:a,onClose:l}=n,{handleDeleteUser:o,validationSchema:c}=g({id:t.id,username:t.username,onClose:l});return(0,r.jsxs)(s.TGG,{isCentered:!0,isOpen:a,onClose:l,children:[(0,r.jsx)(s.T5Q,{}),(0,r.jsx)(s.Z8H,{"data-testid":"delete-user-modal",children:(0,r.jsx)(i.J9,{initialValues:m,validationSchema:c,onSubmit:o,children:e=>{let{isSubmitting:n,dirty:a,isValid:o}=e;return(0,r.jsxs)(i.l0,{children:[(0,r.jsx)(s.geD,{children:"Delete User"}),(0,r.jsx)(s.fpf,{}),(0,r.jsxs)(s.zOL,{children:[(0,r.jsxs)(s.Bwi,{status:"warning",overflow:"visible",colorScheme:"warn",marginBottom:4,children:[(0,r.jsx)(s.Pid,{}),(0,r.jsxs)(s.Gdf,{children:[(0,r.jsx)(s.Bjg,{as:"span",mb:2,children:"You are about to delete the user\xa0"}),(0,r.jsxs)(s.Bjg,{as:"span",mb:2,fontStyle:"italic",fontWeight:"semibold",children:[t.username,"."]}),(0,r.jsx)(s.Bjg,{mb:2,children:"This action cannot be undone. To confirm, please enter the userâ€™s username below."})]})]}),(0,r.jsx)(s.EO$,{direction:"column",spacing:4,children:(0,r.jsx)(d.j0,{name:"usernameConfirmation",label:"Confirm username",placeholder:"Type the username to delete"})})]}),(0,r.jsx)(s.NGc,{children:(0,r.jsxs)("div",{className:"flex w-full gap-2",children:[(0,r.jsx)(s.zxk,{onClick:l,className:"w-1/2",children:"Cancel"}),(0,r.jsx)(s.zxk,{type:"primary",disabled:!a||!o,loading:n,htmlType:"submit",className:"w-1/2","data-testid":"submit-btn",children:"Delete User"})]})})]})}})})]})}},91437:function(e,t,n){"use strict";n.d(t,{K:function(){return s}});var r=n(60240);let s=[{label:"Owner",permissions_label:"Owner",roleKey:r.A7.OWNER,description:"Owners have view and edit access to the whole organization and can create new users"},{label:"Contributor",permissions_label:"Contributor",roleKey:r.A7.CONTRIBUTOR,description:"Contributors can create new users and have view and edit access to the whole organization. Contributors cannot configure storage and messaging services"},{label:"Viewer",permissions_label:"Viewer",roleKey:r.A7.VIEWER,description:"Viewers have view access to the Data Map and all systems"},{label:"Viewer & Approver",permissions_label:"Viewer & Approver",roleKey:r.A7.VIEWER_AND_APPROVER,description:"Viewer & Approvers have view access to the Data Map but can also manage Privacy Requests"},{label:"Approver",permissions_label:"Approver",roleKey:r.A7.APPROVER,description:"Approvers can only access the Privacy Requests portal to review, approve, and create new requests"},{label:"Internal respondent",permissions_label:"Internal respondent",roleKey:r.A7.RESPONDENT,description:"Internal respondents have limited access and can only view and complete manual DSR tasks assigned to them"},{label:"External respondent",permissions_label:"External respondent",roleKey:r.A7.EXTERNAL_RESPONDENT,description:"External respondents can only access the external task portal to complete manual DSR tasks assigned to them"}]},32802:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return z}});var r=n(24246),s=n(27378),i=n(36010),a=n(79894),l=n.n(a),o=n(16134),d=n(30952),c=n(77830),u=n(19904),p=n(60240),h=n(65497),m=n(91317),g=n(99640),x=n(8125),f=n(91437),v=n(61038);let j=e=>{let{userId:t}=e,{data:n}=(0,h.gU)(t,{skip:!t}),s=[];return n&&n.roles&&n.roles.forEach(e=>{let t=f.K.find(t=>t.roleKey===e);t&&s.push(t.permissions_label)}),(0,r.jsx)(r.Fragment,{children:s.map(e=>(0,r.jsx)(i.Vp9,{"data-testid":"user-permissions-badge",children:e},e))})},b=e=>{let{userId:t}=e,{data:n}=(0,h.d6)(t,{skip:!t});return(0,r.jsx)(i.Vp9,{className:"text-center","data-testid":"user-systems-badge",children:n?n.length:0})},y=e=>{let{user:t}=e,n=(0,i.E2M)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.zxk,{size:"small","aria-label":"delete",icon:(0,r.jsx)(i.PJP.ZNm,{}),onClick:e=>{e.stopPropagation(),n.onOpen()},"data-testid":"delete-user-btn"}),(0,r.jsx)(v.Z,{user:t,...n})]})};var w=()=>{let e=(0,o.C)(m.dy),t=(0,u.Tg)([p.Sh.USER_DELETE]),n=(0,u.Tg)([p.Sh.USER_UPDATE]),a=(0,x.o)({pagination:{defaultPageSize:25,pageSizeOptions:[25,50,100]},search:{defaultSearchQuery:""}}),{pageIndex:l,pageSize:d,searchQuery:f,updateSearch:v}=a,{data:w,isLoading:k,isFetching:S,error:C}=(0,h.wv)({page:l,size:d,username:f||void 0}),E=(0,s.useMemo)(()=>{var e,t;return{dataSource:null!==(e=null==w?void 0:w.items)&&void 0!==e?e:[],totalRows:null!==(t=null==w?void 0:w.total)&&void 0!==t?t:0,isLoading:k,isFetching:S,getRowKey:e=>{var t;return null!==(t=e.id)&&void 0!==t?t:""}}},[null==w?void 0:w.items,null==w?void 0:w.total,k,S]),{tableProps:z}=(0,x.V)(a,E);return{tableProps:z,columns:(0,s.useMemo)(()=>[{title:"Username",dataIndex:"username",key:"username",fixed:"left",render:(t,s)=>{let a=!!e&&e.id===s.id,l=n||a;return(0,r.jsxs)(i.kCb,{gap:"small",children:[(0,r.jsx)(g.Z,{href:l?"".concat(c.e3,"/profile/").concat(s.id):void 0,"data-testid":"user-link-".concat(s.id),children:t})," ",s.disabled&&(0,r.jsx)(i.Vp9,{color:"success","data-testid":"invite-sent-badge",children:"Invite sent"})]})}},{title:"Email",dataIndex:"email_address",key:"email_address"},{title:"First name",dataIndex:"first_name",key:"first_name"},{title:"Last name",dataIndex:"last_name",key:"last_name"},{title:"Permissions",key:"permissions",render:(e,t)=>{var n;return(0,r.jsx)(j,{userId:null!==(n=t.id)&&void 0!==n?n:""})}},{title:"Assigned systems",key:"systems",render:(e,t)=>{var n;return(0,r.jsx)(b,{userId:null!==(n=t.id)&&void 0!==n?n:""})}},{title:"Created at",dataIndex:"created_at",key:"created_at",render:e=>e?new Date(e).toUTCString():null},...t?[{title:"",key:"actions",width:80,render:(e,t)=>(0,r.jsx)(y,{user:t})}]:[]],[t,n,e]),error:C,searchQuery:f,updateSearch:v}},k=()=>{let{tableProps:e,columns:t,searchQuery:n,updateSearch:a}=w(),m=(0,o.T)();return(0,s.useEffect)(()=>{m((0,h.Vv)(void 0))},[m]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.kCb,{justify:"space-between",className:"mb-4",children:[(0,r.jsx)(d.f,{value:n,onChange:a,placeholder:"Search by username","data-testid":"user-search"}),(0,r.jsx)(u.ZP,{scopes:[p.Sh.USER_CREATE],children:(0,r.jsx)(l(),{href:"".concat(c.e3,"/new"),passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(i.zxk,{type:"primary","data-testid":"add-new-user-btn",children:"Add new user"})})})]}),(0,r.jsx)(i.iA_,{...e,columns:t,"data-testid":"user-management-table",onRow:e=>({"data-testid":"row-".concat(e.id)})})]})},S=n(59849),C=n(35287),E=n(58754),z=()=>{let{error:e}=w();return e?(0,r.jsx)(S.Z,{error:e,defaultMessage:"A problem occurred while fetching user management"}):(0,r.jsxs)(C.Z,{title:"User Management",children:[(0,r.jsx)(E.Z,{heading:"Users",breadcrumbItems:[{title:"All users"}],isSticky:!1}),(0,r.jsx)(k,{})]})}}},function(e){e.O(0,[431,7245,2888,9774,179],function(){return e(e.s=7873)}),_N_E=e.O()}]);