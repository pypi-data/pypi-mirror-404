(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7984],{69453:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/notifications/digests",function(){return s(80181)}])},129:function(e,t,s){"use strict";var i=s(24246),r=s(36010),a=s(86677),n=s(16134),l=s(25980),c=s(77830),o=s(60240),d=s(31793);t.Z=()=>{let e=(0,a.useRouter)(),t=e.pathname,{plus:s}=(0,l.hz)(),u="providers";t.startsWith(c.AD)?u="providers":t.startsWith(c.Wi)?u="templates":t.startsWith(c.DN)&&(u="digests");let p=[{key:"templates",label:"Templates",requiresPlus:!0,scopes:[o.Sh.MESSAGING_TEMPLATE_UPDATE],path:c.Wi},{key:"digests",label:"Digests",requiresPlus:!0,scopes:[o.Sh.DIGEST_CONFIG_READ],path:c.DN},{key:"providers",label:"Providers",requiresPlus:!1,scopes:[o.Sh.MESSAGING_CREATE_OR_UPDATE],path:c.AD}];s||(p=p.filter(e=>!e.requiresPlus));let h=(0,n.C)(d.uu);p=p.filter(e=>e.scopes.some(e=>h.includes(e)));let g=t=>{let s=p.find(e=>e.key===t);s&&e.push(s.path)},x=p.map(e=>({label:e.label,key:e.key}));return(0,i.jsx)("div",{className:"mb-6",children:(0,i.jsx)(r.v2r,{mode:"horizontal",selectedKeys:[u],onClick:e=>{let{key:t}=e;return g(t)},items:x})})}},59849:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var i=s(24246),r=s(36010),a=s(86677),n=s(88340);let l="/images/errors";var c=e=>{let{status:t}=e;return 404===t?(0,i.jsx)(r.Eep,{src:"".concat(l,"/404.svg"),alt:"Error 404",preview:!1}):500===t?(0,i.jsx)(r.Eep,{src:"".concat(l,"/500.svg"),alt:"Error 500",preview:!1}):(0,i.jsx)(r.Eep,{src:"".concat(l,"/unknown.svg"),alt:"Error Unknown",preview:!1})},o=s(812),d=e=>{let{error:t,defaultMessage:s="An unexpected error occurred.  Please try again",actions:l,showReload:d=!0}=e,u=(0,o.e$)(t,s),p="data"in t&&t.data?JSON.stringify(t.data):JSON.stringify(t),h="status"in t&&t.status?t.status:void 0,g=(0,a.useRouter)(),x=l&&l.length>0||d;return(0,i.jsx)(r.kCb,{vertical:!0,align:"center",justify:"center",className:"h-screen","data-testid":"error-page-result",children:(0,i.jsx)(r.x4B,{status:"error",icon:(0,i.jsx)(c,{status:h}),title:"Error ".concat(h),subTitle:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.Typography.Paragraph,{type:"secondary",children:u}),(0,i.jsx)(r.kCb,{justify:"start",className:"max-w-96",children:(0,i.jsx)(r.UO1,{ghost:!0,size:"small",items:[{key:"1",label:"Show details",classNames:{header:"w-fit"},children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.Typography.Text,{type:"secondary",children:p}),(0,i.jsx)(n.Z,{copyText:p})]})}]})})]}),extra:x&&(0,i.jsxs)(r.kCb,{gap:"small",justify:"center",children:[null==l?void 0:l.map((e,t)=>(0,i.jsx)(r.zxk,{...e,children:e.label},t)),d&&(0,i.jsx)(r.zxk,{onClick:()=>g.reload(),type:"primary",children:"Reload"})]})})})}},80181:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return E}});var i=s(24246),r=s(36010),a=s(59849),n=s(77213),l=s(129),c=s(58754),o=s(86677),d=s(812),u=s(77830),p=s(19904),h=s(26917),g=s(60240),x=s(35493),m=s(40822),y=s(81179),_=s(27378);let j=()=>{var e;let t=(0,o.useRouter)(),[s,i]=(0,_.useState)(""),[r,a]=(0,_.useState)(1),[n,l]=(0,_.useState)(50),c=g.tB.MANUAL_TASKS,d=(0,p.Tg)([g.Sh.DIGEST_CONFIG_CREATE,g.Sh.DIGEST_CONFIG_UPDATE]),h=(0,p.Tg)([g.Sh.DIGEST_CONFIG_DELETE]),{data:x,isLoading:y,refetch:j,error:f}=(0,m.Q6)({digest_config_type:c,page:r,size:n}),[E,{isLoading:v}]=(0,m.yG)(),[T,C]=(0,_.useState)(!1),[S,b]=(0,_.useState)(null),k=(0,_.useMemo)(()=>{if(!(null==x?void 0:x.items))return[];if(!s)return x.items;let e=s.toLowerCase();return x.items.filter(t=>{var s;return t.name.toLowerCase().includes(e)||(null===(s=t.description)||void 0===s?void 0:s.toLowerCase().includes(e))})},[null==x?void 0:x.items,s]),N=async()=>{S&&(await E({config_id:S.id,digest_config_type:c}),C(!1),b(null),j())};return{data:k,total:null!==(e=null==x?void 0:x.total)&&void 0!==e?e:0,isLoading:y,error:f,page:r,pageSize:n,searchQuery:s,setPage:a,setPageSize:l,setSearchQuery:i,refetch:j,handleEdit:e=>{t.push(u.xn.replace("[id]",e.id))},handleDeleteClick:e=>{b(e),C(!0)},deleteModalOpen:T,configToDelete:S,confirmDelete:N,cancelDelete:()=>{C(!1),b(null)},isDeleting:v,canUpdate:d,canDelete:h}};var f=()=>{let e=(0,o.useRouter)(),t=(0,r.UD8)(),{data:s,total:a,isLoading:n,page:l,pageSize:c,searchQuery:_,setPage:f,setPageSize:E,setSearchQuery:v,handleEdit:T,canUpdate:C}=j(),[S]=(0,m.zb)(),b=(0,p.Tg)([g.Sh.DIGEST_CONFIG_CREATE]),k=async e=>{let s=await S({config_id:e.id,digest_config_type:g.tB.MANUAL_TASKS,data:{name:e.name,description:e.description,digest_type:e.digest_type,enabled:!e.enabled,messaging_service_type:e.messaging_service_type,cron_expression:e.cron_expression,timezone:e.timezone,config_metadata:e.config_metadata}});if((0,d.D4)(s)){t.error((0,d.e$)(s.error));return}t.success('Digest "'.concat(e.name,'" ').concat(e.enabled?"disabled":"enabled"," successfully"))};return(0,i.jsxs)("div",{children:[(0,i.jsxs)(r.kCb,{justify:"space-between",align:"center",className:"mb-4",children:[(0,i.jsx)("div",{className:"w-1/3",children:(0,i.jsx)(h.Z,{value:_,onChange:e=>v(e)})}),b&&(0,i.jsx)(r.zxk,{type:"primary",onClick:()=>{e.push(u.dx)},"data-testid":"add-digest-btn",children:"Create digest"})]}),(0,i.jsx)(r.aVo,{loading:n,itemLayout:"horizontal",dataSource:s,locale:{emptyText:(0,i.jsx)("div",{className:"px-4 py-8 text-center",children:(0,i.jsxs)(r.Typography.Paragraph,{type:"secondary",children:["No digest configurations yet. ",(0,i.jsx)("br",{}),(0,i.jsx)(p.ZP,{scopes:[g.Sh.DIGEST_CONFIG_CREATE],children:'Click "Create digest" to get started.'})]})})},renderItem:e=>(0,i.jsxs)(r.aVo.Item,{actions:C?[(0,i.jsx)(r.zxk,{type:"link",onClick:()=>T(e),"data-testid":"edit-list-btn",className:"px-1",children:"Edit"},"edit")]:[],children:[(0,i.jsx)(r.aVo.Item.Meta,{title:e.name,description:(0,i.jsx)(r.TaI,{direction:"vertical",size:4,children:(0,i.jsxs)(r.TaI,{size:4,children:[(0,i.jsx)(r.Vp9,{children:x.Um[e.digest_type]}),(0,i.jsx)(r.Vp9,{children:x.oU[e.messaging_service_type]})]})})}),(0,i.jsxs)(r.kCb,{align:"center",gap:24,children:[(0,i.jsx)(r.Typography.Text,{children:(0,y.uw)(e.cron_expression)}),C&&(0,i.jsx)(r.rsf,{checked:e.enabled,onChange:()=>k(e),size:"small","data-testid":"toggle-enabled-switch"})]})]},e.id)}),a>c&&(0,i.jsx)(r.kCb,{justify:"end",className:"mt-4",children:(0,i.jsx)(r.tlE,{current:l,total:a,pageSize:c,onChange:(e,t)=>{f(e),t!==c&&E(t)},showSizeChanger:!0,showTotal:e=>"Total ".concat(e," items")})})]})},E=()=>{let{error:e}=j();return e?(0,i.jsx)(a.Z,{error:e,defaultMessage:"A problem occurred while fetching your digests"}):(0,i.jsx)(n.Z,{title:"Notifications",children:(0,i.jsxs)(r.kCb,{vertical:!0,"data-testid":"digests-management",children:[(0,i.jsx)(c.Z,{heading:"Notifications"}),(0,i.jsx)(l.Z,{}),(0,i.jsx)(f,{})]})})}}},function(e){e.O(0,[8212,2888,9774,179],function(){return e(e.s=69453)}),_N_E=e.O()}]);