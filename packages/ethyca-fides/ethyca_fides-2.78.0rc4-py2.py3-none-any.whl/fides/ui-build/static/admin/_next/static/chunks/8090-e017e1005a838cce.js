(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8090],{79806:function(e,t,l){"use strict";l.d(t,{Gn:function(){return r},zR:function(){return s}});var a=l(24246),i=l(36010),n=l(56358);let s=e=>{let{title:t}=e;return(0,a.jsx)(i.v7L,{py:0,display:"flex",alignItems:"flex-start",children:(0,a.jsx)(i.Bjg,{mr:"2",color:"gray.700",fontSize:"lg",lineHeight:1.8,children:t})})},r=e=>{let{onDelete:t,onEditYaml:l,formId:s,isSaving:r}=e;return(0,a.jsxs)(i.KR9,{justifyContent:"space-between",children:[t?(0,a.jsx)(i.zxk,{"aria-label":"delete",icon:(0,a.jsx)(n.q,{fontSize:"small"}),onClick:t,"data-testid":"delete-btn"}):null,(0,a.jsxs)("div",{className:"flex gap-2",children:[l&&(0,a.jsx)(i.zxk,{onClick:l,"data-testid":"edit-yaml-btn",children:"Edit YAML"}),(0,a.jsx)(i.zxk,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:s,loading:r,children:"Save"})]})]})};t.ZP=e=>{let{header:t,description:l,isOpen:n,onClose:s,children:r,footer:o}=e;return(0,a.jsxs)(i.JTh,{placement:"right",isOpen:n,onClose:s,size:"md",children:[(0,a.jsx)(i.yY5,{}),(0,a.jsxs)(i.mJD,{"data-testid":"edit-drawer-content",py:2,children:[(0,a.jsxs)(i.TJV,{display:"flex",justifyContent:"space-between",alignItems:"top",mr:2,py:2,gap:2,children:[(0,a.jsx)(i.TJV,{flex:1,minH:8,children:t}),(0,a.jsx)(i.TJV,{display:"flex",justifyContent:"flex-end",mr:2,children:(0,a.jsx)(i.zxk,{"aria-label":"Close editor",onClick:s,"data-testid":"close-drawer-btn",icon:(0,a.jsx)(i.j_w,{fontSize:"smaller"})})})]}),(0,a.jsxs)(i.Q4$,{pt:1,children:[l?(0,a.jsx)(i.Bjg,{fontSize:"sm",mb:4,color:"gray.600",children:l}):null,r]}),o]})]})}},18225:function(e,t,l){"use strict";var a=l(24246),i=l(36010);t.Z=e=>{let{alignment:t="center",...l}=e;return(0,a.jsx)(i.ad9,{boxSize:"full",align:"center",justify:t,children:(0,a.jsx)(i.Y6B,{color:"primary",...l})})}},56358:function(e,t,l){"use strict";l.d(t,{q:function(){return i}});var a=l(24246);let i=(0,l(36010).G1m)({displayName:"TrashCanOutlineIcon",viewBox:"0 0 11 12",path:(0,a.jsx)("path",{d:"M4.5166 1.60859L4.1084 2.21875H7.22363L6.81543 1.60859C6.7832 1.56133 6.72949 1.53125 6.67148 1.53125H4.6584C4.60039 1.53125 4.54668 1.55918 4.51445 1.60859H4.5166ZM7.6748 1.03711L8.46328 2.21875H8.75977H9.79102H9.96289C10.2486 2.21875 10.4785 2.44863 10.4785 2.73438C10.4785 3.02012 10.2486 3.25 9.96289 3.25H9.79102V9.78125C9.79102 10.7309 9.02188 11.5 8.07227 11.5H3.25977C2.31016 11.5 1.54102 10.7309 1.54102 9.78125V3.25H1.36914C1.0834 3.25 0.853516 3.02012 0.853516 2.73438C0.853516 2.44863 1.0834 2.21875 1.36914 2.21875H1.54102H2.57227H2.86875L3.65723 1.03496C3.88066 0.701953 4.25664 0.5 4.6584 0.5H6.67148C7.07324 0.5 7.44922 0.701953 7.67266 1.03496L7.6748 1.03711ZM2.57227 3.25V9.78125C2.57227 10.1615 2.87949 10.4688 3.25977 10.4688H8.07227C8.45254 10.4688 8.75977 10.1615 8.75977 9.78125V3.25H2.57227ZM4.29102 4.625V9.09375C4.29102 9.28281 4.13633 9.4375 3.94727 9.4375C3.7582 9.4375 3.60352 9.28281 3.60352 9.09375V4.625C3.60352 4.43594 3.7582 4.28125 3.94727 4.28125C4.13633 4.28125 4.29102 4.43594 4.29102 4.625ZM6.00977 4.625V9.09375C6.00977 9.28281 5.85508 9.4375 5.66602 9.4375C5.47695 9.4375 5.32227 9.28281 5.32227 9.09375V4.625C5.32227 4.43594 5.47695 4.28125 5.66602 4.28125C5.85508 4.28125 6.00977 4.43594 6.00977 4.625ZM7.72852 4.625V9.09375C7.72852 9.28281 7.57383 9.4375 7.38477 9.4375C7.1957 9.4375 7.04102 9.28281 7.04102 9.09375V4.625C7.04102 4.43594 7.1957 4.28125 7.38477 4.28125C7.57383 4.28125 7.72852 4.43594 7.72852 4.625Z",fill:"currentColor"})})},58754:function(e,t,l){"use strict";var a=l(24246),i=l(36010),n=l(70788);t.Z=e=>{let{heading:t,breadcrumbItems:l,isSticky:s=!0,children:r,rightContent:o,style:d,...u}=e;return(0,a.jsxs)("div",{...u,style:s?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,a.jsxs)(i.kCb,{justify:"space-between",children:["string"==typeof t?(0,a.jsx)(i.Dxz,{className:l||r?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,a.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!l&&(0,a.jsx)(n.m,{className:r?"pb-4":void 0,items:l,"data-testid":"page-breadcrumb"}),r]})}},19904:function(e,t,l){"use strict";l.d(t,{Tg:function(){return s}});var a=l(24246),i=l(16134),n=l(31793);let s=e=>(0,i.C)(n.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:l}=e;return s(t)?(0,a.jsx)(a.Fragment,{children:l}):null}},94799:function(e,t,l){"use strict";l.d(t,{k:function(){return n}});var a=l(76649);let i=e=>(0,a.Ln)({id:"string"},e),n=e=>(null!=e?e:[]).filter(i)},30320:function(e,t,l){"use strict";l.d(t,{m:function(){return o}});var a=l(27378),i=l(25980),n=l(17245),s=l(32885),r=l(94799);let o=e=>{let{resourceFidesKey:t,resourceType:l}=e,{errorAlert:o}=(0,n.VY)(),{plus:d}=(0,i.hz)(),u=(0,a.useMemo)(()=>null!=t?t:"",[]),c=(0,s.YU)(!0,{skip:!d}),m=(0,s.VN)(l,{skip:!d}),{data:x,isLoading:p,error:y,isError:h}=(0,s.PV)(null!=t?t:"",{skip:""!==u&&!(d&&u)}),[f]=(0,s._D)(),v=c.isLoading||m.isLoading||p,_=(0,a.useMemo)(()=>new Map((0,r.k)(c.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[c.data]),g=(0,a.useMemo)(()=>{var e;return null===(e=m.data)||void 0===e?void 0:e.filter(e=>e.active)},[m.data]),j=(0,a.useMemo)(()=>new Map((0,r.k)(g).map(e=>[e.id,e])),[g]),T=(0,a.useMemo)(()=>h&&y&&"status"in y&&404===y.status?new Map:new Map((0,r.k)(x).map(e=>[e.custom_field_definition_id,e])),[x,h,y]),E=(0,a.useMemo)(()=>{let e=[...j.keys()];return e.sort(),e},[j]),b=(0,a.useMemo)(()=>{let e={};return g&&T&&g.forEach(t=>{let l=T.get(t.id||"");l&&(t.allow_list_id&&"string[]"===t.field_type?e[l.custom_field_definition_id]=l.value:e[l.custom_field_definition_id]=l.value.toString())}),e},[g,T]),C=(0,a.useCallback)(async e=>{if(!d)return;let a="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!a)return;let{customFieldValues:i}=e;if(!i||0===Object.keys(i).length)return;let n=[],s=[];E.forEach(e=>{let t=T.get(e),l=i[e];void 0===l||""===l||Array.isArray(l)&&0===l.length?(null==t?void 0:t.id)&&s.push(t.id):n.push({custom_field_definition_id:e,resource_id:a,id:null==t?void 0:t.id,value:l})});try{await f({resource_type:l,resource_id:a,upsert:n,delete:s})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,T,o,t,E,f,l]);return{customFieldValues:b,definitionIdToCustomField:T,idToAllowListWithOptions:_,idToCustomFieldDefinition:j,isEnabled:d,isLoading:v,sortedCustomFieldDefinitionIds:E,upsertCustomFields:C}}},33162:function(e,t,l){"use strict";l.d(t,{uc:function(){return c},JY:function(){return s.J},mZ:function(){return u.m}});var a=l(24246),i=l(36010),n=l(34090),s=l(20987),r=l(30234),o=l(97181),d=l(40324),u=l(30320);let c=e=>{let{resourceFidesKey:t,resourceType:l}=e,{idToAllowListWithOptions:c,idToCustomFieldDefinition:m,isEnabled:x,isLoading:p,sortedCustomFieldDefinitionIds:y}=(0,u.m)({resourceFidesKey:t,resourceType:l});return x&&0!==y.length?(0,a.jsx)(r.Z,{heading:"Custom fields",children:(0,a.jsx)(i.ad9,{flexDir:"column","data-testid":"custom-fields-list",children:(0,a.jsx)(i.ad9,{flexDir:"column",gap:"24px",children:p?(0,a.jsx)(i.w4_,{children:(0,a.jsx)(i.Y6B,{})}):y.length>0&&(0,a.jsx)(i.ad9,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:y.map(e=>{let t=m.get(e);if(!t)return null;let l="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===s.H.STRING)return(0,a.jsx)(n.gN,{name:l,children:e=>{let{field:l}=e;return(0,a.jsx)(d.j0,{...l,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let i=c.get(t.allow_list_id);if(!i)return null;let{options:r}=i;return(0,a.jsx)(o.d,{name:l,allowClear:!0,mode:t.field_type!==s.H.STRING?"multiple":void 0,label:t.name,options:r,tooltip:t.description,layout:"stacked",className:"w-full"},e)})})})})}):null};l(94799)},97181:function(e,t,l){"use strict";l.d(t,{d:function(){return d}});var a=l(24246),i=l(36010),n=l(34090),s=l(27378),r=l(46238),o=l(40324);let d=e=>{let{name:t,label:l,labelProps:d,tooltip:u,isRequired:c,layout:m="inline",helperText:x,...p}=e,[y,h,{setValue:f}]=(0,n.U$)(t),v=!!(h.touched&&h.error),[_,g]=(0,s.useState)("");y.value||"tags"!==p.mode&&"multiple"!==p.mode||(y.value=[]),"tags"===p.mode&&"string"==typeof y.value&&(y.value=[y.value]);let j="tags"===p.mode?(e,t)=>e?e.value!==_||y.value.includes(_)?p.optionRender?p.optionRender(e,t):e.label:'Create "'.concat(_,'"'):void 0:p.optionRender||void 0,T=e=>{g(e),p.onSearch&&p.onSearch(e)},E=(e,t)=>{f(e),p.onChange&&p.onChange(e,t)};return"inline"===m?(0,a.jsx)(i.DTt,{isInvalid:v,isRequired:c,children:(0,a.jsxs)(i.MoG,{templateColumns:l?"1fr 3fr":"1fr",children:[l?(0,a.jsx)(o.__,{htmlFor:p.id||t,...d,children:l}):null,(0,a.jsxs)(i.kCb,{align:"center",children:[(0,a.jsxs)(i.kCb,{vertical:!0,flex:1,className:"mr-2",children:[(0,a.jsx)(i.PhF,{...y,id:p.id||t,"data-testid":"controlled-select-".concat(y.name),...p,optionRender:j,onSearch:"tags"===p.mode?T:void 0,onChange:E,value:y.value||void 0,status:v?"error":void 0}),x&&(0,a.jsx)(i.Kug,{children:x}),(0,a.jsx)(o.Bc,{isInvalid:v,message:h.error,fieldName:y.name})]}),(0,a.jsx)(r.b,{label:u,className:v?"mt-2 self-start":void 0})]})]})}):(0,a.jsx)(i.DTt,{isInvalid:v,isRequired:c,children:(0,a.jsxs)(i.s_g,{alignItems:"start",children:[(0,a.jsxs)(i.kCb,{align:"center",children:[l?(0,a.jsx)(o.__,{htmlFor:p.id||t,fontSize:"xs",my:0,mr:1,...d,children:l}):null,(0,a.jsx)(r.b,{label:u})]}),(0,a.jsx)(i.PhF,{...y,id:p.id||t,"data-testid":"controlled-select-".concat(y.name),...p,optionRender:j,onSearch:"tags"===p.mode?T:void 0,onChange:E,value:y.value||void 0,status:v?"error":void 0}),x&&(0,a.jsx)(i.Kug,{style:{marginTop:0},children:x}),(0,a.jsx)(o.Bc,{isInvalid:v,message:h.error,fieldName:y.name})]})})}},70788:function(e,t,l){"use strict";l.d(t,{m:function(){return d}});var a=l(24246),i=l(36010),n=l(79894),s=l.n(n),r=l(27378);let{Text:o}=i.Typography,d=e=>{let{items:t,...l}=e,n=(0,r.useMemo)(()=>null==t?void 0:t.map((e,l)=>{let n=l===t.length-1,r={...e},d=r.onClick&&!r.href;return("string"==typeof r.title&&(r.title=(0,a.jsx)(o,{style:{color:"inherit",maxWidth:n?void 0:400},ellipsis:!n,id:n?"breadcrumb-current-page":void 0,children:r.title})),d)?r.title=(0,a.jsx)(i.zxk,{type:"text",size:"small",icon:r.icon,onClick:r.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:r.title}):(r.icon&&(r.title=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"anticon align-text-bottom",children:r.icon}),r.title]})),r.href&&r.title&&(r.title=(0,a.jsx)(s(),{href:r.href,className:"ant-breadcrumb-link",children:r.title}),delete r.href)),r}),[t]);return(0,a.jsx)(i.aGc,{items:n,...l})}},9270:function(e,t,l){"use strict";l.d(t,{S:function(){return n}});var a=l(27378),i=l(36866);let n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.h)(e),{pageIndex:l,pageSize:n,updatePageIndex:s,updatePageSize:r,pageSizeOptions:o,showSizeChanger:d}=t,u=(0,a.useMemo)(()=>({current:l,pageSize:n,showSizeChanger:d,pageSizeOptions:o.map(String),onChange:s,onShowSizeChange:(e,t)=>{r(t)}}),[l,n,d,o,s,r]);return{...t,paginationProps:u}}},8917:function(e,t,l){"use strict";l.d(t,{Fb:function(){return o},P3:function(){return c},TY:function(){return u},Un:function(){return m},Uv:function(){return i},mJ:function(){return d},uP:function(){return r}});var a,i,n=l(20987),s=l(59001);let r=new Map([[n.J.SYSTEM,"system:information"],[n.J.DATA_USE,"taxonomy:data use"],[n.J.DATA_CATEGORY,"taxonomy:data category"],[n.J.DATA_SUBJECT,"taxonomy:data subject"],[n.J.PRIVACY_DECLARATION,"system:data use"]]),o={[s.ac.DATA_CATEGORY]:"taxonomy:data category",[s.ac.DATA_USE]:"taxonomy:data use",[s.ac.DATA_SUBJECT]:"taxonomy:data subject",[s.ac.SYSTEM_GROUP]:"taxonomy:system group"},d={[s.ac.DATA_CATEGORY]:n.J.DATA_CATEGORY,[s.ac.DATA_USE]:n.J.DATA_USE,[s.ac.DATA_SUBJECT]:n.J.DATA_SUBJECT,[s.ac.SYSTEM_GROUP]:"system group"};(a=i||(i={})).SINGLE_SELECT="singleSelect",a.MULTIPLE_SELECT="multipleSelect",a.OPEN_TEXT="openText";let u=[{label:"Single select",value:"singleSelect"},{label:"Multiple select",value:"multipleSelect"},{label:"Open text",value:"openText"}],c={singleSelect:"Single-value select",multipleSelect:"Multi-value select",openText:"Open text"},m={[s.ac.DATA_CATEGORY]:"Data category",[s.ac.DATA_USE]:"Data use field",[s.ac.DATA_SUBJECT]:"Data subject",[s.ac.SYSTEM_GROUP]:"System group"}},67522:function(e,t,l){"use strict";var a=l(56141),i=l.n(a),n=l(20987),s=l(812),r=l(8917),o=l(32885);let d=()=>Date.now().toString()+Math.random().toString(),u=e=>e.startsWith("taxonomy:")?e.split(":",2)[1]:"system:information"===e?"system":"system:data use"===e?"privacy declaration":e;t.Z=()=>{let[e,{isLoading:t}]=(0,o.Ld)(),[l,{isLoading:a}]=(0,o.yM)(),[c]=(0,o.Nt)();return{createOrUpdate:async function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,m=u(t.resource_type);if(t.field_type===r.Uv.OPEN_TEXT){let i={...t,field_type:n.H.STRING,id:a?a.id:void 0,resource_type:m};return a?await l(i):await e(i)}if(t.field_type===r.Uv.SINGLE_SELECT||t.field_type===r.Uv.MULTIPLE_SELECT){var x,p;let u;if(!a){let{options:l,...a}=t,i={name:d(),allowed_values:null!=l?l:[]},o=await c(i);if((0,s.D4)(o))return o;let u={...a,field_type:t.field_type===r.Uv.SINGLE_SELECT?n.H.STRING:n.H.STRING_ARRAY,allow_list_id:null===(x=o.data)||void 0===x?void 0:x.id,resource_type:m};return await e(u)}let{options:y,...h}=t;if(!i()(null==o?void 0:o.allowed_values,y)){let e={...o,name:null!==(p=null==o?void 0:o.name)&&void 0!==p?p:d(),id:null==o?void 0:o.id,allowed_values:null!=y?y:[]};if(u=await c(e),(0,s.D4)(u))return u}let f={...h,id:a.id,allow_list_id:u&&!(0,s.D4)(u)?u.data.id:a.allow_list_id,resource_type:m,field_type:t.field_type===r.Uv.SINGLE_SELECT?n.H.STRING:n.H.STRING_ARRAY};return await l(f)}let{value_type:y,...h}=t,f={...h,id:a?a.id:void 0,field_type:y,resource_type:m};return a?await l(f):await e(f)},isLoading:t||a}}},66006:function(e,t,l){"use strict";var a=l(25980),i=l(59001),n=l(39864);t.Z=()=>{let{plus:e}=(0,a.hz)(),{data:t,isLoading:l}=(0,n.MU)(void 0,{skip:!e}),s=[{label:i.Lo.DATA_CATEGORIES,value:i.ac.DATA_CATEGORY},{label:i.Lo.DATA_USES,value:i.ac.DATA_USE},{label:i.Lo.DATA_SUBJECTS,value:i.ac.DATA_SUBJECT}];return e&&s.push({label:i.Lo.SYSTEM_GROUPS,value:i.ac.SYSTEM_GROUP}),l||(null==t?void 0:t.length)&&s.push(...t.map(e=>({label:e.name,value:e.fides_key}))),{valueTypeOptions:s}}},84418:function(e,t,l){"use strict";l.d(t,{d:function(){return d}});var a=l(24246),i=l(36010),n=l(98784),s=l.n(n);let r=e=>{let{itemKey:t,actions:l}=e;return s().isEmpty(l)?null:(0,a.jsx)(i.kCb,{gap:"small",justify:"flex-end",children:l.map((e,n)=>{let{callback:s,label:r,disabled:o}=e;return(0,a.jsx)(i.zxk,{onClick:()=>s(t),type:n===l.length-1?"primary":"default",disabled:o,children:r},r)})})},o=e=>{let{title:t,titleIcon:l,titleTag:n}=e;return(0,a.jsxs)(i.kCb,{align:"center",gap:"small",children:[l,(0,a.jsx)("span",{children:t}),n&&(0,a.jsx)(i.Vp9,{...n})]})},d=e=>{let{title:t,titleIcon:l,titleTag:n,actions:s,width:d=480,...u}=e;return(0,a.jsx)(i.dys,{title:(0,a.jsx)(o,{title:t,titleIcon:l,titleTag:n}),footer:u.footer||!s?u.footer:(0,a.jsx)(r,{itemKey:u.itemKey,actions:s}),width:d,...u})}},33335:function(e,t,l){"use strict";l.d(t,{E:function(){return a}});let a=e=>e.toLowerCase().replace(/[ .]/g,"_").replace(/[^a-zA-Z0-9_<>-]/g,"")},30234:function(e,t,l){"use strict";var a=l(24246),i=l(36010);t.Z=e=>{let{heading:t,HeadingButton:l,children:n}=e;return(0,a.jsx)(i.EO$,{spacing:4,children:(0,a.jsxs)(i.TJV,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,a.jsxs)(i.TJV,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,a.jsx)(i.y_b,{as:"h3",size:"xs",children:t}),l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.s3C,{}),l]})]}),(0,a.jsx)(i.EO$,{spacing:4,px:6,py:6,children:n})]})})}},22583:function(e,t,l){"use strict";l.d(t,{j:function(){return n}});var a=l(36010),i=l(60240);let n={[i.Ej.TAXONOMY_WHITE]:a.tAb.DEFAULT,[i.Ej.TAXONOMY_RED]:a.tAb.ERROR,[i.Ej.TAXONOMY_ORANGE]:a.tAb.WARNING,[i.Ej.TAXONOMY_YELLOW]:a.tAb.CAUTION,[i.Ej.TAXONOMY_GREEN]:a.tAb.SUCCESS,[i.Ej.TAXONOMY_BLUE]:a.tAb.INFO,[i.Ej.TAXONOMY_PURPLE]:a.tAb.ALERT,[i.Ej.SANDSTONE]:a.tAb.SANDSTONE,[i.Ej.MINOS]:a.tAb.MINOS}},92818:function(e,t,l){"use strict";l.d(t,{r:function(){return o}});var a=l(24246),i=l(27378),n=l(97181),s=l(22583),r=l(60240);let o={[r.Ej.TAXONOMY_WHITE]:"White",[r.Ej.TAXONOMY_RED]:"Red",[r.Ej.TAXONOMY_ORANGE]:"Orange",[r.Ej.TAXONOMY_YELLOW]:"Yellow",[r.Ej.TAXONOMY_GREEN]:"Green",[r.Ej.TAXONOMY_BLUE]:"Blue",[r.Ej.TAXONOMY_PURPLE]:"Purple",[r.Ej.SANDSTONE]:"Sandstone",[r.Ej.MINOS]:"Minos"},d=e=>{let{color:t,...l}=e;return(0,a.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(s.j[t],")"),border:t===r.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...l.style}})},u=e=>{let t=null==e?void 0:e.value,l=null==e?void 0:e.label;return(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(d,{color:t}),(0,a.jsx)("span",{children:l})]})};t.Z=e=>{let t=Object.values(r.Ej).map(e=>({value:e,label:o[e]})),[l,s]=(0,i.useState)(void 0);return(0,a.jsx)(n.d,{...e,options:t,optionRender:u,layout:"stacked",value:l,onChange:e=>{s(e)},prefix:(0,a.jsx)(d,{color:null!=l?l:r.Ej.TAXONOMY_WHITE,style:{marginBottom:"2px"}})})}},58090:function(e,t,l){"use strict";l.d(t,{Z:function(){return eM}});var a,i,n,s,r=l(24246),o=l(36010),d=l(69238),u=l.n(d),c=l(86677),m=l(27378),x=l(25980),p=l(812),y=l(77213),h=l(58754),f=l(19904),v=l(32885),_=l(33335),g=l(39864),j=e=>{let{onClose:t}=e,[l,{isLoading:a}]=(0,g.Hb)(),i=(0,o.UD8)(),n=async e=>{var a;let n={...e,taxonomy_type:(0,_.E)(null!==(a=e.name)&&void 0!==a?a:"")},s=await l(n);if((0,p.D4)(s)){i.error((0,p.e$)(s.error));return}i.success("Taxonomy created successfully"),t()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Typography.Paragraph,{children:"Create and organize the core terminology your team uses to describe data and how it's handled. Custom taxonomies let you define domain-specific concepts and then apply them to other privacy objects throughout the platform"}),(0,r.jsxs)(o.l09,{layout:"vertical",onFinish:n,validateTrigger:["onBlur","onChange"],children:[(0,r.jsx)(o.l09.Item,{label:"Taxonomy name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,r.jsx)(o.IIB,{"data-testid":"input-name"})}),(0,r.jsx)(o.l09.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.IIB.TextArea,{rows:2,"data-testid":"input-description"})}),(0,r.jsxs)(o.kCb,{gap:"small",justify:"space-between",children:[(0,r.jsx)(o.zxk,{onClick:t,disabled:a,children:"Cancel"}),(0,r.jsx)(o.zxk,{type:"primary",htmlType:"submit",loading:a,disabled:a,"data-testid":"save-btn",children:"Create taxonomy"})]})]})]})},T=l(33162),E=l(8917),b=l(84418),C=l(67522),A=l(66006),S=l(60240),k=l(31883),I=e=>{var t,l;let{taxonomy:a,onSubmit:i,formId:n,customFields:s,isCustom:d=!1}=e,{fides_key:u,...c}=null!=a?a:{},[x,y]=(0,m.useState)(!1),{valueTypeOptions:h}=(0,A.Z)(),_=h.filter(e=>e.value!==u),g=(0,f.Tg)([S.Sh.CUSTOM_FIELD_DELETE]),[j,T]=o.u_l.useModal(),b=(0,o.UD8)(),[I]=(0,v.UF)(),{createOrUpdate:N}=(0,C.Z)(),O=async e=>{let{id:t,resource_type:l,field_type:a}=e,i=await I({id:t,resource_type:l,field_type:a});if((0,k.D4)(i)){b.error((0,p.e$)(i.error));return}b.success("Attribute removed successfully")},D=e=>{j.confirm({title:"Remove attribute",content:"Are you sure you want to remove this attribute?",onOk:()=>O(e),okText:"Remove",centered:!0})},R=async e=>{var t,l;let a=null==h?void 0:h.find(t=>t.value===e);if(!a||!u){b.error("Taxonomy type not found");return}let i=null!==(t=E.Fb[u])&&void 0!==t?t:u,n=await N({name:null!==(l=a.label)&&void 0!==l?l:a.value,value_type:a.value,resource_type:i},void 0,void 0);if((0,k.D4)(n)){b.error((0,p.e$)(n.error));return}b.success("Attribute added successfully"),y(!1)};return(0,r.jsxs)(o.kCb,{vertical:!0,gap:"large",children:[T,(0,r.jsxs)(o.w5n,{column:1,children:[(0,r.jsx)(o.w5n.Item,{label:"Fides key",children:u}),!d&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.w5n.Item,{label:"Name",children:null!==(t=null==a?void 0:a.name)&&void 0!==t?t:""}),(null==a?void 0:a.description)&&(0,r.jsx)(o.w5n.Item,{label:"Description",children:null!==(l=null==a?void 0:a.description)&&void 0!==l?l:""})]})]}),d&&(0,r.jsxs)(o.l09,{id:n,layout:"vertical",initialValues:c,onFinish:i,children:[(0,r.jsx)(o.l09.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,r.jsx)(o.IIB,{})}),(0,r.jsx)(o.l09.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.IIB.TextArea,{})})]}),x&&(0,r.jsx)(o.PhF,{options:_,defaultOpen:!0,"aria-label":"Attribute type",onSelect:R}),!x&&(0,r.jsx)(o.zxk,{onClick:()=>y(!0),icon:(0,r.jsx)(o.PJP.mm_,{}),children:"Add attribute"}),(0,r.jsx)(o.aVo,{children:(0,r.jsx)(o.CId,{dataSource:s,itemKey:e=>e.id,renderItem:e=>(0,r.jsx)(o.aVo.Item,{actions:g?[(0,r.jsx)(o.zxk,{type:"link",onClick:()=>D(e),children:"Remove"},"remove")]:void 0,children:(0,r.jsx)(o.aVo.Item.Meta,{title:e.name,description:e.description})}),className:"flex-col",itemClassName:"w-full"})})]})},N=l(51980),O=l(9270),D=l(16394);(a=n||(n={})).USAGE_DELETED="taxonomy.usage.deleted",a.USAGE_ADDED="taxonomy.usage.updated",a.ELEMENT_CREATED="taxonomy.element.created",a.ELEMENT_UPDATED="taxonomy.element.updated",a.ELEMENT_DELETED="taxonomy.element.deleted",a.CREATED="taxonomy.created";let R={"taxonomy.usage.deleted":"Usage removed","taxonomy.usage.updated":"Usage added","taxonomy.element.created":"Element created","taxonomy.element.deleted":"Element deleted","taxonomy.element.updated":"Element updated","taxonomy.created":"Taxonomy created"};var L=e=>{var t;let{taxonomyKey:l}=e,{paginationProps:a,pageIndex:i,pageSize:n}=(0,O.S)({defaultPageSize:10,disableUrlState:!0,showSizeChanger:!1}),{data:s,isLoading:d}=(0,g.jW)({fides_key:l,page:i,size:n});if(d)return(0,r.jsx)(o.aVo,{size:"small",itemLayout:"vertical",children:Array.from({length:5}).map((e,t)=>(0,r.jsx)(o.aVo.Item,{children:(0,r.jsx)(o.OdW,{active:!0,children:(0,r.jsx)(o.aVo.Item.Meta,{})})},t))});let u=null!==(t=null==s?void 0:s.items)&&void 0!==t?t:[];return(0,r.jsxs)(o.kCb,{vertical:!0,gap:"middle",children:[(0,r.jsx)(o.aVo,{size:"small",itemLayout:"vertical",children:u.map(e=>{var t;let l=(0,N.B)(new Date(e.created_at),new Date,{addSuffix:!0}),a=(0,D.p6)(new Date(e.created_at)),i=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.ua7,{title:a,children:"".concat((0,D.G8)(l))}),e.user_id?(0,r.jsxs)("span",{children:[" by ",e.user_id]}):null]});return(0,r.jsxs)(o.aVo.Item,{children:[(0,r.jsx)(o.aVo.Item.Meta,{title:null!==(t=R[e.event_type])&&void 0!==t?t:e.event_type,description:i}),(0,r.jsx)(o.Typography.Text,{children:e.description})]},e.id)})}),(0,r.jsx)(o.kCb,{justify:"middle",children:(null==s?void 0:s.total)&&(0,r.jsx)(o.tlE,{...a,total:s.total,hideOnSinglePage:!0})})]})},w=l(59001);let M="custom-taxonomy-form";var U=e=>{var t;let{taxonomy:l,onClose:a,onDelete:i,...n}=e,[s,{isLoading:d}]=(0,g.Km)(),u=(0,o.UD8)(),{sortedCustomFieldDefinitionIds:c,idToCustomFieldDefinition:m}=(0,T.mZ)({resourceType:null!==(t=E.mJ[l.fides_key])&&void 0!==t?t:l.fides_key}),x=!Object.values(w.ac).includes(l.fides_key),y=c.map(e=>m.get(e)).sort((e,t)=>{var l,a;return(null!==(l=e.created_at)&&void 0!==l?l:"").localeCompare(null!==(a=t.created_at)&&void 0!==a?a:"")}),h=async e=>{if(!l.fides_key){u.error("Taxonomy not found");return}let t=await s({fides_key:l.fides_key,...e});if((0,p.D4)(t)){u.error((0,p.e$)(t.error));return}u.success("Taxonomy updated successfully")};return(0,r.jsx)(b.d,{title:"Edit ".concat(null==l?void 0:l.name),...n,itemKey:"",open:!!l,onClose:a,destroyOnHidden:!0,footer:(0,r.jsxs)(o.kCb,{justify:"space-between",className:"w-full",children:[x&&(0,r.jsx)(o.zxk,{onClick:i,children:"Delete"}),(0,r.jsx)(o.zxk,{type:"primary",htmlType:"submit",form:M,loading:d,children:"Save"})]}),children:(0,r.jsx)(o.mQc,{items:[{label:"Details",key:"details",children:(0,r.jsx)(I,{taxonomy:l,onSubmit:h,formId:M,customFields:y,isCustom:x})},{label:"History",key:"history",children:(0,r.jsx)(L,{taxonomyKey:l.fides_key})}]})})},V=l(79806),F=l(56358),P=l(46628),H=l(90673),z=l(30002),G=l(28079),Y=l(69353),B=l(5785),J=e=>{let{taxonomyType:t}=e,[l,a]=(0,B.Vj)(),[i,n]=(0,z.nC)(),[s,r]=(0,G.dk)(),[o,d]=(0,Y.cw)(),[u,c]=(0,B.Ti)(),[x,p]=(0,G.Ql)(),[y,h]=(0,z.wG)(),[f,v]=(0,Y.Nr)(),[_]=(0,B.jU)(),[j]=(0,G.LG)(),[T]=(0,z.h8)(),[E]=(0,Y.Xz)(),[b]=(0,B.K9)(),[C]=(0,G.gu)(),[A]=(0,z.Kv)(),[S]=(0,Y.Uv)(),[k,I]=(0,g.ci)(),[N,O]=(0,g.J1)(),[D]=(0,g.Cy)(),[R]=(0,g.d9)(),L=(0,m.useCallback)(()=>t?k(t):Promise.resolve(void 0),[t,k]),M=(0,m.useCallback)(e=>t?N({taxonomyType:t,...e}):Promise.resolve(void 0),[t,N]),U=(0,m.useCallback)(e=>t?D({taxonomyType:t,...e}):Promise.resolve(void 0),[t,D]),V=(0,m.useCallback)(e=>t?R({taxonomyType:t,key:e}):Promise.resolve(void 0),[t,R]);return t===w.ac.DATA_CATEGORY?{getAllTrigger:l,taxonomyItems:a.data||[],updateTrigger:_,deleteTrigger:b,createTrigger:u,isLoading:a.isLoading,isError:a.isError,isCreating:c.isLoading}:t===w.ac.DATA_USE?{getAllTrigger:s,taxonomyItems:r.data||[],updateTrigger:j,deleteTrigger:C,createTrigger:x,isLoading:r.isLoading,isError:r.isError,isCreating:p.isLoading}:t===w.ac.DATA_SUBJECT?{getAllTrigger:i,taxonomyItems:n.data||[],updateTrigger:T,deleteTrigger:A,createTrigger:y,isLoading:n.isLoading,isError:n.isError,isCreating:h.isLoading}:t===w.ac.SYSTEM_GROUP?{getAllTrigger:o,taxonomyItems:d.data||[],updateTrigger:E,deleteTrigger:S,createTrigger:f,isLoading:d.isLoading,isError:d.isError,isCreating:v.isLoading}:{getAllTrigger:L,taxonomyItems:(null==I?void 0:I.data)||[],updateTrigger:U,deleteTrigger:V,createTrigger:M,isLoading:(null==I?void 0:I.isLoading)||!1,isError:(null==I?void 0:I.isError)||!1,isCreating:O.isLoading}},Z=l(90104),X=l.n(Z),K=l(20987),W=l(18225),q=e=>{let{taxonomyKey:t,...l}=e,{data:a,isLoading:i}=(0,g.Jy)(t);return a?(0,r.jsx)(o.PhF,{options:a.map(e=>{var t;return{value:e.fides_key,label:null!==(t=e.name)&&void 0!==t?t:e.fides_key}}),loading:i,...l}):null},$=e=>{let{customFields:t,formId:l,form:a}=e,{idToAllowListWithOptions:i,idToCustomFieldDefinition:n,isEnabled:s,isLoading:d,sortedCustomFieldDefinitionIds:u}=t;return s&&0!==u.length?(0,r.jsx)(o.l09,{form:a,name:l,initialValues:t.customFieldValues,layout:"vertical","data-testid":"custom-fields-form",children:d?(0,r.jsx)(W.Z,{}):(0,r.jsx)("div",{children:!X()(u)&&(0,r.jsx)("div",{children:u.map(e=>{let l=n.get(e);if(!l)return null;let{id:a,name:s,description:d,allow_list_id:u,field_type:c}=l;if(!u)return(0,r.jsx)(o.l09.Item,{name:a,label:s,tooltip:d,children:c===K.H.STRING?(0,r.jsx)(o.IIB,{}):(0,r.jsx)(q,{taxonomyKey:c,defaultValue:t.customFieldValues[a]})},e);let m=i.get(l.allow_list_id);if(!m)return null;let{options:x}=m;return(0,r.jsx)(o.l09.Item,{name:a,label:s,tooltip:d,children:(0,r.jsx)(o.PhF,{mode:c!==K.H.STRING?"multiple":void 0,allowClear:!0,options:x})},e)})})})}):null},Q=l(43551),ee=l.n(Q),et=()=>{let e=o.l09.useFormInstance(),t=o.l09.useWatch(["rights","values"],e);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.l09.Item,{label:"Automated Decisions or Profiling",name:"automated_decisions_or_profiling",layout:"horizontal",valuePropName:"checked",children:(0,r.jsx)(o.XZJ,{"data-testid":"edit-taxonomy-form_automated-decisions"})}),(0,r.jsx)(o.l09.Item,{name:["rights","values"],label:"Rights",children:(0,r.jsx)(o.PhF,{mode:"multiple",options:(0,p.MM)(S.ts),"data-testid":"edit-taxonomy-form_rights"})}),t&&!X()(t)&&(0,r.jsx)(o.l09.Item,{name:["rights","strategy"],label:"Strategy",required:!0,rules:[{required:!0,message:"Please select a strategy"}],children:(0,r.jsx)(o.PhF,{options:(0,p.MM)(S.jX),"data-testid":"edit-taxonomy-form_strategy"})})]})},el=l(83766),ea=l.n(el),ei=l(1315),en=l(22583),es=l(92818);let er=e=>{let{color:t,...l}=e;return(0,r.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(en.j[t],")"),border:t===S.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...l.style}})};var eo=e=>{let t=Object.values(S.Ej).map(e=>({value:e,label:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(er,{color:e}),(0,r.jsx)("span",{children:es.r[e]})]})}));return(0,r.jsx)(o.PhF,{...e,options:t,placeholder:"Select color"})};let ed="all-suggested";var eu=e=>{let{initialValues:t,onSubmit:l,form:a,formId:i,isDisabled:n}=e,{data:s=[],isLoading:d}=(0,G.fd)(),{data:u,isLoading:c}=(0,ei.K3)(),x=(0,m.useMemo)(()=>s.map(e=>({label:e.name||e.fides_key,value:e.fides_key})),[s]),p=o.l09.useWatch("systems",a),y=(0,m.useMemo)(()=>{var e;let t=p||[];if(!u||0===t.length)return[];let l=null!==(e=null==u?void 0:u.filter(e=>t.includes(e.fides_key)))&&void 0!==e?e:[];return ea()(null==l?void 0:l.flatMap(e=>e.privacy_declarations.map(e=>e.data_use)))},[u,p]),h=(0,m.useMemo)(()=>{var e;return null!==(e=null==u?void 0:u.map(e=>({label:e.name||e.fides_key,value:e.fides_key})))&&void 0!==e?e:[]},[u]),f=(0,m.useMemo)(()=>{let e=[],t=[];return(x.forEach(l=>{y.includes(l.value)?e.push(l):t.push(l)}),0===e.length)?t:[{label:"Select all suggested",value:ed},{label:(0,r.jsxs)(o.TaI,{children:[(0,r.jsx)(o.QMR,{size:14}),(0,r.jsx)("span",{children:"Suggested data uses"})]}),options:e},{label:(0,r.jsxs)(o.TaI,{children:[(0,r.jsx)(o.PJP.BBB,{}),(0,r.jsx)("span",{children:"All data uses"})]}),options:t}]},[x,y]);return(0,r.jsxs)(o.l09,{name:i,initialValues:t,onFinish:e=>{var a,i;let n={...t,...e};(!(null==n?void 0:null===(a=n.rights)||void 0===a?void 0:a.values)||X()(null==n?void 0:null===(i=n.rights)||void 0===i?void 0:i.values))&&ee()(n,"rights"),l(n)},layout:"vertical",form:a,children:[(0,r.jsx)(o.l09.Item,{label:"Name",name:"name",children:(0,r.jsx)(o.IIB,{"data-testid":"edit-taxonomy-form_name",disabled:n})}),(0,r.jsx)(o.l09.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.IIB.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:n})}),(0,r.jsx)(o.l09.Item,{label:"Systems",name:"systems",children:(0,r.jsx)(o.PhF,{mode:"multiple",placeholder:"Select systems",options:h,allowClear:!0,loading:c,disabled:n,"data-testid":"edit-taxonomy-form_systems"})}),(0,r.jsx)(o.l09.Item,{label:"Color",name:"label_color",children:(0,r.jsx)(eo,{disabled:n,"data-testid":"edit-taxonomy-form_color"})}),(0,r.jsx)(o.l09.Item,{label:"Data uses",name:"data_uses",children:(0,r.jsx)(o.PhF,{mode:"multiple",placeholder:"Select data uses",options:f,allowClear:!0,loading:d,disabled:n,onChange:e=>{if(e.includes(ed)){let t=ea()([...y,...e.filter(e=>e!==ed)]);a.setFieldsValue({data_uses:t})}else a.setFieldsValue({data_uses:e})},"data-testid":"edit-taxonomy-form_data_uses"})})]})},ec=e=>{let{initialValues:t,onSubmit:l,form:a,formId:i,taxonomyType:n,isDisabled:s}=e,d=n===w.ac.DATA_SUBJECT;return n===w.ac.SYSTEM_GROUP?(0,r.jsx)(eu,{initialValues:t,onSubmit:l,form:a,formId:i,isDisabled:s}):(0,r.jsxs)(o.l09,{name:i,initialValues:t,onFinish:e=>{var a,i;let n={...t,...e};(!(null==n?void 0:null===(a=n.rights)||void 0===a?void 0:a.values)||X()(null==n?void 0:null===(i=n.rights)||void 0===i?void 0:i.values))&&ee()(n,"rights"),l(n)},layout:"vertical",form:a,children:[(0,r.jsx)(o.l09.Item,{label:"Name",name:"name",children:(0,r.jsx)(o.IIB,{"data-testid":"edit-taxonomy-form_name",disabled:s})}),(0,r.jsx)(o.l09.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.IIB.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:s})}),d&&(0,r.jsx)(et,{})]})},em=e=>{let{taxonomyItem:t,taxonomyType:l,onClose:a}=e,i="edit-taxonomy-form",[n]=o.l09.useForm(),[s]=o.l09.useForm(),d=(0,o.p8r)(),{isOpen:u,onOpen:c,onClose:m}=(0,o.E2M)(),{updateTrigger:x,deleteTrigger:y}=J({taxonomyType:l}),h=(0,H.Xl)(l),v=(0,T.mZ)({resourceFidesKey:null==t?void 0:t.fides_key,resourceType:h}),_=(0,f.Tg)([(0,w.aq)(l).UPDATE]),g=(0,f.Tg)([(0,w.aq)(l).DELETE]),j=async e=>{let l=await x(e);if((0,k.D4)(l)){d((0,P.Vo)((0,p.e$)(l.error)));return}if(v.isEnabled){let e=s.getFieldsValue();await v.upsertCustomFields({fides_key:null==t?void 0:t.fides_key,customFieldValues:e})}d((0,P.t5)("Taxonomy successfully updated")),a()},E=async()=>{await y(t.fides_key),m(),a()},b=async()=>{await x({...t,active:!0}),m(),a()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(V.ZP,{isOpen:!!t,onClose:a,header:(0,r.jsx)(V.zR,{title:(null==t?void 0:t.name)||""}),footer:(0,r.jsxs)(o.KR9,{justifyContent:"space-between",children:[(null==t?void 0:t.active)&&g&&(0,r.jsx)(o.ua7,{title:"Delete label",children:(0,r.jsx)(o.zxk,{"aria-label":"delete",icon:(0,r.jsx)(F.q,{fontSize:"small"}),onClick:c,"data-testid":"delete-btn"})}),!(null==t?void 0:t.active)&&_&&(0,r.jsx)(o.ua7,{title:"Enable label",children:(0,r.jsx)(o.zxk,{"aria-label":"enable",onClick:b,"data-testid":"enable-btn",icon:(0,r.jsx)(o.tEF,{fontSize:"small"})})}),(0,r.jsx)("div",{className:"flex gap-2",children:_&&(0,r.jsx)(o.zxk,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:i,children:"Save"})})]}),children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(o.Typography.Title,{level:3,children:"Details"})}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"w-1/3 shrink-0 text-sm text-gray-500",children:"Fides key:"}),(0,r.jsx)(o.ua7,{title:null==t?void 0:t.fides_key,trigger:"click",children:(0,r.jsx)("span",{className:"flex-1 truncate","data-testid":"edit-drawer-fides-key",children:null==t?void 0:t.fides_key})})]})]}),!!t&&(0,r.jsx)(ec,{initialValues:t,onSubmit:j,form:n,formId:i,taxonomyType:l,isDisabled:!_}),v.isEnabled&&!v.isLoading&&(0,r.jsx)($,{form:s,formId:"custom-fields-form",customFields:v})]}),(0,r.jsx)(o.cVQ,{isOpen:u,onClose:m,onConfirm:E,title:"Delete ".concat(l),message:(0,r.jsx)(o.EO$,{children:(0,r.jsxs)(o.Bjg,{children:["You are about to permanently delete the ",l," ",(0,r.jsx)(o.Bjg,{color:"complimentary.500",as:"span",fontWeight:"bold",children:null==t?void 0:t.name})," ","from your taxonomy. Are you sure you would like to continue?"]})})})]})};l(51901);var ex=l(86298),ep=l(3124),ey=l.n(ep);(i=s||(s={})).DEFAULT="DEFAULT",i.ACTIVE_HOVER="ACTIVE_HOVER",i.PARENT_OF_HOVER="PARENT_OF_HOVER",i.CHILD_OF_HOVER="CHILD_OF_HOVER",i.SIBLING_OF_HOVER="SIBLING_OF_HOVER",i.INACTIVE="INACTIVE";let eh=(0,m.createContext)({activeNodeKey:null,setActiveNodeKey:()=>{},onMouseEnter:()=>{},onMouseLeave:()=>{},getNodeHoverStatus:()=>"DEFAULT"}),ef=e=>{let{children:t}=e,[l,a]=(0,m.useState)(null),i=(0,m.useCallback)(e=>{e!==l&&a(e)},[l]),n=(0,m.useCallback)(()=>{a(null)},[]),s=(0,m.useCallback)(e=>l?e===l?"ACTIVE_HOVER":l.startsWith("".concat(e,"."))||e===w.Ch?"PARENT_OF_HOVER":e.startsWith("".concat(l,"."))||l===w.Ch?"CHILD_OF_HOVER":l.split(".").slice(0,-1).join(".")===e.split(".").slice(0,-1).join(".")?"SIBLING_OF_HOVER":"INACTIVE":"DEFAULT",[l]),o=(0,m.useMemo)(()=>({activeNodeKey:l,setActiveNodeKey:a,onMouseEnter:i,onMouseLeave:n,getNodeHoverStatus:s}),[l,a,i,n,s]);return(0,r.jsx)(eh.Provider,{value:o,children:t})};var ev=l(62266),e_=l(79658);let eg=(0,ev.Z)();var ej=e=>{let{nodes:t,edges:l,options:a}=e;return(0,m.useMemo)(()=>{if(0===t.length)return{nodes:t,edges:l};let e=(0,e_.Z)().id(e=>e.id).parentId(e=>{var t;return null===(t=l.find(t=>t.target===e.id))||void 0===t?void 0:t.source})(t),i="LR"===a.direction?[35,320]:[320,35];return{nodes:eg.nodeSize(i).separation((e,t)=>e.parent===t.parent?1:1.5)(e).descendants().map(e=>{let t;return t="LR"===a.direction?{x:e.y,y:e.x}:{x:e.x,y:e.y},{...e.data,position:t}}),edges:l}},[t,l,a])},eT=e=>{let{positionAbsoluteX:t,positionAbsoluteY:l,nodeWidth:a}=e,{setCenter:i,getZoom:n}=(0,ex._K)();return{centerScreenOnNode:(0,m.useCallback)(()=>i(t+a/2,l,{duration:500,zoom:n()}),[n,t,l,a,i])}},eE=l(1945),eb=l.n(eE),eC=l(8335),eA=e=>{let{type:t,inactive:l=!1}=e;return(0,r.jsx)(ex.HH,{type:t,position:"source"===t?eC.Ly.Right:eC.Ly.Left,style:{width:8,height:8,backgroundColor:l?ey().FIDESUI_NEUTRAL_400:ey().FIDESUI_MINOS},className:"transition-colors duration-300 ease-in"})},eS=e=>{let{data:t,positionAbsoluteX:l,positionAbsoluteY:a}=e,{onCancel:i,onSubmit:n,parentKey:s,isLoading:d=!1}=t,u=(0,m.useRef)(null),[c,x]=(0,m.useState)(""),{centerScreenOnNode:p}=eT({positionAbsoluteX:l,positionAbsoluteY:a,nodeWidth:200});(0,m.useEffect)(()=>{x("");let e=()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.focus({cursor:"start",preventScroll:!0})};(async()=>{await p(),e()})()},[s,p,l,a]);let y=()=>{!d&&c.trim()&&n(c)},h=()=>{d||i()};return(0,r.jsxs)("div",{style:{width:200},"data-testid":"taxonomy-text-input-node",children:[(0,r.jsx)(o.IIB,{placeholder:"Type label name...",ref:u,onBlur:h,onSubmit:y,value:c,onChange:e=>x(e.target.value),onKeyUp:e=>{"Escape"===e.key&&h()},onPressEnter:y,className:eb().input,suffix:d&&(0,r.jsx)(o.yCA,{size:"small"})}),(0,r.jsx)(eA,{type:"target"})]})},ek=e=>{let{getNodeHoverStatus:t}=(0,m.useContext)(eh),{target:l}=e,a=t(l),i=(0,m.useCallback)(()=>{switch(a){case s.ACTIVE_HOVER:case s.PARENT_OF_HOVER:return ey().FIDESUI_MINOS;case s.INACTIVE:return ey().NEUTRAL_400;default:return ey().FIDESUI_SANDSTONE}},[a]),n=(0,m.useCallback)(()=>{switch(a){case s.ACTIVE_HOVER:case s.PARENT_OF_HOVER:return 2;default:return 1}},[a]);return(0,r.jsx)(ex.Jd,{...e,style:{stroke:i(),strokeWidth:n(),transition:"stroke 0.3s ease 0s"}})},eI=l(34770),eN=l.n(eI),eO=e=>{let{data:t,positionAbsoluteX:l,positionAbsoluteY:a}=e,{onMouseEnter:i,onMouseLeave:n,getNodeHoverStatus:d}=(0,m.useContext)(eh),{taxonomyType:u,taxonomyItem:c,onAddButtonClick:x,onTaxonomyItemClick:p,label:y,hasChildren:h,isLastCreatedItem:f,resetLastCreatedItemKey:v,userCanAddLabels:_}=t,{centerScreenOnNode:g}=eT({positionAbsoluteX:l,positionAbsoluteY:a,nodeWidth:200});(0,m.useEffect)(()=>{let e=async()=>{await g(),i(null==c?void 0:c.fides_key)};f&&(e(),v())},[f,i,null==c?void 0:c.fides_key,v,g]);let j=d(null==c?void 0:c.fides_key),T=(0,m.useCallback)(()=>{switch(j){case s.ACTIVE_HOVER:return eN()["button--hover"];case s.PARENT_OF_HOVER:return eN()["button--parent-hover"];case s.INACTIVE:return eN()["button--inactive"];case s.DEFAULT:case s.CHILD_OF_HOVER:case s.SIBLING_OF_HOVER:default:return""}},[j]),E=(null==c?void 0:c.fides_key)===w.Ch,b=u===w.ac.DATA_SUBJECT;return(0,r.jsxs)("div",{className:eN().container,onMouseEnter:()=>i(null==c?void 0:c.fides_key),onMouseLeave:()=>n(null==c?void 0:c.fides_key),"data-testid":"taxonomy-node-".concat(null==c?void 0:c.fides_key),children:[(0,r.jsx)(o.zxk,{className:"".concat(eN().button," ").concat(T()),onClick:()=>null==p?void 0:p(c),disabled:!p,type:"text",children:(0,r.jsxs)(o.Typography.Text,{ellipsis:!0,style:{color:"inherit"},children:[(null==c?void 0:c.active)===!1?"(disabled) ":"",y]})}),!E&&(0,r.jsx)(eA,{type:"target",inactive:j===s.INACTIVE}),h&&(0,r.jsx)(eA,{type:"source",inactive:j===s.INACTIVE}),_&&(!b||E)&&(0,r.jsx)("div",{className:eN()["add-button-container"],children:(0,r.jsx)(o.zxk,{type:"default",className:"".concat(eN()["add-button"]," ").concat(j===s.ACTIVE_HOVER?eN()["add-button--visible"]:""),icon:(0,r.jsx)(o.PJP.mm_,{size:20}),onClick:()=>null==x?void 0:x(c),size:"middle","data-testid":"taxonomy-add-child-label-button","aria-label":"Add child label to ".concat(y)})})]})};let eD=e=>{let{taxonomyType:t,taxonomyItems:l,draftNewItem:a,lastCreatedItemKey:i,resetLastCreatedItemKey:n,onRootItemClick:s,onTaxonomyItemClick:o,onAddButtonClick:d,onCancelDraftItem:u,onSubmitDraftItem:c,userCanAddLabels:x,isCreating:p=!1,rootNodeLabel:y}=e,{fitView:h}=(0,ex._K)();(0,m.useEffect)(()=>{setTimeout(()=>h(),150)},[h,t,l.length]);let f=[(0,m.useMemo)(()=>({id:w.Ch,position:{x:0,y:0},data:{label:y||t,taxonomyItem:{fides_key:w.Ch},taxonomyType:t,onTaxonomyItemClick:s,onAddButtonClick:d,hasChildren:0!==l.length,userCanAddLabels:x},type:"taxonomyTreeNode"}),[y,t,s,d,l.length,x])],v=[];if(l.forEach(e=>{let l=e.name||e.fides_key.split(".").pop()||"",a={id:e.fides_key,position:{x:0,y:0},data:{label:l,taxonomyType:t,taxonomyItem:e,onTaxonomyItemClick:o,onAddButtonClick:d,hasChildren:!1,isLastCreatedItem:i===e.fides_key,resetLastCreatedItemKey:n,userCanAddLabels:x},type:"taxonomyTreeNode"};f.push(a);let s=e.parent_key?f.find(t=>t.id===e.parent_key):null,r=s?s.id:w.Ch,u=e.fides_key,c={id:"".concat(r,"-").concat(u),source:r,target:u,type:"taxonomyTreeEdge"};v.push(c),s&&(s.data.hasChildren=!0)}),a){let e=a.parent_key||w.Ch;f.push({id:"draft-node",position:{x:0,y:0},type:"textInputNode",data:{parentKey:e,onCancel:u,onSubmit:c,isLoading:p},hidden:!a}),v.push({id:"draft-line",source:e,target:"draft-node",animated:!0});let t=f.find(t=>t.id===e);t&&(t.data.hasChildren=!0)}let{nodes:_,edges:g}=ej({nodes:f,edges:v,options:{direction:"LR"}}),j=(0,m.useMemo)(()=>({taxonomyTreeNode:eO,textInputNode:eS}),[]),T=(0,m.useMemo)(()=>({taxonomyTreeEdge:ek}),[]);return(0,r.jsx)("div",{className:"size-full",style:{backgroundColor:ey().FIDESUI_BG_CORINTH},"data-testid":"taxonomy-interactive-tree",children:(0,r.jsx)(ef,{children:(0,r.jsxs)(ex.x$,{nodes:_,edges:g,nodeTypes:j,edgeTypes:T,maxZoom:2,minZoom:.3,nodesConnectable:!1,edgesFocusable:!1,elementsSelectable:!1,proOptions:{hideAttribution:!0},children:[(0,r.jsx)(ex.Aq,{color:ey().FIDESUI_NEUTRAL_100,variant:ex.T7.Dots,size:3}),(0,r.jsx)(ex.a9,{nodeStrokeWidth:3,pannable:!0}),(0,r.jsx)(ex.ZX,{showInteractive:!1})]})})})};var eR=e=>(0,r.jsx)(ex.tV,{children:(0,r.jsx)(eD,{...e})});let eL="add new item",ew=w.ac.DATA_CATEGORY;var eM=e=>{let{initialTaxonomy:t}=e,l=(0,c.useRouter)(),a=null!=t?t:ew,i=(0,x.hz)().plus,{isLoading:n}=(0,v.x8)(),{data:s}=(0,g.MU)(void 0,{skip:!i}),{createTrigger:d,getAllTrigger:_,taxonomyItems:T=[],isCreating:E}=J({taxonomyType:a}),b="true"===l.query.showDisabledItems,C=(0,o.UD8)();(0,m.useEffect)(()=>{_()},[_,a]);let[A,S]=(0,m.useState)(null),[k,I]=(0,m.useState)(null),[N,O]=(0,m.useState)(null),[D,R]=(0,m.useState)(null),L=(0,o.ddY)(),[M]=(0,g.EO)(),V=async()=>{if(!(null==k?void 0:k.fides_key)){C.error("Taxonomy not found");return}let e=await M(k.fides_key);if((0,p.D4)(e)){C.error((0,p.e$)(e.error));return}C.success("Taxonomy deleted successfully"),I(null);let t={...l.query};delete t.key,l.replace({pathname:"/taxonomy",query:t},void 0,{shallow:!0})},F=(0,m.useMemo)(()=>{var e;if(!s)return null;let t=s.find(e=>e.fides_key===a);return null!==(e=null==t?void 0:t.name)&&void 0!==e?e:null==t?void 0:t.fides_key},[s,a]),[P,H]=(0,m.useState)(!1);(0,m.useEffect)(()=>{O(null),R(null),S(null)},[a]),(0,m.useEffect)(()=>{if(a===w.ac.SYSTEM_GROUP&&!n&&!i){let e={...l.query};delete e.key,l.replace({pathname:"/taxonomy",query:e},void 0,{shallow:!0})}},[a,i,n,l]);let z=(0,m.useCallback)(async e=>{if(!N)return;let t=(null==N?void 0:N.parent_key)===w.Ch,l={...N,name:e,parent_key:t?null:N.parent_key},a=await d(l);if((0,p.D4)(a)){C.error((0,p.e$)(a.error));return}R(a.data.fides_key),C.success("New label successfully created"),O(null)},[d,N,C]),G=u()(T,"active"),Y=(0,f.Tg)([(0,w.aq)(a).CREATE]);return(0,r.jsxs)(y.Z,{title:"Taxonomy",children:[(0,r.jsxs)(o.kCb,{vertical:!0,className:"h-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(h.Z,{heading:"Taxonomy"}),(0,r.jsx)("div",{className:"hidden",children:(0,r.jsx)("div",{className:"mb-5 flex justify-between",children:(0,r.jsxs)(o.TaI.Compact,{children:[(0,r.jsx)(o.IIB,{className:"min-w-[350px]",placeholder:"Search",allowClear:!0}),(0,r.jsx)(o.zxk,{type:"default",children:"Clear"})]})})})]}),(0,r.jsxs)("div",{className:"relative grow",children:[(0,r.jsx)("div",{className:"absolute left-2 top-2 z-[1]",children:(0,r.jsx)(o.AHg,{selectedKeys:[a],onSelect:e=>{let{key:t}=e;if(t===eL){H(!0);return}let a={...l.query};delete a.key,l.replace({pathname:"/taxonomy/".concat(t),query:a},void 0,{shallow:!0})},items:(()=>{let e={[w.Lo.DATA_CATEGORIES]:w.ac.DATA_CATEGORY,[w.Lo.DATA_USES]:w.ac.DATA_USE,[w.Lo.DATA_SUBJECTS]:w.ac.DATA_SUBJECT,[w.Lo.SYSTEM_GROUPS]:w.ac.SYSTEM_GROUP},t=(0,p.MM)(w.Lo).filter(e=>i||e.value!==w.Lo.SYSTEM_GROUPS).map(t=>({label:t.label,key:e[t.value]}));return(null==s?void 0:s.length)&&s.forEach(e=>{t.push({label:e.name,key:e.fides_key})}),i&&(t.push({type:"divider"}),t.push({label:"+ Create new",key:eL})),t})(),"data-testid":"taxonomy-type-selector"})}),(0,r.jsx)(o.u_l,{open:P,destroyOnHidden:!0,onCancel:()=>H(!1),width:768,footer:null,centered:!0,title:"Create new taxonomy",children:(0,r.jsx)(j,{onClose:()=>H(!1)})}),(0,r.jsx)(eR,{userCanAddLabels:Y,taxonomyItems:b?T:G,draftNewItem:N,lastCreatedItemKey:D,resetLastCreatedItemKey:()=>R(null),onTaxonomyItemClick:e=>{S(e)},onRootItemClick:()=>{let e;I(null!=(e=Object.values(w.ac).includes(a)?{fides_key:a,name:(0,w._g)(a),description:null}:null==s?void 0:s.find(e=>e.fides_key===a))?e:null)},onAddButtonClick:e=>{var t;O({parent_key:null!==(t=null==e?void 0:e.fides_key)&&void 0!==t?t:null,is_default:!1,description:""})},taxonomyType:a,onCancelDraftItem:()=>O(null),onSubmitDraftItem:z,isCreating:E,rootNodeLabel:null!=F?F:(0,w._g)(a)})]})]}),A&&(0,r.jsx)(em,{taxonomyItem:A,taxonomyType:a,onClose:()=>S(null)}),k&&(0,r.jsx)(U,{title:F?"Edit ".concat(F):"Edit taxonomy",onClose:()=>I(null),onDelete:()=>{L.confirm({title:"Delete ".concat(null==k?void 0:k.name,"?"),icon:null,content:(0,r.jsx)(o.Typography.Paragraph,{children:"Are you sure you want to delete this taxonomy? This action cannot be undone."}),okText:"Delete",okType:"primary",onOk:V,centered:!0})},taxonomy:k})]})}},90673:function(e,t,l){"use strict";l.d(t,{Cd:function(){return n},Xl:function(){return s}});var a=l(20987),i=l(59001);let n=(e,t)=>{let l;if(null==t&&e.every(e=>void 0===e.parent_key))l=e;else{let a=null!=t?t:null;l=e.filter(e=>e.parent_key===a)}return l.map(t=>{var l,a;let i=t.fides_key;return{value:t.fides_key,label:t.name||t.fides_key,description:t.description,children:n(e,i),is_default:null!==(l=t.is_default)&&void 0!==l&&l,active:null!==(a=t.active)&&void 0!==a&&a}})},s=e=>{switch(e){case i.ac.DATA_CATEGORY:return a.J.DATA_CATEGORY;case i.ac.DATA_SUBJECT:return a.J.DATA_SUBJECT;case i.ac.DATA_USE:return a.J.DATA_USE;case i.ac.SYSTEM_GROUP:return"system group";default:return e}}},31883:function(e,t,l){"use strict";l.d(t,{Bw:function(){return a.Bw},D4:function(){return a.D4}});var a=l(19043)},1945:function(e){e.exports={input:"TaxonomyTextInputNode_input__P9czz"}},34770:function(e){e.exports={container:"TaxonomyTreeNode_container__T4KpF",button:"TaxonomyTreeNode_button__mcbOd","button--hover":"TaxonomyTreeNode_button--hover__oycXY","button--parent-hover":"TaxonomyTreeNode_button--parent-hover__pwAPl","button--inactive":"TaxonomyTreeNode_button--inactive__Fjdpe","add-button-container":"TaxonomyTreeNode_add-button-container__eEoRN","add-button":"TaxonomyTreeNode_add-button__oM2vI","add-button--visible":"TaxonomyTreeNode_add-button--visible__Ojqqf"}}}]);