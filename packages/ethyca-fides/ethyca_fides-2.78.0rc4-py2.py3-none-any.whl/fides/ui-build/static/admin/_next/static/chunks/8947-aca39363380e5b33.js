"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8947],{35287:function(e,t,r){var o=r(24246),n=r(36010),i=r(88038),s=r.n(i);r(27378),t.Z=e=>{let{children:t,title:r,fullHeight:i,fullWidth:a,mainProps:u}=e;return(0,o.jsxs)(n.ad9,{"data-testid":r,direction:"column",height:i?"100vh":"calc(100vh - 48px)",width:a?"100vw":"calc(100vw - 240px)",children:[(0,o.jsxs)(s(),{children:[(0,o.jsxs)("title",{children:["Fides Admin UI - ",r]}),(0,o.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,o.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,o.jsx)(n.ad9,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...u,children:t})]})}},9270:function(e,t,r){r.d(t,{S:function(){return i}});var o=r(27378),n=r(36866);let i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,n.h)(e),{pageIndex:r,pageSize:i,updatePageIndex:s,updatePageSize:a,pageSizeOptions:u,showSizeChanger:c}=t,l=(0,o.useMemo)(()=>({current:r,pageSize:i,showSizeChanger:c,pageSizeOptions:u.map(String),onChange:s,onShowSizeChange:(e,t)=>{a(t)}}),[r,i,c,u,s,a]);return{...t,paginationProps:l}}},9110:function(e,t,r){r.d(t,{D:function(){return c}});var o=r(24246),n=r(36010);let i={percentPosition:{align:"start",type:"outer"},steps:3,strokeLinecap:"round",size:{width:24,height:8},rounding:Math.ceil},s={low:"var(--fidesui-error)",medium:"var(--fidesui-warning)",high:"var(--fidesui-success)"},a={low:30,medium:60,high:100},u=e=>({percent:a[e],strokeColor:s[e]}),c=e=>{let{severity:t,labels:r={low:"Low",medium:"Medium",high:"High"},...s}=e;return(0,o.jsx)(n.Exd,{...i,...u(t),format:()=>(0,o.jsx)(n.xvT,{size:"sm",type:"secondary",className:"font-normal",children:r[t]}),...s})}},9431:function(e,t,r){var o=r(24246),n=r(36010),i=r(98784),s=r.n(i),a=r(25980),u=r(35287),c=r(77830),l=r(58754),d=r(49744),m=r(15878);t.Z=e=>{let{children:t,monitorId:r,routeConfig:i}=e,{items:y,activeItem:v,setActiveItem:p}=(0,m.ZP)(i),{flags:{webMonitor:g,heliosV2:f}}=(0,a.hz)();return g||f?(0,o.jsxs)(u.Z,{title:"Action center",mainProps:{overflow:"hidden"},fullHeight:!0,children:[(0,o.jsx)(l.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:c.vi},...r?[{title:r}]:[]],isSticky:!1}),(0,o.jsx)(n.v2r,{"aria-label":"Action center tabs",mode:"horizontal",items:Object.values(y),selectedKeys:s().compact([v]),onClick:async e=>{let t=Object.values(m.em).find(t=>t===e.key);t&&await p(t)},className:"mb-4","data-testid":"action-center-tabs"}),t]}):(0,o.jsx)(d.n,{})}},49744:function(e,t,r){r.d(t,{n:function(){return s}});var o=r(24246),n=r(36010),i=r(77213);let s=()=>(0,o.jsx)(i.Z,{title:"Action center",mainProps:{className:"h-full"},children:(0,o.jsx)(n.kCb,{justify:"center",align:"center",className:"h-full",children:(0,o.jsx)(n.bZj,{message:"Coming soon...",description:"Action center is currently disabled.",type:"info",showIcon:!0})})})},37059:function(e,t,r){r.d(t,{$h:function(){return h},Ak:function(){return f},Av:function(){return D},EY:function(){return y},IC:function(){return P},M8:function(){return E},QC:function(){return I},RV:function(){return O},S0:function(){return w},Tj:function(){return p},Ud:function(){return u},Vr:function(){return T},WJ:function(){return l},mL:function(){return R},mi:function(){return A},n7:function(){return q},nP:function(){return m},nS:function(){return v},rs:function(){return d},sX:function(){return g},ut:function(){return L},vc:function(){return M},wi:function(){return c}});var o=r(78780),n=r(16394),i=r(60240),s=r(98145),a=r(71985);let{useGetAggregateMonitorResultsQuery:u,useGetDiscoveredSystemAggregateQuery:c,useGetDiscoveredAssetsQuery:l,useAddMonitorResultSystemsMutation:d,useIgnoreMonitorResultSystemsMutation:m,useAddMonitorResultAssetsMutation:y,useIgnoreMonitorResultAssetsMutation:v,useRestoreMonitorResultAssetsMutation:p,useUpdateAssetsSystemMutation:g,useUpdateAssetsDataUseMutation:f,useUpdateAssetsMutation:T,useGetConsentBreakdownQuery:A,useGetWebsiteMonitorResourceFiltersQuery:L,useGetInProgressMonitorTasksQuery:h,useRetryMonitorTaskMutation:R,useDismissMonitorTaskMutation:I,useUndismissMonitorTaskMutation:_,useGetMonitorTreeQuery:S,useLazyGetMonitorTreeQuery:O,useLazyGetMonitorTreeAncestorsStatusesQuery:E,useGetMonitorConfigQuery:M,useGetDatastoreFiltersQuery:w,useClassifyStagedResourcesMutation:D,useGetStagedResourceDetailsQuery:P,useLazyGetStagedResourceDetailsQuery:C,usePromoteRemovalStagedResourcesMutation:q}=o.u.injectEndpoints({endpoints:e=>({getAggregateMonitorResults:e.query({query:e=>{let{page:t=1,size:r=20,search:o,monitor_type:i,steward_user_id:s}=e,a=(0,n.$J)({monitor_type:i,steward_user_id:s});return{url:"/plus/discovery-monitor/aggregate-results?".concat(a.toString()),params:{page:t,size:r,search:o,diff_status:"addition"}}},transformResponse:e=>({...e,items:e.items.map(e=>({...e,monitorType:(0,a.G)(e.connection_type),isTestMonitor:e.connection_type===i.Rj.TEST_WEBSITE||e.connection_type===i.Rj.TEST_DATASTORE}))}),providesTags:["Discovery Monitor Results"]}),getMonitorConfig:e.query({query:e=>{let{monitor_config_id:t}=e;return{url:"/plus/discovery-monitor/".concat(t)}}}),getDatastoreFilters:e.query({query:e=>{let{monitor_config_id:t,staged_resource_urn:r}=e;return{url:"/plus/filters/datastore_monitor_resources?monitor_config_id=".concat(t,"&").concat((0,n.du)(r,"staged_resource_urn"))}}}),getMonitorTree:e.query({query:e=>{let{page:t=1,size:r=20,monitor_config_id:o,staged_resource_urn:n,include_descendant_details:i}=e;return{url:"/plus/discovery-monitor/".concat(o,"/tree"),params:{staged_resource_urn:n,include_descendant_details:i,page:t,size:r}}}}),getMonitorTreeAncestorsStatuses:e.query({query:e=>{let{monitor_config_id:t,staged_resource_urn:r}=e;return{url:"/plus/discovery-monitor/".concat(t,"/tree/ancestors-statuses"),params:{staged_resource_urn:r}}}}),getDiscoveredSystemAggregate:e.query({query:e=>{let{key:t,resolved_system_id:r,page:o=1,size:n=20,search:i,diff_status:s}=e;return{url:"/plus/discovery-monitor/system-aggregate-results",params:{monitor_config_id:t,resolved_system_id:r,page:o,size:n,search:i,diff_status:s}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredAssets:e.query({query:e=>{let{key:t,system:r,page:o=1,size:a=20,search:u,diff_status:c=[i.LL.ADDITION],sort_by:l=[s.r6.NAME],sort_asc:d=!0,resource_type:m,data_uses:y,locations:v,consent_aggregated:p}=e,g=Array.isArray(l)?l:[l],f=(0,n.$J)({sort_by:g,resource_type:m,data_uses:y,locations:v,consent_aggregated:p});return{url:"/plus/discovery-monitor/".concat(t,"/results?").concat(f.toString()),params:{resolved_system_id:r,page:o,size:a,search:u,diff_status:c,sort_asc:d}}},providesTags:()=>["Discovery Monitor Results"]}),addMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:r}=e,o=(0,n.du)(r,"resolved_system_ids");return{url:"/plus/discovery-monitor/".concat(t,"/promote"),method:"POST",params:o?new URLSearchParams(o):new URLSearchParams}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:r}=e,o=(0,n.du)(r,"resolved_system_ids");return{method:"POST",url:"/plus/discovery-monitor/".concat(t,"/mute?").concat(o)}},invalidatesTags:["Discovery Monitor Results"]}),addMonitorResultAssets:e.mutation({query:e=>{var t;let r=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>r.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/promote?".concat(r)}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultAssets:e.mutation({query:e=>({method:"POST",url:"/plus/discovery-monitor/mute",body:{staged_resource_urns:e.urnList}}),invalidatesTags:["Discovery Monitor Results","Monitor Field Results","Monitor Field Details"]}),restoreMonitorResultAssets:e.mutation({query:e=>{var t;let r=new URLSearchParams({status_to_set:i.LL.ADDITION});return null===(t=e.urnList)||void 0===t||t.forEach(e=>r.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/un-mute?".concat(r)}},invalidatesTags:["Discovery Monitor Results"]}),updateAssetsSystem:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_system_key:e.systemKey}))}),invalidatesTags:["Discovery Monitor Results","System Assets"]}),updateAssetsDataUse:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_data_uses:e.dataUses}))}),invalidatesTags:["Discovery Monitor Results"]}),updateAssets:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.assets}),invalidatesTags:["Discovery Monitor Results"]}),getConsentBreakdown:e.query({query:e=>{let{stagedResourceUrn:t,statuses:r,page:o=1,size:n=20}=e,i=new URLSearchParams;return i.append("page",String(o)),i.append("size",String(n)),r.forEach(e=>{i.append("status",e)}),{url:"/plus/discovery-monitor/staged_resource/".concat(encodeURIComponent(t),"/consent"),params:i}}}),getStagedResourceDetails:e.query({query:e=>{let{stagedResourceUrn:t}=e;return{url:"/plus/discovery-monitor/staged_resource/".concat(t?encodeURIComponent(t):"")}},providesTags:["Monitor Field Details"]}),getWebsiteMonitorResourceFilters:e.query({query:e=>{let{monitor_config_id:t,resolved_system_id:r,diff_status:o=[i.LL.ADDITION],search:s,resource_type:a,data_uses:u,locations:c,consent_aggregated:l}=e,d={monitor_config_id:t,resolved_system_id:r,diff_status:o};s&&(d.search=s);let m=(0,n.$J)({resource_type:a,data_uses:u,locations:c,consent_aggregated:l}).toString();return{url:m?"/plus/filters/website_monitor_resources?".concat(m):"/plus/filters/website_monitor_resources",params:d}},providesTags:["Discovery Monitor Results"]}),getInProgressMonitorTasks:e.query({query:e=>{let{page:t=1,size:r=20,search:o,task_types:n,statuses:i,return_dismissed:s=!1}=e,a=new URLSearchParams({page:t.toString(),size:r.toString(),return_dismissed:s.toString()});return o&&a.append("search",o),(null==n?void 0:n.length)&&n.forEach(e=>a.append("action_type",e)),(null==i?void 0:i.length)&&i.forEach(e=>a.append("status",e)),{url:"/plus/discovery-monitor/tasks?".concat(a.toString())}},providesTags:["Monitor Tasks"]}),retryMonitorTask:e.mutation({query:e=>{let{taskId:t}=e;return{url:"/plus/discovery-monitor/tasks/".concat(t,"/retry"),method:"POST"}},invalidatesTags:["Monitor Tasks"]}),dismissMonitorTask:e.mutation({query:e=>{let{taskId:t}=e;return{url:"/plus/discovery-monitor/tasks/".concat(t,"/dismissed"),method:"POST"}},invalidatesTags:["Monitor Tasks"]}),undismissMonitorTask:e.mutation({query:e=>{let{taskId:t}=e;return{url:"/plus/discovery-monitor/tasks/".concat(t,"/dismissed"),method:"DELETE"}},invalidatesTags:["Monitor Tasks"]}),classifyStagedResources:e.mutation({query:e=>{let{monitor_config_key:t,...r}=e;return{url:"/plus/discovery-monitor/".concat(t,"/classify"),method:"POST",body:r}},invalidatesTags:["Monitor Field Results","Monitor Field Details","Discovery Monitor Results"]}),promoteRemovalStagedResources:e.mutation({query:e=>{let{monitor_config_key:t,...r}=e;return{url:"/plus/discovery-monitor/".concat(t,"/promote-removal"),method:"POST",body:r}},invalidatesTags:["Monitor Field Results","Monitor Field Details"]})})})},99824:function(e,t,r){r.d(t,{$k:function(){return I},Me:function(){return y},T0:function(){return v},Vr:function(){return h},W3:function(){return _},Z8:function(){return R},Zu:function(){return f},aK:function(){return T},b_:function(){return S},e_:function(){return O},i7:function(){return E},km:function(){return A},sB:function(){return g},tP:function(){return p}});var o=r(24246),n=r(36010),i=r(16394),s=r(60240);let{REVIEW:a,CLASSIFY:u,PROMOTE:c,MUTE:l,UN_MUTE:d,PROMOTE_REMOVALS:m}=r(62678).FieldActionType,y={review:"Mark as reviewed","assign-categories":"Assign categories",classify:"Classify",mute:"Ignore",promote:"Approve","promote-removals":"Remove","un-review":"Un-mark as reviewed","un-mute":"Restore"},v={review:"Marking as reviewed","assign-categories":"Updating data categories",classify:"Classifying",mute:"Ignoring",promote:"Approving","promote-removals":"Removing","un-review":"Un-marking as reviewed","un-mute":"Restoring"},p={review:"Marked as reviewed","assign-categories":"Data category updated",classify:"Classified",mute:"Ignored",promote:"Approved","promote-removals":"Removed","un-review":"Un-marked as reviewed","un-mute":"Restored"},g=[a,c],f={addition:g,reviewed:g,classification_addition:g,classification_error:g,classification_queued:g,classification_update:g,classifying:g,monitored:g,muted:[d],promoting:g,promotion_error:g,removal:[l,m],removal_promotion_error:[l,m],removing:[l,m]},T=[u,a,c,l,d,m],A=[m,u,l,d],L=[u,c],h={addition:L,reviewed:L,classification_addition:L,classification_error:L,classification_queued:L,classification_update:L,classifying:L,monitored:L,muted:[d],promoting:L,promotion_error:L,removal:[m],removal_promotion_error:[m],removing:[m]},R={[a]:"You can only mark resources as reviewed with a data category applied",[u]:"You cannot classify resources that are already in classification or ignored",[l]:"You cannot ignore resources that are already ignored",[c]:"You can only approve resources that have a data category applied",[d]:"You can only restore resources that are ignored",[m]:"You can only remove resources that are in a removed status"},I={classify:[s.LL.ADDITION,s.LL.CLASSIFICATION_ADDITION,s.LL.CLASSIFICATION_UPDATE,s.LL.CLASSIFICATION_ERROR],review:[s.LL.CLASSIFICATION_ADDITION,s.LL.CLASSIFICATION_UPDATE,s.LL.REVIEWED],"un-review":[s.LL.REVIEWED],promote:[s.LL.CLASSIFICATION_ADDITION,s.LL.CLASSIFICATION_UPDATE,s.LL.REVIEWED,s.LL.PROMOTION_ERROR],"promote-removals":[s.LL.REMOVAL,s.LL.REMOVAL_PROMOTION_ERROR],mute:[s.LL.ADDITION,s.LL.CLASSIFICATION_ADDITION,s.LL.CLASSIFICATION_UPDATE,s.LL.REVIEWED,s.LL.REMOVAL,s.LL.CLASSIFICATION_ERROR,s.LL.PROMOTION_ERROR,s.LL.REMOVAL_PROMOTION_ERROR],"un-mute":[s.LL.MUTED],"assign-categories":[s.LL.ADDITION,s.LL.CLASSIFICATION_ADDITION,s.LL.CLASSIFICATION_UPDATE,s.LL.REVIEWED,s.LL.CLASSIFICATION_ERROR,s.LL.PROMOTION_ERROR]},_={"assign-categories":null,"promote-removals":(0,o.jsx)(n.PJP.ZNm,{}),"un-review":null,"un-mute":(0,o.jsx)(n.PJP.G7x,{}),review:(0,o.jsx)(n.PJP.MCw,{}),classify:(0,o.jsx)(n.QMR,{size:14}),mute:(0,o.jsx)(n.PJP.uzw,{}),promote:(0,o.jsx)(n.PJP.MCw,{})},S={REVIEW:"r",PROMOTE:"a",MUTE:"i",UN_MUTE:"z",REFRESH:".",TOGGLE_DRAWER:"o",OPEN_CLASSIFICATION_SELECT:"e"},O={"assign-categories":e=>null,"promote-removals":e=>"Are you sure you want to remove ".concat(e.toLocaleString()," ").concat((0,i._6)(e,"resource","resources"),"?"),"un-review":e=>null,"un-mute":e=>"Are you sure you want to restore ".concat(e.toLocaleString()," ").concat((0,i._6)(e,"resource","resources"),"?"),review:e=>"Are you sure you want to mark ".concat(e.toLocaleString()," ").concat((0,i._6)(e,"resource","resources")," as reviewed?"),classify:e=>"Are you sure you want to run the classifier and apply data categories to ".concat(e.toLocaleString()," unlabeled ").concat((0,i._6)(e,"resource","resources"),"?"),mute:e=>"Are you sure you want to ignore ".concat(e.toLocaleString()," ").concat((0,i._6)(e,"resource","resources"),"? After ignoring, these resources will not appear in future scans."),promote:e=>"Are you sure you want to approve ".concat(e.toLocaleString()," ").concat((0,i._6)(e,"resource","resources"),"? After approving this data can be used for policy automation and DSRs. ")},E={onCancel:async()=>!1,onOk:async()=>!0,icon:null,width:542}},99089:function(e,t,r){r.d(t,{Fp:function(){return s},Nz:function(){return a},rL:function(){return i}});var o=r(78780),n=r(16394);let{useFieldActionsMutation:i,useGetMonitorFieldsQuery:s,useLazyGetAllowedActionsQuery:a}=o.u.injectEndpoints({endpoints:e=>({getMonitorFields:e.query({query:e=>{let{path:{monitor_config_id:t},query:{page:r=1,size:o=20,search:i,diff_status:s,confidence_bucket:a,...u}}=e,c=(0,n.$J)({...u,...i?{search:[i]}:{},...s?{diff_status:s}:{},...a?{confidence_bucket:a}:{}});return{url:"/plus/discovery-monitor/".concat(t,"/fields?").concat(null==c?void 0:c.toString()),params:{page:r,size:o}}},providesTags:["Monitor Field Results"]}),fieldActions:e.mutation({query:e=>{let{path:{monitor_config_id:t,action_type:r},query:{search:o,diff_status:i,confidence_bucket:s,...a},body:u}=e,c=(0,n.$J)({...a,...o?{search:[o]}:{},...i?{diff_status:i}:{},...s?{confidence_bucket:s}:{}});return{url:"/plus/discovery-monitor/".concat(t,"/fields/").concat(r,"?").concat(c.toString()),method:"POST",body:u}},invalidatesTags:["Monitor Field Results","Monitor Field Details","Discovery Monitor Results"]}),getAllowedActions:e.query({query:e=>{let{path:{monitor_config_id:t},query:{search:r,diff_status:o,confidence_bucket:i,...s},body:a}=e,u=(0,n.$J)({...s,...r?{search:[r]}:{},...o?{diff_status:o}:{},...i?{confidence_bucket:i}:{}});return{url:"/plus/discovery-monitor/".concat(t,"/fields/allowed-actions?").concat(u.toString()),method:"POST",body:a}},providesTags:["Allowed Monitor Field Actions"]})})})},63537:function(e,t,r){r.d(t,{NM:function(){return a},Oq:function(){return l},io:function(){return d},nB:function(){return s},v_:function(){return u}});var o=r(16394),n=r(62678),i=r(99824);let s=(e,t)=>({title:e,okText:e,content:t,...i.i7}),a=(e,t)=>"".concat(i.tP[e]).concat((0,o._6)(null!=t?t:0,"","".concat(e===n.FieldActionType.ASSIGN_CATEGORIES?" for":""," ").concat(null==t?void 0:t.toLocaleString()," resources"))),u=e=>{let t=e===n.FieldActionType.CLASSIFY||e===n.FieldActionType.PROMOTE?": View summary in the activity tab":"";return"Action failed".concat(t)},c={high:"high",medium:"medium",low:"low",manual:void 0};function l(e){return c[e]}let d=e=>e.reduce((e,t)=>{switch(e){case"high":return e;case"medium":return"high"===t?t:e;default:return t||e}},void 0)},15878:function(e,t,r){r.d(t,{em:function(){return n},ZP:function(){return m}});var o,n,i=r(24246),s=r(36010),a=r(25980),u=r(63662),c=r(86677),l=e=>{var t,r;let{routes:o,defaultKey:n}=e,{pathname:i,isReady:s,...a}=(0,c.useRouter)(),l=(0,u.useParams)();return{activeItem:null!==(r=null===(t=Object.entries(o).find(e=>{let[,t]=e;return t===i}))||void 0===t?void 0:t[0])&&void 0!==r?r:n,setActiveItem:async e=>{let t=o[e];await a.push({pathname:t,query:l})}}};(o=n||(n={})).ATTENTION_REQUIRED="attention-required",o.ACTIVITY="activity";let d={activity:{key:"activity",type:"item",label:"Activity",icon:(0,i.jsx)(s.PJP.cS$,{})},"attention-required":{key:"attention-required",type:"item",label:"Attention required",icon:(0,i.jsx)(s.PJP.ejL,{})}};var m=e=>{let{flags:{heliosV2:t}}=(0,a.hz)(),r={"attention-required":d["attention-required"],...t?{activity:d.activity}:{}},{activeItem:o,setActiveItem:n}=l({routes:e,defaultKey:"attention-required"});return{activeItem:o,setActiveItem:n,items:r}}},83158:function(e,t,r){var o,n;r.d(t,{$:function(){return o}}),(n=o||(o={})).LOW="low",n.HIGH="high",n.MEDIUM="medium",n.MANUAL="manual"},62678:function(e,t,r){var o,n;r.d(t,{FieldActionType:function(){return o}}),(n=o||(o={})).CLASSIFY="classify",n.REVIEW="review",n.UN_REVIEW="un-review",n.PROMOTE="promote",n.PROMOTE_REMOVALS="promote-removals",n.MUTE="mute",n.UN_MUTE="un-mute",n.ASSIGN_CATEGORIES="assign-categories"},31883:function(e,t,r){r.d(t,{Bw:function(){return o.Bw},D4:function(){return o.D4}});var o=r(19043)}}]);