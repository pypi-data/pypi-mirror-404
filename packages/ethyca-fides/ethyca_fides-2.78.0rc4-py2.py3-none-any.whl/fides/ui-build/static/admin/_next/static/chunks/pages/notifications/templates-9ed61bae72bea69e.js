(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6781],{79349:function(e){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},52033:function(e,t,n){var r=n(26194),i=n(26789)(r);e.exports=i},23545:function(e,t,n){var r=n(97141),i=n(72889);e.exports=function e(t,n,s,a,o){var l=-1,c=t.length;for(s||(s=i),o||(o=[]);++l<c;){var u=t[l];n>0&&s(u)?n>1?e(u,n-1,s,a,o):r(o,u):a||(o[o.length]=u)}return o}},49819:function(e,t,n){var r=n(18911)();e.exports=r},26194:function(e,t,n){var r=n(49819),i=n(50098);e.exports=function(e,t){return e&&r(e,t,i)}},67375:function(e,t,n){var r=n(52033),i=n(80068);e.exports=function(e,t){var n=-1,s=i(e)?Array(e.length):[];return r(e,function(e,r,i){s[++n]=t(e,r,i)}),s}},98497:function(e,t,n){var r=n(66070),i=n(79867),s=n(89278),a=n(67375),o=n(73303),l=n(39334),c=n(96348),u=n(31137),p=n(19785);e.exports=function(e,t,n){t=t.length?r(t,function(e){return p(e)?function(t){return i(t,1===e.length?e[0]:e)}:e}):[u];var d=-1;return t=r(t,l(s)),o(a(e,function(e,n,i){return{criteria:r(t,function(t){return t(e)}),index:++d,value:e}}),function(e,t){return c(e,t,n)})}},1197:function(e,t,n){var r=n(31137),i=n(11871),s=n(63132);e.exports=function(e,t){return s(i(e,t,r),e+"")}},54459:function(e,t,n){var r=n(551),i=n(42630),s=n(31137),a=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:s;e.exports=a},73303:function(e){e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},17845:function(e,t,n){var r=n(55193);e.exports=function(e,t){if(e!==t){var n=void 0!==e,i=null===e,s=e==e,a=r(e),o=void 0!==t,l=null===t,c=t==t,u=r(t);if(!l&&!u&&!a&&e>t||a&&o&&c&&!l&&!u||i&&o&&c||!n&&c||!s)return 1;if(!i&&!a&&!u&&e<t||u&&n&&s&&!i&&!a||l&&n&&s||!o&&s||!c)return -1}return 0}},96348:function(e,t,n){var r=n(17845);e.exports=function(e,t,n){for(var i=-1,s=e.criteria,a=t.criteria,o=s.length,l=n.length;++i<o;){var c=r(s[i],a[i]);if(c){if(i>=l)return c;return c*("desc"==n[i]?-1:1)}}return e.index-t.index}},26789:function(e,t,n){var r=n(80068);e.exports=function(e,t){return function(n,i){if(null==n)return n;if(!r(n))return e(n,i);for(var s=n.length,a=t?s:-1,o=Object(n);(t?a--:++a<s)&&!1!==i(o[a],a,o););return n}}},18911:function(e){e.exports=function(e){return function(t,n,r){for(var i=-1,s=Object(t),a=r(t),o=a.length;o--;){var l=a[e?o:++i];if(!1===n(s[l],l,s))break}return t}}},72889:function(e,t,n){var r=n(96539),i=n(2900),s=n(19785),a=r?r.isConcatSpreadable:void 0;e.exports=function(e){return s(e)||i(e)||!!(a&&e&&e[a])}},57535:function(e,t,n){var r=n(85638),i=n(80068),s=n(42383),a=n(11611);e.exports=function(e,t,n){if(!a(n))return!1;var o=typeof t;return("number"==o?!!(i(n)&&s(t,n.length)):"string"==o&&t in n)&&r(n[t],e)}},11871:function(e,t,n){var r=n(79349),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var s=arguments,a=-1,o=i(s.length-t,0),l=Array(o);++a<o;)l[a]=s[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=s[a];return c[t]=n(l),r(e,this,c)}}},63132:function(e,t,n){var r=n(54459),i=n(49591)(r);e.exports=i},49591:function(e){var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var i=t(),s=16-(i-r);if(r=i,s>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},551:function(e){e.exports=function(e){return function(){return e}}},95099:function(e,t,n){var r=n(23545),i=n(98497),s=n(1197),a=n(57535),o=s(function(e,t){if(null==e)return[];var n=t.length;return n>1&&a(e,t[0],t[1])?t=[]:n>2&&a(t[0],t[1],t[2])&&(t=[t[0]]),i(e,r(t,1),[])});e.exports=o},42944:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/notifications/templates",function(){return n(46632)}])},35287:function(e,t,n){"use strict";var r=n(24246),i=n(36010),s=n(88038),a=n.n(s);n(27378),t.Z=e=>{let{children:t,title:n,fullHeight:s,fullWidth:o,mainProps:l}=e;return(0,r.jsxs)(i.ad9,{"data-testid":n,direction:"column",height:s?"100vh":"calc(100vh - 48px)",width:o?"100vw":"calc(100vw - 240px)",children:[(0,r.jsxs)(a(),{children:[(0,r.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,r.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)(i.ad9,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...l,children:t})]})}},87361:function(e,t,n){"use strict";var r=n(24246),i=n(36010);t.Z=e=>{let{title:t,text:n,onClose:s}=e;return(0,r.jsxs)(i.Br$,{backgroundColor:"gray.50",border:"1px solid",borderRadius:"md",justifyContent:"space-between",py:4,pr:6,pl:3,"data-testid":"empty-state",gap:2,position:"relative",children:[s&&(0,r.jsx)(i.j_w,{boxSize:5,position:"absolute",right:3,top:3,zIndex:1,cursor:"pointer",p:1,onClick:s}),(0,r.jsx)(i.QbF,{alignSelf:"start",color:"minos",mt:.5,flexGrow:0}),(0,r.jsxs)(i.ad9,{direction:"column",gap:2,flexGrow:1,children:[(0,r.jsx)(i.y_b,{fontSize:"md",children:t}),(0,r.jsx)(i.Bjg,{fontSize:"sm",color:"gray.600",lineHeight:"5",children:n})]})]})}},129:function(e,t,n){"use strict";var r=n(24246),i=n(36010),s=n(86677),a=n(16134),o=n(25980),l=n(77830),c=n(60240),u=n(31793);t.Z=()=>{let e=(0,s.useRouter)(),t=e.pathname,{plus:n}=(0,o.hz)(),p="providers";t.startsWith(l.AD)?p="providers":t.startsWith(l.Wi)?p="templates":t.startsWith(l.DN)&&(p="digests");let d=[{key:"templates",label:"Templates",requiresPlus:!0,scopes:[c.Sh.MESSAGING_TEMPLATE_UPDATE],path:l.Wi},{key:"digests",label:"Digests",requiresPlus:!0,scopes:[c.Sh.DIGEST_CONFIG_READ],path:l.DN},{key:"providers",label:"Providers",requiresPlus:!1,scopes:[c.Sh.MESSAGING_CREATE_OR_UPDATE],path:l.AD}];n||(d=d.filter(e=>!e.requiresPlus));let m=(0,a.C)(u.uu);d=d.filter(e=>e.scopes.some(e=>m.includes(e)));let f=t=>{let n=d.find(e=>e.key===t);n&&e.push(n.path)},g=d.map(e=>({label:e.label,key:e.key}));return(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(i.v2r,{mode:"horizontal",selectedKeys:[p],onClick:e=>{let{key:t}=e;return f(t)},items:g})})}},67810:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}}),(r=i||(i={})).PRIVACY_REQUEST_REVIEW_APPROVE="privacy_request_review_approve",r.PRIVACY_REQUEST_REVIEW_DENY="privacy_request_review_deny",r.PRIVACY_REQUEST_RECEIPT="privacy_request_receipt",r.PRIVACY_REQUEST_COMPLETE_ACCESS="privacy_request_complete_access",r.PRIVACY_REQUEST_COMPLETE_DELETION="privacy_request_complete_deletion",r.PRIVACY_REQUEST_COMPLETE_CONSENT="privacy_request_complete_consent",r.SUBJECT_IDENTITY_VERIFICATION="subject_identity_verification",r.MANUAL_TASK_DIGEST="manual_task_digest",r.EXTERNAL_USER_WELCOME="external_user_welcome";var r,i,s={[i.PRIVACY_REQUEST_COMPLETE_ACCESS]:"Access request completed",[i.PRIVACY_REQUEST_COMPLETE_DELETION]:"Erasure request completed",[i.PRIVACY_REQUEST_COMPLETE_CONSENT]:"Consent request completed",[i.PRIVACY_REQUEST_RECEIPT]:"Privacy request received",[i.PRIVACY_REQUEST_REVIEW_APPROVE]:"Privacy request approved",[i.PRIVACY_REQUEST_REVIEW_DENY]:"Privacy request denied",[i.SUBJECT_IDENTITY_VERIFICATION]:"Subject identity verification",[i.MANUAL_TASK_DIGEST]:"Manual task digest",[i.EXTERNAL_USER_WELCOME]:"External user welcome"}},5058:function(e,t,n){"use strict";n.d(t,{Vw:function(){return l},ms:function(){return a},pS:function(){return o},vm:function(){return c}});var r=n(78780),i=n(95099),s=n.n(i);let{useGetSummaryMessagingTemplatesQuery:a,usePutMessagingTemplateByIdMutation:o,useCreateMessagingTemplateByTypeMutation:l,usePatchMessagingTemplateByIdMutation:c}=r.u.injectEndpoints({endpoints:e=>({getSummaryMessagingTemplates:e.query({query:e=>({method:"GET",url:"plus/messaging/templates/summary",params:e}),transformResponse:e=>({...e,items:s()(e.items,"id")}),providesTags:()=>["Property-Specific Messaging Templates"]}),putMessagingTemplateById:e.mutation({query:e=>{let{templateId:t,template:n}=e;return{url:"plus/messaging/templates/".concat(t),method:"PUT",body:n}},invalidatesTags:()=>["Property-Specific Messaging Templates"]}),patchMessagingTemplateById:e.mutation({query:e=>{let{templateId:t,template:n}=e;return{url:"plus/messaging/templates/".concat(t),method:"PATCH",body:n}},invalidatesTags:()=>["Property-Specific Messaging Templates"]}),createMessagingTemplateByType:e.mutation({query:e=>{let{templateType:t,template:n}=e;return{url:"plus/messaging/templates/".concat(t),method:"POST",body:n}},invalidatesTags:()=>["Property-Specific Messaging Templates"]})})})},46632:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return R}});var r=n(24246),i=n(36010),s=n(86677),a=n(27378),o=n(59849),l=n(35287),c=n(71795),u=n(87361),p=n(46238),d=n(77830),m=n(129),f=n(58754),g=n(99640),h=n(2525),v=n(8125),x=n(7426),E=n(66213),_=n(67810),y=e=>{let{isOpen:t,onClose:n,onAccept:s}=e,[o,l]=(0,a.useState)(void 0),c=Object.keys(_.Z).map(e=>({value:e,label:_.Z[e]}));return(0,r.jsxs)(i.TGG,{isOpen:t,onClose:n,size:"2xl",isCentered:!0,children:[(0,r.jsx)(i.T5Q,{}),(0,r.jsxs)(i.Z8H,{"data-testid":"add-messaging-template-modal",children:[(0,r.jsx)(i.geD,{borderBottomWidth:1,fontWeight:"bold",children:"Select message template"}),(0,r.jsxs)(i.zOL,{children:[(0,r.jsx)(i.Bjg,{color:"gray.700",fontWeight:"medium",fontSize:"sm",marginBottom:3,marginTop:1,children:"Add a new email message by selecting a template below and clicking accept."}),(0,r.jsx)(i.Bjg,{color:"gray.700",fontSize:"sm",fontWeight:"medium",marginBottom:2,children:"Choose template:"}),(0,r.jsx)(i.TJV,{"data-testid":"template-type-selector",children:(0,r.jsx)(i.PhF,{options:c,onChange:e=>{l(e)},className:"w-full","aria-label":"Select a template"})})]}),(0,r.jsx)(i.NGc,{justifyContent:"flex-start",children:(0,r.jsxs)("div",{className:"flex w-full gap-4",children:[(0,r.jsx)(i.zxk,{onClick:n,"data-testid":"cancel-btn",className:"grow",children:"Cancel"}),(0,r.jsx)(i.zxk,{onClick:()=>s(o),type:"primary","data-testid":"confirm-btn",disabled:!o,className:"grow",children:"Next"})]})})]})]})},T=n(5058),j=n(812),b=n(46628),C=n(31883),S=()=>{let e=(0,i.p8r)(),[t]=(0,T.vm)();return{toggleIsTemplateEnabled:(0,a.useCallback)(async n=>{let{isEnabled:r,templateId:i}=n,s=await t({templateId:i,template:{is_enabled:r}});if((0,C.D4)(s)){e((0,b.Vo)((0,j.e$)(s.error)));return}e((0,b.t5)("Messaging template ".concat(r?"enabled":"disabled")))},[t,e])}},P=n(64826);let I=()=>{let{isLoading:e,data:t}=(0,P.gz)({page:1,size:100}),n=null==t?void 0:t.items.filter(e=>!e.messaging_templates||0===e.messaging_templates.length),s=!!(!e&&(null==n?void 0:n.length)),a="missing-messages-notice-".concat(null==n?void 0:n.map(e=>e.id).join("-")),[o,l]=(0,c._)("notices.dismissedMessageNoticeId",""),d=a===o;return s&&!d?(0,r.jsx)(u.Z,{title:"Not all properties have messages configured",text:(0,r.jsxs)(i.Typography.Text,{children:["You have properties that do not have messages configured. Users who submit privacy requests for these properties may not receive the necessary emails regarding their requests."," ",(0,r.jsx)(p.b,{label:null==n?void 0:n.map(e=>e.name).join(", ")})]}),onClose:()=>{l(a)},"data-testid":"notice-properties-without-messaging-templates"}):null},A=()=>{let{data:e}=(0,x.tB)({api_set:!1});return(null==e?void 0:e.notifications.enable_property_specific_messaging)?null:(0,r.jsx)(i.kCb,{"data-testid":"notice-properties-without-messaging-templates",children:(0,r.jsx)(u.Z,{title:"Basic messaging enabled",text:(0,r.jsxs)(i.Typography.Text,{children:['In basic messaging mode, you can edit the content of your messages from this screen. Please note that in basic messaging, the "Enable" toggle does not apply. Fides also supports property specific messaging mode. Read our'," ",(0,r.jsx)(i.Typography.Link,{href:"https://fid.es/property-specific-messaging",target:"_blank",rel:"nofollow",children:"docs"})," ","for more information about property specific mode or contact"," ",(0,r.jsx)(i.Typography.Link,{href:"mailto:support@ethyca.com",children:"Ethyca support"})," ","to enable this mode on your Fides instance."]})})})};var R=()=>{var e,t;let n=(0,s.useRouter)(),{toggleIsTemplateEnabled:c}=S(),u=(0,v.o)({pagination:{defaultPageSize:25,pageSizeOptions:[25,50,100]}}),[p,x]=(0,a.useState)(!1),[j,b]=(0,a.useState)(0),[C,P]=(0,a.useState)(!1),{pageIndex:R,pageSize:k}=u,{data:N,isLoading:w,isFetching:M,error:O}=(0,T.ms)({page:R,size:k}),q=(0,a.useMemo)(()=>[{title:"Message",dataIndex:"type",key:"type",render:(e,t)=>{let{type:n,id:i}=t;return(0,r.jsx)(g.Z,{href:"".concat(d.Wi,"/").concat(i),children:_.Z[n]})}},{title:"Properties",dataIndex:"properties",key:"properties",render:(e,t)=>{let{properties:n}=t;return(0,r.jsx)(h.Q,{values:null==n?void 0:n.map(e=>({label:e.name,key:e.id})),columnState:{isExpanded:p,version:j}})},menu:(0,E.Xr)(x,b)},{title:"Enable",dataIndex:"is_enabled",key:"is_enabled",render:(e,t)=>{let{is_enabled:n,id:s}=t;return(0,r.jsx)(i.rsf,{checked:n,onChange:e=>{c({isEnabled:e,templateId:s})}})}}],[p,j,c]),{tableProps:V}=(0,v.V)(u,{dataSource:null!==(e=null==N?void 0:N.items)&&void 0!==e?e:[],totalRows:null!==(t=null==N?void 0:N.total)&&void 0!==t?t:0,isLoading:w,isFetching:M,customTableProps:{locale:{emptyText:(0,r.jsx)(i.HYy,{image:i.HYy.PRESENTED_IMAGE_SIMPLE,description:(0,r.jsxs)(i.kCb,{vertical:!0,gap:"small",children:[(0,r.jsx)(i.Typography.Text,{children:"No messages found"}),(0,r.jsx)(i.zxk,{type:"primary",onClick:()=>P(!0),children:"Add message"})]})})}}});return O?(0,r.jsx)(o.Z,{error:O,defaultMessage:"A problem occurred while fetching your messaging templates"}):(0,r.jsxs)(l.Z,{title:"Notifications",children:[(0,r.jsx)(f.Z,{heading:"Notifications"}),(0,r.jsx)(m.Z,{}),(0,r.jsxs)(i.kCb,{vertical:!0,gap:"small",className:"py-2",children:[(0,r.jsx)(A,{}),(0,r.jsx)(I,{})]}),(0,r.jsxs)(i.kCb,{vertical:!0,gap:"small",children:[(0,r.jsx)(i.kCb,{justify:"flex-end",children:(0,r.jsx)(i.zxk,{type:"primary","data-testid":"add-message-btn",onClick:()=>P(!0),children:"Add message +"})}),w?(0,r.jsx)(i.OdW,{active:!0}):(0,r.jsx)(i.iA_,{...V,columns:q})]}),(0,r.jsx)(y,{isOpen:C,onClose:()=>P(!1),onAccept:e=>{n.push({pathname:d.fO,query:{templateType:e}})}})]})}},31883:function(e,t,n){"use strict";n.d(t,{Bw:function(){return r.Bw},D4:function(){return r.D4}});var r=n(19043)}},function(e){e.O(0,[431,7245,9698,5022,6043,2888,9774,179],function(){return e(e.s=42944)}),_N_E=e.O()}]);