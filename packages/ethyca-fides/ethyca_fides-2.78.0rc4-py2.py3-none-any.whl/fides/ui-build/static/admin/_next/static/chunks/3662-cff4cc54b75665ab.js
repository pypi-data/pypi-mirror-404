(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3662],{58095:function(e,t,r){var l=r(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&l(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,r){for(var l=-1,n=null==e?0:e.length;++l<n;)if(r(t,e[l]))return!0;return!1}},95372:function(e){e.exports=function(e,t,r,l){for(var n=e.length,i=r+(l?1:-1);l?i--:++i<n;)if(t(e[i],i,e))return i;return -1}},8817:function(e,t,r){var l=r(95372),n=r(1129),i=r(58263);e.exports=function(e,t,r){return t==t?i(e,t,r):l(e,n,r)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,r){var l=r(52485),n=r(58095),i=r(21796),a=r(65581),s=r(47111),o=r(43735);e.exports=function(e,t,r){var c=-1,d=n,u=e.length,p=!0,f=[],h=f;if(r)p=!1,d=i;else if(u>=200){var g=t?null:s(e);if(g)return o(g);p=!1,d=a,h=new l}else h=t?[]:f;e:for(;++c<u;){var y=e[c],v=t?t(y):y;if(y=r||0!==y?y:0,p&&v==v){for(var m=h.length;m--;)if(h[m]===v)continue e;t&&h.push(v),f.push(y)}else d(h,v,r)||(h!==f&&h.push(v),f.push(y))}return f}},56632:function(e,t,r){var l=r(89278),n=r(80068),i=r(50098);e.exports=function(e){return function(t,r,a){var s=Object(t);if(!n(t)){var o=l(r,3);t=i(t),r=function(e){return o(s[e],e,s)}}var c=e(t,r,a);return c>-1?s[o?t[c]:c]:void 0}}},47111:function(e,t,r){var l=r(46151),n=r(50344),i=r(43735),a=l&&1/i(new l([,-0]))[1]==1/0?function(e){return new l(e)}:n;e.exports=a},58263:function(e){e.exports=function(e,t,r){for(var l=r-1,n=e.length;++l<n;)if(e[l]===t)return l;return -1}},64925:function(e,t,r){var l=r(56632)(r(66259));e.exports=l},66259:function(e,t,r){var l=r(95372),n=r(89278),i=r(47991),a=Math.max;e.exports=function(e,t,r){var s=null==e?0:e.length;if(!s)return -1;var o=null==r?0:i(r);return o<0&&(o=a(s+o,0)),l(e,n(t,3),o)}},50344:function(e){e.exports=function(){}},94919:function(e,t,r){var l=r(91936),n=1/0;e.exports=function(e){return e?(e=l(e))===n||e===-n?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}},47991:function(e,t,r){var l=r(94919);e.exports=function(e){var t=l(e),r=t%1;return t==t?r?t-r:t:0}},83766:function(e,t,r){var l=r(92198);e.exports=function(e){return e&&e.length?l(e):[]}},12627:function(e,t,r){"use strict";var l=r(24246),n=r(79283),i=r(34929);t.Z=e=>{let{selectedTaxonomies:t,showDisabled:r=!1,...a}=e,{getDataCategoryDisplayNameProps:s,getDataCategories:o}=(0,i.Z)(),c=(r?o():o().filter(e=>e.active)).filter(e=>!(null==t?void 0:t.includes(e.fides_key))).map(e=>{let{name:t,primaryName:r}=s(e.fides_key);return{value:e.fides_key,name:t,primaryName:r,description:e.description||"",label:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("strong",{children:r||t}),r&&": ".concat(t)]}),title:e.fides_key}});return(0,l.jsx)(n.l,{options:c,...a})}},79283:function(e,t,r){"use strict";r.d(t,{l:function(){return d}});var l=r(24246),n=r(36010),i=r(72707),a=r.n(i);let s=e=>{let{data:{formattedTitle:t,description:r,name:i,primaryName:a}}=e;return(0,l.jsxs)(n.kCb,{gap:12,title:"".concat(t," - ").concat(r),children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:a||i}),a&&": ".concat(i)]}),(0,l.jsx)("em",{className:"overflow-hidden text-ellipsis",children:r})]})},o=e=>"options"in e&&Array.isArray(e.options),c=e=>({...e,className:a().option,formattedTitle:e.formattedTitle||[e.primaryName,e.name].filter(e=>e).join(": ")}),d=e=>{let{options:t,...r}=e,i=null==t?void 0:t.map(e=>o(e)?{...e,options:e.options.map(c)}:c(e));return(0,l.jsx)(n.PhF,{options:i,filterOption:(e,t)=>{var r,l;return(null==t?void 0:null===(r=t.formattedTitle)||void 0===r?void 0:r.toLowerCase().includes(e.toLowerCase()))||(null==t?void 0:null===(l=t.value)||void 0===l?void 0:l.toLowerCase().includes(e.toLowerCase()))||!1},optionFilterProp:"label",autoFocus:!0,variant:"borderless",optionRender:s,styles:{popup:{root:{minWidth:"500px"}}},className:"w-full p-0","data-testid":"taxonomy-select",...r})}},34929:function(e,t,r){"use strict";var l=r(24246),n=r(64925),i=r.n(n),a=r(27378),s=r(16134),o=r(30002),c=r(28079),d=r(57072);let u=()=>{let{isLoading:e}=(0,c.fd)(),t=(0,s.C)(c.U3),{isLoading:r}=(0,d.MO)(),l=(0,s.C)(d.qb),{isLoading:n}=(0,o.te)();return{dataUses:t,dataSubjects:(0,s.C)(o.ZL),dataCategories:l,isLoading:e||r||n}};t.Z=()=>{let{dataUses:e,dataCategories:t,dataSubjects:r,isLoading:n}=u(),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.split(".").slice(0,t).join(".")},o=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=t(e);if(!l)return{};let n=t(s(e,r)),i=!!l.parent_key;return{name:l.name||void 0,primaryName:i&&(null==n?void 0:n.name)!==l.name&&(null==n?void 0:n.name)||void 0}},c=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,{name:n,primaryName:i}=o(e,t,r);return n?i?(0,l.jsxs)(a.Fragment,{children:[(0,l.jsxs)("strong",{children:[i,":"]})," ",n]},e):(0,l.jsx)("strong",{children:n},e):e},d=t=>i()(e,{fides_key:t}),p=e=>i()(t,{fides_key:e}),f=e=>i()(r,{fides_key:e});return{getDataUses:()=>e,getDataUseByKey:d,getDataUseDisplayName:e=>c(e,d,1),getDataUseDisplayNameProps:e=>o(e,d,1),getDataCategories:()=>t,getDataCategoryByKey:p,getDataCategoryDisplayName:e=>c(e,p,2),getDataCategoryDisplayNameProps:e=>o(e,p,2),getDataSubjects:()=>r,getDataSubjectByKey:f,getDataSubjectDisplayName:e=>{let t=f(e);return t?t.name:e},getDataSubjectDisplayNameProps:e=>{let t=f(e);return t?{name:t.name||e}:{}},getPrimaryKey:s,isLoading:n}}},84418:function(e,t,r){"use strict";r.d(t,{d:function(){return c}});var l=r(24246),n=r(36010),i=r(98784),a=r.n(i);let s=e=>{let{itemKey:t,actions:r}=e;return a().isEmpty(r)?null:(0,l.jsx)(n.kCb,{gap:"small",justify:"flex-end",children:r.map((e,i)=>{let{callback:a,label:s,disabled:o}=e;return(0,l.jsx)(n.zxk,{onClick:()=>a(t),type:i===r.length-1?"primary":"default",disabled:o,children:s},s)})})},o=e=>{let{title:t,titleIcon:r,titleTag:i}=e;return(0,l.jsxs)(n.kCb,{align:"center",gap:"small",children:[r,(0,l.jsx)("span",{children:t}),i&&(0,l.jsx)(n.Vp9,{...i})]})},c=e=>{let{title:t,titleIcon:r,titleTag:i,actions:a,width:c=480,...d}=e;return(0,l.jsx)(n.dys,{title:(0,l.jsx)(o,{title:t,titleIcon:r,titleTag:i}),footer:d.footer||!a?d.footer:(0,l.jsx)(s,{itemKey:d.itemKey,actions:a}),width:c,...d})}},90673:function(e,t,r){"use strict";r.d(t,{Cd:function(){return i},Xl:function(){return a}});var l=r(20987),n=r(59001);let i=(e,t)=>{let r;if(null==t&&e.every(e=>void 0===e.parent_key))r=e;else{let l=null!=t?t:null;r=e.filter(e=>e.parent_key===l)}return r.map(t=>{var r,l;let n=t.fides_key;return{value:t.fides_key,label:t.name||t.fides_key,description:t.description,children:i(e,n),is_default:null!==(r=t.is_default)&&void 0!==r&&r,active:null!==(l=t.active)&&void 0!==l&&l}})},a=e=>{switch(e){case n.ac.DATA_CATEGORY:return l.J.DATA_CATEGORY;case n.ac.DATA_SUBJECT:return l.J.DATA_SUBJECT;case n.ac.DATA_USE:return l.J.DATA_USE;case n.ac.SYSTEM_GROUP:return"system group";default:return e}}},57072:function(e,t,r){"use strict";r.d(t,{Bd:function(){return l.Bd},L5:function(){return l.L5},MO:function(){return l.MO},qb:function(){return l.qb}});var l=r(5785)},73662:function(e,t,r){"use strict";r.r(t),r.d(t,{HELIOS_ACCESS_ERROR:function(){return eG},MONITOR_ACTION_CENTER_CONFIG:function(){return eW},default:function(){return eH}});var l=r(24246),n=r(36010),i=r(63662),a=r(25980),s=r(77830),o=r(9431),c=r(98784),d=r.n(c),u=r(79894),p=r.n(u),f=r(86677),h=r(27378),g=r(43929),y=r(30952),v=r(59849),m=r(17245),_=r(9270),x=r(37059),b=r(60240),E=r(62678),k=r(99824),T=r(26917);let S="space",A=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"inclusive",{activeListItem:l=null,enableKeyboardShortcuts:n=!1}=t,[i,a]=(0,h.useState)(r),[s,o]=(0,h.useState)([]),c=(e,t)=>{(("inclusive"===i?t:!t)?"add":"remove")=="add"?o([...s,e]):o(s.filter(t=>t!==e))},u=e=>{a(e),o([])},p=d().difference(e,s),f="inclusive"===i?s:p,y="exclusive"===i?s:p;return(0,g.y1)("h",()=>{u("exclusive")},{enabled:n}),(0,g.y1)("l",()=>{u("inclusive")},{enabled:n}),(0,g.y1)(S,e=>{if(l){e.preventDefault();let t=f.includes(l.key);c(l.key,!t)}},{enabled:n},[l,f,c]),{checkboxProps:{checked:"inclusive"===i?f.length>0&&(null==e?void 0:e.length)===f.length:0===y.length,indeterminate:"inclusive"===i?f.length>0&&(null==e?void 0:e.length)!==f.length:y.length>0,onChange:e=>u(e.target.checked?"exclusive":"inclusive")},excludedKeys:y,listSelectMode:i,resetListSelect:()=>{o([]),a("inclusive")},selectedKeys:f,updateListSelectMode:u,updateSelectedListItem:c}},j=e=>{let{...t}=e;return(0,l.jsx)(n.u_l,{title:"Keyboard shortcuts",footer:null,...t,children:(0,l.jsx)(n.w5n,{bordered:!0,column:1,items:[{key:"".concat(n.dHR.NAVIGATE_UP,"-").concat(n.dHR.NAVIGATE_DOWN),label:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:n.dHR.NAVIGATE_DOWN})," ","/"," ",(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:n.dHR.NAVIGATE_UP})]}),children:"Activate the next/previous field"},{key:S,label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:S}),children:"Toggle checkbox of the active field"},{key:"h",label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:"h"}),children:"Select all fields"},{key:"l",label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:"l"}),children:"Deselect all fields"},{key:n.dHR.CLEAR_FOCUS,label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:n.dHR.CLEAR_FOCUS}),children:"Clear the active field"},{key:k.b_.TOGGLE_DRAWER,label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:k.b_.TOGGLE_DRAWER}),children:"Open/close details drawer for active field"},{key:k.b_.REVIEW,label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:k.b_.REVIEW}),children:"Mark the active field as reviewed"},{key:k.b_.PROMOTE,label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:k.b_.PROMOTE}),children:"Approve the active field"},{key:k.b_.MUTE,label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:k.b_.MUTE}),children:"Ignore the active field"},{key:k.b_.UN_MUTE,label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:k.b_.UN_MUTE}),children:"Restore the active field"},{key:k.b_.OPEN_CLASSIFICATION_SELECT,label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:k.b_.OPEN_CLASSIFICATION_SELECT}),children:"Edit data categories for the active field"},{key:k.b_.REFRESH,label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:k.b_.REFRESH}),children:"Refresh the list"},{key:k.b_.REFRESH,label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:k.b_.REFRESH}),children:"Refresh the list"},{key:T.M,label:(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:"/"}),children:"Focus the search input"},{key:"?",label:(0,l.jsxs)("div",{className:"whitespace-nowrap",children:[(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:"?"})," (",(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:"shift"}),"+",(0,l.jsx)(n.Typography.Text,{keyboard:!0,children:"/"}),")"]}),children:"Open/close this modal"}]})})};var C=r(99089),R=r(83766),D=r.n(R),I=r(16394),M=r(59001),w=r(90673),N=r(39864),L=r(83158),O=r(3124),F=r.n(O);let U="load_more",P="skeleton",z=["Unlabeled","Classifying...","Classified","Reviewed","Approving...","Approved","Removed","Ignored","Error","Removing..."],V=["Approved","Ignored","Approving...","Removing..."],$=["Unlabeled","Classifying...","Classified","Reviewed","Removed","Error"],q={addition:{label:"Unlabeled"},reviewed:{label:"Reviewed",color:n.tAb.ALERT},classification_addition:{label:"Classified",color:n.tAb.CAUTION},classification_error:{label:"Error",color:n.tAb.ERROR},classification_queued:{label:"Classifying...",color:n.tAb.INFO},classification_update:{label:"Classified",color:n.tAb.CAUTION},classifying:{label:"Classifying...",color:n.tAb.INFO},monitored:{label:"Approved",color:n.tAb.SUCCESS},muted:{label:"Ignored",color:n.tAb.DEFAULT},promoting:{label:"Approving...",color:n.tAb.DEFAULT},promotion_error:{label:"Error",color:n.tAb.ERROR},removal:{label:"Removed",color:n.tAb.ERROR},removing:{label:"Removing...",color:n.tAb.DEFAULT},removal_promotion_error:{label:"Error",color:n.tAb.ERROR}},W={[b.D$.DATABASE]:n.PJP.S9g,[b.D$.FIELD]:n.PJP.sgG,[b.D$.SCHEMA]:n.PJP.ehp,[b.D$.TABLE]:n.PJP.iA_},G={STATUS:"status-section",DATA_CATEGORY:"data-category-section",CONFIDENCE:"confidence-section"},H={[b.Ag.ADDITION]:{color:F().FIDESUI_SUCCESS,tooltip:"This resource was added in the latest scan"},[b.Ag.REMOVAL]:{color:F().FIDESUI_ERROR,tooltip:"This resource was removed in the latest scan"},[b.Ag.CHANGE]:{color:F().FIDESUI_WARNING,tooltip:"This resource was modified in the latest scan"}},J=[L.$.HIGH,L.$.MEDIUM,L.$.LOW,L.$.MANUAL],B=(e,t)=>{if(!e||0===e.length)return[];let r=(e,t)=>{let l=t=>{if(t.value===e)return{title:t.label||e,children:t.children||[]};if(t.children&&t.children.length>0){let l=r(e,t.children);if(l)return l}return null};return t.reduce((e,t)=>null!=e?e:l(t),null)},l=new Map;e.forEach(e=>{let n=e.split(".");n.forEach((e,i)=>{let a=n.slice(0,i+1).join(".");if(!l.has(a)){let e=r(a,t);l.set(a,{title:(null==e?void 0:e.title)||(0,I.kC)(a.split(".").pop()||a),key:a,checkable:!0,selectable:!1})}})});let n=Array.from(l.values()),i=new Map;n.forEach(e=>{let t=e.key.toString().split(".");if(t.length>1){let r=t.slice(0,-1).join(".");i.has(r)||i.set(r,[]),i.get(r).push(e)}});let a=e=>(i.get(e)||[]).map(e=>{let t=a(e.key.toString());return{...e,children:t.length>0?t:void 0,isLeaf:0===t.length}});return n.filter(e=>1===e.key.toString().split(".").length).map(e=>{let t=a(e.key.toString());return{...e,children:t.length>0?t:void 0,isLeaf:0===t.length}})},Y=e=>{let{resourceStatus:t,setResourceStatus:r,dataCategory:i,confidenceBucket:a,setDataCategory:s,setConfidenceBucket:o,resetToInitialState:c,monitorId:d,stagedResourceUrn:u}=e,[p,f]=(0,h.useState)(t),[g,y]=(0,h.useState)(i),[v,m]=(0,h.useState)(a),[_,b]=(0,h.useState)([G.STATUS]),{data:E,refetch:k}=(0,x.S0)({monitor_config_id:d,staged_resource_urn:u},{refetchOnMountOrArgChange:!0}),[T,{data:S=[]}]=(0,N.ci)();(0,h.useEffect)(()=>{T(M.ac.DATA_CATEGORY)},[T]);let A=(0,h.useMemo)(()=>(0,w.Cd)(S),[S]),j=J.filter(e=>{var t;return null==E?void 0:null===(t=E.confidence_bucket)||void 0===t?void 0:t.includes(e)}),C=(0,h.useMemo)(()=>z.map(e=>({title:e.replace(/\.{3}$/,""),key:e,checkable:!0,selectable:!1,isLeaf:!0})),[]),R=(0,h.useMemo)(()=>(null==E?void 0:E.data_category)&&0!==E.data_category.length?B(E.data_category,A):[],[null==E?void 0:E.data_category,A]),O=[...C.length>0?[{title:"Status",key:G.STATUS,checkable:!0,selectable:!1,isLeaf:!1,children:C}]:[],...j.length>0?[{title:"Confidence",key:G.CONFIDENCE,checkable:!0,selectable:!1,isLeaf:!1,children:j.map(e=>({title:(0,I.kC)(e),key:e,checkable:!0,selectable:!1,isLeaf:!0}))}]:[],...R.length>0?[{title:"Data category",key:G.DATA_CATEGORY,checkable:!0,selectable:!1,isLeaf:!1,children:R}]:[]],F=D()([...null!=p?p:[],...null!=g?g:[],...null!=v?v:[]]),U=new Set(t||[]).size+new Set(i||[]).size+new Set(a||[]).size;return(0,l.jsx)(n.wn$,{treeProps:{checkable:!0,checkedKeys:F,onCheck:e=>{let t=Array.isArray(e)?e:e.checked,r=[],l=[],n=[],i=Object.values(G),a=(e,t)=>t.some(t=>t!==e&&t.startsWith("".concat(e,"."))),s=t.map(e=>e.toString());t.forEach(e=>{let t=e.toString();if(i.some(e=>e===t))return;let o=z.find(e=>e===t),c=Object.values(L.$).find(e=>e===t);o?r.push(o):c?l.push(c):a(t,s)||n.push(t)}),f(r.length>0?r:[]),y(n.length>0?n:[]),m(l.length>0?l:[])},treeData:O,expandedKeys:_,onExpand:e=>{b(e)}},onApply:()=>{r(p&&p.length>0?Array.from(new Set(p)):p),s(g&&g.length>0?Array.from(new Set(g)):g),o(v&&v.length>0?Array.from(new Set(v)):v)},onReset:()=>{c(),f($),m([]),y([])},onClear:()=>{f([]),m([]),y([])},onOpenChange:e=>{e&&k()},activeFiltersCount:U})};var K=r(9110);let Q=e=>{switch(e){case 1:return b.D$.DATABASE;case 2:return b.D$.SCHEMA;case 3:return b.D$.TABLE;default:return b.D$.FIELD}},Z=e=>{if(!e||"string"!=typeof e)return[];let t=e.trim();if(!t)return[];let r=t.split(".");if(r.length<2)return[];let l=r.filter(e=>e&&e.trim().length>0);return l.length<2?[]:(l.shift(),l.length>0&&l.pop(),0===l.length)?[]:l.map((e,t)=>{let r=W[Q(t+1)];return{title:e.trim(),IconComponent:r}})};var X=r(79283),ee=r(34929),et=e=>{let{onSelectDataCategory:t,urn:r,...i}=e,{getDataCategoryDisplayNameProps:a,getDataCategories:s}=(0,ee.Z)(),o=s().filter(e=>e.active),[c,d]=(0,h.useState)(!1),u=o.map(e=>{let{name:t,primaryName:r}=a(e.fides_key);return{value:e.fides_key,label:(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:r||t}),r&&": ".concat(t)]}),name:t,primaryName:r,description:e.description||""}});return(0,l.jsx)(X.l,{options:u,prefix:(0,l.jsx)(n.zxk,{"aria-label":"Add Data Category",type:"text",size:"small",icon:(0,l.jsx)(n.PJP.mm_,{}),disabled:i.disabled}),placeholder:"",suffixIcon:null,classNames:{root:"w-full max-w-full overflow-hidden p-0 cursor-pointer -ml-5"},style:{"--ant-select-multiple-selector-bg-disabled":"transparent"},variant:"borderless",autoFocus:!1,maxTagCount:"responsive",open:c,onOpenChange:e=>d(e),onSelect:e=>{t(e),d(!1)},"data-classification-select":r,popupMatchSelectWidth:600,...i})},er=r(97947),el=r.n(er),en=r(63537);let ei=e=>{let{label:t,closable:r,onClose:i,isFromClassifier:a}=e;return(0,l.jsx)(n.Vp9,{color:"white",bordered:!0,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},closable:r,onClose:i,style:{marginInlineEnd:"calc((var(--ant-padding-xs) * 0.5))"},icon:a&&(0,l.jsx)(n.QMR,{}),children:(0,l.jsx)(n.xvT,{size:"sm",children:t})})},ea=e=>{let{title:t,IconComponent:r}=e;return{title:r?(0,l.jsxs)(n.kCb,{gap:3,align:"center",children:[(0,l.jsx)(r,{}),(0,l.jsx)("span",{children:t})]}):t}};var es=e=>{let{urn:t,name:r,diff_status:i,selected:a,onSelect:s,onSetDataCategories:o,dataCategoriesDisabled:c,onNavigate:u,actions:p,classifications:f,...h}=e,g="preferred_data_categories"in h?h.preferred_data_categories:[],y=d()(null==f?void 0:f.flatMap(e=>{let{confidence_bucket:t}=e,r=t?(0,en.Oq)(t):void 0;return r?[r]:[]})).thru(en.io).value();return(0,l.jsx)(n.aVo.Item,{actions:[y&&(0,l.jsx)(K.D,{severity:y,className:"mr-2"}),...null!=p?p:[]],children:(0,l.jsx)(n.aVo.Item.Meta,{avatar:(0,l.jsx)("div",{className:"ml-2",children:(0,l.jsx)(n.XZJ,{checked:a,onChange:e=>s&&s(t,e.target.checked)})}),title:(0,l.jsxs)(n.kCb,{gap:12,align:"center",className:el()["monitor-field__title"],children:[(0,l.jsx)(n.zxk,{type:"text",size:"small",className:"-mx-2",onClick:()=>u&&u(t),children:r}),i&&i!==b.LL.ADDITION&&(0,l.jsx)(n.Vp9,{bordered:!1,color:q[i].color,children:q[i].label}),(0,l.jsx)(n.ua7,{title:t,mouseEnterDelay:.5,children:(0,l.jsx)(n.aGc,{className:el()["monitor-field__breadcrumb"],items:Z(t).map(ea),role:"presentation",style:{overflow:"hidden"}})})]}),description:(0,l.jsx)(et,{mode:"multiple",value:null!=g?g:[],urn:t,tagRender:e=>{let r=!!(null==f?void 0:f.find(t=>t.label===e.value));return ei({...e,isFromClassifier:r,onClose:()=>{var r;o(t,null!==(r=null==g?void 0:g.filter(t=>t!==e.value))&&void 0!==r?r:[])}})},onSelectDataCategory:e=>{(null==g?void 0:g.includes(e))||o(t,[...null!=g?g:[],e])},disabled:c})})},t)},eo=r(812),ec=r(32500),ed=r.n(ec);let eu=(e,t)=>e.find(e=>{let{children:r}=e;return r&&!!r.find(e=>e.key.toString()===t)}),ep=(e,t)=>{var r;return null!==(r=eu(e,t))&&void 0!==r?r:e.reduce((e,r)=>{if(r.children){var l;return null!==(l=eu(r.children,t))&&void 0!==l?l:ep(r.children,t)}return e},null)},ef=e=>{let{node:t,treeData:r,onLoadMore:i,actions:a}=e;if(!t.title)return null;if(t.key.toString().startsWith(U)){let e=ep(r,t.key.toString());return(0,l.jsx)(n.zxk,{type:"link",block:!0,onClick:()=>{(null==e?void 0:e.key)&&i(e.key.toString())},className:"p-0",children:t.title})}if(t.key.toString().startsWith(P))return(0,l.jsx)(n.OdW,{paragraph:!1,title:{width:"80px"},active:!0,children:t.title});let s=t.diffStatus===b.LL.MUTED;return(0,l.jsxs)(n.kCb,{gap:4,align:"center",className:"group ml-1 flex grow ".concat(s?"opacity-40":""),"aria-label":s?"".concat(t.title," (ignored)"):void 0,children:[(0,l.jsx)(n.xvT,{ellipsis:{tooltip:t.title},className:"grow select-none",children:t.title}),(0,l.jsx)(n.Ltx,{menu:{items:a?Object.entries(a).map(e=>{let[r,{disabled:l,...n}]=e;return{key:r,disabled:l([t]),...n}}):[],onClick:e=>{var r;let{key:l,domEvent:n}=e;n.preventDefault(),n.stopPropagation(),null===(r=a[l])||void 0===r||r.callback([t.key],[t])}},destroyOnHidden:!0,className:"group mr-1 flex-none group-[.multi-select]/monitor-tree:pointer-events-none group-[.multi-select]/monitor-tree:opacity-0",children:(0,l.jsx)(n.zxk,{"aria-label":"Show More Resource Actions",icon:(0,l.jsx)(n.PJP.r43,{className:"opacity-0 group-hover:opacity-100 group-[.ant-dropdown-open]:opacity-100"}),type:"text",size:"small",className:"self-end"})})]})},eh=(e,t,r,l)=>e.map(e=>e.key===t?{...e,status:r,diffStatus:l}:e.children?{...e,children:eh(e.children,t,r,l)}:e),eg=(e,t)=>e.map(e=>{if(e.key===t){let{children:t,...r}=e;return r}return e.children?{...e,children:eg(e.children,t)}:e}),ey=e=>{let t=[];return e.children&&e.children.length>0&&e.children.forEach(e=>{"string"==typeof e.key&&(t.push(e.key),t.push(...ey(e)))}),t},ev=(e,t)=>{for(let r of e){if(r.key===t)return r;if(r.children){let e=ev(r.children,t);if(e)return e}}},em=e=>!!e.update_status&&e.diff_status!==b.LL.MUTED,e_=(e,t)=>{var r;let i=e.items.map(e=>{let t=e.resource_type?W[e.resource_type]:void 0,r=e.update_status?H[e.update_status]:void 0;return{title:e.name,key:e.urn,selectable:!0,icon:t?()=>(0,l.jsx)(n.ua7,{title:null==r?void 0:r.tooltip,children:(0,l.jsx)(n.Cts,{className:"h-full",offset:[0,5],color:null==r?void 0:r.color,dot:em(e),children:(0,l.jsx)(t,{className:"h-full"})})}):void 0,status:e.update_status,diffStatus:e.diff_status,isLeaf:e.resource_type===b.D$.FIELD||!e.has_grandchildren,classifyable:[b.D$.SCHEMA,b.D$.TABLE,b.D$.ENDPOINT,b.D$.FIELD].includes(e.resource_type)}});return(null!==(r=null==i?void 0:i.length)&&void 0!==r?r:0)<100?i:[...i,{title:"Load more...",key:"".concat(U,"-").concat(e.page,"-").concat(t),selectable:!1,isLeaf:!0}]},ex=(e,t,r)=>e.map(e=>{if(e.key===t){var l,n;return{...e,children:[...null!==(n=null===(l=e.children)||void 0===l?void 0:l.filter(e=>!(e.key.toString().startsWith(U)||e.key.toString().startsWith(P))))&&void 0!==n?n:[],...r]}}return e.children?{...e,children:ex(e.children,t,r)}:e}),eb=(e,t,r)=>e.map(e=>e.key===t?{...e,children:r}:e.children?{...e,children:eb(e.children,t,r)}:e),eE=(e,t,r)=>e.map(e=>{if(e.key===t){var l;let t=(null!==(l=e.children)&&void 0!==l?l:[]).filter(e=>!(e.key.toString().startsWith(U)||e.key.toString().startsWith(P))),n=new Map(r.map(e=>[e.key,e])),i=new Map(t.map(e=>[e.key,e])),a=t.map(e=>{let t=n.get(e.key);return null!=t?t:e});return r.forEach(e=>{i.has(e.key)||a.push(e)}),{...e,children:a}}return e.children?{...e,children:eE(e.children,t,r)}:e}),ek=(0,h.forwardRef)((e,t)=>{let{setSelectedNodeKeys:r,selectedNodeKeys:i,nodeActions:a,primaryAction:s}=e,o=(0,f.useRouter)(),{errorAlert:c}=(0,m.VY)(),d=decodeURIComponent(o.query.monitorId),[u]=(0,x.RV)(),[p]=(0,x.M8)(),[g,y]=(0,h.useState)({}),[v,_]=(0,h.useState)([]),[b,E]=(0,h.useState)([]),k=(0,h.useRef)({}),T=(0,h.useRef)({}),S=(0,h.useCallback)(async e=>{var t;let{nodeKey:r,queryParams:l,fastUpdateFn:n,detailedUpdateFn:i}=e,a=(null!==(t=k.current[r])&&void 0!==t?t:0)+1;k.current[r]=a;let s=u({...l,include_descendant_details:!1}),o=u({...l,include_descendant_details:!0});s.then(e=>{let{data:t}=e;t&&k.current[r]===a&&T.current[r]!==a&&n(t)}),o.then(e=>{let{data:t}=e;t&&k.current[r]===a&&(T.current[r]=a,(null!=i?i:n)(t))})},[u]),A=(0,h.useCallback)(e=>new Promise(t=>{let{children:r,key:l}=e;if(r){t();return}let n=l.toString();S({nodeKey:n,queryParams:{monitor_config_id:d,staged_resource_urn:n,size:100},fastUpdateFn:e=>{_(t=>eb(t,l,e_(e,n))),y(e=>({...e,[n]:{pageSize:100,pageIndex:1}}))}}),t()}),[S,d]),j=(0,h.useCallback)(e=>{let t=g[e];t&&(_(t=>ex(t,e,[...Array(100)].map((t,r)=>({key:"".concat(P,"-").concat(e,"-").concat(r),title:"SKELETON",isLeaf:!0})))),S({nodeKey:e,queryParams:{monitor_config_id:d,staged_resource_urn:e,size:100,page:t.pageIndex+1},fastUpdateFn:t=>{_(r=>ex(r,e,e_(t,e)))},detailedUpdateFn:t=>{_(r=>eE(r,e,e_(t,e))),y(t=>{var r,l;return{...t,[e]:{pageSize:100,pageIndex:(null!==(l=null===(r=t[e])||void 0===r?void 0:r.pageIndex)&&void 0!==l?l:0)+1}}})}}))},[g,S,d]),C=(0,h.useCallback)(e=>{_(t=>{let r=ev(t,e),l=[e];return r&&l.push(...ey(r)),E(e=>e.filter(e=>!l.includes(e.toString()))),y(e=>{let t={...e};return l.forEach(e=>{delete t[e]}),t}),l.forEach(e=>{delete k.current[e],delete T.current[e]}),eg(t,e)})},[]),R=(0,h.useCallback)(async e=>{let t=async e=>{try{let t=await p({monitor_config_id:d,...e&&{staged_resource_urn:e}});if(t.error){c((0,eo.e$)(t.error),"Failed to get schema explorer ancestors statuses");return}let r=t.data;if(!r)return;e?C(e):r.forEach(e=>{C(e.urn)}),_(e=>r.reduce((e,t)=>eh(e,t.urn,t.update_status,t.diff_status),e))}catch(e){c("An unexpected error occurred while refreshing the schema explorer")}};if(0===e.length){await t();return}await Promise.all(e.map(e=>t(e)))},[p,d,C,c]),D=(0,h.useCallback)((e,t)=>{E(e),t.expanded&&!t.node.children&&A&&A(t.node)},[A]);return(0,h.useImperativeHandle)(t,()=>({refreshResourcesAndAncestors:R})),(0,h.useEffect)(()=>{(async()=>{v.length>0||S({nodeKey:"root",queryParams:{monitor_config_id:d,size:100},fastUpdateFn:e=>{_(e_(e))}})})()},[S,d,_,v.length]),(0,l.jsxs)(n.kCb,{gap:"middle",vertical:!0,className:"h-full",children:[(0,l.jsx)(n.Dxz,{level:3,className:"sticky top-0",ellipsis:!0,children:"Schema explorer"}),(0,l.jsx)(n.mpN.DirectoryTree,{loadData:A,treeData:v,expandedKeys:b,onExpand:D,onSelect:e=>{r(e)},showIcon:!0,showLine:!0,blockNode:!0,multiple:!0,rootClassName:"h-full overflow-x-hidden ".concat(ed()["monitor-tree"]," group/monitor-tree ").concat(i.length>1?"multi-select":""),expandAction:"doubleClick",titleRender:e=>(0,l.jsx)(ef,{node:e,treeData:v,onLoadMore:j,actions:a})}),i.length>0&&(0,l.jsxs)(n.kCb,{justify:"space-between",align:"center",gap:"small",children:[(0,l.jsx)(n.zxk,{"aria-label":"Classify ".concat(i.length," Selected Nodes"),icon:(0,l.jsx)(n.QMR,{size:12}),size:"small",onClick:()=>{var e;return null===(e=a[s])||void 0===e?void 0:e.callback(i,i.flatMap(e=>{let t=ev(v,e.toString());return t?[t]:[]}))},className:"flex-none"}),(0,l.jsx)(n.xvT,{ellipsis:!0,children:"".concat(i.length," ").concat((0,I._6)(i.length,"resource","resources")," selected")}),(0,l.jsx)(n.Ltx,{menu:{items:a?Object.entries(a).map(e=>{let[t,{label:r,disabled:l}]=e;return{key:t,label:r,disabled:l(i.flatMap(e=>{let t=ev(v,e.toString());return t?[t]:[]}))}}):[],onClick:e=>{var t;let{key:r,domEvent:l}=e;l.preventDefault(),l.stopPropagation(),null===(t=a[r])||void 0===t||t.callback(i,i.flatMap(e=>{let t=ev(v,e.toString());return t?[t]:[]}))}},destroyOnHidden:!0,className:"group mr-1 flex-none",children:(0,l.jsx)(n.zxk,{"aria-label":"Show More Resource Actions",icon:(0,l.jsx)(n.PJP.r43,{}),size:"small",className:"self-end"})})]})]})});ek.displayName="MonitorTree";var eT=r(12627),eS=r(84418);let eA=(e,t)=>(0,l.jsx)(t,{...e,className:"!sticky top-0 z-[2] bg-white"}),ej=e=>{var t;let{resource:r,fieldActions:i,...a}=e,s=(0,h.useMemo)(()=>{var e;if(!(null==r?void 0:r.classifications))return[];let t="preferred_data_categories"in r&&null!==(e=r.preferred_data_categories)&&void 0!==e?e:[];return r.classifications.filter(e=>t.includes(e.label))},[r]);return(0,l.jsx)(eS.d,{...a,classNames:{body:"!pt-0 !mt-[var(--ant-padding-lg)] max-h-full"},children:r?(0,l.jsx)(n.mQc,{defaultActiveKey:"details",renderTabBar:eA,items:[{key:"details",label:"Details",children:(0,l.jsxs)(n.kCb,{gap:"middle",vertical:!0,children:[(0,l.jsx)(n.w5n,{bordered:!0,size:"small",column:1,items:[..."system_key"in r&&r.system_key?[{key:"system",label:"System",children:r.system_key}]:[],{key:"path",label:"Path",children:r.urn},{key:"data-type",label:"Data type",children:"source_data_type"in r?r.source_data_type:void 0},{key:"description",label:"Description",children:r.description}]}),(0,l.jsx)(n.l09,{layout:"vertical",children:(0,l.jsx)(n.l09.Item,{label:"Data categories",children:(0,l.jsx)(eT.Z,{variant:"outlined",mode:"multiple",maxTagCount:"responsive",value:"preferred_data_categories"in r?r.preferred_data_categories:[],autoFocus:!1,disabled:null==r||!r.diff_status||!k.$k["assign-categories"].some(e=>e===r.diff_status),onChange:e=>i["assign-categories"]([r.urn],!0,{user_assigned_data_categories:e})})})}),s.length>0&&(0,l.jsx)(n.aVo,{"data-testid":"classifications-reasoning-list",dataSource:s,renderItem:e=>{let t=e.confidence_bucket?(0,en.Oq)(e.confidence_bucket):void 0;return(0,l.jsx)(n.aVo.Item,{children:(0,l.jsx)(n.aVo.Item.Meta,{avatar:(0,l.jsx)(n.qEK,{icon:(0,l.jsx)(n.QMR,{color:"black"})}),title:(0,l.jsxs)(n.kCb,{align:"center",gap:"middle",children:[(0,l.jsx)("div",{children:e.label}),t&&(0,l.jsx)(K.D,{severity:t})]}),description:e.rationale})})}})]})},{key:"activity",label:"Activity",children:(0,l.jsx)(n.aVo,{dataSource:"errors"in r&&r.errors?null===(t=r.errors)||void 0===t?void 0:t.map((e,t)=>({key:t,title:e.phase,description:new Date(e.timestamp).toLocaleString(),content:e.message})):[],renderItem:(e,t)=>(0,l.jsxs)(n.aVo.Item,{children:[(0,l.jsx)(n.aVo.Item.Meta,{title:e.title,description:e.description}),(0,l.jsx)(n.nvN,{ellipsis:{expandable:"collapsible",rows:3},copyable:{icon:(0,l.jsx)(n.PJP.CKM,{className:"pt-1",size:18})},children:e.content})]},t),itemLayout:"vertical"})}]}):null})};var eC=r(31883);let eR=(e,t)=>{let[r]=(0,C.rL)(),l=(0,n.UD8)(),i=(0,n.ddY)(),a=n=>async(a,s,o)=>{if(!e)return;let c=Date.now();if(!await i.confirm((0,en.nB)(k.Me[n],k.e_[n](o))))return;l.open({key:c,type:"loading",content:"".concat(k.T0[n]," ").concat(o," ").concat((0,I._6)(o,"resource","resources"),"..."),duration:0});let d=await r({query:{...a.query},path:{monitor_config_id:e,action_type:n},body:{excluded_resource_urns:s}});if((0,eC.D4)(d)){l.open({key:c,type:"error",content:(0,en.v_)(n),duration:5});return}if(l.open({key:c,type:"success",content:(0,en.NM)(n,o),duration:5}),t&&n!==E.FieldActionType.REVIEW){let e=a.query.staged_resource_urn||[];await t(e)}};return{"assign-categories":a(E.FieldActionType.ASSIGN_CATEGORIES),"promote-removals":a(E.FieldActionType.PROMOTE_REMOVALS),"un-review":a(E.FieldActionType.UN_REVIEW),"un-mute":a(E.FieldActionType.UN_MUTE),review:a(E.FieldActionType.REVIEW),classify:a(E.FieldActionType.CLASSIFY),mute:a(E.FieldActionType.MUTE),promote:a(E.FieldActionType.PROMOTE)}},eD={DRAWER_OPEN:".ant-drawer-open",DRAWER_SELECT:".ant-drawer-open .ant-select",SELECT:".ant-select",SELECT_SELECTOR:".ant-select-selector",SELECT_DISABLED:"ant-select-disabled",INPUT:"input",LIST_ITEM_SELECT:"[data-classification-select]"},eI=(e,t,r,l,i,a)=>{let s=(0,n.UD8)(),o=e=>{let t=e.querySelector(eD.SELECT_SELECTOR);if(!t)return!1;if(e.classList.contains(eD.SELECT_DISABLED))return s.warning("You cannot assign categories to this resource in its current state"),!1;let r=new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(r);let l=e.querySelector(eD.INPUT);return l&&l.focus(),!0},c=r=>{var l;e&&(e.diff_status&&(null===(l=k.$k[r])||void 0===l?void 0:l.includes(e.diff_status))?t[r]([e.urn]):s.warning(k.Z8[r]))};(0,g.y1)(k.b_.REVIEW,()=>c(E.FieldActionType.REVIEW),[e,t]),(0,g.y1)(k.b_.PROMOTE,()=>c(E.FieldActionType.PROMOTE),[e,t]),(0,g.y1)(k.b_.MUTE,()=>c(E.FieldActionType.MUTE),[e,t]),(0,g.y1)(k.b_.UN_MUTE,()=>c(E.FieldActionType.UN_MUTE),[e,t]),(0,g.y1)(k.b_.REFRESH,()=>a(),[a]),(0,g.y1)(k.b_.TOGGLE_DRAWER,()=>{e&&i?l(void 0):e&&!i&&l(e.urn)},[e,l,i]),(0,g.y1)(k.b_.OPEN_CLASSIFICATION_SELECT,t=>{if(t.preventDefault(),!e)return;let r=null;if(i){let e=document.querySelector(eD.DRAWER_OPEN);e&&(r=e.querySelector(eD.SELECT))}else{let t=CSS.escape(e.urn);r=document.querySelector('[data-classification-select="'.concat(t,'"]'))}r&&o(r)},[e,s,i]),(0,g.y1)("escape",e=>{let t=document.activeElement;if((null==t?void 0:t.tagName)!=="INPUT")return;let r=t.closest(eD.LIST_ITEM_SELECT),l=t.closest(eD.DRAWER_SELECT);(r||l)&&(e.preventDefault(),e.stopPropagation(),t.blur())},{enableOnFormTags:["INPUT"]},[i])};var eM=r(70675);let ew=e=>{let[t,...r]=e.map(e=>Object.values(E.FieldActionType).flatMap(t=>k.$k[t].some(t=>t===e)?[t]:[]));return r.reduce((e,t)=>d().intersection(e,[...t]),null!=t?t:[])},eN=(e,t)=>{let[r]=(0,eM.qb)(),[l]=(0,x.Av)(),[i]=(0,eM.zV)(),[a]=(0,eM.Hf)(),[s]=(0,eM._J)(),[o]=(0,eM.NA)(),[c]=(0,x.n7)(),d=(0,n.UD8)(),u=(0,n.ddY)(),p=(e,r)=>async function(l){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2?arguments[2]:void 0,a=Date.now();if(!(1===l.length&&n||await u.confirm((0,en.nB)(k.Me[e],k.e_[e](l.length)))))return;d.open({key:a,type:"loading",content:"".concat(k.T0[e]," ").concat(l.length," ").concat((0,I._6)(l.length,"resource","resources"),"..."),duration:0});let s=await r(l,i);if((0,eC.D4)(s)){d.open({key:a,type:"error",content:(0,en.v_)(e),duration:5});return}d.open({key:a,type:"success",content:(0,en.NM)(e,l.length),duration:5}),e!==E.FieldActionType.PROMOTE_REMOVALS&&t&&await t(l)},f=async e=>i({staged_resource_urns:e}),h=async e=>s({staged_resource_urns:e}),g=async e=>a({staged_resource_urns:e}),y=async t=>l({monitor_config_key:e,staged_resource_urns:t}),v=async(t,r)=>{var l;let[n]=t;return o({monitor_config_id:e,staged_resource_urn:n,user_assigned_data_categories:null!==(l=null==r?void 0:r.user_assigned_data_categories)&&void 0!==l?l:void 0})},m=async t=>r({monitor_config_key:e,staged_resource_urns:t}),_=async t=>c({monitor_config_key:e,staged_resource_urns:t});return{"assign-categories":p(E.FieldActionType.ASSIGN_CATEGORIES,v),"promote-removals":p(E.FieldActionType.PROMOTE_REMOVALS,_),"un-review":()=>{},"un-mute":p(E.FieldActionType.UN_MUTE,h),review:p(E.FieldActionType.REVIEW,m),classify:p(E.FieldActionType.CLASSIFY,y),mute:p(E.FieldActionType.MUTE,f),promote:p(E.FieldActionType.PROMOTE,g)}};var eL=r(40431);let eO=()=>{let[e,t]=(0,eL.v1)("resourceStatus",(0,eL.S$)((0,eL.km)(z)).withDefault($)),[r,l]=(0,eL.v1)("confidenceBucket",(0,eL.S$)((0,eL.km)(Object.values(L.$)))),[n,i]=(0,eL.v1)("dataCategory",(0,eL.S$)(eL.Oi));return{resourceStatus:e,setResourceStatus:t,confidenceBucket:r,setConfidenceBucket:l,dataCategory:n,setDataCategory:i,reset:()=>{t([]),l([]),i([])},resetToInitialState:()=>{t($),l(null),i(null)}}},eF=e=>new Map(e.map(e=>[e.key,e])),eU=(e,t)=>d()([...new Map([...e,...t]).entries()]).map(t=>{let[r,l]=t;return d().chain(e.get(r)).defaultTo(l).cloneDeep().merge(l).value()}).thru(eF).value();var eP=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],[t,r]=(0,h.useState)(new Map);return{nodes:t,update:l=>{let n=e?eU(t,l):l;d()([...n.entries()]).some(e=>{let[r,l]=e;return!d().isEqual(t.get(r),l)})&&r(e=>new Map([...e,...l]))},reset:()=>{r(new Map)}}},ez=(e,t)=>{var r,l;let n=(0,C.Fp)(e),i=(0,x.IC)(t,{skip:!t.stagedResourceUrn}),{update:a,nodes:s,reset:o}=eP();return(null===(r=n.data)||void 0===r?void 0:r.items)&&a(eF(n.data.items.map(e=>({key:e.urn,...e})))),{listQuery:{...n,nodes:d().chain(null===(l=n.data)||void 0===l?void 0:l.items).defaultTo([]).flatMap(e=>d().chain(s.get(e.urn)).thru(e=>e?[e]:[]).value()).thru(eF).value(),refetch:()=>{o(),n.refetch()}},detailsQuery:{...i,node:t.stagedResourceUrn?s.get(t.stagedResourceUrn):void 0,refetch:()=>{o(),i.refetch()}},nodes:s}};let eV=e=>Object.values(b.LL).flatMap(t=>q[t].label===e?[t]:[]);var e$=e=>{var t,r,i,a,o,c,u,T;let{monitorId:S}=e,R=(0,f.useRouter)(),D=(0,h.useRef)(null),[I,M]=(0,h.useState)(!1),{paginationProps:w,pageIndex:N,pageSize:L,resetPagination:O}=(0,_.S)({defaultPageSize:25}),F=(0,m.Rx)(),{resourceStatus:U,confidenceBucket:P,dataCategory:z,...$}=eO(),{data:W}=(0,x.vc)({monitor_config_id:S}),[G,H]=(0,h.useState)([]),J={path:{monitor_config_id:S},query:{staged_resource_urn:G.map(e=>e.toString()),search:F.searchProps.value,diff_status:U?U.flatMap(eV):void 0,confidence_bucket:P||void 0,data_category:z||void 0}},[B,K]=(0,h.useState)(),[Q,Z]=(0,h.useState)(),[X,ee]=(0,h.useState)(null),[et,{data:er,isFetching:el}]=(0,C.Nz)(),en=eR(S,async e=>{var t;await (null===(t=D.current)||void 0===t?void 0:t.refreshResourcesAndAncestors(e))}),ei=eN(S,async e=>{var t;await (null===(t=D.current)||void 0===t?void 0:t.refreshResourcesAndAncestors(e))}),{listQuery:{nodes:ea,...eo},detailsQuery:{data:ec},nodes:ed}=ez({...J,query:{...J.query,size:L,page:N}},{stagedResourceUrn:B}),{excludedKeys:eu,listSelectMode:ep,resetListSelect:ef,selectedKeys:eh,updateSelectedListItem:eg,checkboxProps:ey}=A(Array.from(ea.keys()),{activeListItem:Q?{...Q,key:null==Q?void 0:Q.key.toString()}:void 0,enableKeyboardShortcuts:!0}),ev=async e=>{if((null==Q?void 0:Q.urn)&&e&&X){let t=[...ea.values()].findIndex(t=>t.urn===e);-1!==t&&X(t)}K(e)};(0,g.y1)("?",()=>M(!I),{useKey:!0},[I]);let em="exclusive"===ep?null==er?void 0:er.allowed_actions:ew(eh.flatMap(e=>{let t=ed.get(e);return(null==t?void 0:t.diff_status)?[t.diff_status]:[]})),e_=null!==(c=null===(t=eo.data)||void 0===t?void 0:t.total)&&void 0!==c?c:0,ex="exclusive"===ep&&(null===(r=eo.data)||void 0===r?void 0:r.total)?e_-eu.length:eh.length;return((0,h.useEffect)(()=>{O(),ef()},[U,P,G,F.searchQuery,z]),eI(Q,ei,eg,ev,!!B,()=>eo.refetch()),eo.error)?(0,l.jsx)(v.Z,{error:eo.error,defaultMessage:"A problem occurred while fetching your monitor results"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.qX1,{className:"h-[calc(100%-48px)] overflow-hidden",children:[(0,l.jsx)(n.qX1.Panel,{defaultSize:250,style:{paddingRight:"var(--ant-padding-md)"},children:(0,l.jsx)(ek,{ref:D,setSelectedNodeKeys:H,selectedNodeKeys:G,primaryAction:E.FieldActionType.CLASSIFY,nodeActions:Object.fromEntries(k.km.map(e=>[e,{label:k.Me[e],disabled:t=>d()(t).map(t=>(e!==E.FieldActionType.PROMOTE_REMOVALS||t.status!==b.Ag.REMOVAL)&&(e!==E.FieldActionType.CLASSIFY||!t.classifyable||t.diffStatus===b.LL.MUTED)&&(e!==E.FieldActionType.MUTE||t.diffStatus===b.LL.MUTED)&&(e!==E.FieldActionType.UN_MUTE||t.diffStatus!==b.LL.MUTED)).some(e=>!0===e),callback:t=>{ei[e](t,!1)}}]))})}),(0,l.jsx)(n.qX1.Panel,{style:{paddingLeft:"var(--ant-padding-md)",overflow:"hidden"},children:(0,l.jsxs)(n.kCb,{vertical:!0,gap:"middle",className:"h-full",children:[(0,l.jsxs)(n.kCb,{justify:"space-between",children:[(0,l.jsx)(n.Dxz,{level:2,ellipsis:!0,children:"Monitor results"}),(0,l.jsx)(n.kCb,{align:"center",children:(null==W?void 0:W.last_monitored)&&(0,l.jsxs)(n.xvT,{type:"secondary",children:["Last scan:"," ",new Date(null==W?void 0:W.last_monitored).toLocaleString()]})})]}),(0,l.jsxs)(n.kCb,{justify:"space-between",wrap:"wrap",gap:"small",children:[(0,l.jsxs)(n.kCb,{gap:"small",children:[(0,l.jsx)(y.f,{value:F.searchQuery,onChange:F.updateSearch,placeholder:"Search"}),(0,l.jsx)(n.ua7,{title:"Display keyboard shortcuts",children:(0,l.jsx)(n.zxk,{"aria-label":"Display keyboard shortcuts",icon:(0,l.jsx)(n.PJP.N1d,{}),onClick:()=>M(!0)})})]}),(0,l.jsxs)(n.kCb,{gap:"small",children:[(0,l.jsx)(Y,{resourceStatus:U,confidenceBucket:P,dataCategory:z,...$,monitorId:S,stagedResourceUrn:G.map(e=>e.toString())}),(0,l.jsx)(n.Ltx,{onOpenChange:e=>{e&&"exclusive"===ep&&et({...J,query:{...J.query},body:{excluded_resource_urns:eu.map(e=>e.toString())}})},menu:{items:[...k.aK.map(e=>({key:e,label:!el&&(null==em?void 0:em.includes(e))?k.Me[e]:(0,l.jsx)(n.ua7,{title:k.Z8[e],children:k.Me[e]}),disabled:el||!(null==em?void 0:em.includes(e)),onClick:async()=>{"exclusive"===ep?await en[e](J,eu.map(e=>e.toString()),ex):await ei[e](eh.map(e=>e.toString())),ef()}}))]},disabled:eh.length<=0,children:(0,l.jsx)(n.zxk,{type:"primary",icon:(0,l.jsx)(n.PJP._ME,{}),iconPosition:"end",loading:el,children:"Actions"})}),(0,l.jsx)(n.ua7,{title:"Refresh",children:(0,l.jsx)(n.zxk,{icon:(0,l.jsx)(n.PJP.CQM,{}),onClick:()=>eo.refetch(),"aria-label":"Refresh"})})]})]}),(0,l.jsxs)(n.kCb,{gap:"middle",align:"center",children:[(0,l.jsx)(n.XZJ,{id:"select-all",...ey}),(0,l.jsx)("label",{htmlFor:"select-all",children:"Select all"}),!!ex&&(0,l.jsxs)(n.xvT,{strong:!0,children:[ex.toLocaleString()," selected"]})]}),(0,l.jsx)(n.aVo,{dataSource:[...ea.values()],className:"-ml-3 h-full overflow-y-scroll pl-1",loading:eo.isFetching,enableKeyboardShortcuts:!0,locale:!F.searchProps.value&&d()(U).intersection(V).isEmpty()?{emptyText:(0,l.jsx)(n.HYy,{image:n.HYy.PRESENTED_IMAGE_SIMPLE,description:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{children:"All resources have been either approved or ignored."}),(0,l.jsx)("div",{children:"Approved resources can be found in the manage datasets view."}),(0,l.jsx)("div",{children:"To see ignored resources, adjust your filters."})]}),children:(0,l.jsxs)(n.kCb,{gap:"middle",justify:"center",children:[(0,l.jsx)(p(),{href:s.$m,passHref:!0,legacyBehavior:!0,children:(0,l.jsx)(n.zxk,{children:"Manage datasets view"})}),(0,l.jsx)(n.zxk,{type:"primary","aria-label":"Refresh page",onClick:()=>{$.resetToInitialState(),R.reload()},children:"Refresh page"})]})})}:void 0,onActiveItemChange:(e,t,r)=>{ee(()=>r),(null==e?void 0:e.urn)?(Z({...e,key:e.urn}),B&&e.urn!==B&&K(e.urn)):Z(void 0)},renderItem:e=>es({...e,selected:eh.includes(e.urn),onSelect:eg,onNavigate:ev,onSetDataCategories:(e,t)=>ei["assign-categories"]([e],!0,{user_assigned_data_categories:t}),dataCategoriesDisabled:null==e||!e.diff_status||!k.$k["assign-categories"].some(t=>t===e.diff_status),actions:(null==e?void 0:e.diff_status)?k.Vr[e.diff_status].map(t=>(0,l.jsx)(n.ua7,{title:k.Me[t],children:(0,l.jsx)(n.zxk,{"aria-label":k.Me[t],icon:k.W3[t],onClick:()=>ei[t]([e.urn]),disabled:null==e||!e.diff_status||!k.$k[t].some(t=>t===e.diff_status),style:{fontSize:"var(--ant-button-content-font-size-lg)"}})},t)):[]})}),(0,l.jsx)(n.tlE,{...w,showSizeChanger:{suffixIcon:(0,l.jsx)(n.PJP._ME,{})},total:(null===(i=eo.data)||void 0===i?void 0:i.total)||0,hideOnSinglePage:(null===(a=w.pageSize)||void 0===a?void 0:a.toString())===(null===(o=w.pageSizeOptions)||void 0===o?void 0:o[0])})]})})]}),(0,l.jsx)(ej,{itemKey:null!==(u=null==ec?void 0:ec.urn)&&void 0!==u?u:"",title:null!==(T=null==ec?void 0:ec.name)&&void 0!==T?T:null,titleIcon:(0,l.jsx)(n.PJP.sgG,{}),titleTag:{bordered:!1,color:(null==ec?void 0:ec.diff_status)?q[ec.diff_status].color:void 0,className:"font-normal text-[var(--ant-font-size-sm)]",children:(null==ec?void 0:ec.diff_status)?q[ec.diff_status].label:null},actions:((null==ec?void 0:ec.diff_status)?k.Zu[ec.diff_status]:k.sB).map(e=>({label:k.Me[e],callback:t=>ei[e]([t]),disabled:null==ec||!ec.diff_status||!k.$k[e].some(e=>e===ec.diff_status)})),open:!!B,onClose:()=>K(void 0),resource:ec,fieldActions:ei,mask:!Q}),(0,l.jsx)(j,{open:I,onCancel:()=>M(!1)})]})},eq=r(15878);let eW={[eq.em.ACTIVITY]:s.CR,[eq.em.ATTENTION_REQUIRED]:s.ic},eG="Attempting to access monitor results without the required feature flag enabled";var eH=()=>{let{flags:{heliosV2:e}}=(0,a.hz)(),t=(0,i.useParams)(),r=(null==t?void 0:t.monitorId)?decodeURIComponent(t.monitorId):void 0,s=!r,c=!e&&eG;return c?(0,l.jsx)(n.x4B,{status:"error",title:c}):(0,l.jsx)(o.Z,{monitorId:r,routeConfig:eW,children:s?null:(0,l.jsx)(e$,{monitorId:r})})}},72707:function(e){e.exports={option:"TaxonomySelect_option__vY6v2"}},97947:function(e){e.exports={"monitor-field__title":"MonitorFieldListItem_monitor-field__title__YrxOU","monitor-field__breadcrumb":"MonitorFieldListItem_monitor-field__breadcrumb__Rn4vE"}},32500:function(e){e.exports={"monitor-tree":"MonitorTree_monitor-tree__QKz6T"}}}]);