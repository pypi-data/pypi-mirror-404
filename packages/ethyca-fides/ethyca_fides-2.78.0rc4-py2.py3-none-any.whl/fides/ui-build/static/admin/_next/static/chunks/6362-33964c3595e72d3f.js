"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6362],{97181:function(e,t,i){i.d(t,{d:function(){return d}});var n=i(24246),s=i(36010),r=i(34090),a=i(27378),l=i(46238),o=i(40324);let d=e=>{let{name:t,label:i,labelProps:d,tooltip:c,isRequired:u,layout:h="inline",helperText:m,...x}=e,[p,f,{setValue:g}]=(0,r.U$)(t),j=!!(f.touched&&f.error),[y,v]=(0,a.useState)("");p.value||"tags"!==x.mode&&"multiple"!==x.mode||(p.value=[]),"tags"===x.mode&&"string"==typeof p.value&&(p.value=[p.value]);let b="tags"===x.mode?(e,t)=>e?e.value!==y||p.value.includes(y)?x.optionRender?x.optionRender(e,t):e.label:'Create "'.concat(y,'"'):void 0:x.optionRender||void 0,_=e=>{v(e),x.onSearch&&x.onSearch(e)},k=(e,t)=>{g(e),x.onChange&&x.onChange(e,t)};return"inline"===h?(0,n.jsx)(s.DTt,{isInvalid:j,isRequired:u,children:(0,n.jsxs)(s.MoG,{templateColumns:i?"1fr 3fr":"1fr",children:[i?(0,n.jsx)(o.__,{htmlFor:x.id||t,...d,children:i}):null,(0,n.jsxs)(s.kCb,{align:"center",children:[(0,n.jsxs)(s.kCb,{vertical:!0,flex:1,className:"mr-2",children:[(0,n.jsx)(s.PhF,{...p,id:x.id||t,"data-testid":"controlled-select-".concat(p.name),...x,optionRender:b,onSearch:"tags"===x.mode?_:void 0,onChange:k,value:p.value||void 0,status:j?"error":void 0}),m&&(0,n.jsx)(s.Kug,{children:m}),(0,n.jsx)(o.Bc,{isInvalid:j,message:f.error,fieldName:p.name})]}),(0,n.jsx)(l.b,{label:c,className:j?"mt-2 self-start":void 0})]})]})}):(0,n.jsx)(s.DTt,{isInvalid:j,isRequired:u,children:(0,n.jsxs)(s.s_g,{alignItems:"start",children:[(0,n.jsxs)(s.kCb,{align:"center",children:[i?(0,n.jsx)(o.__,{htmlFor:x.id||t,fontSize:"xs",my:0,mr:1,...d,children:i}):null,(0,n.jsx)(l.b,{label:c})]}),(0,n.jsx)(s.PhF,{...p,id:x.id||t,"data-testid":"controlled-select-".concat(p.name),...x,optionRender:b,onSearch:"tags"===x.mode?_:void 0,onChange:k,value:p.value||void 0,status:j?"error":void 0}),m&&(0,n.jsx)(s.Kug,{style:{marginTop:0},children:m}),(0,n.jsx)(o.Bc,{isInvalid:j,message:f.error,fieldName:p.name})]})})}},46782:function(e,t,i){i.d(t,{j:function(){return r},l:function(){return a}});var n=i(30454),s=i.n(n);let r="#/definitions/FidesDatasetReference",a=e=>{let t=(e,t,i)=>{let n;return(void 0===t||""===t||void 0===t)&&(n="".concat(e," is required")),i===r&&((null==t?void 0:t.includes("."))?t.split(".").length<3&&(n="Dataset reference must include at least three parts"):n="Dataset reference must be dot delimited"),n},i=t=>{var i,n;return null!==(n=null==e?void 0:null===(i=e.required)||void 0===i?void 0:i.includes(t))&&void 0!==n&&n};return{validateField:t,isRequiredField:i,getFieldValidation:(e,n)=>{if(i(e))return e=>{var i;return t(n.title,e,null===(i=n.allOf)||void 0===i?void 0:i[0].$ref)}},preprocessValues:t=>{let i=s()(t);return e&&Object.keys(e.properties).forEach(t=>{var n,s;if((null===(n=e.properties[t].allOf)||void 0===n?void 0:n[0].$ref)===r){let e=null===(s=i.secrets[t])||void 0===s?void 0:s.split(".");e&&(i.secrets[t]={dataset:e.shift(),field:e.join("."),direction:"from"})}"WebsiteSchema"!==e.title||"URL"!==e.properties[t].title||i.secrets[t].startsWith("http://")||i.secrets[t].startsWith("https://")||(i.secrets[t]="https://".concat(i.secrets[t])),"integer"===e.properties[t].type&&"string"==typeof i.secrets[t]&&""===i.secrets[t].trim()&&(i.secrets[t]=void 0)}),i}}}},39715:function(e,t,i){var n=i(24246),s=i(36010);i(27378),t.Z=e=>{let{isEmptyState:t,yamlError:i}=e;return(0,n.jsxs)(s.TJV,{w:"fit-content",bg:"white",p:3,borderRadius:3,children:[(0,n.jsxs)(s.Br$,{children:[(0,n.jsx)(s.y_b,{as:"h5",color:"gray.700",size:"xs",children:"YAML"}),(0,n.jsx)(s.hw$,{colorScheme:"red",size:"sm",variant:"solid",children:"Error"})]}),(0,n.jsx)(s.TJV,{bg:"red.50",border:"1px solid",borderColor:"red.300",color:"red.300",mt:"16px",borderRadius:"6px",children:(0,n.jsxs)(s.Br$,{alignItems:"flex-start",margin:["14px","17px","14px","17px"],children:[(0,n.jsx)(s.f9v,{}),t&&(0,n.jsxs)(s.TJV,{children:[(0,n.jsx)(s.y_b,{as:"h5",color:"red.500",fontWeight:"semibold",size:"xs",children:"Error message:"}),(0,n.jsx)(s.Bjg,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:"Yaml system is required"})]}),i&&(0,n.jsxs)(s.TJV,{children:[(0,n.jsx)(s.y_b,{as:"h5",color:"red.500",fontWeight:"semibold",size:"xs",children:"Error message:"}),(0,n.jsx)(s.Bjg,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:i.message}),(0,n.jsx)(s.Bjg,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:i.reason}),(0,n.jsxs)(s.Bjg,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:["Ln ",(0,n.jsx)("b",{children:i.mark.line}),", Col"," ",(0,n.jsx)("b",{children:i.mark.column}),", Pos"," ",(0,n.jsx)("b",{children:i.mark.position})]})]})]})})]})}},41207:function(e,t,i){i.d(t,{F:function(){return a},M:function(){return r}});var n=i(76649),s=i(65218);let r=i.n(s)()(()=>i.e(7088).then(i.bind(i,57088)).then(e=>e.default),{loadableGenerated:{webpack:()=>[57088]},ssr:!1}),a=e=>(0,n.Ln)({name:"string"},e)&&"YAMLException"===e.name},1226:function(e,t,i){var n=i(24246);i(27378);var s=i(77213);t.Z=e=>{let{children:t}=e;return(0,n.jsx)(s.Z,{title:"Connections",children:t})}},11274:function(e,t,i){i.d(t,{s:function(){return F}});var n=i(24246),s=i(96356),r=i(36010),a=i(86677),l=i(27378),o=i(16134),d=i(77830),c=i(60240),u=i(17245),h=i(84306),m=i(14207),x=i(16125),p=i(33335),f=i(34090),g=i(46782),j=i(46238);let y=(e,t)=>{let i={...e};return Object.entries(t.properties).forEach(t=>{let[n,s]=t;if("integer"===s.type){let t=s.default?Number(s.default):e[n];i[n]=t||0}else{var r;let t=null!==(r=s.default)&&void 0!==r?r:e[n];i[n]=null!=t?t:null}}),i};var v=e=>{let{data:t,defaultValues:i,isSubmitting:a=!1,onSaveClick:d,onTestConnectionClick:h,testButtonLabel:x="Test integration"}=e,p=(0,l.useRef)(!1),{handleError:v}=(0,u.HK)(),{connection:b,connectionOption:_}=(0,o.C)(s.ZZ),[k,C]=(0,m.h2)(),S=e=>{let t;return(void 0===e||""===e)&&(t="Connection Identifier is required"),e&&(0,r.uQB)(e)&&(t="Connection Identifier must be an alphanumeric value"),t},w=(e,t,i)=>{let n;return(void 0===t||""===t)&&(n="".concat(e," is required")),i===g.j&&(t.includes(".")?t.split(".").length<3&&(n="Dataset reference must include at least three parts"):n="Dataset reference must be dot delimited"),n},T=(e,t)=>(0,n.jsx)(r.tLq,{color:"gray.900",fontSize:"14px",fontWeight:"semibold",htmlFor:e,minWidth:"150px",children:t}),z=e=>{var t;if((null===(t=e.allOf)||void 0===t?void 0:t[0].$ref)===g.j)return"Enter dataset.collection.field"},R=(e,i)=>{var s;return(0,n.jsx)(f.gN,{id:e,name:e,validate:(null!==(s=t.required)&&void 0!==s&&!!s.includes(e)||"integer"===i.type)&&(e=>{var t;return w(i.title,e,null===(t=i.allOf)||void 0===t?void 0:t[0].$ref)}),children:s=>{var a;let{field:l,form:o}=s;return(0,n.jsxs)(r.DTt,{display:"flex",isRequired:null===(a=t.required)||void 0===a?void 0:a.includes(e),isInvalid:o.errors[e]&&o.touched[e],children:[T(e,i.title),(0,n.jsxs)(r.s_g,{align:"flex-start",w:"inherit",children:["integer"!==i.type&&(0,n.jsx)(r.RVe,{...l,value:l.value||"",placeholder:z(i),autoComplete:"off",color:"gray.700",size:"sm"}),"integer"===i.type&&(0,n.jsxs)(r.UW0,{allowMouseWheel:!0,color:"gray.700",defaultValue:0,min:0,size:"sm",children:[(0,n.jsx)(r.v4G,{...l,autoComplete:"off"}),(0,n.jsxs)(r.eMw,{children:[(0,n.jsx)(r.tTI,{}),(0,n.jsx)(r.ey7,{})]})]}),(0,n.jsx)(r.eDG,{children:o.errors[e]})]}),(0,n.jsx)(r.ad9,{alignItems:"center",h:8,ml:2,children:(0,n.jsx)(j.b,{label:i.description})})]})}},e)},V=async()=>{try{await k(b.key).unwrap()}catch(e){v(e)}};return(0,l.useEffect)(()=>(p.current=!0,C.isSuccess&&h(C),()=>{p.current=!1}),[h,C]),(0,n.jsx)(f.J9,{enableReinitialize:!0,initialValues:(()=>{let e={...i};if(null==b?void 0:b.key){var n,s;e.name=null!==(s=b.name)&&void 0!==s?s:"",e.description=b.description,e.instance_key=b.connection_type===c.Rj.SAAS?null===(n=b.saas_config)||void 0===n?void 0:n.fides_key:b.key}return y(e,t)})(),onSubmit:(e,i)=>{let n={...e};Object.keys(t.properties).forEach(i=>{var s;if((null===(s=t.properties[i].allOf)||void 0===s?void 0:s[0].$ref)===g.j){let t=e[i].split(".");n[i]={dataset:t.shift(),field:t.join("."),direction:"from"}}}),d(n,i)},validateOnBlur:!1,validateOnChange:!1,children:e=>(0,n.jsx)(f.l0,{noValidate:!0,children:(0,n.jsxs)(r.s_g,{align:"stretch",gap:"16px",children:[(0,n.jsx)(f.gN,{id:"name",name:"name",validate:e=>w("Name",e),children:t=>{var i;let{field:s}=t;return(0,n.jsxs)(r.DTt,{display:"flex",isRequired:!0,isInvalid:!!(e.errors.name&&e.touched.name),children:[T("name","Name"),(0,n.jsxs)(r.s_g,{align:"flex-start",w:"inherit",mr:"6",children:[(0,n.jsx)(r.RVe,{...s,autoComplete:"off",autoFocus:!0,color:"gray.700",placeholder:"Enter a friendly name for your new ".concat(_.human_readable," connection"),size:"sm","data-testid":"input-name"}),(0,n.jsx)(r.eDG,{children:null===(i=e.errors.name)||void 0===i?void 0:i.toString()})]})]})}}),(0,n.jsx)(f.gN,{id:"description",name:"description",children:e=>{let{field:t}=e;return(0,n.jsxs)(r.DTt,{display:"flex",children:[T("description","Description"),(0,n.jsx)(r.$gm,{...t,color:"gray.700",placeholder:"Enter a description for your new ".concat(_.human_readable," connection"),resize:"none",size:"sm",value:t.value||"",mr:"6"})]})}}),(0,n.jsx)(f.gN,{id:"instance_key",name:"instance_key",validate:S,children:t=>{var i;let{field:s}=t;return(0,n.jsxs)(r.DTt,{display:"flex",isRequired:!0,isInvalid:!!(e.errors.instance_key&&e.touched.instance_key),children:[T("instance_key","Connection Identifier"),(0,n.jsxs)(r.s_g,{align:"flex-start",w:"inherit",children:[(0,n.jsx)(r.RVe,{...s,autoComplete:"off",color:"gray.700",isDisabled:!!(null==b?void 0:b.key),placeholder:"A unique identifier for your new ".concat(_.human_readable," connection"),size:"sm"}),(0,n.jsx)(r.eDG,{children:null===(i=e.errors.instance_key)||void 0===i?void 0:i.toString()})]}),(0,n.jsx)(r.ad9,{alignItems:"center",h:8,ml:2,children:(0,n.jsx)(j.b,{label:"The fides_key will allow fidesops to associate dataset field references appropriately. Must be a unique alphanumeric value with no spaces (underscores allowed) to represent this connection."})})]})}}),Object.entries(t.properties).map(e=>{let[t,i]=e;return"advanced_settings"===t?null:R(t,i)}),(0,n.jsxs)(r.ad9,{gap:2,children:[(0,n.jsx)(r.zxk,{disabled:!(null==b?void 0:b.key),loading:C.isLoading||C.isFetching,onClick:V,"data-testid":"test-connection-button",children:x}),(0,n.jsx)(r.zxk,{htmlType:"submit",type:"primary",disabled:a,loading:a,children:"Save"})]})]})})})};let b=e=>{let{onConnectionCreated:t,data:i}=e,r=(0,x.I0)(),{errorAlert:a,successAlert:d}=(0,h.V)(),{handleError:f}=(0,u.HK)(),[g,j]=(0,l.useState)(!1),{connection:y,connectionOption:v}=(0,o.C)(s.ZZ),[b]=(0,m.pH)(),[_]=(0,m.Du)();return{isSubmitting:g,handleSubmit:async e=>{try{var l;j(!0);let o={access:c.uv.WRITE,connection_type:null==v?void 0:v.identifier,description:e.description,disabled:!1,key:(0,p.E)(e.instance_key),name:e.name},u=await b(o).unwrap();if((null===(l=u.failed)||void 0===l?void 0:l.length)>0)a(u.failed[0].message);else{let l={connection_key:u.succeeded[0].key,secrets:{}};Object.entries(i.properties).forEach(t=>{l.secrets[t[0]]=e[t[0]]});let o=await _(l).unwrap();"failed"===o.test_status?a((0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("b",{children:"Message:"})," ",o.msg,(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"Failure Reason:"})," ",o.failure_reason]})):(r((0,s.lm)(u.succeeded[0])),d("Connector successfully ".concat((null==y?void 0:y.key)?"updated":"added","!")),(null==y?void 0:y.key)||!t||t())}}catch(e){f(e)}finally{j(!1)}},connectionOption:v}},_=e=>{let{data:t,onConnectionCreated:i,onTestConnectionClick:s}=e,{isSubmitting:a,handleSubmit:l,connectionOption:o}=b({onConnectionCreated:i,data:t});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.TJV,{color:"gray.700",fontSize:"14px",h:"80px",children:["Connect to your ",o.human_readable," environment by providing the information below. Once you have saved the form, you may test the integration to confirm that it's working correctly."]}),(0,n.jsx)(v,{data:t,defaultValues:{description:"",instance_key:"",name:""},isSubmitting:a,onSaveClick:l,onTestConnectionClick:s})]})},k={description:"",instance_key:"",name:""},C=e=>{let{data:t,onConnectionCreated:i,onTestEmail:s}=e,{connectionOption:a,isSubmitting:l,handleSubmit:o}=b({onConnectionCreated:i,data:t});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.TJV,{color:"gray.700",fontSize:"14px",h:"80px",children:["Configure your ",a.human_readable," connector by providing the connector name, description and a test email address. Once you have saved the details, you can click test email to check the format of the email."]}),(0,n.jsx)(v,{data:t,defaultValues:k,isSubmitting:l,onSaveClick:e=>{o(e)},onTestConnectionClick:s,testButtonLabel:"Test email"})]})};var S=i(55484),w=i(27259),T=i(67762),z=e=>{let{defaultValues:t,isSubmitting:i=!1,onSaveClick:l}=e,c=(0,a.useRouter)(),{connection:u,connectionOption:h}=(0,o.C)(s.ZZ);return(0,n.jsx)(f.J9,{initialValues:(()=>{if(null==u?void 0:u.key){var e;t.name=null!==(e=u.name)&&void 0!==e?e:"",t.description=u.description}return t})(),onSubmit:(e,t)=>{l(e,t)},validateOnBlur:!1,validateOnChange:!1,validationSchema:S.Ry().shape({name:S.Z_().required("Name is required")}),children:(0,n.jsx)(f.l0,{noValidate:!0,children:(0,n.jsxs)(r.s_g,{align:"stretch",gap:"16px",children:[(0,n.jsx)(w.Z,{autoFocus:!0,disabled:!!(null==u?void 0:u.key),isRequired:!0,label:"Name",name:"name",placeholder:"Enter a friendly name for your new ".concat(h.human_readable," connection")}),(0,n.jsx)(w.Z,{label:"Description",name:"description",placeholder:"Enter a description for your new ".concat(h.human_readable," connection"),type:"textarea"}),(0,n.jsx)(T.h,{isSubmitting:i,onCancelClick:()=>{c.push(d.JR)}})]})})})};let R=e=>{let{onConnectionCreated:t}=e,i=(0,x.I0)(),{errorAlert:a,successAlert:d}=(0,h.V)(),{handleError:p}=(0,u.HK)(),[f,g]=(0,l.useState)(!1),{connection:j,connectionOption:y}=(0,o.C)(s.ZZ),[v]=(0,m.pH)(),b=async(e,n)=>{try{var r;g(!0);let n={access:c.uv.WRITE,connection_type:null==y?void 0:y.identifier,description:e.description,disabled:!1,name:e.name,key:null==j?void 0:j.key},l=await v(n).unwrap();(null===(r=l.failed)||void 0===r?void 0:r.length)>0?a(l.failed[0].message):(i((0,s.lm)(l.succeeded[0])),d("Connector successfully ".concat((null==j?void 0:j.key)?"updated":"added","!")),(null==j?void 0:j.key)||!t||t())}catch(e){p(e)}finally{g(!1)}};return(0,n.jsxs)(r.s_g,{align:"stretch",gap:"16px",children:[(0,n.jsxs)(r.TJV,{color:"gray.700",fontSize:"14px",children:["To begin setting up your new ",y.human_readable," ","connector you must first assign a name to the connector and a description.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Once you have completed this section you can then progress onto"," ",(0,n.jsx)(r.Bjg,{display:"inline-block",fontWeight:"700",children:"DSR customization"})," ","using the menu on the left hand side."]}),(0,n.jsx)(z,{defaultValues:{description:"",name:""},isSubmitting:f,onSaveClick:b})]})},V=e=>{let{data:t,onConnectionCreated:i,onTestConnectionClick:a}=e,d=(0,x.I0)(),{errorAlert:f,successAlert:g}=(0,h.V)(),{handleError:j}=(0,u.HK)(),[y,b]=(0,l.useState)(!1),{connection:_,connectionOption:k}=(0,o.C)(s.ZZ),[C]=(0,m.pL)(),[S]=(0,m.pH)(),[w]=(0,m.Du)(),T=async(e,r)=>{try{if(b(!0),_){var a;let i={access:c.uv.WRITE,connection_type:_.connection_type,description:e.description,disabled:!1,key:_.key,name:e.name},r=await S(i).unwrap();if((null===(a=r.failed)||void 0===a?void 0:a.length)>0)f(r.failed[0].message);else{d((0,s.lm)(r.succeeded[0]));let i={connection_key:_.key,secrets:{}};Object.entries(t.properties).forEach(t=>{i.secrets[t[0]]=e[t[0]]});let a=await w(i).unwrap();"failed"===a.test_status?f((0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("b",{children:"Message:"})," ",a.msg,(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"Failure Reason:"})," ",a.failure_reason]})):g("Connector successfully updated!")}}else{let n={description:e.description,name:e.name,instance_key:(0,p.E)(e.instance_key),saas_connector_type:k.identifier,secrets:{}};Object.entries(t.properties).forEach(t=>{n.secrets[t[0]]=e[t[0]]});let r=await C(n).unwrap();d((0,s.lm)(r.connection)),g("Connector successfully added!"),null==i||i()}}catch(e){j(e)}finally{b(!1)}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.TJV,{color:"gray.700",fontSize:"14px",h:"80px",children:["Connect to your ",k.human_readable," environment by providing the information below. Once you have saved the form, you may test the integration to confirm that it's working correctly."]}),(0,n.jsx)(v,{data:t,defaultValues:{description:"",instance_key:"",name:""},isSubmitting:y,onSaveClick:T,onTestConnectionClick:a})]})};var I=i(16394);let Z=e=>{var t,i;let{response:a}=e,{connectionOption:l}=(0,o.C)(s.ZZ);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.KMv,{color:"gray.100"}),(0,n.jsxs)(r.s_g,{align:"flex-start",mt:"16px",children:[(null===(t=a.data)||void 0===t?void 0:t.test_status)==="succeeded"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.Br$,{children:[(0,n.jsxs)(r.y_b,{as:"h5",color:"gray.700",size:"xs",children:["Successfully connected to ",l.human_readable]}),(0,n.jsx)(r.hw$,{colorScheme:"green",size:"sm",variant:"solid",children:"Success"})]}),(0,n.jsx)(r.Bjg,{color:"gray.500",fontSize:"sm",mt:"12px !important",children:(0,I.p6)(a.fulfilledTimeStamp)}),(0,n.jsx)(r.TJV,{bg:"green.100",border:"1px solid",borderColor:"green.300",color:"green.700",mt:"16px",borderRadius:"6px",children:(0,n.jsxs)(r.Br$,{alignItems:"flex-start",margin:["14px","17px","14px","17px"],children:[(0,n.jsx)(r.StI,{}),(0,n.jsxs)(r.TJV,{children:[(0,n.jsx)(r.y_b,{as:"h5",color:"green.500",fontWeight:"semibold",size:"xs",children:"Success message:"}),(0,n.jsx)(r.Bjg,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:a.data.msg})]})]})})]}),(null===(i=a.data)||void 0===i?void 0:i.test_status)==="failed"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.Br$,{children:[(0,n.jsxs)(r.y_b,{as:"h5",color:"gray.700",size:"xs",children:["Output error to ",l.human_readable]}),(0,n.jsx)(r.hw$,{colorScheme:"red",size:"sm",variant:"solid",children:"Error"})]}),(0,n.jsx)(r.Bjg,{color:"gray.500",fontSize:"sm",mt:"12px !important",children:(0,I.p6)(a.fulfilledTimeStamp)}),(0,n.jsx)(r.TJV,{bg:"red.50",border:"1px solid",borderColor:"red.300",color:"red.300",mt:"16px",borderRadius:"6px",children:(0,n.jsxs)(r.Br$,{alignItems:"flex-start",margin:["14px","17px","14px","17px"],children:[(0,n.jsx)(r.f9v,{}),(0,n.jsxs)(r.TJV,{children:[(0,n.jsx)(r.y_b,{as:"h5",color:"red.500",fontWeight:"semibold",size:"xs",children:"Error message:"}),(0,n.jsx)(r.Bjg,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:a.data.failure_reason}),(0,n.jsx)(r.Bjg,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:a.data.msg})]})]})})]})]})]})},F=e=>{let{onConnectionCreated:t}=e,i=(0,a.useRouter)(),{connectionOption:u}=(0,o.C)(s.ZZ),h=u&&u.type===c.Zi.MANUAL,{data:m,isFetching:x,isLoading:p,isSuccess:f}=(0,s.n3)(u.identifier,{skip:h}),[g,j]=(0,l.useState)(),y=e=>{j(e)},v=(0,l.useCallback)(()=>{i.push(d.JR)},[i]),b=(0,l.useCallback)(()=>{switch(null==u?void 0:u.type){case c.Zi.DATABASE:if(f&&m)return(0,n.jsx)(_,{data:m,onConnectionCreated:t,onTestConnectionClick:y});break;case c.Zi.MANUAL:return(0,n.jsx)(R,{onConnectionCreated:t});case c.Zi.SAAS:if(f&&m)return(0,n.jsx)(V,{data:m,onConnectionCreated:t,onTestConnectionClick:y});break;case c.Zi.EMAIL:if(f&&m)return(0,n.jsx)(C,{data:m,onConnectionCreated:v,onTestEmail:y})}},[null==u?void 0:u.type,m,f,t,v]);return(0,n.jsxs)(r.ad9,{gap:"97px",children:[(0,n.jsxs)(r.s_g,{w:"579px",gap:"16px",align:"stretch",children:[(x||p)&&(0,n.jsx)(r.w4_,{children:(0,n.jsx)(r.Y6B,{})}),b()]}),g&&(0,n.jsx)(r.TJV,{mt:"16px",maxW:"528px",w:"fit-content",children:(0,n.jsx)(Z,{response:g})})]})}},38212:function(e,t,i){i.d(t,{Z:function(){return v}});var n=i(24246),s=i(17245),r=i(96356),a=i(14207),l=i(36010),o=i(86677),d=i(27378),c=i(16134),u=i(812),h=i(77830),m=i(41966),x=i(84306),p=i(66527),f=i(41207),g=i(39715),j=e=>{let{data:t=[],isSubmitting:i=!1,onSubmit:s,onCancel:r,disabled:a}=e,o=(0,d.useRef)(null),{errorAlert:c}=(0,x.V)(),u=t.length>0?p.ZP.dump(t):void 0,[h,j]=(0,d.useState)(void 0),[y,v]=(0,d.useState)(!1),[b,_]=(0,d.useState)(!u),k=(0,l.E2M)(),{data:C}=(0,m.LH)({minimal:!0}),[S,w]=(0,d.useState)([]),T=e=>{p.ZP.load(e,{json:!0}),j(void 0)},z=()=>{let e=o.current.getValue();s(p.ZP.load(e,{json:!0})),w([])};return(0,n.jsxs)(l.ad9,{gap:"97px",children:[(0,n.jsxs)(l.s_g,{align:"stretch",w:"800px",children:[(0,n.jsx)(f.M,{defaultLanguage:"yaml",defaultValue:u,height:"calc(100vh - 526px)",onChange:e=>{try{v(!0),T(e),_(!!(!e||""===e.trim()))}catch(e){(0,f.F)(e)?j(e):c("Could not parse the supplied YAML")}},onMount:(e,t)=>{o.current=e,o.current.focus()},options:{fontFamily:"Menlo",fontSize:13,minimap:{enabled:!0},readOnly:a},theme:"light"}),(0,n.jsxs)(l.Br$,{justifyContent:"flex-end",pr:6,children:[r&&(0,n.jsx)(l.zxk,{onClick:r,children:"Cancel"}),(0,n.jsx)(l.zxk,{type:"primary",disabled:a||b||!!h||i,loading:i,onClick:()=>{if(C&&C.length){let e=o.current.getValue(),t=C.filter(t=>e.includes("fides_key: ".concat(t.fides_key,"\n"))).map(e=>e.fides_key);if(w(t),t.length){k.onOpen();return}}z()},htmlType:"submit","data-testid":"save-yaml-btn",children:"Save"})]})]}),y&&(b||h)&&(0,n.jsx)(g.Z,{isEmptyState:b,yamlError:h}),(0,n.jsx)(l.cVQ,{isOpen:k.isOpen,onClose:k.onClose,onConfirm:()=>{z(),k.onClose()},title:"Overwrite dataset",message:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.Bjg,{children:["You are about to overwrite the dataset",S.length>1?"s":""," ",S.map((e,t)=>{let i=t===S.length-1;return(0,n.jsxs)(d.Fragment,{children:[(0,n.jsx)(l.Bjg,{color:"complimentary.500",as:"span",fontWeight:"bold",children:e}),i?".":", "]},e)})]}),(0,n.jsx)(l.Bjg,{children:"Are you sure you would like to continue?"})]})})]})};let y=e=>{let{children:t,...i}=e;return(0,n.jsx)(l.Bjg,{color:"gray.700",fontSize:"14px",...i,children:t})};var v=()=>{let e=(0,o.useRouter)(),{errorAlert:t,successAlert:i}=(0,s.VY)(),{handleError:x}=(0,s.HK)(),[p,f]=(0,d.useState)(!1),{connection:g}=(0,c.C)(r.ZZ),{data:v,isFetching:b,isLoading:_,isSuccess:k}=(0,a.Eg)(g.key),[C]=(0,a.Lz)(),[S]=(0,m.EG)(),{data:w,isLoading:T,error:z}=(0,m.LH)({minimal:!0}),[R,V]=(0,d.useState)(void 0);(0,d.useEffect)(()=>{v&&v.items.length&&V(v.items[0].ctl_dataset.fides_key)},[v]);let I=async n=>{var s;let r={connection_key:null==g?void 0:g.key,dataset_pairs:n},a=await C(r).unwrap();(null===(s=a.failed)||void 0===s?void 0:s.length)>0?t(a.failed[0].message):i("Dataset successfully updated!"),e.push(h.JR)},Z=async()=>{if(R)try{let e=R;v&&v.items.length&&(e=v.items[0].fides_key);let t=[{fides_key:e,ctl_dataset_fides_key:R}];I(t)}catch(e){x(e)}},F=async e=>{try{f(!0);let i=Array.isArray(e)?e:[e],n=await S(i);if((0,u.D4)(n)){let e=(0,u.e$)(n.error);t(e);return}let s=i.map(e=>({fides_key:e.fides_key,ctl_dataset_fides_key:e.fides_key}));if(v&&v.items.length){let{items:e}=v;s=e.map((e,t)=>({fides_key:e.fides_key,ctl_dataset_fides_key:i[t].fides_key}))}I(s)}catch(e){x(e)}finally{f(!1)}},B=""!==R&&void 0!==R;if(b||_||T&&!z)return(0,n.jsx)(l.w4_,{children:(0,n.jsx)(l.Y6B,{})});let E=w&&w.length;return(0,n.jsxs)(l.s_g,{alignItems:"left",gap:4,children:[z&&(0,n.jsx)(y,{color:"red",children:"There was a problem loading existing datasets, please try again."}),(0,n.jsxs)(l.s_g,{alignItems:"flex-start",children:[E&&(0,n.jsx)("div",{children:(0,n.jsx)(l.s_g,{alignSelf:"start",gap:4,children:(0,n.jsxs)(l.TJV,{"data-testid":"dataset-selector-section",children:[(0,n.jsx)(y,{mb:4,children:"Choose a dataset to associate with this connector."}),(0,n.jsxs)(l.Br$,{children:[(0,n.jsx)(l.PhF,{allowClear:!0,options:w.map(e=>({label:e.fides_key,value:e.fides_key})),className:"w-full",placeholder:"Select",onChange:e=>V(e),value:R,"data-testid":"dataset-selector","aria-label":"Select a dataset"}),(0,n.jsx)(l.zxk,{onClick:Z,type:"primary",className:"self-start",disabled:!B,"data-testid":"save-dataset-link-btn",children:"Save"})]})]})})}),E&&k&&(null==v?void 0:v.items)&&(0,n.jsx)(l.izJ,{plain:!0,children:"or"}),k&&(null==v?void 0:v.items)&&(0,n.jsxs)(l.TJV,{"data-testid":"yaml-editor-section",children:[(0,n.jsx)(y,{mb:4,children:"View your dataset YAML below!"}),(0,n.jsx)(j,{data:v.items.map(e=>e.ctl_dataset),isSubmitting:p,onSubmit:F,disabled:B})]})]})]})}},27259:function(e,t,i){var n=i(24246),s=i(36010),r=i(34090);t.Z=e=>{let{disabled:t=!1,isRequired:i=!1,label:a,placeholder:l,type:o="text",...d}=e,{id:c,autoFocus:u}=d,[h,m]=(0,r.U$)(d);return(0,n.jsxs)(s.DTt,{display:"flex",isRequired:i,isInvalid:!!(m.error&&m.touched),children:[a&&(0,n.jsx)(s.tLq,{color:"gray.900",fontSize:"14px",fontWeight:"semibold",htmlFor:c,minWidth:"150px",children:a}),(0,n.jsxs)(s.s_g,{align:"flex-start",w:"inherit",children:["number"===o&&(0,n.jsxs)(s.UW0,{allowMouseWheel:!0,color:"gray.700",defaultValue:0,min:0,size:"sm",children:[(0,n.jsx)(s.v4G,{...h,autoComplete:"off",autoFocus:u}),(0,n.jsxs)(s.eMw,{children:[(0,n.jsx)(s.tTI,{}),(0,n.jsx)(s.ey7,{})]})]}),"text"===o&&(0,n.jsx)(s.RVe,{...h,autoComplete:"off",autoFocus:u,color:"gray.700",isDisabled:t,placeholder:l,size:"sm"}),"textarea"===o&&(0,n.jsx)(s.$gm,{...h,autoComplete:"off",autoFocus:u,color:"gray.700",placeholder:l,resize:"none",size:"sm",value:h.value||""}),(0,n.jsx)(s.eDG,{children:m.error})]})]})}},67762:function(e,t,i){i.d(t,{h:function(){return r}});var n=i(24246),s=i(36010);i(27378);let r=e=>{let{isSubmitting:t=!1,onCancelClick:i}=e;return(0,n.jsxs)(s.ylc,{size:"sm",spacing:"8px",variant:"outline",children:[(0,n.jsx)(s.vTv,{onClick:i,variant:"outline",children:"Cancel"}),(0,n.jsx)(s.vTv,{bg:"primary.800",color:"white",isDisabled:t,isLoading:t,loadingText:"Submitting",size:"sm",variant:"solid",type:"submit",_active:{bg:"primary.500"},_disabled:{opacity:"inherit"},_hover:{bg:"primary.400"},children:"Save"})]})}},50881:function(e,t,i){i.d(t,{Z:function(){return v}});var n=i(24246),s=i(17245),r=i(96356),a=i(14207),l=i(36010),o=i(86677),d=i(27378),c=i(16134),u=i(77830),h=i(34090),m=i(55484),x=i(97181),p=i(57072),f=i(5785),g=i(27259),j=i(67762),y=e=>{let{data:t=[],isSubmitting:i=!1,onSaveClick:r}=e,{isLoading:a}=(0,p.MO)(),d=(0,c.C)(f.qb),y=(0,o.useRouter)(),{errorAlert:v}=(0,s.VY)(),b=()=>{y.push(u.JR)};return a?null:(0,n.jsx)(h.J9,{enableReinitialize:!0,initialValues:{fields:t.length>0?t:[{pii_field:"",dsr_package_label:"",data_categories:[]}]},onSubmit:(e,t)=>{if(new Set(e.fields.map(e=>e.pii_field)).size<e.fields.length){v("PII Field must be unique");return}r(e,t)},validateOnBlur:!1,validateOnChange:!1,validationSchema:m.Ry({fields:m.IX().of(m.Ry().shape({pii_field:m.Z_().required("PII Field is required").min(1,"PII Field must have at least one character").max(200,"PII Field has a maximum of 200 characters").label("PII Field"),dsr_package_label:m.Z_().required("DSR Package Label is required").min(1,"DSR Package Label must have at least one character").max(200,"DSR Package Label has a maximum of 200 characters").label("DSR Package Label"),data_categories:m.IX(m.Z_()).label("Data Categories")}))}),children:e=>(0,n.jsx)(h.l0,{style:{marginTop:0},noValidate:!0,children:(0,n.jsx)(l.s_g,{align:"stretch",children:(0,n.jsx)(h.F2,{name:"fields",render:t=>{let{fields:s}=e.values;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.Br$,{color:"gray.900",flex:"1",fontSize:"14px",fontWeight:"semibold",lineHeight:"20px",mb:"6px",spacing:"24px",children:[(0,n.jsx)(l.TJV,{w:"416px",children:"PII Field"}),(0,n.jsx)(l.TJV,{w:"416px",children:"DSR Package Label"}),(0,n.jsx)(l.TJV,{w:"416px",children:"Data Categories"}),(0,n.jsx)(l.TJV,{visibility:"hidden",children:(0,n.jsx)(l.lr0,{})})]}),(0,n.jsx)(l.TJV,{children:s&&s.length>0?s.map((e,i)=>(0,n.jsxs)(l.Br$,{mt:i>0?"12px":void 0,spacing:"24px",align:"flex-start",children:[(0,n.jsx)(l.TJV,{minH:"57px",w:"416px",children:(0,n.jsx)(g.Z,{autoFocus:0===i,isRequired:!0,name:"fields.".concat(i,".pii_field")})}),(0,n.jsx)(l.TJV,{minH:"57px",w:"416px",children:(0,n.jsx)(g.Z,{isRequired:!0,name:"fields.".concat(i,".dsr_package_label")})}),(0,n.jsx)(l.TJV,{minH:"57px",w:"416px",children:(0,n.jsx)(x.d,{name:"fields.".concat(i,".data_categories"),options:d.map(e=>({value:e.fides_key,label:e.fides_key})),isRequired:!0,mode:"multiple"})}),(0,n.jsx)(l.TJV,{h:"57px",visibility:i>0?"visible":"hidden",children:(0,n.jsx)(l.lr0,{onClick:()=>t.remove(i),_hover:{cursor:"pointer"}})})]},i)):null}),(0,n.jsx)(l.zxk,{className:"my-6",onClick:()=>{t.push({pii_field:"",dsr_package_label:"",data_categories:[]})},children:"Add new PII field"}),(0,n.jsx)(j.h,{isSubmitting:i,onCancelClick:b})]})}})})})})},v=()=>{let e=(0,d.useRef)(!1),t=(0,o.useRouter)(),{successAlert:i}=(0,s.VY)(),{handleError:h}=(0,s.HK)(),[m,x]=(0,d.useState)(!1),[p,f]=(0,d.useState)([]),{connection:g}=(0,c.C)(r.ZZ),{data:j,isFetching:v,isLoading:b,isSuccess:_}=(0,a.QV)(g.key),[k]=(0,a.jF)(),[C]=(0,a._d)(),S=async(e,n)=>{try{x(!0);let n={connection_key:null==g?void 0:g.key,body:{...e}};p.length>0?await C(n).unwrap():await k(n).unwrap(),i("DSR customization ".concat(p.length>0?"updated":"added","!")),t.push(u.JR)}catch(e){h(e)}finally{x(!1)}};return(0,d.useEffect)(()=>(e.current=!0,_&&j&&f(j.fields),()=>{e.current=!1}),[j,_]),(0,n.jsxs)(l.s_g,{align:"stretch",gap:"16px",children:[(0,n.jsx)(l.TJV,{color:"gray.700",fontSize:"14px",w:"572px",children:"Customize your PII fields to create a friendly label name for your privacy request packages. This “Package Label” is the label your user will see in their downloaded package."}),(v||b)&&(0,n.jsx)(l.w4_,{children:(0,n.jsx)(l.Y6B,{})}),e.current&&!b?(0,n.jsx)(y,{data:p,isSubmitting:m,onSaveClick:S}):null]})}},33335:function(e,t,i){i.d(t,{E:function(){return n}});let n=e=>e.toLowerCase().replace(/[ .]/g,"_").replace(/[^a-zA-Z0-9_<>-]/g,"")},57072:function(e,t,i){i.d(t,{Bd:function(){return n.Bd},L5:function(){return n.L5},MO:function(){return n.MO},qb:function(){return n.qb}});var n=i(5785)}}]);