id: TF_IAM002
name: iam-wildcard-resource
severity: high
category: iam
languages: [terraform]
description: Detects IAM policies with wildcard resources
message: "IAM policy has wildcard resource: {code_snippet}"
pattern:
  type: resource
  resource_type: aws_iam_policy
  field: policy
  contains: ['"Resource": ["*"]', '"Resource": "*"', "'Resource': ['*']", "'Resource': '*'"]
fix_template: "Specify specific resources instead of using wildcards"
education: |
  Wildcard resources grant access to all resources of the specified type.
  Scope permissions to specific resources.
references:
  - https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html
