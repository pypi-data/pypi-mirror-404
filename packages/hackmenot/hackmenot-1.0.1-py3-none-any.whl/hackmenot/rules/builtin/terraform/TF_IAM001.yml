id: TF_IAM001
name: iam-wildcard-action
severity: high
category: iam
languages: [terraform]
description: Detects IAM policies with wildcard actions
message: "IAM policy has wildcard action: {code_snippet}"
pattern:
  type: resource
  resource_type: aws_iam_policy
  field: policy
  contains: ['"Action": ["*"]', '"Action": "*"', "'Action': ['*']", "'Action': '*'"]
fix_template: "Specify specific actions instead of using wildcards"
education: |
  Wildcard actions grant more permissions than necessary.
  Follow the principle of least privilege.
references:
  - https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html
