"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[50728],{50728:(e,s,n)=>{n.r(s),n.d(s,{default:()=>R});var t=n(89379),o=n(65043),i=n(42261),l=n(15492),r=n(11645),a=n(97326),d=n(20691),c=n(8354),p=n(99472),x=n(54522),f=n(22019),h=n(46909),g=n(47419),u=n(98080),v=n(91957),j=n(91686),m=n(12624),y=n(98105),A=n(76399),b=n(61494),S=n(8347),_=n(70501),k=n(26944),C=n(46237),w=n(89967),z=n(29792),T=n(1259),E=n(41334),I=n(14524),M=n(74017),P=n(70579);const{Panel:L}=a.A,{Option:B}=u.A,{TabPane:O}=y.A,{Text:F}=b.A,R=e=>{let{visible:s,onClose:n,onOpenShellConfig:u}=e;const[b,B]=(0,o.useState)(null),{isDarkMode:R}=(0,S.D)(),[D,N]=(0,o.useState)({}),[U,G]=(0,o.useState)(!1),[J,K]=(0,o.useState)(!1),[W,q]=(0,o.useState)({}),[H,Q]=(0,o.useState)(null),[V,X]=(0,o.useState)([]),[Y,Z]=(0,o.useState)({}),[$,ee]=(0,o.useState)({}),[se,ne]=(0,o.useState)(!1);(0,o.useEffect)(()=>{if(s){te(),oe();const e=()=>{oe(),setTimeout(()=>te(),1e3)};return window.addEventListener("mcpStatusChanged",e),()=>{window.removeEventListener("mcpStatusChanged",e)}}},[s]);const te=async()=>{G(!0);try{const e=await fetch("/api/mcp/status");if(e.ok){const s=await e.json();console.log("MCP Status received:",s),console.log("Servers:",s.servers),console.log("Server configs:",s.server_configs),B(s)}else console.error("MCP status fetch failed:",e.status,e.statusText);const s=await fetch("/api/mcp/builtin-tools/status");if(s.ok){const e=await s.json();N(e.categories||{})}else console.error("Failed to fetch builtin tools status")}catch(e){console.error("Failed to fetch MCP status:",e)}finally{G(!1)}},oe=async()=>{try{const e=await fetch("/api/mcp/permissions");if(e.ok){const s=await e.json();Q(s)}}catch(e){console.error("Failed to fetch MCP permissions:",e)}},ie=async(e,s)=>{q(s=>(0,t.A)((0,t.A)({},s),{},{[e]:!0}));try{const n=await fetch("/api/mcp/toggle-server",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server_name:e,enabled:s})});if(n.ok){const e=await n.json();e.success?(f.Ay.success(e.message),await te()):f.Ay.error(e.message||"Failed to toggle server")}else f.Ay.error("Failed to toggle server")}catch(n){f.Ay.error("Failed to toggle server"),console.error("Toggle error:",n)}finally{q(s=>(0,t.A)((0,t.A)({},s),{},{[e]:!1}))}},le=e=>{const s=Array.isArray(e)?e:[e];X(s),s.forEach(e=>{e&&(async e=>{if(!Y[e]){ee(s=>(0,t.A)((0,t.A)({},s),{},{[e]:!0}));try{const s=await fetch("/api/mcp/servers/".concat(e,"/details"));if(s.ok){const n=await s.json();console.log("Fetched details for ".concat(e,":"),n),Z(s=>(0,t.A)((0,t.A)({},s),{},{[e]:n}))}else console.error("Failed to fetch details for ".concat(e,": ").concat(s.status," ").concat(s.statusText)),Z(s=>(0,t.A)((0,t.A)({},s),{},{[e]:{tools:[],resources:[],prompts:[],logs:[]}}))}catch(s){console.error("Failed to fetch details for ".concat(e,":"),s),Z(s=>(0,t.A)((0,t.A)({},s),{},{[e]:{tools:[],resources:[],prompts:[],logs:[]}}))}finally{ee(s=>(0,t.A)((0,t.A)({},s),{},{[e]:!1}))}}})(e)})},re=e=>{var s;const n=null===b||void 0===b||null===(s=b.server_configs)||void 0===s?void 0:s[e];return null!==n&&void 0!==n&&n.description&&n.description.trim()?n.description:null!==n&&void 0!==n&&n.service_id?n.service_id:e},ae=e=>e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"K"):e.toString();return(0,P.jsxs)(h.A,{title:"MCP Server Status",open:s,onCancel:n,footer:[(0,P.jsx)(l.Ay,{icon:(0,P.jsx)(z.A,{}),onClick:()=>K(!0),children:"Browse Registry"},"registry"),(0,P.jsx)(l.Ay,{type:"primary",onClick:async()=>{G(!0);try{(await fetch("/api/mcp/initialize",{method:"POST"})).ok&&await te()}catch(e){console.error("Failed to reinitialize MCP:",e)}finally{G(!1)}},loading:U,children:"Reinitialize"},"reinit"),(0,P.jsx)(l.Ay,{onClick:n,children:"Close"},"close")],width:800,children:[U?(0,P.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,P.jsx)(j.A,{size:"large"})}):b?(0,P.jsxs)(v.A,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,P.jsxs)(g.A,{gutter:16,children:[(0,P.jsx)(r.A,{span:12,children:(0,P.jsx)(i.A,{message:"MCP System ".concat(b.initialized?"Initialized":"Not Initialized"),description:(0,P.jsxs)("div",{children:[(0,P.jsxs)("div",{children:[b.connected_servers,"/",b.total_servers," servers connected"]}),(0,P.jsx)("div",{style:{fontSize:"12px",marginTop:"4px",opacity:.8},children:(()=>{if(!b)return null;const e=(e,s)=>e.includes("/.ziya/")?"(user's home)":e.endsWith("/mcp_config.json")&&!e.includes("/.ziya/")?e.includes("/mcp_config.json")&&e.split("/").length>2?"(project root)":"(current working directory)":"";return b.config_path&&b.config_exists?"Using config: ".concat(b.config_path):b.config_search_paths&&b.config_search_paths.length>0?(0,P.jsxs)("div",{children:[(0,P.jsx)("div",{children:"No MCP configuration file found in search path."}),(0,P.jsx)("div",{style:{fontSize:"11px",opacity:.7,marginTop:"2px"},children:"Using built-in server defaults."}),(0,P.jsxs)("div",{style:{fontSize:"11px",opacity:.7,marginTop:"4px",wordBreak:"break-all"},children:["Search path: ",b.config_search_paths.map((s,n)=>(0,P.jsxs)("div",{style:{marginTop:n>0?"2px":"0"},children:[n>0&&"\u2193 ",(0,P.jsx)("code",{style:{backgroundColor:"rgba(0,0,0,0.1)",padding:"1px 3px",borderRadius:"2px",fontSize:"10px",fontFamily:"monospace"},children:s}),(0,P.jsx)("span",{style:{marginLeft:"4px",fontStyle:"italic"},children:e(s)})]},n))]})]}):"Using built-in server defaults"})()})]}),type:b.initialized&&b.connected_servers>0?"success":"warning",showIcon:!0,style:{height:"100%"}})}),(0,P.jsxs)(r.A,{span:12,children:[b.token_costs&&(()=>{const{total_tool_tokens:e,enabled_tool_tokens:s,instructions:n}=b.token_costs,t=e-s,o=(e>0&&Math.round(t/e*100),s+n.per_model_cost);return(0,P.jsx)(i.A,{message:(0,P.jsxs)("span",{children:["Total Context Token Usage",t>0&&(0,P.jsxs)("span",{style:{fontSize:"12px",marginLeft:"8px",opacity:.7},children:["(saving ",ae(t)," tokens)"]})]}),description:(0,P.jsxs)("div",{children:[(0,P.jsxs)("div",{style:{fontSize:"20px",fontWeight:"bold",marginBottom:"8px"},children:[ae(o)," ",(0,P.jsx)("span",{style:{fontSize:"14px",fontWeight:"normal",opacity:.7},children:"tokens"})]}),(0,P.jsxs)("div",{style:{fontSize:"12px",opacity:.7},children:[(0,P.jsxs)("div",{children:["\ud83d\udd27 MCP Tools: ",(0,P.jsx)("strong",{children:ae(s)})," tokens",t>0&&(0,P.jsxs)("span",{style:{opacity:.7},children:[" ","(",ae(e)," total, ",ae(t)," disabled)"]})]}),(0,P.jsxs)("div",{children:["\ud83d\udccb Instructions: ",(0,P.jsx)("strong",{children:ae(n.per_model_cost)})," tokens (for current model)"]})]})]}),type:"info",showIcon:!0,style:{height:"100%"}})})(),!b.token_costs&&(0,P.jsx)(i.A,{message:"Token Usage Unavailable",description:"Token cost calculation is not available",type:"warning",showIcon:!0,style:{height:"100%"}})]})]}),(0,P.jsxs)("div",{children:[(0,P.jsx)(c.A,{orientation:"left",children:(0,P.jsxs)(v.A,{children:[(0,P.jsx)(E.A,{}),"Builtin Tools",Object.keys(D).length>0&&(0,P.jsxs)(A.A,{color:"blue",children:[Object.values(D).filter(e=>e.enabled).length," enabled",b.servers&&Object.values(b.servers).filter(e=>e.builtin).length>0&&" + ".concat(Object.values(b.servers).filter(e=>e.builtin).length," servers")]})]})}),(e=>{const s=null===(e=b.servers)||void 0===e?void 0:e.ondemand,n=s&&s.tools>0,t=(null===s||void 0===s?void 0:s.available_tools)||[];if(n){var o;const e=(null===(o=b.token_costs)||void 0===o?void 0:o.servers.ondemand)||0,n=s.tool_details||[];return(0,P.jsx)("div",{style:{marginBottom:12,padding:16,border:R?"1px solid #434343":"1px solid #eee",borderRadius:6,backgroundColor:R?"#1a1f2e":"#f0f5ff"},children:(0,P.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:(0,P.jsxs)("div",{style:{flex:1},children:[(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[(0,P.jsx)("strong",{style:{fontSize:"14px"},children:"On-demand Tools - Active"}),(0,P.jsxs)(A.A,{color:"blue",style:{marginLeft:8},children:[s.tools," tool",1!==s.tools?"s":""," loaded"]}),e>0&&(0,P.jsxs)(A.A,{color:"purple",style:{marginLeft:4},children:[ae(e)," tokens"]})]}),(0,P.jsx)("div",{style:{fontSize:"12px",color:R?"#a0a0a0":"#666",marginBottom:12},children:"Specialized tools automatically loaded based on files in context"}),n.length>0&&(0,P.jsx)("div",{style:{fontSize:"12px",marginTop:8,paddingLeft:12,borderLeft:"2px solid ".concat(R?"#40a9ff":"#1890ff")},children:n.map((e,s)=>(0,P.jsxs)("div",{style:{marginBottom:6},children:[(0,P.jsx)("strong",{style:{color:R?"#40a9ff":"#1890ff"},children:e.name}),(0,P.jsxs)("div",{style:{fontSize:"11px",color:R?"#888":"#999",marginTop:2},children:["Triggered by: ",(0,P.jsx)("code",{style:{backgroundColor:R?"#1f1f1f":"#f5f5f5",padding:"2px 6px",borderRadius:3,fontSize:"11px"},children:e.trigger_desc})," file",e.triggers.length>1?"s":""," in context"]})]},s))})]})})},"ondemand")}if(t.length>0){const e=t.filter(e=>e.dependencies_met).length,s=t.filter(e=>!e.dependencies_met).length;return(0,P.jsxs)("div",{style:{marginBottom:12,padding:12,border:R?"1px solid #434343":"1px solid #eee",borderRadius:6,backgroundColor:R?"#1a1a1a":"#fafafa"},children:[(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"13px"},onClick:()=>ne(!se),children:[(0,P.jsx)("span",{style:{marginRight:8},children:se?"\u25bc":"\u25b6"}),(0,P.jsx)("strong",{children:"On-demand Tools"}),(0,P.jsx)(A.A,{color:"default",style:{marginLeft:8,fontSize:"11px"},children:"None Active"}),e>0&&(0,P.jsxs)(A.A,{color:"green",style:{marginLeft:4,fontSize:"11px"},children:[e," available"]}),s>0&&(0,P.jsxs)(A.A,{color:"orange",style:{marginLeft:4,fontSize:"11px"},children:[s," needs dependencies"]})]}),se&&(0,P.jsxs)("div",{style:{marginTop:12,paddingLeft:20},children:[(0,P.jsx)("div",{style:{fontSize:"11px",color:R?"#888":"#999",marginBottom:8},children:"Tools automatically loaded when matching files are added to context"}),t.map((e,s)=>(0,P.jsxs)("div",{style:{marginBottom:8,paddingBottom:8,borderBottom:s<t.length-1?"1px solid ".concat(R?"#2a2a2a":"#e8e8e8"):"none"},children:[(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,P.jsx)("strong",{style:{fontSize:"12px",color:R?"#40a9ff":"#1890ff"},children:e.name}),e.dependencies_met?(0,P.jsx)(A.A,{color:"green",style:{fontSize:"10px",padding:"0 4px"},children:"Ready"}):(0,P.jsx)(A.A,{color:"orange",style:{fontSize:"10px",padding:"0 4px"},children:"Dependencies Missing"})]}),(0,P.jsxs)("div",{style:{fontSize:"10px",color:R?"#666":"#999",marginTop:2},children:["Triggers: ",(0,P.jsx)("code",{style:{backgroundColor:R?"#0d0d0d":"#f0f0f0",padding:"1px 4px",borderRadius:2,fontSize:"10px"},children:e.triggers.join(", ")}),!e.dependencies_met&&(0,P.jsxs)("span",{style:{marginLeft:6,color:"#ff9800"},children:["\u2022 Install: pip install ",e.missing_dependencies.join(" ")]})]})]},s))]})]},"ondemand-available")}return null})(),b.servers&&Object.entries(b.servers).filter(e=>{let[s,n]=e;return n.builtin&&!n.is_ondemand}).map(e=>{var s,t,o;let[i,r]=e;const a=!1!==(null===(s=b.server_configs)||void 0===s||null===(t=s[i])||void 0===t?void 0:t.enabled),d=(null===(o=b.token_costs)||void 0===o?void 0:o.servers[i])||0;return(0,P.jsx)("div",{style:{marginBottom:12,padding:16,border:R?"1px solid #434343":"1px solid #eee",borderRadius:6,backgroundColor:a&&r.connected?R?"#162312":"#f6ffed":R?"#1f1f1f":"#fafafa"},children:(0,P.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,P.jsxs)("div",{style:{flex:1},children:[(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[(0,P.jsxs)("strong",{style:{fontSize:"14px",textTransform:"capitalize"},children:[i," Server"]}),(0,P.jsx)(A.A,{color:a&&r.connected?"green":a?"orange":"default",style:{marginLeft:8},children:a?r.connected?"Connected":"Disconnected":"Disabled"}),(0,P.jsxs)(A.A,{color:"purple",style:{marginLeft:4},children:[(0,P.jsx)(E.A,{})," Builtin Server"]}),r.tools>0&&(0,P.jsxs)(A.A,{color:"blue",style:{marginLeft:4},children:[(0,P.jsx)(M.A,{})," ",r.tools," tool",1!==r.tools?"s":""]}),d>0&&(0,P.jsxs)(A.A,{color:"cyan",style:{marginLeft:4},children:[ae(d)," tokens"]})]}),(0,P.jsx)("div",{style:{fontSize:"12px",color:R?"#a0a0a0":"#666",marginBottom:8},children:"time"===i?"Provides current date and time information":"shell"===i?"Execute shell commands with configurable safety controls":"Built-in MCP server"}),r.connected&&r.tools>0&&(0,P.jsx)("div",{style:{fontSize:"11px",color:R?"#888":"#999"},children:(0,P.jsxs)(v.A,{children:[(0,P.jsxs)("span",{children:[r.tools," tools"]}),r.resources>0&&(0,P.jsxs)("span",{children:["\u2022 ",r.resources," resources"]}),r.prompts>0&&(0,P.jsxs)("span",{children:["\u2022 ",r.prompts," prompts"]})]})})]}),(0,P.jsxs)(v.A,{children:["shell"===i&&(0,P.jsx)(l.Ay,{size:"small",icon:(0,P.jsx)(I.A,{}),onClick:()=>{null===u||void 0===u||u(),n()},children:"Configure"}),(0,P.jsx)(m.A,{checked:a,onChange:e=>ie(i,e),loading:W[i],size:"small"})]})]})},i)}),Object.entries(D).map(e=>{let[s,n]=e;return(0,P.jsx)("div",{style:{marginBottom:12,padding:16,border:R?"1px solid #434343":"1px solid #eee",borderRadius:6,backgroundColor:n.enabled?R?"#162312":"#f6ffed":R?"#1f1f1f":"#fafafa"},children:(0,P.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,P.jsxs)("div",{style:{flex:1},children:[(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[(0,P.jsx)("strong",{style:{fontSize:"14px"},children:n.name}),(0,P.jsx)(A.A,{color:n.dependencies_available?"green":"orange",style:{marginLeft:8},children:n.dependencies_available?"Ready":"Dependencies Missing"}),(0,P.jsxs)(A.A,{color:"purple",style:{marginLeft:4},children:[(0,P.jsx)(E.A,{})," Builtin"]})]}),(0,P.jsx)("div",{style:{fontSize:"12px",color:R?"#a0a0a0":"#666",marginBottom:8},children:n.description}),n.requires_dependencies&&!n.dependencies_available&&(0,P.jsx)(i.A,{type:"warning",message:"Missing Dependencies",description:(0,P.jsxs)("div",{children:["Install with: ",(0,P.jsxs)("code",{children:["pip install ",n.requires_dependencies.join(" ")]})]}),style:{marginBottom:8}}),n.available_tools&&n.available_tools.length>0&&(0,P.jsxs)("div",{style:{fontSize:"11px",color:R?"#888":"#999"},children:["Available tools: ",n.available_tools.join(", ")]})]}),(0,P.jsx)(m.A,{checked:n.enabled,onChange:e=>(async(e,s)=>{try{(await fetch("/api/mcp/builtin-tools/toggle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:e,enabled:s})})).ok&&(N(n=>(0,t.A)((0,t.A)({},n),{},{[e]:(0,t.A)((0,t.A)({},n[e]),{},{enabled:s})})),f.Ay.success("".concat(s?"Enabled":"Disabled"," ").concat(e," builtin tools")),window.dispatchEvent(new CustomEvent("mcpStatusChanged")))}catch(n){f.Ay.error("Failed to update builtin tool settings")}})(s,e),disabled:!n.dependencies_available,size:"small"})]})},s)}),0===Object.keys(D).length&&(!b.servers||0===Object.values(b.servers).filter(e=>e.builtin&&!e.is_ondemand).length)&&(0,P.jsx)(p.A,{description:"No builtin tools available",image:p.A.PRESENTED_IMAGE_SIMPLE,style:{margin:"32px 0"}})]}),(()=>{const e=b.servers&&b.server_configs?Object.keys(b.server_configs).filter(e=>{var s;return!(null!==(s=b.servers[e])&&void 0!==s&&s.builtin)}):[];return 0===e.length?null:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(c.A,{orientation:"left",children:(0,P.jsxs)(v.A,{children:[(0,P.jsx)(z.A,{}),"External MCP Servers",b.servers&&(0,P.jsxs)(A.A,{color:"blue",children:[e.length," configured"]})]})}),(0,P.jsx)(a.A,{activeKey:V,onChange:le,children:e.map(e=>{var s,n,o,r,a,c,h,g,u,S,_,z,E,I;const B=b.servers[e]||{connected:!1,resources:0,tools:0,prompts:0,capabilities:{}},D=!1!==(null===(s=b.server_configs)||void 0===s||null===(n=s[e])||void 0===n?void 0:n.enabled);(null===H||void 0===H||null===(o=H.servers)||void 0===o||null===(r=o[e])||void 0===r?void 0:r.permission)||null===H||void 0===H||null===(a=H.defaults)||void 0===a||a.server;return B.builtin?null:(0,P.jsx)(L,{header:(0,P.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,P.jsxs)(v.A,{children:[(0,P.jsx)(A.A,{color:D&&B.connected?"green":D?"red":"default",icon:D&&B.connected?(0,P.jsx)(C.A,{}):(0,P.jsx)(w.A,{}),children:D?B.connected?"Connected":"Disconnected":"Disabled"}),(0,P.jsx)("span",{children:re(e)}),B.builtin&&(0,P.jsx)(A.A,{color:"blue",children:"built-in"})]}),(0,P.jsxs)(v.A,{children:[(0,P.jsxs)(A.A,{icon:(0,P.jsx)(M.A,{}),children:[B.tools," tools"]}),(0,P.jsxs)(A.A,{icon:(0,P.jsx)(T.A,{}),children:[B.resources," resources"]}),void 0!==(null===(c=b.token_costs)||void 0===c?void 0:c.servers[e])&&(0,P.jsxs)(A.A,{color:D&&B.connected?void 0:"default",style:D&&B.connected?{}:{opacity:.5},children:[ae(b.token_costs.servers[e])," tokens"]})]})]}),children:(0,P.jsxs)(v.A,{direction:"vertical",style:{width:"100%"},children:[(0,P.jsxs)(d.A,{bordered:!0,size:"small",column:1,children:[(0,P.jsxs)(d.A.Item,{label:"Server Process",children:[(0,P.jsx)(m.A,{checked:D,onChange:s=>ie(e,s),loading:W[e],size:"small"}),(0,P.jsx)("span",{style:{marginLeft:8},children:D?"Enabled":"Disabled"}),D&&B.tools>0&&((s,n)=>{const t=Object.keys((null===H||void 0===H||null===(s=H.servers)||void 0===s||null===(n=s[e])||void 0===n?void 0:n.tools)||{}).filter(s=>{var n,t,o,i;return"disabled"===(null===H||void 0===H||null===(n=H.servers)||void 0===n||null===(t=n[e])||void 0===t||null===(o=t.tools)||void 0===o||null===(i=o[s])||void 0===i?void 0:i.permission)}).length;B.tools,B.tools;return t>0?(0,P.jsxs)("span",{style:{marginLeft:8,fontSize:"11px",color:"#ff4d4f"},children:["(",t," disabled)"]}):(0,P.jsx)("span",{style:{marginLeft:8,fontSize:"11px",color:"#999"},children:"(all tools enabled)"})})()]}),(null===(h=b.token_costs)||void 0===h?void 0:h.servers[e])&&(0,P.jsx)(d.A.Item,{label:"Context Cost",children:(s=>{const n=b.token_costs.servers[e],t=((null===H||void 0===H||null===(s=H.servers)||void 0===s?void 0:s[e])||{}).tools||{},o=Object.values(t).filter(e=>"disabled"===(null===e||void 0===e?void 0:e.permission)).length,i=B.tools>0?(B.tools-o)/B.tools:1,l=Math.round(n*i),r=n-l;return(0,P.jsxs)("span",{children:[(0,P.jsxs)(A.A,{color:D&&B.connected?"blue":"default",style:D&&B.connected?{}:{opacity:.5},children:[ae(l)," tokens active"]}),r>0&&(0,P.jsxs)(A.A,{color:"default",style:{opacity:.6},children:[ae(r)," tokens saved"]})]})})()}),!D&&(null===(g=b.server_configs)||void 0===g||null===(u=g[e])||void 0===u?void 0:u.registry_provider)&&(0,P.jsx)(d.A.Item,{label:"Actions",children:(0,P.jsx)(l.Ay,{type:"primary",danger:!0,size:"small",onClick:()=>(async e=>{q(s=>(0,t.A)((0,t.A)({},s),{},{[e]:!0}));try{const s=await fetch("/api/mcp/registry/services/uninstall/".concat(e),{method:"DELETE"});if(s.ok)await s.json(),f.Ay.success("Service ".concat(e," uninstalled successfully")),await te(),window.dispatchEvent(new Event("mcpStatusChanged"));else{const e=await s.json();f.Ay.error("Failed to uninstall service: ".concat(e.detail||"Unknown error"))}}catch(s){f.Ay.error("Failed to uninstall service"),console.error("Uninstall error:",s)}finally{q(s=>(0,t.A)((0,t.A)({},s),{},{[e]:!1}))}})(e),loading:W[e],children:"Uninstall Service"})})]}),$[e]?(0,P.jsx)(j.A,{}):Y[e]?(0,P.jsxs)(y.A,{defaultActiveKey:"tools",children:[(0,P.jsx)(O,{tab:"Tools (".concat(Y[e].tools.length,")"),children:(0,P.jsx)(x.A,{dataSource:Y[e].tools,renderItem:s=>{var n,t,o,i,l;const r="enabled"===((null===H||void 0===H||null===(n=H.servers)||void 0===n||null===(t=n[e])||void 0===t||null===(o=t.tools)||void 0===o||null===(i=o[s.name])||void 0===i?void 0:i.permission)||(null===H||void 0===H||null===(l=H.defaults)||void 0===l?void 0:l.tool)||"enabled");return(0,P.jsxs)(x.A.Item,{style:{opacity:r?1:.5,backgroundColor:r?"transparent":R?"#1a1a1a":"#f5f5f5"},children:[(0,P.jsx)(x.A.Item.Meta,{title:(0,P.jsx)("span",{style:{textDecoration:r?"none":"line-through"},children:s.name}),description:s.description?(0,P.jsx)("div",{style:{fontSize:"13px"},children:(0,P.jsx)(k.default,{markdown:s.description,enableCodeApply:!1})}):null}),(0,P.jsxs)(v.A,{children:[(0,P.jsx)(m.A,{checked:r,onChange:n=>(async(e,s,n)=>{try{(await fetch("/api/mcp/permissions/tool",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server_name:e,tool_name:s,permission:n})})).ok?(f.Ay.success("Permission for ".concat(s," updated.")),oe()):f.Ay.error("Failed to update permission.")}catch(t){f.Ay.error("Failed to update permission.")}})(e,s.name,n?"enabled":"disabled"),size:"small"}),(0,P.jsx)("span",{style:{fontSize:"12px",color:r?"#52c41a":"#999"},children:r?"Enabled":"Disabled"})]})]})},locale:{emptyText:(0,P.jsx)(p.A,{description:"No tools found",image:p.A.PRESENTED_IMAGE_SIMPLE})}})},"tools"),(0,P.jsx)(O,{tab:"Resources (".concat(Y[e].resources.length,")"),children:(0,P.jsx)(x.A,{dataSource:Y[e].resources,renderItem:e=>(0,P.jsx)(x.A.Item,{children:(0,P.jsx)(x.A.Item.Meta,{title:e.name,description:e.description?(0,P.jsxs)("div",{style:{fontSize:"13px"},children:[(0,P.jsx)(k.default,{markdown:e.description,enableCodeApply:!1}),(0,P.jsx)("div",{style:{color:"#999",fontSize:"11px",marginTop:"4px"},children:e.uri})]}):e.uri})}),locale:{emptyText:(0,P.jsx)(p.A,{description:"No resources found",image:p.A.PRESENTED_IMAGE_SIMPLE})}})},"resources"),(0,P.jsx)(O,{tab:"Prompts (".concat(Y[e].prompts.length,")"),children:(0,P.jsx)(x.A,{dataSource:Y[e].prompts,renderItem:e=>(0,P.jsx)(x.A.Item,{children:(0,P.jsx)(x.A.Item.Meta,{title:e.name,description:e.description?(0,P.jsx)("div",{style:{fontSize:"13px"},children:(0,P.jsx)(k.default,{markdown:e.description,enableCodeApply:!1})}):null})}),locale:{emptyText:(0,P.jsx)(p.A,{description:"No prompts found",image:p.A.PRESENTED_IMAGE_SIMPLE})}})},"prompts"),(0,P.jsx)(O,{tab:"Config Stanza",children:(0,P.jsxs)("div",{children:[(0,P.jsxs)(F,{type:"secondary",style:{fontSize:"12px",marginBottom:8,display:"block"},children:["Configuration file: ",b.config_path||"~/.ziya/mcp_config.json"]}),(0,P.jsx)("pre",{style:{backgroundColor:R?"#1f1f1f":"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"12px",overflow:"auto",maxHeight:"300px"},children:JSON.stringify((null===(S=b.server_configs)||void 0===S?void 0:S[e])||{},null,2)})]})},"config"),(0,P.jsx)(O,{tab:"Logs",children:(0,P.jsxs)("div",{children:[(0,P.jsx)(F,{type:"secondary",style:{fontSize:"12px",marginBottom:8,display:"block"},children:"Server logs (startup, errors, and recent activity)"}),null!==(_=Y[e])&&void 0!==_&&null!==(z=_.logs)&&void 0!==z&&z.length?(0,P.jsx)("pre",{style:{backgroundColor:R?"#1f1f1f":"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"11px",overflow:"auto",maxHeight:"300px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:null===(E=Y[e])||void 0===E||null===(I=E.logs)||void 0===I?void 0:I.join("\n")}):(0,P.jsx)(p.A,{description:B.connected?"No recent logs":"Server disconnected - no logs available",image:p.A.PRESENTED_IMAGE_SIMPLE})]})},"logs")]}):(0,P.jsx)(i.A,{message:"Could not load server details. The server might be disconnected or disabled.",type:"warning"})]})},e)})})]})})(),b.servers&&0===Object.keys(b.servers).filter(e=>{var s;return!(null!==(s=b.servers[e])&&void 0!==s&&s.builtin)}).length&&(0,P.jsx)(i.A,{message:"No external MCP servers configured",type:"info",showIcon:!0,style:{marginTop:16}})]}):(0,P.jsx)(i.A,{message:"Failed to load MCP status",type:"error"}),(0,P.jsx)(_.default,{visible:J,onClose:()=>{K(!1),te()}})]})}}}]);
//# sourceMappingURL=50728.191ac7f4.chunk.js.map