"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[58350],{58350:(e,n,s)=>{s.r(n),s.d(n,{default:()=>j});var o=s(89379),a=s(65043),t=s(42261),i=s(15492),l=s(32513),r=s(97326),d=s(8354),c=s(6658),h=s(22019),m=s(46909),f=s(25558),p=s(91957),g=s(12624),u=s(76399),x=s(73847),y=s(95240),A=s(70579);const{Panel:C}=r.A,j=e=>{let{visible:n,onClose:s}=e;const[j,v]=(0,a.useState)(null),[w,b]=(0,a.useState)(null),[k,O]=(0,a.useState)(""),[S,E]=(0,a.useState)(!1);(0,a.useEffect)(()=>{n&&G()},[n]);const G=async()=>{try{const e=await fetch("/api/mcp/shell-config");if(e.ok){const n=await e.json();v(n),b(n)}}catch(e){console.error("Failed to fetch shell config:",e),v({enabled:!0,allowedCommands:[],gitOperationsEnabled:!0,safeGitOperations:[],timeout:30}),b(defaultConfig)}},B=async e=>{try{await fetch("/api/mcp/toggle-server",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server_name:"shell",enabled:e})})}catch(n){console.warn("Failed to sync MCP server toggle:",n)}},T=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(j){E(!0);try{const n=await fetch("/api/mcp/shell-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,o.A)((0,o.A)({},j),{},{persist:e}))});if(n.ok){const o=await n.json();o.success?(await B(j.enabled),window.dispatchEvent(new CustomEvent("mcpStatusChanged",{detail:{serverName:"shell",enabled:j.enabled}})),h.Ay.success(o.message||(e?"Configuration saved to file":"Configuration applied for this session"))):h.Ay.error(o.message||"Failed to update shell configuration"),s()}else h.Ay.error("Failed to save shell configuration")}catch(n){h.Ay.error("Failed to save shell configuration"),console.error("Save error:",n)}finally{E(!1)}}},N=()=>{j&&k.trim()&&!j.allowedCommands.includes(k.trim())&&(v(e=>(0,o.A)((0,o.A)({},e),{},{allowedCommands:[...e.allowedCommands,k.trim()]})),O(""))},P=()=>{j&&w&&JSON.stringify(j)!==JSON.stringify(w)?m.A.confirm({title:"Unsaved Changes",icon:(0,A.jsx)(y.A,{style:{color:"#faad14"}}),content:"You have unsaved changes. What would you like to do?",okText:"Apply Changes",cancelText:"Discard Changes",okButtonProps:{loading:S},onOk:async()=>{await T(!1)},onCancel:()=>{s()},maskClosable:!0,closable:!0}):s()},F=["rm","rmdir","mv","cp","chmod","chown","sudo","su"],L=e=>F.some(n=>e.toLowerCase().includes(n.toLowerCase()));return j?(0,A.jsx)(m.A,{title:"Shell Command Configuration",open:n,onCancel:P,width:600,footer:[(0,A.jsx)(i.Ay,{onClick:P,children:"Cancel"},"cancel"),(0,A.jsx)(i.Ay,{loading:S,onClick:()=>T(!1),children:"Apply"},"apply"),(0,A.jsx)(i.Ay,{type:"primary",loading:S,onClick:()=>T(!0),children:"Save"},"save")],children:(0,A.jsxs)(p.A,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,A.jsxs)("div",{children:[(0,A.jsxs)(p.A,{align:"center",children:[(0,A.jsx)(g.A,{checked:j.enabled,onChange:async e=>{v(n=>(0,o.A)((0,o.A)({},n),{},{enabled:e})),await B(e)}}),(0,A.jsx)("span",{children:"Enable shell command execution"})]}),(0,A.jsx)("div",{style:{marginTop:8,color:"#666",fontSize:"12px"},children:"Enables execution of whitelisted commands for file operations, system inspection, and diagnostics"})]}),(0,A.jsx)(d.A,{}),(0,A.jsx)(t.A,{message:"Security Notice",description:"Only enable commands that are safe for AI execution. Git operations are limited to read-only and safe operations by default.",type:"info",showIcon:!0,style:{marginBottom:16}}),(0,A.jsxs)(r.A,{defaultActiveKey:["1"],ghost:!0,children:[(0,A.jsxs)(C,{header:"Basic Configuration",children:[(0,A.jsxs)("div",{children:[(0,A.jsx)("h4",{children:"Allowed Commands"}),(0,A.jsx)("div",{style:{marginBottom:12,color:"#666",fontSize:"12px"},children:"Commands that the AI agent can execute. These are loaded from the server configuration."}),(0,A.jsx)("div",{style:{marginBottom:12},children:(0,A.jsxs)(c.A.Group,{compact:!0,children:[(0,A.jsx)(c.A,{placeholder:"Add additional command",value:k,onChange:e=>O(e.target.value),onPressEnter:N,style:{width:"calc(100% - 80px)"}}),(0,A.jsx)(i.Ay,{type:"primary",icon:(0,A.jsx)(x.A,{}),onClick:N,style:{width:80},children:"Add"})]})}),j.allowedCommands&&j.allowedCommands.length>0&&(0,A.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:16},children:[...j.allowedCommands].sort().map(e=>(0,A.jsxs)(u.A,{closable:!0,color:L(e)?"red":"blue",onClose:()=>(e=>{j&&v(n=>(0,o.A)((0,o.A)({},n),{},{allowedCommands:n.allowedCommands.filter(n=>n!==e)}))})(e),style:{marginBottom:"4px"},children:[e,L(e)&&(0,A.jsx)(y.A,{style:{marginLeft:4,color:"#ff4d4f"}})]},e))})]}),(0,A.jsx)(d.A,{}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("h4",{children:["Command Timeout: ",j.timeout,"s"]}),(0,A.jsx)(f.A,{min:10,max:600,value:j.timeout,onChange:e=>v(n=>(0,o.A)((0,o.A)({},n),{},{timeout:e})),marks:{10:"10s",60:"1m",120:"2m",300:"5m",600:"10m"},style:{width:"100%",marginBottom:20}})]}),(0,A.jsx)(d.A,{}),(0,A.jsxs)("div",{children:[(0,A.jsxs)(p.A,{align:"center",style:{marginBottom:12},children:[(0,A.jsx)(g.A,{checked:j.gitOperationsEnabled,onChange:e=>v(n=>(0,o.A)((0,o.A)({},n),{},{gitOperationsEnabled:e}))}),(0,A.jsx)("span",{children:"Enable safe Git operations"})]}),(0,A.jsx)("div",{style:{marginBottom:12,color:"#666",fontSize:"12px"},children:"When enabled, allows read-only and safe Git commands"}),j.gitOperationsEnabled&&(0,A.jsxs)("div",{style:{marginLeft:24},children:[(0,A.jsx)("h5",{children:"Allowed Git Operations:"}),(0,A.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:["status","log","show","diff","branch","remote","config --get","ls-files","ls-tree","blame","tag","stash list","reflog","rev-parse","describe","shortlog","whatchanged"].map(e=>(0,A.jsxs)(l.A,{checked:j.safeGitOperations.includes(e),onChange:()=>(e=>{j&&v(n=>(0,o.A)((0,o.A)({},n),{},{safeGitOperations:n.safeGitOperations.includes(e)?n.safeGitOperations.filter(n=>n!==e):[...n.safeGitOperations,e]}))})(e),children:["git ",e]},e))})]})]})]},"1"),(0,A.jsx)(C,{header:"Advanced Configuration",children:(0,A.jsx)(t.A,{message:"Advanced Configuration",description:"This section is reserved for future advanced shell configuration options.",type:"info",showIcon:!0})},"2")]})]})}):(0,A.jsx)(m.A,{title:"Shell Command Configuration",open:n,onCancel:s,footer:null,children:(0,A.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:"Loading configuration..."})})}}}]);
//# sourceMappingURL=58350.3d231d54.chunk.js.map