project:
  type: website
  output-dir: ../docs

##

quartodoc:
  title: "API Reference"

  package: atdata
  dir: api
  
  style: pkgdown
  parser: google
  render_interlinks: true

  sections:
    # Core module
    - title: Core
      desc: Core types, decorators, and dataset classes
      contents:
        - name: packable
        - name: PackableSample
          children: embedded
        - name: DictSample
          children: embedded
        - name: Dataset
          children: embedded
        - name: SampleBatch
          children: embedded
        - name: Lens
          children: embedded
        - name: lens
        - name: load_dataset
        - name: DatasetDict
          children: embedded

    # Protocols
    - title: Protocols
      desc: Abstract protocols for storage backends
      contents:
        - kind: page
          path: Packable-protocol
          contents:
            - name: Packable
        - name: IndexEntry
        - name: AbstractIndex
        - name: AbstractDataStore
        - name: DataSource

    # Data Sources
    - title: Data Sources
      desc: Data source implementations for streaming
      contents:
        - name: URLSource
          children: embedded
        - name: S3Source
          children: embedded
        - name: BlobSource
          children: embedded

    # Local storage
    - title: Local Storage
      desc: Local Redis/S3 storage backend
      contents:
        - name: local.Index
          children: embedded
        - name: local.LocalDatasetEntry
          children: embedded
        - name: local.S3DataStore
          children: embedded

    # Atmosphere
    - title: Atmosphere
      desc: ATProto federation
      package: atdata.atmosphere
      contents:
        - name: AtmosphereClient
          children: embedded
        - name: AtmosphereIndex
          children: embedded
        - name: AtmosphereIndexEntry
          children: embedded
        - name: PDSBlobStore
          children: embedded
        - name: SchemaPublisher
        - name: SchemaLoader
        - name: DatasetPublisher
        - name: DatasetLoader
        - name: LensPublisher
        - name: LensLoader
        - name: AtUri

    # Promotion
    - title: Promotion
      desc: Local to atmosphere migration
      package: atdata.promote
      contents:
        - name: promote_to_atmosphere

#

website:
  title: "atdata"
  description: "A loose federation of distributed, typed datasets built on ATProto and WebDataset"
  site-url: https://github.com/forecast-bio/atdata

  repo-url: https://github.com/forecast-bio/atdata
  repo-actions: [issue]

  bread-crumbs: false

  navbar:
    # background: primary
    title: "atdata"
    left:
      # - text: "Guide"
      #   href: index.qmd
      - text: "Tutorials"
        menu:
          - text: "Quick Start"
            href: tutorials/quickstart.qmd
          - text: "Local Workflow"
            href: tutorials/local-workflow.qmd
          - text: "Atmosphere Publishing"
            href: tutorials/atmosphere.qmd
          - text: "Promotion Workflow"
            href: tutorials/promotion.qmd
      - text: "Reference"
        menu:
          - text: "Architecture Overview"
            href: reference/architecture.qmd
          - text: "Packable Samples"
            href: reference/packable-samples.qmd
          - text: "Datasets"
            href: reference/datasets.qmd
          - text: "Lenses"
            href: reference/lenses.qmd
          - text: "Local Storage"
            href: reference/local-storage.qmd
          - text: "Atmosphere"
            href: reference/atmosphere.qmd
          - text: "Promotion"
            href: reference/promotion.qmd
          - text: "load_dataset API"
            href: reference/load-dataset.qmd
          - text: "Protocols"
            href: reference/protocols.qmd
          - text: "URI Specification"
            href: reference/uri-spec.qmd
          - text: "Troubleshooting & FAQ"
            href: reference/troubleshooting.qmd
          - text: "Deployment Guide"
            href: reference/deployment.qmd
      - text: "API"
        href: api/index.qmd
    right:
      - icon: github
        href: https://github.com/forecast-bio/atdata

  sidebar:
    - title: "Guide"
      style: "docked"
      contents:
        - index.qmd
        - section: "Getting Started"
          contents:
            - tutorials/quickstart.qmd
            - tutorials/local-workflow.qmd
            - tutorials/atmosphere.qmd
            - tutorials/promotion.qmd
        - section: "Reference"
          contents:
            - reference/architecture.qmd
            - reference/packable-samples.qmd
            - reference/datasets.qmd
            - reference/lenses.qmd
            - reference/local-storage.qmd
            - reference/atmosphere.qmd
            - reference/promotion.qmd
            - reference/load-dataset.qmd
            - reference/protocols.qmd
            - reference/uri-spec.qmd
            - reference/troubleshooting.qmd
            - reference/deployment.qmd

  page-footer:
    left: "Built with [Quarto](https://quarto.org/)"
    right: "MIT License"

#

format:
  html:

    theme:
      - pandoc
      - brand
      - theme-light.scss
    css:
      - styles.css
      - assets/styles.css
    toc: true
    toc-location: right
    include-in-header:
    - text: |
        <style>
        .navbar-logo {
          max-height: unset;
          height: 18px;
          margin-top: -1px;
        }
        .navbar-brand {
          margin-top: 6px;
        }
        .navbar-brand.navbar-brand-logo {
          margin-right: 0px;
        }
        .navbar-title {
          color: #F95838;
          font-size: 19pt;
          font-family: 'Times New Roman';
          font-style: italic;
          letter-spacing: -0.6px;
        }
        </style>
    
    # theme:
    #   light: cosmo
    #   dark: darkly
    # css: assets/styles.css
    # toc: true
    # toc-depth: 3
    code-copy: true
    code-overflow: wrap
    highlight-style: github

execute:
  enabled: false
