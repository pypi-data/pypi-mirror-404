"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .configgroupcloud import ConfigGroupCloud, ConfigGroupCloudTypedDict
from .configgrouplookups import ConfigGroupLookups, ConfigGroupLookupsTypedDict
from .estimatedingestrateoptionsconfiggroup import EstimatedIngestRateOptionsConfigGroup
from .gittypeconfiggroup import GitTypeConfigGroup, GitTypeConfigGroupTypedDict
from .typeoptionsconfiggroup import TypeOptionsConfigGroup
from cribl_control_plane import models
from cribl_control_plane.types import BaseModel, UNSET_SENTINEL
import pydantic
from pydantic import field_serializer, model_serializer
from typing import List, Optional
from typing_extensions import Annotated, NotRequired, TypedDict


class GroupCreateRequestTypedDict(TypedDict):
    id: str
    cloud: NotRequired[ConfigGroupCloudTypedDict]
    deploying_worker_count: NotRequired[float]
    description: NotRequired[str]
    estimated_ingest_rate: NotRequired[EstimatedIngestRateOptionsConfigGroup]
    r"""Estimated ingest rate for Cloud Groups, in GB/sec."""
    git: NotRequired[GitTypeConfigGroupTypedDict]
    incompatible_worker_count: NotRequired[float]
    inherits: NotRequired[str]
    is_fleet: NotRequired[bool]
    r"""Indicates whether this is an Edge Fleet. This flag is deprecated — use to identify Edge Fleets."""
    is_search: NotRequired[bool]
    r"""Indicates whether this is an internal Search Group. This flag is deprecated — use to identify Search Groups."""
    lookup_deployments: NotRequired[List[ConfigGroupLookupsTypedDict]]
    max_worker_age: NotRequired[str]
    name: NotRequired[str]
    on_prem: NotRequired[bool]
    provisioned: NotRequired[bool]
    source_group_id: NotRequired[str]
    streamtags: NotRequired[List[str]]
    tags: NotRequired[str]
    type: NotRequired[TypeOptionsConfigGroup]
    upgrade_version: NotRequired[str]
    worker_count: NotRequired[float]
    worker_remote_access: NotRequired[bool]


class GroupCreateRequest(BaseModel):
    id: str

    cloud: Optional[ConfigGroupCloud] = None

    deploying_worker_count: Annotated[
        Optional[float], pydantic.Field(alias="deployingWorkerCount")
    ] = None

    description: Optional[str] = None

    estimated_ingest_rate: Annotated[
        Optional[EstimatedIngestRateOptionsConfigGroup],
        pydantic.Field(alias="estimatedIngestRate"),
    ] = None
    r"""Estimated ingest rate for Cloud Groups, in GB/sec."""

    git: Optional[GitTypeConfigGroup] = None

    incompatible_worker_count: Annotated[
        Optional[float], pydantic.Field(alias="incompatibleWorkerCount")
    ] = None

    inherits: Optional[str] = None

    is_fleet: Annotated[
        Optional[bool],
        pydantic.Field(
            deprecated="warning: ** DEPRECATED ** - This will be removed in a future release, please migrate away from it as soon as possible.",
            alias="isFleet",
        ),
    ] = None
    r"""Indicates whether this is an Edge Fleet. This flag is deprecated — use to identify Edge Fleets."""

    is_search: Annotated[
        Optional[bool],
        pydantic.Field(
            deprecated="warning: ** DEPRECATED ** - This will be removed in a future release, please migrate away from it as soon as possible.",
            alias="isSearch",
        ),
    ] = None
    r"""Indicates whether this is an internal Search Group. This flag is deprecated — use to identify Search Groups."""

    lookup_deployments: Annotated[
        Optional[List[ConfigGroupLookups]], pydantic.Field(alias="lookupDeployments")
    ] = None

    max_worker_age: Annotated[Optional[str], pydantic.Field(alias="maxWorkerAge")] = (
        None
    )

    name: Optional[str] = None

    on_prem: Annotated[Optional[bool], pydantic.Field(alias="onPrem")] = None

    provisioned: Optional[bool] = None

    source_group_id: Annotated[Optional[str], pydantic.Field(alias="sourceGroupId")] = (
        None
    )

    streamtags: Optional[List[str]] = None

    tags: Optional[str] = None

    type: Optional[TypeOptionsConfigGroup] = None

    upgrade_version: Annotated[
        Optional[str], pydantic.Field(alias="upgradeVersion")
    ] = None

    worker_count: Annotated[Optional[float], pydantic.Field(alias="workerCount")] = None

    worker_remote_access: Annotated[
        Optional[bool], pydantic.Field(alias="workerRemoteAccess")
    ] = None

    @field_serializer("estimated_ingest_rate")
    def serialize_estimated_ingest_rate(self, value):
        if isinstance(value, str):
            try:
                return models.EstimatedIngestRateOptionsConfigGroup(value)
            except ValueError:
                return value
        return value

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.TypeOptionsConfigGroup(value)
            except ValueError:
                return value
        return value

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(
            [
                "cloud",
                "deployingWorkerCount",
                "description",
                "estimatedIngestRate",
                "git",
                "incompatibleWorkerCount",
                "inherits",
                "isFleet",
                "isSearch",
                "lookupDeployments",
                "maxWorkerAge",
                "name",
                "onPrem",
                "provisioned",
                "sourceGroupId",
                "streamtags",
                "tags",
                "type",
                "upgradeVersion",
                "workerCount",
                "workerRemoteAccess",
            ]
        )
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m
