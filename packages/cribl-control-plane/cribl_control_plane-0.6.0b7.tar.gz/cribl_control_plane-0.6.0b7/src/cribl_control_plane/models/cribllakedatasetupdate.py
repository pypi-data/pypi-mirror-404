"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .cacheconnection import CacheConnection, CacheConnectionTypedDict
from .formatoptions import FormatOptions
from .lakedatasetmetrics import LakeDatasetMetrics, LakeDatasetMetricsTypedDict
from .lakedatasetsearchconfig import (
    LakeDatasetSearchConfig,
    LakeDatasetSearchConfigTypedDict,
)
from cribl_control_plane import models
from cribl_control_plane.types import BaseModel, UNSET_SENTINEL
import pydantic
from pydantic import field_serializer, model_serializer
from typing import List, Optional
from typing_extensions import Annotated, NotRequired, TypedDict


class CriblLakeDatasetUpdateTypedDict(TypedDict):
    accelerated_fields: NotRequired[List[str]]
    bucket_name: NotRequired[str]
    cache_connection: NotRequired[CacheConnectionTypedDict]
    deletion_started_at: NotRequired[float]
    description: NotRequired[str]
    format_: NotRequired[FormatOptions]
    http_da_used: NotRequired[bool]
    id: NotRequired[str]
    metrics: NotRequired[LakeDatasetMetricsTypedDict]
    retention_period_in_days: NotRequired[float]
    search_config: NotRequired[LakeDatasetSearchConfigTypedDict]
    storage_location_id: NotRequired[str]
    view_name: NotRequired[str]


class CriblLakeDatasetUpdate(BaseModel):
    accelerated_fields: Annotated[
        Optional[List[str]], pydantic.Field(alias="acceleratedFields")
    ] = None

    bucket_name: Annotated[Optional[str], pydantic.Field(alias="bucketName")] = None

    cache_connection: Annotated[
        Optional[CacheConnection], pydantic.Field(alias="cacheConnection")
    ] = None

    deletion_started_at: Annotated[
        Optional[float], pydantic.Field(alias="deletionStartedAt")
    ] = None

    description: Optional[str] = None

    format_: Annotated[Optional[FormatOptions], pydantic.Field(alias="format")] = None

    http_da_used: Annotated[Optional[bool], pydantic.Field(alias="httpDAUsed")] = None

    id: Optional[str] = None

    metrics: Optional[LakeDatasetMetrics] = None

    retention_period_in_days: Annotated[
        Optional[float], pydantic.Field(alias="retentionPeriodInDays")
    ] = None

    search_config: Annotated[
        Optional[LakeDatasetSearchConfig], pydantic.Field(alias="searchConfig")
    ] = None

    storage_location_id: Annotated[
        Optional[str], pydantic.Field(alias="storageLocationId")
    ] = None

    view_name: Annotated[Optional[str], pydantic.Field(alias="viewName")] = None

    @field_serializer("format_")
    def serialize_format_(self, value):
        if isinstance(value, str):
            try:
                return models.FormatOptions(value)
            except ValueError:
                return value
        return value

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(
            [
                "acceleratedFields",
                "bucketName",
                "cacheConnection",
                "deletionStartedAt",
                "description",
                "format",
                "httpDAUsed",
                "id",
                "metrics",
                "retentionPeriodInDays",
                "searchConfig",
                "storageLocationId",
                "viewName",
            ]
        )
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m
