"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .diffline import DiffLine, DiffLineTypedDict
from cribl_control_plane.types import BaseModel, UNSET_SENTINEL
import pydantic
from pydantic import model_serializer
from typing import List, Optional, Union
from typing_extensions import Annotated, NotRequired, TypeAliasType, TypedDict


class BlockTypedDict(TypedDict):
    header: str
    lines: List[DiffLineTypedDict]
    r"""Diff Line"""
    new_start_line: float
    old_start_line: float
    old_start_line2: NotRequired[float]


class Block(BaseModel):
    header: str

    lines: List[DiffLine]
    r"""Diff Line"""

    new_start_line: Annotated[float, pydantic.Field(alias="newStartLine")]

    old_start_line: Annotated[float, pydantic.Field(alias="oldStartLine")]

    old_start_line2: Annotated[
        Optional[float], pydantic.Field(alias="oldStartLine2")
    ] = None

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(["oldStartLine2"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m


ChecksumBeforeTypedDict = TypeAliasType(
    "ChecksumBeforeTypedDict", Union[str, List[str]]
)


ChecksumBefore = TypeAliasType("ChecksumBefore", Union[str, List[str]])


OldModeTypedDict = TypeAliasType("OldModeTypedDict", Union[str, List[str]])


OldMode = TypeAliasType("OldMode", Union[str, List[str]])


class DiffFilesTypedDict(TypedDict):
    added_lines: float
    blocks: List[BlockTypedDict]
    deleted_lines: float
    is_combined: bool
    is_git_diff: bool
    language: str
    new_name: str
    old_name: str
    changed_percentage: NotRequired[float]
    checksum_after: NotRequired[str]
    checksum_before: NotRequired[ChecksumBeforeTypedDict]
    deleted_file_mode: NotRequired[str]
    is_binary: NotRequired[bool]
    is_copy: NotRequired[bool]
    is_deleted: NotRequired[bool]
    is_new: NotRequired[bool]
    is_rename: NotRequired[bool]
    is_too_big: NotRequired[bool]
    mode: NotRequired[str]
    new_file_mode: NotRequired[str]
    new_mode: NotRequired[str]
    old_mode: NotRequired[OldModeTypedDict]
    unchanged_percentage: NotRequired[float]


class DiffFiles(BaseModel):
    added_lines: Annotated[float, pydantic.Field(alias="addedLines")]

    blocks: List[Block]

    deleted_lines: Annotated[float, pydantic.Field(alias="deletedLines")]

    is_combined: Annotated[bool, pydantic.Field(alias="isCombined")]

    is_git_diff: Annotated[bool, pydantic.Field(alias="isGitDiff")]

    language: str

    new_name: Annotated[str, pydantic.Field(alias="newName")]

    old_name: Annotated[str, pydantic.Field(alias="oldName")]

    changed_percentage: Annotated[
        Optional[float], pydantic.Field(alias="changedPercentage")
    ] = None

    checksum_after: Annotated[Optional[str], pydantic.Field(alias="checksumAfter")] = (
        None
    )

    checksum_before: Annotated[
        Optional[ChecksumBefore], pydantic.Field(alias="checksumBefore")
    ] = None

    deleted_file_mode: Annotated[
        Optional[str], pydantic.Field(alias="deletedFileMode")
    ] = None

    is_binary: Annotated[Optional[bool], pydantic.Field(alias="isBinary")] = None

    is_copy: Annotated[Optional[bool], pydantic.Field(alias="isCopy")] = None

    is_deleted: Annotated[Optional[bool], pydantic.Field(alias="isDeleted")] = None

    is_new: Annotated[Optional[bool], pydantic.Field(alias="isNew")] = None

    is_rename: Annotated[Optional[bool], pydantic.Field(alias="isRename")] = None

    is_too_big: Annotated[Optional[bool], pydantic.Field(alias="isTooBig")] = None

    mode: Optional[str] = None

    new_file_mode: Annotated[Optional[str], pydantic.Field(alias="newFileMode")] = None

    new_mode: Annotated[Optional[str], pydantic.Field(alias="newMode")] = None

    old_mode: Annotated[Optional[OldMode], pydantic.Field(alias="oldMode")] = None

    unchanged_percentage: Annotated[
        Optional[float], pydantic.Field(alias="unchangedPercentage")
    ] = None

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(
            [
                "changedPercentage",
                "checksumAfter",
                "checksumBefore",
                "deletedFileMode",
                "isBinary",
                "isCopy",
                "isDeleted",
                "isNew",
                "isRename",
                "isTooBig",
                "mode",
                "newFileMode",
                "newMode",
                "oldMode",
                "unchangedPercentage",
            ]
        )
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m
