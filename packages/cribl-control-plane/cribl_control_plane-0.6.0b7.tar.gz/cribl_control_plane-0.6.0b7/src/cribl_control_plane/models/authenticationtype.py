"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .authenticationmethodoptionssasl import AuthenticationMethodOptionsSasl
from .itemstypesasloauthparams import (
    ItemsTypeSaslOauthParams,
    ItemsTypeSaslOauthParamsTypedDict,
)
from .itemstypesaslsaslextensions import (
    ItemsTypeSaslSaslExtensions,
    ItemsTypeSaslSaslExtensionsTypedDict,
)
from .saslmechanismoptionssasl import SaslMechanismOptionsSasl
from cribl_control_plane import models
from cribl_control_plane.types import BaseModel, UNSET_SENTINEL
import pydantic
from pydantic import field_serializer, model_serializer
from typing import List, Optional
from typing_extensions import Annotated, NotRequired, TypedDict


class AuthenticationTypeTypedDict(TypedDict):
    r"""Authentication parameters to use when connecting to brokers. Using TLS is highly recommended."""

    disabled: bool
    username: NotRequired[str]
    password: NotRequired[str]
    auth_type: NotRequired[AuthenticationMethodOptionsSasl]
    r"""Enter credentials directly, or select a stored secret"""
    credentials_secret: NotRequired[str]
    r"""Select or create a secret that references your credentials"""
    mechanism: NotRequired[SaslMechanismOptionsSasl]
    keytab_location: NotRequired[str]
    r"""Location of keytab file for authentication principal"""
    principal: NotRequired[str]
    r"""Authentication principal, such as `kafka_user@example.com`"""
    broker_service_class: NotRequired[str]
    r"""Kerberos service class for Kafka brokers, such as `kafka`"""
    oauth_enabled: NotRequired[bool]
    r"""Enable OAuth authentication"""
    token_url: NotRequired[str]
    r"""URL of the token endpoint to use for OAuth authentication"""
    client_id: NotRequired[str]
    r"""Client ID to use for OAuth authentication"""
    oauth_secret_type: NotRequired[str]
    client_text_secret: NotRequired[str]
    r"""Select or create a stored text secret"""
    oauth_params: NotRequired[List[ItemsTypeSaslOauthParamsTypedDict]]
    r"""Additional fields to send to the token endpoint, such as scope or audience"""
    sasl_extensions: NotRequired[List[ItemsTypeSaslSaslExtensionsTypedDict]]
    r"""Additional SASL extension fields, such as Confluent's logicalCluster or identityPoolId"""


class AuthenticationType(BaseModel):
    r"""Authentication parameters to use when connecting to brokers. Using TLS is highly recommended."""

    disabled: bool

    username: Optional[str] = None

    password: Optional[str] = None

    auth_type: Annotated[
        Optional[AuthenticationMethodOptionsSasl], pydantic.Field(alias="authType")
    ] = None
    r"""Enter credentials directly, or select a stored secret"""

    credentials_secret: Annotated[
        Optional[str], pydantic.Field(alias="credentialsSecret")
    ] = None
    r"""Select or create a secret that references your credentials"""

    mechanism: Optional[SaslMechanismOptionsSasl] = None

    keytab_location: Annotated[
        Optional[str], pydantic.Field(alias="keytabLocation")
    ] = None
    r"""Location of keytab file for authentication principal"""

    principal: Optional[str] = None
    r"""Authentication principal, such as `kafka_user@example.com`"""

    broker_service_class: Annotated[
        Optional[str], pydantic.Field(alias="brokerServiceClass")
    ] = None
    r"""Kerberos service class for Kafka brokers, such as `kafka`"""

    oauth_enabled: Annotated[Optional[bool], pydantic.Field(alias="oauthEnabled")] = (
        None
    )
    r"""Enable OAuth authentication"""

    token_url: Annotated[Optional[str], pydantic.Field(alias="tokenUrl")] = None
    r"""URL of the token endpoint to use for OAuth authentication"""

    client_id: Annotated[Optional[str], pydantic.Field(alias="clientId")] = None
    r"""Client ID to use for OAuth authentication"""

    oauth_secret_type: Annotated[
        Optional[str], pydantic.Field(alias="oauthSecretType")
    ] = None

    client_text_secret: Annotated[
        Optional[str], pydantic.Field(alias="clientTextSecret")
    ] = None
    r"""Select or create a stored text secret"""

    oauth_params: Annotated[
        Optional[List[ItemsTypeSaslOauthParams]], pydantic.Field(alias="oauthParams")
    ] = None
    r"""Additional fields to send to the token endpoint, such as scope or audience"""

    sasl_extensions: Annotated[
        Optional[List[ItemsTypeSaslSaslExtensions]],
        pydantic.Field(alias="saslExtensions"),
    ] = None
    r"""Additional SASL extension fields, such as Confluent's logicalCluster or identityPoolId"""

    @field_serializer("auth_type")
    def serialize_auth_type(self, value):
        if isinstance(value, str):
            try:
                return models.AuthenticationMethodOptionsSasl(value)
            except ValueError:
                return value
        return value

    @field_serializer("mechanism")
    def serialize_mechanism(self, value):
        if isinstance(value, str):
            try:
                return models.SaslMechanismOptionsSasl(value)
            except ValueError:
                return value
        return value

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(
            [
                "username",
                "password",
                "authType",
                "credentialsSecret",
                "mechanism",
                "keytabLocation",
                "principal",
                "brokerServiceClass",
                "oauthEnabled",
                "tokenUrl",
                "clientId",
                "oauthSecretType",
                "clientTextSecret",
                "oauthParams",
                "saslExtensions",
            ]
        )
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m
