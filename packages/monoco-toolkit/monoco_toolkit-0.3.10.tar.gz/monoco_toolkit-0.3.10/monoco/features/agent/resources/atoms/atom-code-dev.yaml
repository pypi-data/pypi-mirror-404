---
name: atom-code-dev
type: atom
domain: code
description: 代码开发的原子操作 - 调研、实现、测试、文档
version: 1.0.0
author: Monoco Toolkit

# 系统级合规规则
compliance_rules:
  - rule: "遵循项目代码规范"
    severity: warning
  
  - rule: "优先编写测试"
    severity: warning
    mindset: "TDD"
  
  - rule: "保持代码简单直观"
    severity: info
    mindset: "KISS"

# 原子操作定义
operations:
  - name: investigate
    description: 理解需求与上下文，识别相关代码和依赖
    reminder: "理解需求后再开始编码，识别相关文件和依赖 Issue"
    checkpoints:
      - "阅读并理解 Issue 描述"
      - "识别相关代码文件"
      - "检查依赖 Issue 状态"
      - "评估技术可行性"
    output: "技术方案草稿、风险清单"
  
  - name: implement
    description: 实现代码变更
    reminder: "遵循项目代码规范，小步提交，处理边界情况"
    checkpoints:
      - "遵循项目代码规范"
      - "编写/更新必要的文档"
      - "处理边界情况"
      - "保持代码可审查性（单次提交 < 400 行）"
  
  - name: test
    description: 运行测试确保代码质量
    reminder: "所有测试必须通过，检查测试覆盖率"
    checkpoints:
      - "编写/更新单元测试"
      - "运行测试套件 (pytest, cargo test, etc.)"
      - "修复失败的测试"
      - "检查测试覆盖率"
    compliance_rules:
      - rule: "所有单元测试必须通过后才能提交"
        severity: error
  
  - name: document
    description: 更新文档
    reminder: "代码变更必须同步更新文档"
    checkpoints:
      - "更新代码注释"
      - "更新相关文档"
      - "更新 CHANGELOG（如适用）"
