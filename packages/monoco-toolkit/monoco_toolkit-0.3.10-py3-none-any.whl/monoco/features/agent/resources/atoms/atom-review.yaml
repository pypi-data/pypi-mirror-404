---
name: atom-review
type: atom
domain: review
description: 代码评审的原子操作 - 检出、验证、对抗、反馈
version: 1.0.0
author: Monoco Toolkit

# 系统级合规规则
compliance_rules:
  - rule: "必须先通过 Engineer 的测试 (Verify)，再进行对抗测试 (Challenge)"
    severity: error
  
  - rule: "必须尝试编写至少一个边界测试用例"
    severity: warning
  
  - rule: "禁止未经测试直接 Approve"
    severity: error

# 原子操作定义
operations:
  - name: checkout
    description: 检出待评审的代码
    reminder: "获取待评审的 PR/Branch，确认与 Base 分支的差异"
    checkpoints:
      - "检出 PR/Branch"
      - "确认与 Base 分支的差异"
      - "检查环境配置"
  
  - name: verify
    description: 验证 Engineer 提交的测试 (White-box)
    reminder: "先运行 Engineer 编写的测试，验证功能正确性"
    checkpoints:
      - "运行 Engineer 编写的单元测试"
      - "运行集成测试（如适用）"
      - "检查测试覆盖率报告"
    compliance_rules:
      - rule: "如果现有测试失败，直接进入 Reject 流程"
        severity: error
  
  - name: challenge
    description: 对抗测试，尝试破坏代码 (Black-box / Edge Cases)
    reminder: "Try to break it - 寻找边界情况和安全漏洞"
    checkpoints:
      - "分析代码逻辑，寻找盲区（并发、大/小数值、注入攻击等）"
      - "编写新的 Challenge Test Cases"
      - "运行这些新测试"
    compliance_rules:
      - rule: "必须尝试编写至少一个边界测试用例"
        severity: warning
  
  - name: feedback
    description: 提供评审反馈
    reminder: "明确批准、拒绝或请求修改，提供具体反馈"
    checkpoints:
      - "功能是否正确实现"
      - "代码是否符合设计规范"
      - "测试是否充分"
      - "文档是否同步更新"
      - "是否遵循项目规范"
