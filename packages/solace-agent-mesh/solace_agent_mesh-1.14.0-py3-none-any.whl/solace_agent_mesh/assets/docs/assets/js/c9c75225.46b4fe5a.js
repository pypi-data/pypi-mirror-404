"use strict";(self.webpackChunksolace_agenitc_mesh_docs=self.webpackChunksolace_agenitc_mesh_docs||[]).push([[9291],{7898:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"documentation/enterprise/auth-proxy","title":"Authentication Proxy","description":"Gateway OAuth enables apps and gateways (like MCP) to authenticate via the OAuth2 service without registering separate redirect URIs with OAuth providers. Apps redirect directly to the auth server, which handles the OAuth flow and returns a gateway code that can be exchanged for tokens.","source":"@site/docs/documentation/enterprise/auth-proxy.md","sourceDirName":"documentation/enterprise","slug":"/documentation/enterprise/auth-proxy","permalink":"/solace-agent-mesh/docs/documentation/enterprise/auth-proxy","draft":false,"unlisted":false,"editUrl":"https://github.com/SolaceLabs/solace-agent-mesh/edit/main/docs/docs/documentation/enterprise/auth-proxy.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"title":"Authentication Proxy","sidebar_position":12},"sidebar":"docSidebar","previous":{"title":"Enabling SSO","permalink":"/solace-agent-mesh/docs/documentation/enterprise/single-sign-on"},"next":{"title":"Secure User Delegated Access","permalink":"/solace-agent-mesh/docs/documentation/enterprise/secure-user-delegated-access"}}');var a=n(4848),o=n(8453);const i={title:"Authentication Proxy",sidebar_position:12},s="Authentication Proxy",c={},d=[{value:"How It Works",id:"how-it-works",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Gateway Configuration",id:"gateway-configuration",level:3}];function l(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",mermaid:"mermaid",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"authentication-proxy",children:"Authentication Proxy"})}),"\n",(0,a.jsx)(t.p,{children:"Gateway OAuth enables apps and gateways (like MCP) to authenticate via the OAuth2 service without registering separate redirect URIs with OAuth providers. Apps redirect directly to the auth server, which handles the OAuth flow and returns a gateway code that can be exchanged for tokens."}),"\n",(0,a.jsx)(t.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,a.jsx)(t.p,{children:"High-level flow of the authentication proxy:"}),"\n",(0,a.jsx)(t.mermaid,{value:"graph TD\n    D[MCP Client<br> e.g. Claude Code] --\x3e A;\n    A[MCP Server Gateway<br>port 8090] --\x3e B;\n    B[OAuth2 Service<br>port 8080] --\x3e C;\n    C[OAuth Provider] --\x3e B;\n    B --\x3e A;\n    A --\x3e D;\n    linkStyle 0 stroke-width:2px,fill:none,stroke:white;\n    linkStyle 1 stroke-width:2px,fill:none,stroke:white;\n    linkStyle 2 stroke-width:2px,fill:none,stroke:white;\n    linkStyle 3 stroke-width:2px,fill:none,stroke:grey;\n    linkStyle 4 stroke-width:2px,fill:none,stroke:grey;\n    linkStyle 5 stroke-width:2px,fill:none,stroke:grey;"}),"\n",(0,a.jsx)(t.p,{children:"Detailed sequence diagram of the OAuth2 authentication proxy flow:"}),"\n",(0,a.jsx)(t.mermaid,{value:"sequenceDiagram\n    participant MC as MCP Client\n    participant UB as User Browser\n    participant AG as MCP Server Gateway\n    participant AS as Auth Server (OAuth2)\n    participant OP as OAuth Provider\n\n    MC->>+AG: 1. GET /.well-known/oauth-authorization-server\n    AG--\x3e>-MC: 2. Returns auth address\n\n    MC->>UB: 3. Opens browser at auth URL\n    Note right of MC: Includes redirect_uri and code params\n\n    UB->>+AG: 4. GET /oauth/authorize\n    AG--\x3e>-UB: 5. Redirect: /login?gateway_uri=...\n\n    Note over UB, AS: User is redirected to Auth Server\n    UB->>+AS: Follows redirect\n    AS--\x3e>-UB: 6. Redirect to OAuth Provider\n\n    Note over UB, OP: User is redirected to OAuth Provider\n    UB->>+OP: Follows redirect\n    OP--\x3e>-UB: 7. User authenticates & grants consent\n\n    Note over OP, AS: Provider redirects back to Auth Server with auth code\n    OP->>+AS: 8. Redirect: /callback?code=...\n    \n    AS->>+OP: 9. Exchange authorization code for tokens\n    OP--\x3e>-AS: Returns access_token, refresh_token\n\n    Note over AS, UB: Auth Server creates a gateway code and redirects to App\n    AS--\x3e>-UB: 10. Redirect: /oauth/callback?code=GATEWAY_CODE\n\n    Note over UB, AG: User is redirected back to the App Gateway\n    UB->>+AG: Follows redirect with GATEWAY_CODE\n    \n    AG->>+AS: 11. Exchange gateway code for tokens\n    AS--\x3e>-AG: Returns access_token, refresh_token\n    AG--\x3e>MC: 12. Return access_token to client"}),"\n",(0,a.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,a.jsxs)(t.p,{children:["To enable the authentication proxy, add the following to your OAuth2 YAML configuration, usually named ",(0,a.jsx)(t.code,{children:"oauth2_config.yaml"})]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",children:'# This enables apps to redirect through this auth server for OAuth\nproxy_oauth:\n  enabled: true\n  # Whitelist of allowed gateway callback URIs\n  # Apps with URIs in this list can use this auth server for OAuth proxy\n  allowed_redirect_uris:\n    - "http://localhost:8090/oauth/callback"  # MCP gateway\n    - "http://localhost:*"  # Wildcard for development - requires strict_uri_validation set to `false`\n    - "https://mcp.example.com/oauth/callback"  # Production Example\n\n  # Gateway code time-to-live in seconds (default: 300 = 5 minutes)\n  # Codes expire after this time for security\n  gateway_code_ttl_seconds: 300\n\n  # URI validation mode (default: false = wildcard matching allowed)\n  # Set to true for production to require exact URI matches\n  strict_uri_validation: false\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Update ",(0,a.jsx)(t.code,{children:"allowed_redirect_uris"})," with the actual callback URIs of your gateways."]}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["The path ",(0,a.jsx)(t.code,{children:"/gateway-oauth"})," must be exposed and accessible in your deployment environment (e.g., Docker, Kubernetes) and it should point to the Auth Server service port."]})}),"\n",(0,a.jsx)(t.h3,{id:"gateway-configuration",children:"Gateway Configuration"}),"\n",(0,a.jsxs)(t.p,{children:["In your MCP Gateway configuration YAML (e.g. ",(0,a.jsx)(t.code,{children:"my-mcp-gateway.yaml"}),"), update the ",(0,a.jsx)(t.code,{children:"adapter"})," section to enable OAuth and point to the Auth Server:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",children:"adapter_config:\n    enable_auth: ${OAUTH2_ENABLED}\n\n    external_auth_service_url: ${EXTERNAL_AUTH_SERVICE_URL, http://localhost:8080}\n    external_auth_provider: ${EXTERNAL_AUTH_PROVIDER, azure}\n"})})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>s});var r=n(6540);const a={},o=r.createContext(a);function i(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);