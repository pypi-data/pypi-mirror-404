test_case_id: "switch_workflow_default_case_001"
description: "Tests a switch workflow where no case matches and default is used"
tags: ["all", "workflows", "switch"]
skip_intermediate_events: true
expected_completion_timeout_seconds: 30

test_runner_config_overrides:
  agent_config:
    artifact_scope: "namespace"

gateway_input:
  target_agent_name: "SwitchTestWorkflow"
  user_identity: "workflow_test_user@example.com"
  external_context:
    a2a_session_id: "switch_default_test_session"
  parts:
    - type: "data"
      data:
        action: "unknown_action"

llm_interactions:
  # default_handler (TestPeerAgentA): Handle unknown action
  - static_response:
      choices:
        - message:
            role: "assistant"
            content: |
              «««save_artifact: filename="default_output.json" mime_type="application/json" description="Default handler result"
              {"result": "Handled unknown action", "action": "default"}
              »»»
    expected_request:
      tools_present: ["load_artifact"]

  # System processes the artifact save notification
  - static_response:
      choices:
        - message:
            role: "assistant"
            content: "Default action completed. «result:artifact=default_output.json:0 status=success»"

expected_gateway_output:
  - type: "final_response"
    task_state: "completed"
