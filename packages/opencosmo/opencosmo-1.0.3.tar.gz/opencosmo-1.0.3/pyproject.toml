[project]
name = "opencosmo"
version = "1.0.3"
description = "OpenCosmo Python Toolkit"
authors = [
  { name = "Patrick Wells", email = "pwells@anl.gov" },
  { name = "Will Hicks", email = "whicks@anl.gov"},
  { name = "Patricia Larsen", email = "prlarsen@anl.gov" },
  { name = "Michael Buehlmann", email = "mbuehlmann@anl.gov" }

]
readme = "README.md"
requires-python = ">=3.11,<3.15"

dependencies = [
  "h5py>=3.12.1,<4.0.0",
  "astropy>=7.2.0,<8.0.0",
  "pydantic>=2.10.6,<3.0.0",
  "hdf5plugin>=5.0.0,<6.0.0",
  "healpy>=1.18.1,<2.0.0",
  "healsparse==1.11.1",
  "deprecated>=1.2.18,<2.0.0",
  "numpy>=2.0,<2.4",
  "click (>=8.2.1,<9.0.0)",
  "numba>=0.62.1",
  "rustworkx>=0.17.1",
]

[dependency-groups]
dev = [
  "ruff>=0.9.4,<1.0.0",
  "mypy>=1.15,<2.0.0",
  "types-deprecated>=1.2.15.20250304",
  "pre-commit>=4.2.0,<5.0.0",
  "towncrier (>=24.8.0,<25.0.0)",
  "pip>=25.1.1",
  "pytest>=8.3.4,<9.0.0",
  "pytest-timeout>=2.4.0",
]
docs = [
  "sphinx>=9.0.0",
  "sphinx-rtd-theme>=3.0.2,<4.0.0",
  "autodoc-pydantic>=2.2.0,<3.0.0",
]
mpi = [
  "mpi4py>=3.1.0,<5.0.0"
]
test = [
    "pandas>=2.3.3",
    "pandas-stubs>=2.3.2.250926",
    "polars>=1.35.2",
    "pyarrow>=21.0.0",
    "pyxsim>=4.4.3",
    "yt>=4.4.1",
]
test-mpi = [
  "mpi-pytest>=2025.4.0,<2026.0.0"
]
[project.scripts]
opencosmo = "opencosmo.analysis.cli:cli"

[project.optional-dependencies]
io = [
    "pyarrow>=21.0.0",
]

[build-system]
requires = ["uv_build>=0.8.2,<0.9.0", "pip"]
build-backend = "uv_build"

[tool.uv.build-backend]
source-include = ["LICENSE.md"]


[[tool.mypy.overrides]]
module = ["h5py", "astropy.*", "healpy", "healsparse", "numba"]
ignore_missing_imports = true

[tool.towncrier]
directory = "changes"
package = "opencosmo"
filename = "docs/source/changelog.rst"

[tool.pytest.ini_options]
testpaths = ["test"]
log_cli = true
log_cli_level = "INFO"

[tool.pyrefly]
project-includes = [
    "**/*.py*",
]
replace-imports-with-any = ["astropy.units", "astropy.constants"]

[lint.pycodestyle]
max-doc-length = 90

[tool.ruff.lint]
future-annotations = true
preview = true
extend-select = ["TC"]

[tool.towncrier.fragment.improvement]
name = "Improvements"
showcontent = true

[tool.towncrier.fragment.feature]
name = "New Features"

[tool.towncrier.fragment.bugfix]
name = "Bugfixes"

[tool.towncrier.fragment.doc]
name = "Documentation"

[tool.towncrier.fragment.removal]
name = "Deprecations and Removals"

[tool.towncrier.fragment.misc]
name = "Miscellaneous"

