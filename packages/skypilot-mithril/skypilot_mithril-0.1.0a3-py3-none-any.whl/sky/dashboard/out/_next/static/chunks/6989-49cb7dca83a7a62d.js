"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6989],{88950:function(e,t,n){n.d(t,{Bw:function(){return p},Ph:function(){return d},Ql:function(){return x},i4:function(){return f},ki:function(){return u}});var r=n(85893),a=n(67294),o=n(2067),s=n(45895),l=n(7242),i=n(70282),c=n(32350);let d=o.fC;o.ZA;let u=o.B4,f=a.forwardRef((e,t)=>{let{className:n,children:a,...l}=e;return(0,r.jsxs)(o.xz,{ref:t,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n),...l,children:[a,(0,r.jsx)(o.JO,{asChild:!0,children:(0,r.jsx)(s.Z,{className:"h-4 w-4 opacity-50"})})]})});f.displayName=o.xz.displayName;let m=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(o.u_,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",n),...a,children:(0,r.jsx)(l.Z,{className:"h-4 w-4"})})});m.displayName=o.u_.displayName;let h=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(o.$G,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",n),...a,children:(0,r.jsx)(s.Z,{className:"h-4 w-4"})})});h.displayName=o.$G.displayName;let p=a.forwardRef((e,t)=>{let{className:n,children:a,position:s="popper",...l}=e;return(0,r.jsx)(o.h_,{children:(0,r.jsxs)(o.VY,{ref:t,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:s,...l,children:[(0,r.jsx)(m,{}),(0,r.jsx)(o.l_,{className:(0,c.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(h,{})]})})});p.displayName=o.VY.displayName,a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(o.__,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",n),...a})}).displayName=o.__.displayName;let x=a.forwardRef((e,t)=>{let{className:n,children:a,...s}=e;return(0,r.jsxs)(o.ck,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...s,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(o.wU,{children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(o.eT,{children:a})]})});x.displayName=o.ck.displayName,a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(o.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",n),...a})}).displayName=o.Z0.displayName},36989:function(e,t,n){n.d(t,{$3:function(){return p},$B:function(){return b},Kl:function(){return S},LU:function(){return x},Md:function(){return h},WH:function(){return m},Zg:function(){return w},Zn:function(){return g},Zt:function(){return y},os:function(){return _},sY:function(){return N},x9:function(){return k},xn:function(){return j},yc:function(){return u}});var r=n(85893),a=n(67294),o=n(53302),s=n(11886),l=n(88950),i=n(51214),c=n(41664),d=n.n(c);let u=i.nb.REFRESH_INTERVAL,f={placement:"bottom",color:"default"},m=e=>{let{children:t,...n}=e,a=n.content;return n.content=void 0,(0,r.jsx)(o.e,{...f,...n,content:(0,r.jsx)("span",{className:"left-full w-max px-2 py-1 text-sm text-gray-100 bg-gray-500 text-sm capitalize rounded",children:a}),children:t})},h=e=>{let{children:t,...n}=e,a=n.content;return n.content=void 0,(0,r.jsx)(o.e,{...f,...n,content:(0,r.jsx)("span",{className:"left-full w-max px-2 py-1 text-sm text-gray-100 bg-gray-500 text-sm rounded whitespace-pre-line",children:a}),children:t})},p=e=>{let t,{timestamp:n,className:o=""}=e,[,s]=(0,a.useState)(0);if((0,a.useEffect)(()=>{if(!n)return;let e=setInterval(()=>{s(e=>e+1)},1e4);return()=>clearInterval(e)},[n]),!n)return null;let l=new Date-n;return t=l<5e3?"just now":l<6e4?"".concat(Math.floor(l/1e3),"s ago"):l<36e5?"".concat(Math.floor(l/6e4),"m ago"):l<864e5?"".concat(Math.floor(l/36e5),"h ago"):"".concat(Math.floor(l/864e5),"d ago"),(0,r.jsx)(h,{content:"Last updated: ".concat(n.toLocaleString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!1,timeZoneName:"short"}).replace(",","")),className:"text-sm text-muted-foreground",children:(0,r.jsxs)("span",{className:"text-xs text-gray-500 ".concat(o),children:["Updated ",t]})})};function x(e){if(!e&&0!==e)return"-";let t=e=Math.floor(e),n="",r=0;for(let e of[{value:31536e3,label:"y"},{value:2592e3,label:"mo"},{value:86400,label:"d"},{value:3600,label:"h"},{value:60,label:"m"},{value:1,label:"s"}])if(t>=e.value&&r<2){let a=Math.floor(t/e.value);n+="".concat(a).concat(e.label," "),t%=e.value,r++}return n.trim()||"0s"}function g(e){return e.replace(/\x1b\[([0-9]{1,2}(;[0-9]{1,2})?)?[mGKH]/g,"")}function y(e){return!!(!e||e.includes("<sky-payload")||/rich_(init|update|start|exit)/i.test(e)||/<rich_.*?>.*<\/rich_.*?>/i.test(e)||/^├──/.test(e)||/^└──/.test(e))}function b(e){let{logs:t,controller:n=!1}=e,[o,s]=(0,a.useState)("all"),i=t?Array.isArray(t)?t:"string"==typeof t?t.split("\n").filter(e=>""!==e):[]:[],[c,d]=(0,a.useState)(i),[u,f]=(0,a.useState)([]);return(0,a.useEffect)(()=>{f(function(e){let t;let n=/\((head|worker\d+),/g,r=new Set;for(;null!==(t=n.exec(e));)r.add(t[1]);return Array.from(r).sort((e,t)=>"head"===e?-1:"head"===t?1:e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"}))}(i.join("\n")))},[i]),(0,a.useEffect)(()=>{"all"===o?d(i):d(i.filter(e=>e.includes("(".concat(o,","))))},[o,i]),(0,r.jsxs)("div",{children:[(0,r.jsx)("style",{children:'\n  .logs-container {\n    background-color: #f7f7f7;\n    padding: 16px;\n    max-height: calc(100vh - 300px);\n    overflow-y: auto;\n    overflow-x: hidden;\n    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;\n    line-height: 1.5;\n    border-radius: 6px;\n    min-height: fit-content;\n  }\n\n  .log-line {\n    display: block;\n    white-space: pre-wrap;\n    margin: 2px 0;\n  }\n\n  .log-line .level {\n    display: inline;\n    width: 1ch;\n    margin-right: 1ch;\n    font-weight: bold;\n  }\n\n  .log-line.INFO .level {\n    color: #2563eb;\n  }\n\n  .log-line.WARNING .level {\n    color: #d97706;\n  }\n\n  .log-line.ERROR .level {\n    color: #dc2626;\n  }\n\n  .log-line.DEBUG .level {\n    color: #6b7280;\n  }\n\n  .log-line .timestamp {\n    color: #059669;\n    margin-right: 1ch;\n    white-space: nowrap;\n  }\n\n  .log-line .location {\n    color: #6366f1;\n    margin-right: 1ch;\n    white-space: nowrap;\n  }\n\n  .log-line .message {\n    color: #111827;\n    word-break: break-word;\n    white-space: pre-wrap;\n  }\n\n  .log-line .log-prefix {\n    color: #6366f1;\n    font-weight: 500;\n  }\n\n  .log-line .log-rest {\n    color: #111827;\n    word-break: break-word;\n    white-space: pre-wrap;\n  }\n'}),!n&&(0,r.jsx)("div",{style:{marginBottom:"1rem"},children:(0,r.jsxs)(l.Ph,{onValueChange:e=>s(e),value:o,children:[(0,r.jsx)(l.i4,{"aria-label":"Node",className:"focus:ring-0 focus:ring-offset-0",children:(0,r.jsx)(l.ki,{placeholder:"Select Node"})}),(0,r.jsxs)(l.Bw,{children:[(0,r.jsx)(l.Ql,{value:"all",children:"All Nodes"}),u.map(e=>(0,r.jsx)(l.Ql,{value:e,children:e},e))]})]})}),(0,r.jsx)("div",{className:"logs-container whitespace-pre-wrap break-all font-mono text-sm text-gray-900","aria-label":"job-logs",children:c.join("\n")})]})}function w(e){let t,{date:n}=e;if(!n)return"N/A";let a=new Date,o=n.getFullYear()+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0"),l=n.toLocaleString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0,timeZoneName:"short"});return t=function(e){if(!e||"string"!=typeof e)return e;if("just now"===e)return"now";if("less than a minute ago"===e.toLowerCase())return"Less than 1m ago";let t=e.match(/^about\s+(\d+)\s+(\w+)\s+ago$/i);if(t){let e=t[1],n=t[2],r={second:"s",seconds:"s",minute:"m",minutes:"m",hour:"h",hours:"h",day:"d",days:"d",month:"mo",months:"mo",year:"yr",years:"yr"};if(r[n])return"".concat(e).concat(r[n]," ago")}let n=e.match(/^a[n]?\s+(\w+)\s+ago$/i);if(n){let e=n[1],t={second:"s",minute:"m",hour:"h",day:"d",month:"mo",year:"yr"};if(t[e])return"1".concat(t[e]," ago")}let r=e.match(/^(\d+)\s+(\w+)\s+ago$/i);if(r){let e=r[1],t=r[2],n={second:"s",seconds:"s",minute:"m",minutes:"m",hour:"h",hours:"h",day:"d",days:"d",month:"mo",months:"mo",year:"yr",years:"yr"};if(n[t])return"".concat(e).concat(n[t]," ago")}return e}((0,s.B)(n,a,{addSuffix:!0})),(0,r.jsx)(m,{content:o+" "+l,className:"text-sm text-muted-foreground",children:(0,r.jsx)("span",{className:"border-b border-dotted border-gray-400 cursor-help",children:t})})}function j(e){return e?e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")+" "+e.toLocaleString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0,timeZoneName:"short"}):"N/A"}let N=e=>e&&e.jobCounts?e.jobCounts:{},v=e=>{if(!e||0===e.length)return{};let t=e.filter(e=>"READY"===e.status),n={};t.forEach(e=>{try{let t=e.cloud&&""!==e.cloud.trim()&&"undefined"!==e.cloud,r=e.region&&"undefined"!==e.region&&null!==e.region&&""!==e.region.trim();if(!t&&!r)return;let a=t?e.cloud:"Unknown",o=r?e.region:null;n[a]||(n[a]={count:0,regions:new Set}),n[a].count+=1,o&&n[a].regions.add(o)}catch(e){n.Unknown||(n.Unknown={count:0,regions:new Set}),n.Unknown.count+=1}});let r={};return Object.entries(n).forEach(e=>{let[t,n]=e,a=n.regions.size,o=t.toLowerCase().includes("kubernetes")||t.toLowerCase().includes("k8s")?"context":"region",s=1===a?"1 ".concat(o):"".concat(a," ").concat(o,"s");r[a>0?"".concat(t," (").concat(s,")"):t]=n.count}),r},k=e=>{let{jobCounts:t,getStatusStyle:n}=e;return t&&0!==Object.keys(t).length?(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:Object.entries(t).map(e=>{let[t,a]=e,o=n(t);return(0,r.jsxs)("span",{className:"px-2 py-1 rounded-full flex items-center space-x-2 text-xs font-medium ".concat(o),children:[(0,r.jsx)("span",{children:t}),(0,r.jsx)("span",{className:"text-xs bg-white/50 px-1.5 py-0.5 rounded",children:a})]},t)})}):(0,r.jsx)("span",{className:"text-gray-1000",children:"No active jobs"})},S=e=>{let{replicaInfo:t}=e,n=v(t);if(0===Object.keys(n).length)return(0,r.jsx)("span",{className:"text-gray-500 text-sm",children:"-"});let a=i.MO.NAME_TRUNCATE_LENGTH,o=e=>{let t=e.indexOf("(");if(-1===t)return e;let n=e.substring(0,t).trim(),r=e.substring(t+1,e.length-1);if(r.length<=a)return e;let o="".concat(r.substring(0,Math.floor((a-3)/2)),"...").concat(r.substring(r.length-Math.ceil((a-3)/2)));return"".concat(n," (").concat(o,")")};return(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:Object.entries(n).map(e=>{let[t,n]=e,a=o(t),s=a!==t;return(0,r.jsxs)("span",{className:"px-2 py-1 rounded-full flex items-center space-x-2 text-xs font-medium bg-blue-50 text-blue-700",children:[s?(0,r.jsx)(h,{content:t,className:"text-sm text-muted-foreground",children:(0,r.jsx)("span",{children:a})}):(0,r.jsx)("span",{children:t}),(0,r.jsx)("span",{className:"text-xs bg-white/50 px-1.5 py-0.5 rounded",children:n})]},t)})})},_=(e,t,n)=>{if(!e)return"-";if(n.find(n=>n.name===e&&n.hash===t)&&t)return(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(h,{content:"This pool is running",placement:"top",children:(0,r.jsx)("div",{className:"w-2 h-2 bg-green-700 rounded-full"})}),(0,r.jsx)(d(),{href:"/jobs/pools/".concat(e),className:"text-gray-700 hover:text-blue-600 hover:underline",children:e})]});let a=t?t.substring(0,4):"";return(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(h,{content:"This pool is terminated",placement:"top",children:(0,r.jsx)("div",{className:"w-2 h-2 bg-gray-800"})}),(0,r.jsxs)("span",{children:[e," (",a,")"]})]})}}}]);