# Doctor Session Schema
# Artifact: .doctor/session.yaml

type: object
required:
  - status
  - created_at

properties:
  status:
    type: string
    enum: [investigating, diagnosed, treated, abandoned]
    description: Current session status

  created_at:
    type: string
    format: date-time
    description: RFC3339 UTC timestamp

  updated_at:
    type: string
    format: date-time
    description: RFC3339 UTC timestamp of last update

  patient:
    type: string
    description: Repository or system name

  symptoms:
    type: array
    items:
      type: object
      properties:
        description:
          type: string
        category:
          type: string
          enum: [error, timeout, crash, wrong_output, performance, unknown]
        evidence:
          type: string
    description: Observed symptoms

  hypotheses:
    type: array
    items:
      type: object
      properties:
        description:
          type: string
        confidence:
          type: integer
          minimum: 0
          maximum: 100
        evidence_for:
          type: array
          items:
            type: string
        evidence_against:
          type: array
          items:
            type: string
        falsifiable_by:
          type: string
    description: Working hypotheses with confidence

  diagnosis:
    type: object
    properties:
      summary:
        type: string
      confidence:
        type: integer
        minimum: 0
        maximum: 100
      root_cause:
        type: string
      contributing_factors:
        type: array
        items:
          type: string
    description: Final diagnosis (when confident)

  evidence_files:
    type: array
    items:
      type: string
    description: Paths to evidence snapshots in .doctor/evidence/
