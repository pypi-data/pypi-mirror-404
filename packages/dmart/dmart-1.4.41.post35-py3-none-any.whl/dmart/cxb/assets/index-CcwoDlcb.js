import{p as Oe,L as fe,a8 as S,a9 as _e,B as u,h,F as l,E as n,k as s,O as Le,c as e,R as $e,a6 as H,al as Te,e as r,j as C,aj as O,f as G,l as Be,H as Re,aJ as Je,ag as He}from"./svelte-B2XmcTi_.js";import{s as Ne}from"./spaces-0oyGvpii.js";import{B as z,C as Ie,D as Ue,a as K,M as I,S as Q}from"./flowbite-svelte-BLvjb-sa.js";import{J as he,M as Ve}from"./svelte-jsoneditor-CUGSvWId.js";import{M as Ge,r as Ke,j as Qe}from"./compare-C3AjiGFR.js";import{a as W}from"./dmart_services-BN8RAjGS.js";import{D as X,R as Y,a as Z}from"./@edraj-CS4NwVbD.js";import{s as ee,L as te}from"./toast-B9WDyfyI.js";import{P as re}from"./Prism--hMplq-p.js";import{g as We}from"./@roxi-CGMFK4i8.js";import{A as Xe,D as Ye,E as Ze,P as et,l as tt}from"./flowbite-svelte-icons-D8uFOOjS.js";import"./clsx-B-dksMZM.js";import"./esm-env-rsSWfq8L.js";import"./@floating-ui-BwwcF-xh.js";import"./tailwind-variants-Cj20BoQ3.js";import"./tailwind-merge-CJvxXMcu.js";import"./json-source-map-DRgZidqy.js";import"./ajv-Cpj98o6Y.js";import"./immutable-json-patch-DtRO2E_S.js";import"./jsonrepair-B30Dx381.js";import"./lodash-es-DZVAA2ox.js";import"./@jsonquerylang-laKNoFFq.js";import"./@fortawesome-DRW1UCdr.js";import"./svelte-awesome-DhnMA6Q_.js";import"./svelte-select-CjHAt_85.js";import"./svelte-floating-ui-BlS3sOAQ.js";import"./natural-compare-lite-Bg2Xcf-o.js";import"./memoize-one-BdPwpGay.js";import"./@lezer-za4Q-8Ew.js";import"./@codemirror-Rn7_6DkE.js";import"./crelt-C8TCjufn.js";import"./@marijn-DXwl3gUT.js";import"./style-mod-Bs6eFhZE.js";import"./w3c-keyname-Vcq4gwWv.js";import"./@replit--ERk53eB.js";import"./codemirror-wrapped-line-indent-DPhKvljI.js";import"./@zerodevx-BlBZjKxu.js";import"./prismjs-DTUiLGJu.js";import"./hookar-BMRD9G9H.js";import"./consolite-DlCuI0F9.js";var rt=u("<!>Add new space",1),at=u('<div class="flex items-center gap-2"><!> View Meta</div>'),st=u('<div class="flex items-center gap-2"><!> Edit</div>'),ot=u('<div class="flex items-center gap-2 text-red-600"><!> Delete</div>'),lt=u("<!> <!> <!>",1),it=u("<!> <!>",1),nt=u('<div class="absolute top-2 left-2"><!></div>  <div class="flex flex-col items-center text-center p-4" style="cursor: pointer"><span class="inline-block px-3 py-1 mb-3 border border-gray-300 rounded-md text-sm font-medium"> </span> <h3 class="font-semibold text-lg"> </h3> <p class="text-gray-600 mt-2 mb-4 line-clamp-3"> </p> <div class="text-xs text-gray-500 mt-auto"> </div></div>',1),dt=u('<div class="mt-4"><p class="text-red-600 font-medium mb-2">Error:</p> <div class="max-h-60 overflow-auto"><!></div></div>'),ct=u("<!> Creating ...",1),vt=u('<div class="space-y-4"><!> <!></div> <div class="flex justify-between w-full mt-4"><!> <!></div>',1),ut=u("<div><!></div>"),mt=u('<div class="mt-4"><p class="text-red-600 font-medium mb-2">Error:</p> <div class="max-h-60 overflow-auto"><!></div></div>'),pt=u("<!> Saving Changes ...",1),ft=u('<div><!> <!></div> <div class="flex justify-between w-full"><!> <!></div>',1),_t=u('<p class="text-center mb-6">Are you sure you want to delete the space <span class="font-bold"> </span>?<br/> This action cannot be undone.</p>'),$t=u('<div class="mt-4"><p class="text-red-600 font-medium mb-2">Error:</p> <div class="max-h-60 overflow-auto"><!></div></div>'),ht=u("<!> Deleting ...",1),gt=u('<!> <!> <div class="flex justify-between w-full"><!> <!></div>',1),xt=u('<div class="container mx-auto px-12 py-6"><div class="flex justify-between items-center mb-1 px-1"><h1 class="text-2xl font-bold mb-6">All Spaces</h1> <!></div> <hr class="mb-6 border-gray-300"/> <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-4 gap-4 w-full place-items-center"></div></div> <!> <!> <!> <!>',1);function nr(ge,xe){Oe(xe,!0);const ae=()=>fe(We,"$goto",se),ye=()=>fe(Ne,"$spaces",se),[se,be]=Re();ae();let U=S(!1),L=S(!1),T=S(!1),B=S(!1),m=S(null),f=S(null),b=S(_e({shortname:"",is_active:!0,slug:"",displayname:{en:"",ar:"",ku:""},description:{en:"",ar:"",ku:""}})),V=S(()=>!0),P=S(!1),F=S(_e({json:void 0}));function we(){r(f,null),r(b,{shortname:"",is_active:!0,slug:"",displayname:{en:"",ar:"",ku:""},description:{en:"",ar:"",ku:""}},!0),r(B,!0)}async function Se(){if(e(V)()&&e(b).shortname.trim())try{r(P,!0),r(f,null);const t={is_active:e(b).is_active,slug:e(b).slug,displayname:e(b).displayname,description:e(b).description};await X.request({space_name:e(b).shortname.trim(),request_type:Z.create,records:[{resource_type:Y.space,shortname:e(b).shortname.trim(),subpath:"/",attributes:Ke(t)}]}),ee(te.info,`Space "${e(b).shortname.trim()}" created successfully!`),await W(),r(B,!1)}catch(t){r(f,t.response.data,!0)}finally{r(P,!1)}}function Pe(t){r(f,null),r(m,structuredClone(t),!0),r(F,{json:e(m)},!0),r(U,!0)}function ke(t){r(f,null),r(m,structuredClone(t),!0),r(F,{json:e(m)},!0),r(L,!0)}async function Ce(){if(e(m)){const t=Qe(Je(e(F)));delete t.uuid;try{r(P,!0),r(f,null),await X.request({space_name:e(m).shortname,request_type:Z.update,records:[{resource_type:Y.space,shortname:e(m).shortname,subpath:"/",attributes:t.attributes}]}),r(L,!1),ee(te.info,`Space "${e(m).shortname}" updated successfully!`),await W()}catch(v){r(f,v,!0)}finally{r(P,!1)}}}function De(t){r(f,null),r(m,t,!0),r(T,!0)}async function Me(){if(e(m))try{r(P,!0),r(f,null),await X.request({space_name:e(m).shortname,request_type:Z.delete,records:[{resource_type:Y.space,shortname:e(m).shortname,subpath:"/",attributes:{}}]}),ee(te.info,`Space "${e(m).shortname}" has been deleted successfully!`),r(T,!1),r(m,null),await W()}catch(t){r(f,t,!0)}finally{r(P,!1)}}async function je(t){ae()("/management/content/[space_name]",{space_name:t})}var oe=xt(),le=h(oe),ie=n(le),ze=l(n(ie),2);z(ze,{size:"md",class:"bg-primary",style:"cursor: pointer",onclick:we,children:(t,v)=>{var _=rt(),g=h(_);Xe(g,{class:"me-2 h-5 w-5"}),s(t,_)},$$slots:{default:!0}});var Ee=l(ie,4);Le(Ee,5,()=>(ye()??[]).filter(t=>{var v;return((v=t==null?void 0:t.attributes)==null?void 0:v.hide_space)!==!0}),Te,(t,v)=>{Ie(t,{class:"relative w-full",children:(_,g)=>{var y=nt(),x=h(y),E=n(x);z(E,{class:"!p-1",color:"light",children:(d,c)=>{var $=it(),A=h($);Ye(A,{});var N=l(A,2);Ue(N,{simple:!0,children:(Ae,yt)=>{var ve=lt(),ue=h(ve);K(ue,{class:"w-full",onclick:()=>Pe(e(v)),children:(R,pe)=>{var j=at(),J=n(j);Ze(J,{size:"sm"}),s(R,j)},$$slots:{default:!0}});var me=l(ue,2);K(me,{class:"w-full",onclick:()=>ke(e(v)),children:(R,pe)=>{var j=st(),J=n(j);et(J,{size:"sm"}),s(R,j)},$$slots:{default:!0}});var Fe=l(me,2);K(Fe,{class:"w-full",onclick:()=>De(e(v)),children:(R,pe)=>{var j=ot(),J=n(j);tt(J,{size:"sm"}),s(R,j)},$$slots:{default:!0}}),s(Ae,ve)},$$slots:{default:!0}}),s(d,$)},$$slots:{default:!0}});var D=l(x,2);D.__click=()=>je(e(v).shortname);var w=n(D),M=n(w),a=l(w,2),o=n(a),i=l(a,2),p=n(i),k=l(i,2),q=n(k);$e(d=>{var c,$,A,N;H(M,e(v).shortname),H(o,(($=(c=e(v).attributes)==null?void 0:c.displayname)==null?void 0:$.en)||e(v).shortname),H(p,((N=(A=e(v))==null?void 0:A.description)==null?void 0:N.en)||""),H(q,`Updated: ${d??""}`)},[()=>{var d;return new Date((d=e(v))==null?void 0:d.attributes.updated_at).toLocaleDateString()}]),s(_,y)},$$slots:{default:!0}})});var ne=l(le,2);I(ne,{size:"xl",title:"Add New Space",get open(){return e(B)},set open(t){r(B,t,!0)},children:(t,v)=>{var _=vt(),g=h(_),y=n(g);Ge(y,{isCreate:!0,get formData(){return e(b)},set formData(a){r(b,a,!0)},get validateFn(){return e(V)},set validateFn(a){r(V,a,!0)}});var x=l(y,2);{var E=a=>{var o=dt(),i=l(n(o),2),p=n(i);re(p,{get code(){return e(f)}}),s(a,o)};C(x,a=>{e(f)&&a(E)})}var D=l(g,2),w=n(D);z(w,{color:"alternative",onclick:()=>r(B,!1),children:(a,o)=>{var i=O("Cancel");s(a,i)},$$slots:{default:!0}});var M=l(w,2);z(M,{class:"bg-primary",onclick:Se,children:(a,o)=>{var i=G(),p=h(i);{var k=d=>{var c=ct(),$=h(c);Q($,{class:"me-3",size:"4",color:"blue"}),s(d,c)},q=d=>{var c=O("Create");s(d,c)};C(p,d=>{e(P)?d(k):d(q,!1)})}s(a,i)},$$slots:{default:!0}}),s(t,_)},$$slots:{default:!0}});var de=l(ne,2);I(de,{size:"xl",title:"Space Metadata",autoclose:!0,get open(){return e(U)},set open(t){r(U,t,!0)},children:(t,v)=>{var _=ut(),g=n(_);{var y=x=>{he(x,{get content(){return e(F)},readOnly:!0})};C(g,x=>{e(m)&&x(y)})}s(t,_)},$$slots:{default:!0}});var ce=l(de,2);I(ce,{size:"xl",title:"Edit Space",get open(){return e(L)},set open(t){r(L,t,!0)},children:(t,v)=>{var _=ft(),g=h(_),y=n(g);{var x=o=>{he(o,{readOnly:!1,get mode(){return Ve.text},get content(){return e(F)},set content(i){r(F,i,!0)}})};C(y,o=>{e(m)&&o(x)})}var E=l(y,2);{var D=o=>{var i=mt(),p=l(n(i),2),k=n(p);re(k,{get code(){return e(f)}}),s(o,i)};C(E,o=>{e(f)&&o(D)})}var w=l(g,2),M=n(w);z(M,{color:"alternative",onclick:()=>r(L,!1),children:(o,i)=>{var p=O("Cancel");s(o,p)},$$slots:{default:!0}});var a=l(M,2);z(a,{class:"bg-primary",onclick:Ce,children:(o,i)=>{var p=G(),k=h(p);{var q=c=>{var $=pt(),A=h($);Q(A,{class:"me-3",size:"4",color:"blue"}),s(c,$)},d=c=>{var $=O("Save Changes");s(c,$)};C(k,c=>{e(P)?c(q):c(d,!1)})}s(o,p)},$$slots:{default:!0}}),s(t,_)},$$slots:{default:!0}});var qe=l(ce,2);I(qe,{size:"md",title:"Confirm Deletion",get open(){return e(T)},set open(t){r(T,t,!0)},children:(t,v)=>{var _=gt(),g=h(_);{var y=a=>{var o=_t(),i=l(n(o)),p=n(i);$e(()=>H(p,e(m).shortname)),s(a,o)};C(g,a=>{e(m)&&a(y)})}var x=l(g,2);{var E=a=>{var o=$t(),i=l(n(o),2),p=n(i);re(p,{get code(){return e(f)}}),s(a,o)};C(x,a=>{e(f)&&a(E)})}var D=l(x,2),w=n(D);z(w,{color:"alternative",onclick:()=>r(T,!1),children:(a,o)=>{var i=O("Cancel");s(a,i)},$$slots:{default:!0}});var M=l(w,2);z(M,{color:"red",onclick:Me,children:(a,o)=>{var i=G(),p=h(i);{var k=d=>{var c=ht(),$=h(c);Q($,{class:"me-3",size:"4",color:"blue"}),s(d,c)},q=d=>{var c=O("Delete");s(d,c)};C(p,d=>{e(P)?d(k):d(q,!1)})}s(a,i)},$$slots:{default:!0}}),s(t,_)},$$slots:{default:!0}}),s(ge,oe),Be(),be()}He(["click"]);export{nr as default};
