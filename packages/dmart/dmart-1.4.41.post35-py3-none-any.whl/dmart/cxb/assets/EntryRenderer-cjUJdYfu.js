import{p as kt,b as at,i as Ir,f as I,h as p,j as v,t as mt,y as Ue,k as r,l as jt,B as l,F as o,E as a,R as U,a6 as te,af as Pe,W as _a,c as e,a2 as Qe,U as Xe,Z as Tt,a9 as ot,a8 as R,a7 as At,aJ as ht,e as s,aj as be,O as yt,al as gt,S as pr,H as Gt,L as St,I as Qt,ag as Yt,A as fa,v as ma,J as fr,aK as pa,aI as ha,ax as ya,_ as Xt}from"./svelte-B2XmcTi_.js";import{M as ga,H as ba,a as Vr,c as Cr,b as xa,L as wa,s as ka,d as ja,P as Pa,e as Fa}from"./ListView-dXTYjhLu.js";import{R as y,D as Ye,b as $e,C as N,a as Ot,Q as Nr,S as Ca}from"./@edraj-CS4NwVbD.js";import{J as hr,M as yr}from"./svelte-jsoneditor-CUGSvWId.js";import{M as Br,r as er,j as Dt,i as Ma}from"./compare-C3AjiGFR.js";import{P as Kt}from"./Prism--hMplq-p.js";import{T as Da}from"./Table2Cols-BsbwicQm.js";import{s as ct,L as vt}from"./toast-B9WDyfyI.js";import{M as Rt,L as ft,k as Ht,B as bt,g as Wr,F as Et,l as ir,m as dr,n as Mr,C as Zt,D as Aa,a as ur,h as Ea,o as Ta,I as Sa,T as Dr}from"./flowbite-svelte-BLvjb-sa.js";import{A as Ar}from"./axios-CG2WSiiR.js";import{m as Er}from"./marked-DKjyhwJX.js";import{c as rr,I as Oa,s as Tr,a as $a}from"./global-igKv-1g9.js";import{g as Jr,h as Sr,i as Or,j as $r,k as za,D as qa,E as Hr,P as Ra,l as Kr,m as La,n as zr,o as Ua,p as cr,q as qr,r as Ia,R as Va,s as Na,t as Ba,u as Wa,v as Ja,w as Rr,x as Ha,y as Ka}from"./flowbite-svelte-icons-D8uFOOjS.js";import{B as Ga}from"./BreadCrumbLite-ClLCZ5eT.js";import{g as gr}from"./@roxi-CGMFK4i8.js";import{b as mr}from"./plantuml-encoder-C47mzt9T.js";import{u as Qa}from"./user-DeK_NB5v.js";import{b as Ya}from"./dmart_services-BN8RAjGS.js";var Za=l('<div class="h-full w-full"><p style="margin: 0px"><b>State:</b> </p> <br/> <p style="margin: 0px"><b>Body:</b> </p></div>'),Xa=l('<p style="margin: 0px"><b>Type:</b> </p>'),es=l('<div><div class="h-full w-full"><!></div> <!></div>'),ts=l('<object type="image/svg+xml"><img class="mw-100 border"/></object>'),rs=l('<img class="mw-100 border"/>'),as=l('<audio controls><track kind="captions"/></audio>'),ss=l('<video controls><track kind="captions"/></video>',2),os=l('<object class="pdf-viewer svelte-zbqh6d" type="application/pdf"><p>For some reason PDF is not rendered here properly.</p></object>'),ns=l('<div class="w-full h-full"><article class="prose"><!></article></div>'),ls=l('<a target="_blank" rel="noopener noreferrer" download=""> </a>');function is(C,t){var F,d,B,D;kt(t,!1);let _=at(t,"attributes",24,()=>({})),x=at(t,"resource_type",8),f=at(t,"url",8),n=at(t,"displayname",8,void 0),w=((d=(F=_())==null?void 0:F.payload)==null?void 0:d.content_type)||"",M=(D=(B=_())==null?void 0:B.payload)==null?void 0:D.body;Ir();var P=I(),se=p(P);{var ye=g=>{var c=Za(),_e=a(c),Z=o(a(_e)),re=o(_e,4),fe=o(a(re));U(()=>{te(Z,` ${mt(_()),Ue(()=>{var Fe,Ae,Ie;return(Ie=(Ae=(Fe=_())==null?void 0:Fe.payload)==null?void 0:Ae.body)==null?void 0:Ie.state})??""}`),te(fe,` ${mt(_()),Ue(()=>{var Fe,Ae,Ie;return(Ie=(Ae=(Fe=_())==null?void 0:Fe.payload)==null?void 0:Ae.body)==null?void 0:Ie.body})??""}`)}),r(g,c)},h=g=>{var c=I(),_e=p(c);{var Z=fe=>{var Fe=es(),Ae=a(Fe),Ie=a(Ae);Kt(Ie,{language:"json",get code(){return M}});var b=o(Ae,2);{var X=Ce=>{var K=Xa(),A=o(a(K));U(()=>te(A,` ${mt(_()),Ue(()=>_().type??"N/A")??""}`)),r(Ce,K)};v(b,Ce=>{mt(x()),mt(y),Ue(()=>x()===y.reaction)&&Ce(X)})}r(fe,Fe)},re=fe=>{var Fe=I(),Ae=p(Fe);{var Ie=X=>{var Ce=I(),K=p(Ce);{var A=oe=>{var J=ts(),ke=a(J);U(()=>{Pe(J,"data",f()),Pe(J,"title",n()),Pe(ke,"src",f()),Pe(ke,"alt",n())}),r(oe,J)},Ve=oe=>{var J=rs();U(()=>{Pe(J,"src",f()),Pe(J,"alt",n())}),r(oe,J)};v(K,oe=>{mt(f()),Ue(()=>f().endsWith("svg"))?oe(A):oe(Ve,!1)})}r(X,Ce)},b=X=>{var Ce=I(),K=p(Ce);{var A=oe=>{var J=as();U(()=>Pe(J,"src",f())),r(oe,J)},Ve=oe=>{var J=I(),ke=p(J);{var Y=k=>{var T=ss();U(()=>Pe(T,"src",f())),r(k,T)},u=k=>{var T=I(),S=p(T);{var ne=De=>{var ve=os();U(()=>{Pe(ve,"title",n()),Pe(ve,"data",f())}),r(De,ve)},me=De=>{var ve=I(),H=p(ve);{var ee=O=>{var Ee=ns(),tt=a(Ee),rt=a(tt);_a(rt,()=>(mt(Er),Ue(()=>Er(M)))),r(O,Ee)},m=O=>{var Ee=ls(),tt=a(Ee);U(()=>{Pe(Ee,"href",f()),Pe(Ee,"title",n()),te(tt,`link ${n()??""}`)}),r(O,Ee)};v(H,O=>{Ue(()=>["markdown","html","text"].includes(w))?O(ee):O(m,!1)},!0)}r(De,ve)};v(S,De=>{Ue(()=>w.includes("pdf"))?De(ne):De(me,!1)},!0)}r(k,T)};v(ke,k=>{Ue(()=>w.includes("video"))?k(Y):k(u,!1)},!0)}r(oe,J)};v(K,oe=>{Ue(()=>w.includes("audio"))?oe(A):oe(Ve,!1)},!0)}r(X,Ce)};v(Ae,X=>{Ue(()=>w.includes("image"))?X(Ie):X(b,!1)},!0)}r(fe,Fe)};v(_e,fe=>{mt(x()),mt(y),Ue(()=>x()===y.json||x()===y.reaction)?fe(Z):fe(re,!1)},!0)}r(g,c)};v(se,g=>{mt(x()),mt(y),Ue(()=>x()===y.comment)?g(ye):g(h,!1)})}r(C,P),jt()}function Gr(C){let t=/^.+\.([^.]+)$/.exec(C);return t==null?"":t[1]}var ds=l("<div><!></div>"),us=l('<div class="modal-header flex justify-between items-center p-3 border-b"><h5 class="modal-title text-lg font-semibold"> </h5></div> <!>',1);function cs(C,t){kt(t,!0);let _=at(t,"openViewContentModal",15);function x(w){return w?w.includes("image")?"max-w-screen-xl":w.includes("video")?"max-w-screen-lg":w.includes("pdf")?"max-w-4xl":w==="markdown"?"max-w-screen-md":"w-auto":"w-auto"}let f=Qe(()=>{var w,M,P;return x((P=(M=(w=t.selectedAttachment)==null?void 0:w.attributes)==null?void 0:M.payload)==null?void 0:P.content_type)}),n=Qe(()=>{var w,M,P,se;return((se=(P=(M=(w=t.selectedAttachment)==null?void 0:w.attributes)==null?void 0:M.payload)==null?void 0:P.content_type)==null?void 0:se.includes("pdf"))||!1});{let w=Qe(()=>e(n)?"p-0 h-auto":"p-0 overflow-auto");Rt(C,{get class(){return e(f)},get bodyClass(){return e(w)},autoclose:!1,placement:"center",get open(){return _()},set open(M){_(M)},children:(M,P)=>{var se=us(),ye=p(se),h=a(ye),F=a(h),d=o(ye,2);{var B=D=>{var g=ds(),c=a(g);{let _e=Qe(()=>{var Z,re;return Ye.getAttachmentUrl({resource_type:t.selectedAttachment.resource_type,space_name:t.space_name,subpath:t.subpath,parent_shortname:t.parent_resource_type===y.folder?"":t.parent_shortname,shortname:t.selectedAttachment.shortname,ext:Gr((re=(Z=t.selectedAttachment.attributes)==null?void 0:Z.payload)==null?void 0:re.body)})});is(c,{get resource_type(){return y[t.selectedAttachment.resource_type]},get attributes(){return t.selectedAttachment.attributes},get displayname(){return t.selectedAttachment.shortname},get url(){return e(_e)}})}U(()=>Xe(g,1,Tt(e(n)?"pdf-container":"media-container"),"svelte-1edrafr")),r(D,g)};v(d,D=>{t.selectedAttachment&&D(B)})}U(()=>{var D,g,c,_e;return te(F,((c=(g=(D=t.selectedAttachment)==null?void 0:D.attributes)==null?void 0:g.displayname)==null?void 0:c.en)||((_e=t.selectedAttachment)==null?void 0:_e.shortname)||"Attachment Content")}),r(M,se)},$$slots:{default:!0}})}jt()}function Lr(C){const t=new Blob([JSON.stringify(C)],{type:"application/json"});return new File([t],"data.json",{type:"application/json"})}var vs=l('<span class="font-medium"> </span>'),_s=l("<option> </option>"),fs=l("<option> </option>"),ms=l("<div><!> <!></div>"),ps=l("<div><!> <!></div>"),hs=l("<div><!> <!></div>"),ys=l("<div><!> <!></div>"),gs=l("<div><!> <!></div>"),bs=l("<div><!></div>"),xs=l("<div><!></div>"),ws=l("<div><!></div>"),ks=l('<div><!> <!></div> <hr class="my-4"/> <!>',1),js=l("<div><!></div>"),Ps=l("<div><!></div>"),Fs=l("<option> </option>"),Cs=l("<option>None</option> <!>",1),Ms=l('<div><!> <!> <div class="mt-3"><!> <!></div></div>'),Ds=l("<div><!> <!></div>"),As=l("<div><!> <!></div>"),Es=l("<div><!> <!></div>"),Ts=l('<div class="mt-3"><!></div>'),Ss=l('<form><div class="flex justify-between items-center px-4 pt-4 border-b rounded-t"><h3 class="text-xl font-semibold text-gray-900"><!></h3></div> <div class="p-4 max-h-[75vh] overflow-y-auto"><!> <div class="flex flex-col space-y-4"><!> <div><!> <!></div> <!></div> <!></div> <div class="flex justify-end space-x-2 p-4 border-t"><!> <!></div></form>');function Os(C,t){kt(t,!0);const _=()=>St(rr,"$currentEntry",x),[x,f]=Gt();let n=at(t,"meta",31,()=>ot({})),w=at(t,"payload",27,()=>ot({})),M=at(t,"isOpen",15,!1),P=at(t,"isUpdateMode",11,!1),se=at(t,"selectedAttachment",11,null),ye=at(t,"space_name",11,""),h=at(t,"subpath",11,""),F=at(t,"parent_shortname",11,""),d=R(ot($e.media)),B=R(ot(N.image)),D=R(null),g=R(ot(w())),c=R(""),_e=R(null),Z=R(!1),re=R(null),fe=R(null);At(()=>{M()&&se()&&P()?Fe(se()):M()||Ae()});function Fe(K){var Ve,oe,J,ke,Y,u;if(!K)return;const A=structuredClone(ht(K));if(n({shortname:A.shortname,is_active:A.attributes.is_active,displayname:A.attributes.displayname,description:A.attributes.description}),A.resource_type===y.json||A.resource_type===y.media&&[N.text,N.json,N.markdown,N.html].includes((oe=(Ve=A==null?void 0:A.attributes)==null?void 0:Ve.payload)==null?void 0:oe.content_type)||A.resource_type===y.comment)s(d,$e[A.resource_type],!0),s(B,(ke=(J=A==null?void 0:A.attributes)==null?void 0:J.payload)==null?void 0:ke.content_type,!0),A.resource_type===y.json?s(g,{json:A.attributes.payload.body},!0):typeof A.attributes.payload.body=="string"?s(g,A.attributes.payload.body,!0):s(g,{body:A.attributes.payload.body},!0);else{s(_e,$e[A.resource_type],!0),s(d,e(_e),!0);const k=structuredClone(A);(u=(Y=k==null?void 0:k.attributes)==null?void 0:Y.payload)!=null&&u.body&&delete k.attributes.payload.body,s(g,{json:k,text:void 0},!0)}}function Ae(){s(d,$e.media,!0),s(B,N.image,!0),s(D,null),s(g,{},!0),s(c,""),n({shortname:"",is_active:!0,displayname:{en:"",ar:"",ku:""},description:{en:"",ar:"",ku:""}})}async function Ie(K){K.preventDefault(),s(Z,!0),s(re,null),s(fe,null);try{if(P()&&e(d)===$e.json&&e(_e)!==null){await Ce();return}let A;e(d)==$e.comment?A=await Ye.request({space_name:ye(),request_type:P()?Ot.update:Ot.create,records:[er({resource_type:y.comment,shortname:n().shortname,subpath:`${h()}/${F()}`.replaceAll("//","/"),attributes:{displayname:n().displayname,description:n().description,is_active:!0,payload:{content_type:N.json,body:{state:"commented",body:P()?e(g).body:e(g)}}}})]}):[$e.csv,$e.jsonl,$e.sqlite,$e.parquet].includes(e(d))?A=await Ye.uploadWithPayload({space_name:ye(),subpath:t.parentResourceType===y.folder?h():h()+"/"+F(),shortname:n().shortname,resource_type:y[e(d)],payload_file:y[e(d)]===y.json?Lr(e(g)):e(D)[0],attributes:{displayname:n().displayname,description:n().description,is_active:!0,payload:{content_type:N[e(d)],schema_shortname:e(c),body:{}}}}):[N.image,N.pdf,N.audio,N.video,N.apk].includes(e(B))?A=await Ye.uploadWithPayload({space_name:ye(),subpath:t.parentResourceType===y.folder?h():h()+"/"+F(),shortname:n().shortname,resource_type:y[e(d)],payload_file:y[e(d)]===y.json?Lr(e(g)):e(D)[0],attributes:er({displayname:n().displayname,description:n().description,is_active:!0,payload:{content_type:e(B),body:{}}})}):[N.json,N.text,N.html,N.markdown,N].includes(e(B))&&(A=await Ye.request({space_name:ye(),request_type:P()?Ot.update:Ot.create,records:[er({resource_type:y[e(d)],shortname:n().shortname,subpath:t.parentResourceType===y.folder?h():`${h()}/${F()}`,attributes:{displayname:n().displayname,description:n().description,is_active:!0,payload:{content_type:e(B),schema_shortname:e(d)==$e.json&&e(c)?e(c):null,body:e(d)==$e.json?Dt(ht(e(g))):e(g)}}})]})),A.status==="success"?(ct(vt.info),M(!1),Ae(),_().refreshEntry()):ct(vt.warn)}catch(A){console.log(A),ct(vt.warn,A.response.data),s(fe,A.response.data,!0)}finally{s(Z,!1)}}function b(K){return K}let X;async function Ce(){var Ve,oe;s(re,null),s(fe,null);let K=Dt(ht(e(g)));K.subpath=t.parentResourceType===y.folder?h():`${h()}/${F()}`,K.attributes.displayname=n().displayname,K.attributes.description=n().description;const A={space_name:ye(),request_type:Ot.update,records:[er(K)]};try{(await Ye.request(A)).status==="success"?(ct(vt.info),M(!1),Ae(),_().refreshEntry()):ct(vt.warn)}catch(J){ct(vt.warn,((Ve=J.response)==null?void 0:Ve.data)||"Error updating metadata"),s(fe,((oe=J.response)==null?void 0:oe.data)||"Error updating metadata",!0)}finally{s(Z,!1)}}At(()=>{!P()&&e(d)&&(e(d)===$e.json?Ue(()=>{s(B,N.json,!0),s(g,{json:{}},!0)}):e(d)===$e.comment?Ue(()=>{s(g,"")}):e(d)===$e.media?Ue(()=>{s(B,N.image,!0),s(g,"")}):Ue(()=>{s(g,{},!0)}))}),Rt(C,{size:"xl",get open(){return M()},set open(K){M(K)},children:(K,A)=>{var Ve=Ss(),oe=a(Ve),J=a(oe),ke=a(J);{var Y=V=>{var L=I(),le=p(L);{var Ke=ge=>{var ae=be("Edit Attachment Metadata");r(ge,ae)},Ne=ge=>{var ae=be("Edit Attachment Content");r(ge,ae)};v(le,ge=>{e(d)===$e.json&&e(_e)!==null?ge(Ke):ge(Ne,!1)})}r(V,L)},u=V=>{var L=be("Add Attachment");r(V,L)};v(ke,V=>{P()?V(Y):V(u,!1)})}var k=o(oe,2),T=a(k);{var S=V=>{Wr(V,{color:"red",children:(L,le)=>{var Ke=vs(),Ne=a(Ke);U(()=>te(Ne,e(re))),r(L,Ke)},$$slots:{default:!0}})};v(T,V=>{e(re)&&V(S)})}var ne=o(T,2),me=a(ne);{let V=Qe(()=>!P());Br(me,{get isCreate(){return e(V)},get formData(){return n()},set formData(L){n(L)},get validateFn(){return X},set validateFn(L){X=L}})}var De=o(me,2),ve=a(De);ft(ve,{for:"resourceType",children:(V,L)=>{var le=be("Attachment Type");r(V,le)},$$slots:{default:!0}});var H=o(ve,2);Ht(H,{id:"resourceType",get disabled(){return P()},get value(){return e(d)},set value(V){s(d,V,!0)},children:(V,L)=>{var le=I(),Ke=p(le);yt(Ke,17,()=>Object.values($e).filter(Ne=>Ne!==$e.alteration),gt,(Ne,ge)=>{var ae=_s(),We=a(ae),ie={};U(()=>{te(We,e(ge)),ie!==(ie=e(ge))&&(ae.value=(ae.__value=e(ge))??"")}),r(Ne,ae)}),r(V,le)},$$slots:{default:!0}});var ee=o(De),m=o(ee);{var O=V=>{var L=ks(),le=p(L),Ke=a(le);ft(Ke,{for:"contentType",children:(ie,ze)=>{var je=be("Content Type");r(ie,je)},$$slots:{default:!0}});var Ne=o(Ke,2);Ht(Ne,{id:"contentType",get disabled(){return P()},get value(){return e(B)},set value(ie){s(B,ie,!0)},children:(ie,ze)=>{var je=I(),xe=p(je);yt(xe,17,()=>Object.values(N).filter(ue=>![N.json,N.csv,N.jsonl,N.sqlite,N.parquet].includes(ue)),gt,(ue,E)=>{var j=fs(),W=a(j),$={};U(()=>{te(W,e(E)),$!==($=e(E))&&(j.value=(j.__value=e(E))??"")}),r(ue,j)}),r(ie,je)},$$slots:{default:!0}});var ge=o(le,4);{var ae=ie=>{var ze=ms(),je=a(ze);ft(je,{for:"imageFile",children:(ue,E)=>{var j=be("Image File");r(ue,j)},$$slots:{default:!0}});var xe=o(je,2);Et(xe,{id:"imageFile",type:"file",accept:"image/png, image/jpeg, image/webp",clearable:!0,get files(){return e(D)},set files(ue){s(D,ue,!0)}}),r(ie,ze)},We=ie=>{var ze=I(),je=p(ze);{var xe=E=>{var j=ps(),W=a(j);ft(W,{for:"pdfFile",children:(G,Q)=>{var Te=be("PDF File");r(G,Te)},$$slots:{default:!0}});var $=o(W,2);Et($,{id:"pdfFile",type:"file",accept:"application/pdf",clearable:!0,get files(){return e(D)},set files(G){s(D,G,!0)}}),r(E,j)},ue=E=>{var j=I(),W=p(j);{var $=Q=>{var Te=hs(),qe=a(Te);ft(qe,{for:"apkFile",children:(pe,he)=>{var ce=be("APK File");r(pe,ce)},$$slots:{default:!0}});var Me=o(qe,2);Et(Me,{id:"apkFile",type:"file",accept:".apk",clearable:!0,get files(){return e(D)},set files(pe){s(D,pe,!0)}}),r(Q,Te)},G=Q=>{var Te=I(),qe=p(Te);{var Me=he=>{var ce=ys(),Be=a(ce);ft(Be,{for:"audioFile",children:(Je,Ge)=>{var Oe=be("Audio File");r(Je,Oe)},$$slots:{default:!0}});var Se=o(Be,2);Et(Se,{id:"audioFile",type:"file",accept:"audio/*",clearable:!0,get files(){return e(D)},set files(Je){s(D,Je,!0)}}),r(he,ce)},pe=he=>{var ce=I(),Be=p(ce);{var Se=Ge=>{var Oe=gs(),nt=a(Oe);ft(nt,{for:"pythonFile",children:(_t,Re)=>{var lt=be("Python File");r(_t,lt)},$$slots:{default:!0}});var dt=o(nt,2);Et(dt,{id:"pythonFile",type:"file",accept:".py",clearable:!0,get files(){return e(D)},set files(_t){s(D,_t,!0)}}),r(Ge,Oe)},Je=Ge=>{var Oe=I(),nt=p(Oe);{var dt=Re=>{var lt=bs(),Pt=a(lt);ga(Pt,{get content(){return e(g)},set content(Vt){s(g,Vt,!0)}}),r(Re,lt)},_t=Re=>{var lt=I(),Pt=p(lt);{var Vt=Ft=>{var $t=xs(),Nt=a($t);ba(Nt,{get content(){return e(g)},set content(Bt){s(g,Bt,!0)}}),r(Ft,$t)},ar=Ft=>{var $t=ws(),Nt=a($t);ir(Nt,{get value(){return e(g)},set value(Bt){s(g,Bt,!0)}}),r(Ft,$t)};v(Pt,Ft=>{e(B)===N.html?Ft(Vt):Ft(ar,!1)},!0)}r(Re,lt)};v(nt,Re=>{e(B)===N.markdown?Re(dt):Re(_t,!1)},!0)}r(Ge,Oe)};v(Be,Ge=>{e(B)===N.python?Ge(Se):Ge(Je,!1)},!0)}r(he,ce)};v(qe,he=>{e(B)===N.audio?he(Me):he(pe,!1)},!0)}r(Q,Te)};v(W,Q=>{e(B)===N.apk?Q($):Q(G,!1)},!0)}r(E,j)};v(je,E=>{e(B)===N.pdf?E(xe):E(ue,!1)},!0)}r(ie,ze)};v(ge,ie=>{e(B)===N.image?ie(ae):ie(We,!1)})}r(V,L)},Ee=V=>{var L=I(),le=p(L);{var Ke=ge=>{var ae=I(),We=p(ae);{var ie=ze=>{var je=js(),xe=a(je);hr(xe,{onRenderMenu:b,get mode(){return yr.text},get content(){return e(g)},set content(ue){s(g,ue,!0)}}),r(ze,je)};v(We,ze=>{(e(g).json||e(g).text)&&ze(ie)})}r(ge,ae)},Ne=ge=>{var ae=I(),We=p(ae);{var ie=je=>{var xe=Ps(),ue=a(xe);{var E=W=>{ir(W,{get value(){return e(g).body},set value($){e(g).body=$}})},j=W=>{ir(W,{get value(){return e(g)},set value($){s(g,$,!0)}})};v(ue,W=>{P()?W(E):W(j,!1)})}r(je,xe)},ze=je=>{var xe=I(),ue=p(xe);{var E=W=>{var $=Ms(),G=a($);ft(G,{for:"csvFile",children:(pe,he)=>{var ce=be("CSV File");r(pe,ce)},$$slots:{default:!0}});var Q=o(G,2);Et(Q,{id:"csvFile",type:"file",accept:".csv",clearable:!0,get files(){return e(D)},set files(pe){s(D,pe,!0)}});var Te=o(Q,2),qe=a(Te);ft(qe,{for:"csvSchema",children:(pe,he)=>{var ce=be("Schema");r(pe,ce)},$$slots:{default:!0}});var Me=o(qe,2);Ht(Me,{id:"csvSchema",get disabled(){return P()},get value(){return e(c)},set value(pe){s(c,pe,!0)},children:(pe,he)=>{var ce=Cs(),Be=p(ce);Be.value=Be.__value="";var Se=o(Be,2);Qt(Se,()=>Ye.query({space_name:ye(),type:Nr.search,subpath:"/schema",search:"",retrieve_json_payload:!0,limit:99}),null,(Je,Ge)=>{var Oe=I(),nt=p(Oe);yt(nt,17,()=>e(Ge).records.map(dt=>dt.shortname),gt,(dt,_t)=>{var Re=Fs(),lt=a(Re),Pt={};U(()=>{te(lt,e(_t)),Pt!==(Pt=e(_t))&&(Re.value=(Re.__value=e(_t))??"")}),r(dt,Re)}),r(Je,Oe)}),r(pe,ce)},$$slots:{default:!0}}),r(W,$)},j=W=>{var $=I(),G=p($);{var Q=qe=>{var Me=Ds(),pe=a(Me);ft(pe,{for:"jsonlFile",children:(ce,Be)=>{var Se=be("JSONL File");r(ce,Se)},$$slots:{default:!0}});var he=o(pe,2);Et(he,{id:"jsonlFile",type:"file",accept:".jsonl",clearable:!0,get files(){return e(D)},set files(ce){s(D,ce,!0)}}),r(qe,Me)},Te=qe=>{var Me=I(),pe=p(Me);{var he=Be=>{var Se=As(),Je=a(Se);ft(Je,{for:"sqliteFile",children:(Oe,nt)=>{var dt=be("SQLite File");r(Oe,dt)},$$slots:{default:!0}});var Ge=o(Je,2);Et(Ge,{id:"sqliteFile",type:"file",accept:".sqlite,.sqlite3,.db,.db3,.s3db,.sl3",clearable:!0,get files(){return e(D)},set files(Oe){s(D,Oe,!0)}}),r(Be,Se)},ce=Be=>{var Se=I(),Je=p(Se);{var Ge=Oe=>{var nt=Es(),dt=a(nt);ft(dt,{for:"parquetFile",children:(Re,lt)=>{var Pt=be("Parquet File");r(Re,Pt)},$$slots:{default:!0}});var _t=o(dt,2);Et(_t,{id:"parquetFile",type:"file",accept:".parquet",clearable:!0,get files(){return e(D)},set files(Re){s(D,Re,!0)}}),r(Oe,nt)};v(Je,Oe=>{e(d)===$e.parquet&&Oe(Ge)},!0)}r(Be,Se)};v(pe,Be=>{e(d)===$e.sqlite?Be(he):Be(ce,!1)},!0)}r(qe,Me)};v(G,qe=>{e(d)===$e.jsonl?qe(Q):qe(Te,!1)},!0)}r(W,$)};v(ue,W=>{e(d)===$e.csv?W(E):W(j,!1)},!0)}r(je,xe)};v(We,je=>{e(d)===$e.comment?je(ie):je(ze,!1)},!0)}r(ge,ae)};v(le,ge=>{e(d)===$e.json?ge(Ke):ge(Ne,!1)},!0)}r(V,L)};v(m,V=>{e(d)===$e.media?V(O):V(Ee,!1)})}var tt=o(ne,2);{var rt=V=>{var L=Ts(),le=a(L);Kt(le,{get code(){return e(fe)},language:"json"}),r(V,L)};v(tt,V=>{e(fe)&&V(rt)})}var it=o(k,2),st=a(it);bt(st,{color:"alternative",onclick:()=>{M(!1)},get disabled(){return e(Z)},children:(V,L)=>{var le=be("Cancel");r(V,le)},$$slots:{default:!0}});var et=o(st,2);{let V=Qe(()=>e(Z)?"cursor-not-allowed":"cursor-pointer");bt(et,{color:"blue",type:"submit",get class(){return e(V)},get disabled(){return e(Z)},children:(L,le)=>{var Ke=I(),Ne=p(Ke);{var ge=We=>{var ie=be();U(()=>te(ie,P()?"Updating...":"Uploading...")),r(We,ie)},ae=We=>{var ie=I(),ze=p(ie);{var je=ue=>{var E=I(),j=p(E);{var W=G=>{var Q=be("Update Metadata");r(G,Q)},$=G=>{var Q=be("Update Content");r(G,Q)};v(j,G=>{e(d)===$e.json&&e(_e)!==null?G(W):G($,!1)})}r(ue,E)},xe=ue=>{var E=be("Upload");r(ue,E)};v(ze,ue=>{P()?ue(je):ue(xe,!1)})}r(We,ie)};v(Ne,We=>{e(Z)?We(ge):We(ae,!1)})}r(L,Ke)},$$slots:{default:!0}})}U(()=>te(ee,` ${e(d)??""} `)),pr("submit",Ve,Ie),r(K,Ve)},$$slots:{default:!0}}),jt(),f()}var $s=l('<div class="p-6"><!></div>'),zs=l("<!> ",1),qs=l('<span class="inline-flex items-center gap-2"><!> </span>'),Rs=l("<!> <strong>UPLOAD</strong>",1),Ls=l('<div class="flex items-center gap-2"><!> View Meta</div>'),Us=l('<div class="flex items-center gap-2"><!> Edit</div>'),Is=l('<div class="flex items-center gap-2 text-red-600"><!> Delete</div>'),Vs=l("<!> <!> <!>",1),Ns=l("<!> <!>",1),Bs=l('<a class="font-semibold text-lg underline text-primary" target="_blank"> </a>'),Ws=l('<p class="font-semibold text-lg"> </p>'),Js=l('<div class="absolute top-2 right-2"><!></div>'),Hs=l('<div class="absolute top-2 left-2"><!></div> <div class="flex flex-col items-center text-center p-4"><span class="inline-block px-3 py-1 mb-3 border border-gray-300 rounded-md text-sm font-medium bg-primary"><!></span> <!> <p class="text-gray-600 mt-2 mb-4 line-clamp-3"> </p> <div class="text-xs text-gray-500 mt-auto"> <br/> </div></div> <!>',1),Ks=l('<div class="d-flex justify-content-center flex-column px-5 mt-2"><div class="flex justify-between"><div><!> <!></div> <!></div> <div class="my-5 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-4 gap-4 w-full place-items-center"></div></div>'),Gs=l('<div class="flex flex-row"><!> <!> <!></div>'),Qs=l('<p class="text-center mb-6">Are you sure you want to delete the attachment <span class="font-bold"> </span>?<br/> This action cannot be undone.</p>'),Ys=l('<!> <div class="flex justify-between w-full"><!> <!></div>',1),Zs=l('<!>  <div class="d-flex justify-content-between mx-2 flex-row"></div> <!> <!> <!> <!>',1);function Xs(C,t){kt(t,!0);const _=()=>St(rr,"$currentEntry",x),[x,f]=Gt();let n=at(t,"attachments",19,()=>[]);async function w(){var u,k,T,S,ne,me,De,ve;for(const H of e(X))if(["csv","parquet","jsonl"].includes(H.resource_type)){const ee=await Ye.fetchDataAsset({resourceType:t.resource_type,dataAssetType:H.resource_type,spaceName:t.space_name,subpath:t.subpath,shortname:t.parent_shortname,query_string:`SELECT * FROM '${H.shortname}'`});ee instanceof Ar?(H.dataAsset={code:(k=(u=ee.response.data)==null?void 0:u.error)==null?void 0:k.code,message:(S=(T=ee.response.data)==null?void 0:T.error)==null?void 0:S.message},((me=(ne=ee.response.data)==null?void 0:ne.error)==null?void 0:me.info.length)>0&&(H.dataAsset.details=(ve=(De=ee.response.data)==null?void 0:De.error)==null?void 0:ve.info[0].msg)):H.dataAsset=ee}else if(H.resource_type==="sqlite"){const ee=await Ye.fetchDataAsset({resourceType:t.resource_type,dataAssetType:H.resource_type,spaceName:t.space_name,subpath:t.subpath,shortname:t.parent_shortname,query_string:"SELECT * FROM temp.information_schema.tables",filter_data_assets:[H.shortname]});H.dataAsset=(await Promise.all(ee.map(async m=>{const O=await Ye.fetchDataAsset({resourceType:t.resource_type,dataAssetType:H.resource_type,spaceName:t.space_name,subpath:t.subpath,shortname:t.parent_shortname,query_string:`SELECT * FROM '${m.table_name}' LIMIT 10`,filter_data_assets:[H.shortname]});return O instanceof Ar?null:{table_name:m.table_name,rows:O}}))).filter(m=>m!==null)}}let M=R(!1),P=R(!1),se=R(ot({json:{},text:void 0})),ye=R(!1);async function h(u){const k={space_name:t.space_name,request_type:Ot.delete,records:[{resource_type:u.resource_type,shortname:u.shortname,subpath:`${u.subpath}/${t.parent_shortname}`,attributes:{}}]};try{s(ye,!0),(await Ye.request(k)).status==="success"?(ct(vt.info,`Attachment ${u.shortname} deleted successfully.`),_().refreshEntry(),s(Z,!1)):ct(vt.warn)}catch{ct(vt.warn)}finally{s(ye,!1),s(c,!1)}}function F(u){s(re,u,!0),s(M,!0),s(Z,!0)}function d(u,k){u=u.filter(ne=>!["tree","text","table"].includes(ne.text));const T={separator:!0};return u.slice(0,u.length-2).concat([T,{space:!0}])}function B(u){s(re,u,!0),s(se,{json:u,text:void 0},!0),s(P,!0)}function D(u){s(re,u,!0),F(e(re))}function g(u){s(re,u,!0),s(c,!0)}let c=R(!1),_e=R(!1),Z=R(!1),re=R(null);function fe(u){s(re,u,!0),s(_e,!0)}At(()=>{e(b)==="all"?s(X,Object.values(n()).flat(1),!0):s(X,n()[e(b)]||[],!0)});let Fe=R(ot({})),Ae=R(ot({}));function Ie(u){u.stopPropagation(),s(M,!1),s(re,null),s(Fe,{},!0),s(Ae,{},!0),s(Z,!0)}let b=R("all"),X=R(ot(Object.values(n()).flat(1))),Ce=R(ot({}));function K(){const u=Object.values(n()).flat(1),k={all:u};return u.forEach(T=>{var ne,me;let S="other";T.resource_type===y.media&&((me=(ne=T.attributes)==null?void 0:ne.payload)!=null&&me.content_type)?S=T.attributes.payload.content_type:T.resource_type===y.csv?S="csv":T.resource_type===y.json?S="json":T.resource_type===y.comment&&(S="comment"),k[S]=k[S]||[],k[S].push(T)}),k}At(()=>{s(Ce,K(),!0),Ue(()=>{s(X,e(Ce)[e(b)]||e(Ce).all,!0)})}),At(()=>{e(b)&&Ue(()=>{s(X,e(Ce)[e(b)]||e(Ce).all,!0)})});var A=Zs(),Ve=p(A);Rt(Ve,{size:"lg",get open(){return e(P)},set open(u){s(P,u,!0)},children:(u,k)=>{var T=$s(),S=a(T);hr(S,{onRenderMenu:d,get mode(){return yr.text},get content(){return e(se)},readOnly:!0}),r(u,T)},$$slots:{default:!0}});var oe=o(Ve,4);Qt(oe,w,u=>{var k=Gs(),T=a(k);dr(T,{size:"md",class:"mt-8"});var S=o(T,2);dr(S,{size:"md",class:"mt-8"});var ne=o(S,2);dr(ne,{size:"md",class:"mt-8"}),r(u,k)},(u,k)=>{var T=Ks(),S=a(T),ne=a(S),me=a(ne);{let ee=Qe(()=>e(b)==="all"?"m-1 bg-primary text-white":"m-1 bg-[#F5F5FF] text-primary");Mr(me,{get class(){return e(ee)},style:"cursor: pointer;",onclick:()=>{s(b,"all")},children:(m,O)=>{var Ee=zs(),tt=p(Ee);Jr(tt,{size:"lg"});var rt=o(tt);U(()=>{var it;return te(rt,` ALL (${(((it=e(Ce).all)==null?void 0:it.length)||0)??""})`)}),r(m,Ee)},$$slots:{default:!0}})}var De=o(me,2);yt(De,17,()=>Object.keys(e(Ce)).filter(ee=>ee!=="all"),gt,(ee,m)=>{{let O=Qe(()=>e(b)===e(m)?"m-1 bg-primary text-white":"m-1 bg-[#F5F5FF] text-black");Mr(ee,{get class(){return e(O)},style:"cursor: pointer;",onclick:()=>{s(b,e(m),!0)},children:(Ee,tt)=>{var rt=qs(),it=a(rt);{var st=L=>{Sr(L,{size:"lg"})},et=L=>{var le=I(),Ke=p(le);{var Ne=ae=>{Or(ae,{size:"lg"})},ge=ae=>{var We=I(),ie=p(We);{var ze=xe=>{$r(xe,{size:"lg"})},je=xe=>{var ue=I(),E=p(ue);{var j=$=>{qr($,{size:"lg"})},W=$=>{var G=I(),Q=p(G);{var Te=Me=>{zr(Me,{size:"lg"})},qe=Me=>{cr(Me,{size:"lg"})};v(Q,Me=>{e(m)==="csv"?Me(Te):Me(qe,!1)},!0)}r($,G)};v(E,$=>{e(m)===N.text||e(m)===N.markdown||e(m)===N.html?$(j):$(W,!1)},!0)}r(xe,ue)};v(ie,xe=>{e(m)===N.video?xe(ze):xe(je,!1)},!0)}r(ae,We)};v(Ke,ae=>{e(m)===N.audio?ae(Ne):ae(ge,!1)},!0)}r(L,le)};v(it,L=>{e(m)===N.image?L(st):L(et,!1)})}var V=o(it);U(L=>{var le;return te(V,` ${L??""} (${(((le=e(Ce)[e(m)])==null?void 0:le.length)||0)??""})`)},[()=>e(m).toUpperCase()]),r(Ee,rt)},$$slots:{default:!0}})}});var ve=o(ne,2);bt(ve,{class:"text-primary cursor-pointer hover:bg-primary hover:text-white",outline:!0,onclick:Ie,children:(ee,m)=>{var O=Rs(),Ee=p(O);za(Ee,{size:"md",class:"mr-2"}),r(ee,O)},$$slots:{default:!0}});var H=o(S,2);yt(H,21,()=>e(X),gt,(ee,m)=>{Zt(ee,{class:"relative w-full",children:(O,Ee)=>{var tt=Hs(),rt=p(tt),it=a(rt);bt(it,{class:"!p-1",color:"light",children:(E,j)=>{var W=Ns(),$=p(W);qa($,{});var G=o($,2);Aa(G,{simple:!0,children:(Q,Te)=>{var qe=Vs(),Me=p(qe);ur(Me,{class:"w-full",onclick:()=>B(e(m)),children:(ce,Be)=>{var Se=Ls(),Je=a(Se);Hr(Je,{size:"sm"}),r(ce,Se)},$$slots:{default:!0}});var pe=o(Me,2);ur(pe,{class:"w-full",onclick:()=>D(e(m)),children:(ce,Be)=>{var Se=Us(),Je=a(Se);Ra(Je,{size:"sm"}),r(ce,Se)},$$slots:{default:!0}});var he=o(pe,2);ur(he,{class:"w-full",onclick:()=>g(e(m)),children:(ce,Be)=>{var Se=Is(),Je=a(Se);Kr(Je,{size:"sm"}),r(ce,Se)},$$slots:{default:!0}}),r(Q,qe)},$$slots:{default:!0}}),r(E,W)},$$slots:{default:!0}});var st=o(rt,2),et=a(st),V=a(et);{var L=E=>{var j=I(),W=p(j);{var $=Q=>{Sr(Q,{size:"xl",class:"text-white"})},G=Q=>{var Te=I(),qe=p(Te);{var Me=he=>{Or(he,{size:"xl",class:"text-white"})},pe=he=>{var ce=I(),Be=p(ce);{var Se=Ge=>{$r(Ge,{size:"xl",class:"text-white"})},Je=Ge=>{var Oe=I(),nt=p(Oe);{var dt=Re=>{qr(Re,{size:"xl",class:"text-white"})},_t=Re=>{cr(Re,{size:"xl",class:"text-white"})};v(nt,Re=>{var lt;[N.text,N.markdown,N.html].includes((lt=e(m).attributes)==null?void 0:lt.payload.content_type)?Re(dt):Re(_t,!1)},!0)}r(Ge,Oe)};v(Be,Ge=>{var Oe;((Oe=e(m).attributes)==null?void 0:Oe.payload.content_type)===N.video?Ge(Se):Ge(Je,!1)},!0)}r(he,ce)};v(qe,he=>{var ce;((ce=e(m).attributes)==null?void 0:ce.payload.content_type)===N.audio?he(Me):he(pe,!1)},!0)}r(Q,Te)};v(W,Q=>{var Te;((Te=e(m).attributes)==null?void 0:Te.payload.content_type)===N.image?Q($):Q(G,!1)})}r(E,j)},le=E=>{var j=I(),W=p(j);{var $=Q=>{zr(Q,{size:"xl",class:"text-white"})},G=Q=>{var Te=I(),qe=p(Te);{var Me=he=>{Ua(he,{size:"xl",class:"text-white"})},pe=he=>{cr(he,{size:"xl",class:"text-white"})};v(qe,he=>{[y.comment,y.json].includes(e(m).resource_type)?he(Me):he(pe,!1)},!0)}r(Q,Te)};v(W,Q=>{e(m).resource_type===y.csv?Q($):Q(G,!1)},!0)}r(E,j)};v(V,E=>{e(m).resource_type===y.media?E(L):E(le,!1)})}var Ke=o(et,2);{var Ne=E=>{var j=Bs(),W=a(j);U($=>{var G,Q;Pe(j,"href",$),te(W,((Q=(G=e(m).attributes)==null?void 0:G.displayname)==null?void 0:Q.en)||e(m).shortname)},[()=>{var $,G;return Ye.getAttachmentUrl({resource_type:e(m).resource_type,space_name:t.space_name,subpath:t.subpath,parent_shortname:t.resource_type===y.folder?"":t.parent_shortname,shortname:e(m).shortname,ext:Gr((G=($=e(m).attributes)==null?void 0:$.payload)==null?void 0:G.body)})}]),r(E,j)},ge=E=>{var j=Ws(),W=a(j);U(()=>{var $,G;return te(W,((G=($=e(m).attributes)==null?void 0:$.displayname)==null?void 0:G.en)||e(m).shortname)}),r(E,j)};v(Ke,E=>{e(m).resource_type===y.media?E(Ne):E(ge,!1)})}var ae=o(Ke,2),We=a(ae),ie=o(ae,2),ze=a(ie),je=o(ze,2),xe=o(st,2);{var ue=E=>{var j=Js();j.__click=()=>fe(e(m));var W=a(j);bt(W,{class:"!p-1",color:"light",children:($,G)=>{La($,{})},$$slots:{default:!0}}),r(E,j)};v(xe,E=>{e(m).resource_type!==y.reaction&&E(ue)})}U(E=>{var j,W,$;te(We,((W=(j=e(m).attributes)==null?void 0:j.description)==null?void 0:W.en)||""),te(ze,`Type: ${e(m).resource_type??""} (${(($=e(m).attributes)==null?void 0:$.payload.content_type)??"N/A"??""}) `),te(je,` Updated: ${E??""}`)},[()=>{var E;return new Date((E=e(m))==null?void 0:E.attributes.updated_at).toLocaleDateString()}]),r(O,tt)},$$slots:{default:!0}})}),r(u,T)});var J=o(oe,2);cs(J,{get selectedAttachment(){return e(re)},get space_name(){return t.space_name},get subpath(){return t.subpath},get parent_resource_type(){return t.resource_type},get parent_shortname(){return t.parent_shortname},get openViewContentModal(){return e(_e)},set openViewContentModal(u){s(_e,u,!0)}});var ke=o(J,2);Os(ke,{get isUpdateMode(){return e(M)},get selectedAttachment(){return e(re)},get parentResourceType(){return t.resource_type},get space_name(){return t.space_name},get subpath(){return t.subpath},get parent_shortname(){return t.parent_shortname},get isOpen(){return e(Z)},set isOpen(u){s(Z,u,!0)},get meta(){return e(Fe)},set meta(u){s(Fe,u,!0)},get payload(){return e(Ae)},set payload(u){s(Ae,u,!0)}});var Y=o(ke,2);Rt(Y,{size:"md",title:"Confirm Deletion",get open(){return e(c)},set open(u){s(c,u,!0)},children:(u,k)=>{var T=Ys(),S=p(T);{var ne=H=>{var ee=Qs(),m=o(a(ee)),O=a(m);U(()=>te(O,e(re).shortname)),r(H,ee)};v(S,H=>{e(re)&&H(ne)})}var me=o(S,2),De=a(me);bt(De,{color:"alternative",onclick:()=>s(c,!1),children:(H,ee)=>{var m=be("Cancel");r(H,m)},$$slots:{default:!0}});var ve=o(De,2);bt(ve,{color:"red",onclick:()=>h(e(re)),get disabled(){return e(ye)},children:(H,ee)=>{var m=be();U(()=>te(m,e(ye)?"Deleting...":"Delete")),r(H,m)},$$slots:{default:!0}}),r(u,T)},$$slots:{default:!0}}),r(C,A),jt(),f()}Yt(["click"]);var eo=l('<tr class="border-b hover:bg-gray-50"><td class="px-4 py-2 font-medium"> </td><td class="px-4 py-2 bg-red-50 whitespace-normal cursor-pointer"><span class="text-red-600 font-bold block break-words"> </span></td><td class="px-4 py-2 bg-green-50 whitespace-normal cursor-pointer"><span class="text-green-600 font-bold block break-words"> </span></td></tr>'),to=l('<thead><tr><th class="px-4 py-2 w-[20%]">Property</th><th class="px-4 py-2 w-[40%]">Previous Value</th><th class="px-4 py-2 w-[40%]">New Value</th></tr></thead> <tbody></tbody>',1),ro=l('<div class="border rounded-lg overflow-hidden"><!></div>'),ao=l('<div class="text-center py-4 text-gray-500">No changes recorded</div>'),so=l('<div class="flex justify-between mt-4 mb-2"><p class="text-lg"><strong>By:</strong> </p> <p class="text-lg"><strong>At:</strong> </p></div> <!>',1),oo=l("<button> </button>"),no=l("<button> </button>"),lo=l('<div class="text-center py-8 text-gray-500">No history records found</div>'),io=l('<div class="p-6 bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700 w-full"><!> <div class="flex flex-col sm:flex-row justify-between my-6"><div class="mb-2 sm:mb-0"><span class="mr-2">Items per page:</span> <div class="inline-flex space-x-1"></div></div> <div class="flex items-center space-x-2"><span class="text-sm text-gray-700 dark:text-gray-300"> </span> <div class="flex space-x-1"><button>&lt; Prev</button> <!> <button>Next &gt;</button></div></div></div></div> <!> <!>',1);function uo(C,t){kt(t,!0);let _=R(ot([])),x=R(!0),f=R(10),n=R(0),w=R(0),M=R(!1),P=R(null);async function se(){s(x,!0);try{const c=await Ye.query({type:Nr.history,filter_shortnames:t.shortname?[t.shortname]:[],space_name:t.space_name,subpath:t.subpath,search:"",limit:e(f),offset:e(n),sort_by:"timestamp",sort_type:Ca.descending});s(_,c.records||[],!0),s(w,c.attributes.total||e(_).length,!0)}catch(c){console.error("Failed to fetch history:",c)}finally{s(x,!1)}}function ye(c){s(f,c,!0),s(n,0),se()}fa(se);function h(c){return c.split(".").map(_e=>_e.charAt(0).toUpperCase()+_e.slice(1)).join(" > ")}function F(c){s(P,c,!0),s(M,!0)}var d=I(),B=p(d);{var D=c=>{Ea(c,{class:"m-5",size:"lg",style:"width: 100%"})},g=c=>{var _e=io(),Z=p(_e),re=a(Z);yt(re,17,()=>e(_),gt,(Y,u)=>{var k=so(),T=p(k),S=a(T),ne=o(a(S)),me=o(S,2),De=o(a(me)),ve=o(T,2);{var H=m=>{var O=ro(),Ee=a(O);Ta(Ee,{class:"w-full table-fixed",children:(tt,rt)=>{var it=to(),st=o(p(it),2);yt(st,21,()=>Object.entries(e(u).attributes.diff),gt,(et,V)=>{var L=Qe(()=>ma(e(V),2));let le=()=>e(L)[0];const Ne=Qe(()=>e(L)[1]);var ge=eo(),ae=a(ge),We=a(ae),ie=o(ae);ie.__click=()=>{var j;return F((j=e(Ne))==null?void 0:j.old)};var ze=a(ie),je=a(ze),xe=o(ie);xe.__click=()=>{var j;return F((j=e(Ne))==null?void 0:j.new)};var ue=a(xe),E=a(ue);U((j,W,$)=>{te(We,j),te(je,W),te(E,$)},[()=>h(le()),()=>{var j;return JSON.stringify((j=e(Ne))==null?void 0:j.old)||""},()=>{var j;return JSON.stringify((j=e(Ne))==null?void 0:j.new)||""}]),r(et,ge)}),r(tt,it)},$$slots:{default:!0}}),r(m,O)},ee=m=>{var O=ao();r(m,O)};v(ve,m=>{var O;(O=e(u).attributes)!=null&&O.diff&&Object.keys(e(u).attributes.diff).length>0?m(H):m(ee,!1)})}U(m=>{var O;te(ne,` ${(((O=e(u).attributes)==null?void 0:O.owner_shortname)||"Unknown")??""}`),te(De,` ${m??""}`)},[()=>{var m;return new Date((m=e(u).attributes)==null?void 0:m.timestamp).toLocaleString()}]),r(Y,k)});var fe=o(re,2),Fe=a(fe),Ae=o(a(Fe),2);yt(Ae,20,()=>[5,10,25,50],gt,(Y,u)=>{var k=oo();k.__click=()=>ye(u);var T=a(k);U(()=>{Xe(k,1,`px-3 py-1 text-sm rounded ${e(f)===u?"bg-blue-600 text-white":"bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`),te(T,u)}),r(Y,k)});var Ie=o(Fe,2),b=a(Ie),X=a(b),Ce=o(b,2),K=a(Ce);K.__click=()=>{s(n,Math.max(0,e(n)-e(f)),!0),se()};var A=o(K,2);yt(A,17,()=>Array(Math.min(5,Math.ceil(e(w)/e(f)))),gt,(Y,u,k)=>{const T=Qe(()=>Math.max(0,Math.min(Math.floor(e(n)/e(f))-2,Math.ceil(e(w)/e(f))-5))),S=Qe(()=>e(T)+k),ne=Qe(()=>Math.floor(e(n)/e(f))===e(S));var me=no();me.__click=()=>{s(n,e(S)*e(f)),se()};var De=a(me);U(()=>{Xe(me,1,`px-3 py-1 rounded ${e(ne)?"bg-blue-600 text-white":"bg-gray-200 text-gray-800 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200"}`),te(De,e(S)+1)}),r(Y,me)});var Ve=o(A,2);Ve.__click=()=>{s(n,Math.min(e(w)-e(f),e(n)+e(f)),!0),se()};var oe=o(Z,2);{var J=Y=>{var u=lo();r(Y,u)};v(oe,Y=>{e(_).length===0&&Y(J)})}var ke=o(oe,2);Rt(ke,{class:"pt-8",get open(){return e(M)},set open(Y){s(M,Y,!0)},children:(Y,u)=>{Kt(Y,{language:"json",get code(){return e(P)}})},$$slots:{default:!0}}),U((Y,u)=>{te(X,`${Y??""} of ${u??""} pages`),Xe(K,1,`px-2 py-1 rounded ${e(n)===0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-800 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200"}`),K.disabled=e(n)===0,Xe(Ve,1,`px-2 py-1 rounded ${e(n)+e(f)>=e(w)?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-800 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200"}`),Ve.disabled=e(n)+e(f)>=e(w)},[()=>Math.floor(e(n)/e(f))+1,()=>Math.ceil(e(w)/e(f))]),r(c,_e)};v(B,c=>{e(x)?c(D):c(g,!1)})}r(C,d),jt()}Yt(["click"]);var co=l("<option> </option>"),vo=l("<option>Select an action</option> <!>",1),_o=l('<div class="mb-4"><!> <!></div>'),fo=l("<option> </option>"),mo=l("<option> </option>"),po=l("<option>Select resolution</option> <!>",1),ho=l('<div class="mb-4"><!> <!></div>'),yo=l('<div class="mb-4"><!> <!></div>'),go=l('<!> <!> <!> <div class="mb-4 justify-end flex"><!></div>',1),bo=l("<!> <!>",1),xo=l('<form class="flex flex-col space-y-4"><!></form>'),wo=l('<h1 class="text-2xl font-bold mb-4">Ticket Form</h1> <!>',1);function ko(C,t){kt(t,!0);let _=at(t,"formData",15);const x=JSON.parse(localStorage.getItem("roles"));let f=R(null),n=R(null),w=R(null),M=R(""),P=R(null),se=R(ot([])),ye=R(ot([]));async function h(){var d,B;s(P,await Ye.retrieveEntry({resource_type:y.content,space_name:t.space_name,subpath:"workflows",shortname:t.meta.workflow_shortname,retrieve_json_payload:!0,retrieve_attachments:!1,validate_schema:!0}),!0),s(P,e(P).payload.body,!0),e(P)&&(s(se,((d=e(P).states.filter(D=>D.state===t.meta.state)[0])==null?void 0:d.next)||[],!0),(e(se)||[]).length&&s(ye,((B=e(P).states.filter(D=>D.state===e(f))[0])==null?void 0:B.resolutions)||[],!0))}At(()=>{var d,B;s(n,((B=(d=e(se))==null?void 0:d.filter(D=>D.state===e(f))[0])==null?void 0:B.action)||null,!0)}),At(()=>{var d;(e(se)||[]).length&&s(ye,((d=e(P).states.filter(B=>B.state===e(f))[0])==null?void 0:d.resolutions)||[],!0)}),At(()=>{e(w)&&_(_().resolution=e(w),!0),e(n)&&_(_().action=e(n),!0),e(M)&&_(_().comment=e(M),!0)});async function F(d){d.preventDefault();try{return await Ye.progressTicket({space_name:t.space_name,subpath:t.subpath,shortname:t.shortname,action:e(n),resolution:e(w),comment:e(M)}),ct(vt.info,"Ticket has been updated successfully!"),{success:!0}}catch(B){return ct(vt.warn,"Failed to update the ticket!"),{success:!1,errorMessage:B.message}}}Zt(C,{class:"p-4 max-w-4xl mx-auto my-2",children:(d,B)=>{var D=wo(),g=o(p(D),2);{var c=Z=>{var re=xo(),fe=a(re);Qt(fe,h,Fe=>{var Ae=bo(),Ie=p(Ae);Dr(Ie,{class:"m-5",size:"lg",style:"width: 100%"});var b=o(Ie,2);Dr(b,{class:"m-5",size:"lg",style:"width: 100%"}),r(Fe,Ae)},(Fe,Ae)=>{var Ie=go(),b=p(Ie);{var X=J=>{var ke=_o(),Y=a(ke);ft(Y,{for:"status",class:"block mb-2",children:(k,T)=>{var S=be("State");r(k,S)},$$slots:{default:!0}});var u=o(Y,2);Ht(u,{id:"status",get value(){return e(f)},set value(k){s(f,k,!0)},children:(k,T)=>{var S=vo(),ne=p(S);ne.value=(ne.__value=null)??"";var me=o(ne,2);yt(me,17,()=>e(se),gt,(De,ve)=>{var H=co(),ee=a(H),m={};U((O,Ee)=>{H.disabled=O,te(ee,`${e(ve).state??""} ${Ee??""}`),m!==(m=e(ve).state)&&(H.value=(H.__value=e(ve).state)??"")},[()=>!e(ve).roles.some(O=>x.includes(O)),()=>e(ve).roles&&!e(ve).roles.some(O=>x.includes(O))?`(${e(ve).roles})`:""]),r(De,H)}),r(k,S)},$$slots:{default:!0}}),r(J,ke)};v(b,J=>{e(se).length&&J(X)})}var Ce=o(b,2);fr(Ce,()=>e(f),J=>{var ke=I(),Y=p(ke);{var u=k=>{var T=ho(),S=a(T);ft(S,{for:"resolution",class:"block mb-2",children:(me,De)=>{var ve=be("Resolution");r(me,ve)},$$slots:{default:!0}});var ne=o(S,2);Ht(ne,{id:"resolution",get value(){return e(w)},set value(me){s(w,me,!0)},children:(me,De)=>{var ve=po(),H=p(ve);H.value=(H.__value=null)??"";var ee=o(H,2);yt(ee,17,()=>e(ye),gt,(m,O)=>{var Ee=I(),tt=p(Ee);{var rt=st=>{var et=fo(),V=a(et),L={};U(()=>{te(V,e(O)),L!==(L=e(O))&&(et.value=(et.__value=e(O))??"")}),r(st,et)},it=st=>{var et=mo(),V=a(et),L={};U(()=>{var le;te(V,(le=e(O))==null?void 0:le.en),L!==(L=e(O).key)&&(et.value=(et.__value=e(O).key)??"")}),r(st,et)};v(tt,st=>{typeof e(O)=="string"?st(rt):st(it,!1)})}r(m,Ee)}),r(me,ve)},$$slots:{default:!0}}),r(k,T)};v(Y,k=>{e(ye).length!==0&&k(u)})}r(J,ke)});var K=o(Ce,2);{var A=J=>{var ke=yo(),Y=a(ke);ft(Y,{for:"comment",class:"block mb-2",children:(k,T)=>{var S=be("Comment");r(k,S)},$$slots:{default:!0}});var u=o(Y,2);Sa(u,{id:"comment",type:"text",placeholder:"Comment...",get value(){return e(M)},set value(k){s(M,k,!0)}}),r(J,ke)};v(K,J=>{var ke;e(f)&&!((ke=e(P).states.filter(Y=>Y.state===e(f))[0])!=null&&ke.next)&&J(A)})}var Ve=o(K,2),oe=a(Ve);bt(oe,{type:"submit",class:"bg-primary text-white hover:bg-primary-700",children:(J,ke)=>{var Y=be("Submit");r(J,Y)},$$slots:{default:!0}}),r(Fe,Ie)}),pr("submit",re,F),r(Z,re)},_e=Z=>{Wr(Z,{color:"blue",class:"mb-4 text-lg text-center",children:(re,fe)=>{var Fe=be("This ticket is closed. You cannot perform any actions on it.");r(re,Fe)},$$slots:{default:!0}})};v(g,Z=>{t.meta.is_open?Z(c):Z(_e,!1)})}r(d,D)},$$slots:{default:!0}}),jt()}function jo(C){if(C.states){let t=`@startuml
`;return t+=`title "${C.name}"
`,C.states.map(_=>{t+=`state "${_.state}"
`,_.next?_.next.map(x=>{t+=`${_.state} --> ${x.state}
`,t+=`note on link
`,t+=`action: ${x.action}
`,x.roles&&(t+=`roles:
`,x.roles.map(f=>{t+=`* ${f}
`})),t+=`end note
`}):t+=`${_.state} --> [*]
`}),C.states.map(_=>{_.resolutions&&(t+=`note left of "${_.state}"
Resolutions:
`,_.resolutions.map(x=>{t+=`* ${x.key}
`}),t+=`end note
`)}),C.initial_state.map(_=>{t+=`[*] --> ${_.name}
`,t+=`note on link
action: create
roles:
`,_.roles.map(x=>{t+=`* ${x}
`}),t+=`end note
`}),t+="@enduml",t}else return`@startuml
@enduml`}var Po=l('<div class="px-1 pb-1 h-full w-full" style="text-align: left; direction: ltr; overflow: hidden auto;"><div class="preview svelte-1ykxikk"><a><img/></a></div></div>');function Fo(C,t){kt(t,!0);let _={name:t.shortname,content:jo(t.workflowContent),encodedContent(){return mr.encode(this.content)}};var x=Po(),f=a(x),n=a(f),w=a(n);U((M,P)=>{Pe(n,"href",M),Pe(n,"download",`${t.shortname??""}.svg`),Pe(w,"src",P),Pe(w,"alt",t.shortname)},[()=>"https://www.plantuml.com/plantuml/svg/"+_.encodedContent(),()=>"https://www.plantuml.com/plantuml/svg/"+_.encodedContent()]),r(C,x),jt()}const Ur=`@startjson
<style>
jsonDiagram {  node {BackGroundColor business}  
highlight {BackGroundColor greenyellow}}
</style>
#highlight "*" / "*_shortname"
`;function Qr(C){var _,x;let t={};for(const f in C){const n=C[f];n.type==="object"&&n.properties?t[f]=Qr(n.properties):n.properties&&n.properties.code?t[f]=n.properties.code.type:(t[f]=n.type,n.type==="array"&&(t[f]+=" of "+((_=n==null?void 0:n.items)==null?void 0:_.type)||"unknown",(x=n==null?void 0:n.items)!=null&&x.enum&&(t[f]={type:t[f],enum:n.items.enum})),n.pattern&&(t[f]+=`/pattern\\n${n.pattern}`))}return t}function tr(C){try{return{name:"",content:`${Ur}
${JSON.stringify(Qr(C),null,2)}
@endjson`,encodedContent:function(){return mr.encode(this.content)}}.encodedContent()}catch{return{name:"",content:`${Ur}
{"error": "something is wrong with the schema"}
@endjson`,encodedContent:function(){return mr.encode(this.content)}}.encodedContent()}}var Co=l("<a><img/></a>");function Mo(C,t){kt(t,!1);let _=at(t,"shortname",8),x=at(t,"properties",8);Ir();var f=Co(),n=a(f);U((w,M)=>{Pe(f,"href",w),Pe(f,"download",`${_()??""}.svg`),Pe(n,"src",M),Pe(n,"alt",_())},[()=>(mt(tr),mt(x()),Ue(()=>"https://www.plantuml.com/plantuml/svg/"+tr(x()))),()=>(mt(tr),mt(x()),Ue(()=>"https://www.plantuml.com/plantuml/svg/"+tr(x())))]),r(C,f),jt()}function vr(C){if(C==="/")return C;const t=C.split("/");return t.pop(),t.join("/")||"/"}var Do=l('<p class="text-4xl cursor-pointer"> </p> <!>',1);function Yr(C,t){kt(t,!0);const _=()=>St(gr,"$goto",x),[x,f]=Gt();_();function n(w,M){w.preventDefault(),_()("/management/content/[space_name]/[subpath]/[shortname]/[resource_type]",{space_name:"management",subpath:"permissions",shortname:M,resource_type:"permission"})}Zt(C,{class:"w-full max-w-4xl mx-auto p-4 my-2",children:(w,M)=>{var P=I(),se=p(P);yt(se,17,()=>t.permissions,gt,(ye,h)=>{var F=Do(),d=p(F);d.__click=g=>n(g,e(h));var B=a(d),D=o(d,2);Qt(D,()=>Ye.retrieveEntry({resource_type:y.permission,space_name:"management",subpath:"permissions",shortname:e(h),retrieve_json_payload:!0,retrieve_attachments:!1,validate_schema:!0}),null,(g,c)=>{Vr(g,{get formData(){return e(c)},readOnly:!0})}),U(()=>te(B,e(h))),r(ye,F)}),r(w,P)},$$slots:{default:!0}}),jt(),f()}Yt(["click"]);var Ao=l('<p class="text-4xl cursor-pointer"> </p> <!>',1);function Eo(C,t){kt(t,!0);const _=()=>St(gr,"$goto",x),[x,f]=Gt();_();function n(w,M){w.preventDefault(),_()("/management/content/[space_name]/[subpath]/[shortname]/[resource_type]",{space_name:"management",subpath:"roles",shortname:M,resource_type:"role"})}Zt(C,{class:"w-full max-w-4xl mx-auto p-4 my-2",children:(w,M)=>{var P=I(),se=p(P);yt(se,17,()=>t.roles,gt,(ye,h)=>{var F=Ao(),d=p(F);d.__click=g=>n(g,e(h));var B=a(d),D=o(d,2);Qt(D,()=>Ye.retrieveEntry({resource_type:y.role,space_name:"management",subpath:"roles",shortname:e(h),retrieve_json_payload:!0,retrieve_attachments:!1,validate_schema:!0}),null,(g,c)=>{Yr(g,{get permissions(){return e(c).permissions}})}),U(()=>te(B,e(h))),r(ye,F)}),r(w,P)},$$slots:{default:!0}}),jt(),f()}Yt(["click"]);function _r(C){if(C!=null)return C}function To(C){const _=C.replace(/^\/+|\/+$/g,"").split("/");return _.length<=1||_.length===1&&_[0]===""?"/":"/"+_.slice(0,-1).join("/")}async function So(C,t,_,x,f){var M;const n=Dt(C),w=n.shortname;if(delete n.uuid,delete n.shortname,x===y.schema?n.payload.body=_r(n.payload.body):x===y.content&&_==="workflows"&&(n.payload={body:_r(Dt(n.payload.body)),schema:"workflow",content_type:"json"}),x===y.user&&(n.password.startsWith("$argon2id")||n.password==="")&&delete n.password,f){const P=Dt(f);if(P.payload&&P.payload.body&&n.payload&&n.payload.body){const se=Object.keys(P.payload.body),ye=Object.keys(n.payload.body);se.filter(F=>!ye.includes(F)).forEach(F=>{n.payload.body[F]=null})}}try{return await Ye.request({space_name:t,request_type:Ot.update,records:[{resource_type:x,shortname:w,subpath:x===y.folder?To(_):_,attributes:_r(n)}]}),ct(vt.info,"Entry has been updated successfully!"),{success:!0}}catch(P){return{success:!1,errorMessage:((M=P.response)==null?void 0:M.data)||P.message}}}async function Oo(C,t,_,x){let f;if(x===y.folder){const n=_.split("/");n[n.length-1]="",f=n.join("/")}else f=_;try{return await Ye.request({space_name:t,request_type:Ot.delete,records:[{resource_type:x,shortname:C.shortname,subpath:f||"/",attributes:{}}]}),ct(vt.info,"Entry deleted successfully"),{success:!0}}catch(n){return ct(vt.warn,"Failed to delete the entry!"),{success:!1,errorMessage:n.message}}}async function $o(C,t,_,x,f){try{const n=x,w=n===y.folder?_.split("/").slice(0,-1).join("-")||"/":_,M={src_space_name:t,src_subpath:w,src_shortname:C.shortname,dest_space_name:"personal",dest_subpath:`/people/${f}/trash/${t}/${w}`.replaceAll("//","/"),dest_shortname:C.shortname};return await Ye.request({space_name:t,request_type:Ot.move,records:[{resource_type:n,shortname:C.shortname,subpath:w,attributes:M}]}),ct(vt.info,"Entry deleted successfully"),{success:!0}}catch(n){return ct(vt.warn,"Failed to delete the entry!"),{success:!1,errorMessage:n.message}}}function zo(C,t){return!(C==="personal"&&t.startsWith("people/")&&t.endsWith("/trash"))}var qo=l("<!> <p>List view</p>",1),Ro=l("<!> <p>Content</p>",1),Lo=l('<li class="mr-2" role="presentation"><button type="button" role="tab"><div class="flex items-center gap-2"><!> <p>Diagram</p></div></button></li>'),Uo=l('<li role="presentation"><button type="button" role="tab"><div class="flex items-center gap-2"><!> <p>Role explorer</p></div></button></li>'),Io=l('<li role="presentation"><button type="button" role="tab"><div class="flex items-center gap-2"><!> <p>Permission explorer</p></div></button></li>'),Vo=l('<li class="ml-auto" role="presentation"><button class="inline-flex items-center p-4 border-b-2 rounded-t-lg border-transparent hover:text-primary hover:border-primary" type="button" title="Save changes"><div class="flex items-center gap-2"><!> <p class="text-primary">Save</p></div></button></li>'),No=l('<li role="presentation"><button class="inline-flex items-center p-4 border-b-2 rounded-t-lg border-transparent hover:text-red-600 hover:border-red-600" type="button" title="Delete this entry"><div class="flex items-center gap-2"><!> <p class="text-red-500">Trash</p></div></button></li>'),Bo=l('<li role="presentation"><button class="inline-flex items-center p-4 border-b-2 rounded-t-lg border-transparent hover:text-red-600 hover:border-red-600" type="button" title="Delete this entry"><div class="flex items-center gap-2"><!> <p class="text-red-500">Delete</p></div></button></li> <!>',1),Wo=l('<div class="overflow-auto"><!></div>'),Jo=l('<h1 class="text-2xl font-bold mb-4">Payload</h1> <!>',1),Ho=l("<!> <!> <!>",1),Ko=l('<div class="overflow-auto"><!></div>'),Go=l("<!> <!>",1),Qo=l('<div role="tabpanel"><!> <!></div>'),Yo=l('<div role="tabpanel"><!></div>'),Zo=l('<div role="tabpanel"><!></div>'),Xo=l('<p class="text-center mb-6">Are you sure you want to delete <span class="font-bold"> </span> <br/> This action cannot be undone.</p> <div class="flex justify-between w-full"><!> <!></div>',1),en=l('<p class="text-center mb-6">You have unsaved changes. Do you want to discard them and refresh?</p> <div class="flex justify-between w-full"><!> <!></div>',1),tn=l('<div class="flex flex-col w-full"><!> <div class="border-b border-gray-200"><ul class="flex flex-wrap -mb-px text-sm font-medium text-center" role="tablist"><li class="mr-2" role="presentation"><button type="button" role="tab"><div class="flex items-center gap-2"><!></div></button></li> <li class="mr-2" role="presentation"><button type="button" role="tab"><div class="flex items-center gap-2"><!> <p>Entry</p></div></button></li> <li class="mr-2" role="presentation"><button type="button" role="tab"><div class="flex items-center gap-2"><!> <p>Form</p></div></button></li> <!> <li class="mr-2" role="presentation"><button type="button" role="tab"><div class="flex items-center gap-2"><!> <p> </p></div></button></li> <!> <!> <li role="presentation"><button type="button" role="tab"><div class="flex items-center gap-2"><!> <p>History</p></div></button></li> <!> <!> <li role="presentation"><button class="inline-flex items-center p-4 border-b-2 rounded-t-lg border-transparent hover:text-primary hover:border-primary" type="button" title="Save changes"><div class="flex items-center gap-2"><!> <p class="text-primary">Refresh</p></div></button></li></ul></div> <div class="mt-2"><div role="tabpanel"><!></div> <div role="tabpanel"><!> <!></div> <div role="tabpanel"><!></div> <!> <div role="tabpanel"><!></div> <!> <!> <div role="tabpanel"><!></div></div></div> <!> <!>',1);function xn(C,t){var Pr,Fr;kt(t,!0);const _=()=>St(gr,"$goto",M),x=()=>St(Qa,"$user",M),f=()=>St(Tr,"$spaceChildren",M),n=()=>St($a,"$currentListView",M),w=()=>St(xa,"$bulkBucket",M),[M,P]=Gt();_();const se=512,ye=50,h={list:0,entry:1,form:2,attachments:3,history:4,diagram:5,roles_explorer:6,permissions_explorer:7};let F=at(t,"entry",15),d=at(t,"resource_type",7);pa(ka,"");const B=((Fr=(Pr=F())==null?void 0:Pr.payload)==null?void 0:Fr.schema_shortname)||null;let D=R(ot(Oa.form));rr.set({entry:F(),refreshEntry:u});let g=R(!1),c=R(ot({json:structuredClone(F())})),_e=R(ot({}));setTimeout(()=>{s(_e,Dt(ht(e(c))),!0)},se);let Z=R(!1),re=R(ot({action:null,resolution:null,comment:null})),fe=R(null);const Fe=t.space_name==="personal"&&t.subpath.startsWith(`people/${x().shortname}/trash`),Ae=Cr("update",t.space_name,t.subpath,d()),Ie=t.space_name==="management"&&t.subpath==="/"&&(d()===y.space||d()===y.folder)?!1:Cr("delete",t.space_name,t.subpath,d());let b=R(ot(h.list)),X=R(!1),Ce,K;function A(){if(d()===y.space)_()("/management/content");else if(d()===y.folder){const i=t.subpath.split("/").slice(0,-1).join("-")||"";_()("/management/content/[space_name]/[subpath]",{space_name:t.space_name,subpath:i})}else _()("/management/content/[space_name]/[subpath]",{space_name:t.space_name,subpath:t.subpath})}async function Ve(){s(X,!0),s(fe,null);const i=await So(ht(e(c)),t.space_name,t.subpath,d(),ht(e(_e)));i.success?await u():s(fe,i.errorMessage,!0),s(X,!1)}let oe=R(!1);function J(){s(oe,!0)}async function ke(){s(X,!0),s(fe,null);const i=await Oo(F(),t.space_name,t.subpath,d());i.success?A():s(fe,i.errorMessage,!0),s(X,!1)}async function Y(){s(X,!0);const i=await $o(F(),t.space_name,t.subpath,d(),x().shortname);i.success?A():s(fe,i.errorMessage,!0),s(X,!1)}async function u(){if(d()===y.folder){if(e(Z)){F(await Ye.retrieveEntry({resource_type:d(),space_name:t.space_name,subpath:vr(t.subpath),shortname:F().shortname,retrieve_json_payload:!0,retrieve_attachments:!0,validate_schema:!0}));const i=await Ya(t.space_name,vr(t.subpath),ye,0,[y.folder]);f().data.set(`${t.space_name}:/${vr(t.subpath)}`.replaceAll("//","/"),i.records||[]),ha(Tr,Ue(f).data=structuredClone(f().data),Ue(f))}await n().fetchPageRecords()}else F(await Ye.retrieveEntry({resource_type:d(),space_name:t.space_name,subpath:t.subpath,shortname:F().shortname,retrieve_json_payload:!0,retrieve_attachments:!0,validate_schema:!0}));s(c,{json:ht(F())},!0),setTimeout(()=>{s(_e,Dt(ht(e(c))),!0)},se),rr.set({entry:F(),refreshEntry:u}),s(g,!e(g))}At(()=>{e(b)===h.entry?Ue(()=>{const i=Dt(ht(e(c)));s(c,{text:JSON.stringify(i,null,2)},!0)}):e(b)===h.form&&Ue(()=>{const i=Dt(ht(e(c)));s(c,{json:i},!0)})});let k=!1;async function T(i){if(i&&i.preventDefault(),e(Z)){s(ne,async()=>{await u()}),s(S,!0);return}await u()}At(()=>{e(c)&&s(Z,!Ma(Dt(ht(e(c))),ht(e(_e))))});let S=R(!1),ne=R(null);function me(){s(S,!1),e(ne)&&(e(ne)(),s(ne,null))}function De(){s(S,!1),s(ne,null)}function ve(i){e(Z)&&(i.preventDefault(),i.returnValue=!0)}var H=tn();pr("beforeunload",ya,ve);var ee=p(H),m=a(ee);{let i=Qe(()=>{var z,q;return(q=(z=F())==null?void 0:z.payload)==null?void 0:q.content_type});Ga(m,{get space_name(){return t.space_name},get subpath(){return t.subpath},get resource_type(){return d()},get schema_name(){return B},get shortname(){return F().shortname},get payloadContentType(){return e(i)}})}var O=o(m,2),Ee=a(O),tt=a(Ee),rt=a(tt);rt.__click=()=>s(b,h.list,!0);var it=a(rt),st=a(it);{var et=i=>{var z=qo(),q=p(z);Jr(q,{size:"md"}),r(i,z)},V=i=>{var z=Ro(),q=p(z);Hr(q,{size:"md"}),r(i,z)};v(st,i=>{[y.folder,y.space].includes(d())?i(et):i(V,!1)})}var L=o(tt,2),le=a(L);le.__click=()=>s(b,h.entry,!0);var Ke=a(le),Ne=a(Ke);Ia(Ne,{size:"md"});var ge=o(L,2),ae=a(ge);ae.__click=()=>s(b,h.form,!0);var We=a(ae),ie=a(We);Va(ie,{size:"md"});var ze=o(ge,2);{var je=i=>{var z=Lo(),q=a(z);q.__click=()=>s(b,h.diagram,!0);var He=a(q),Ze=a(He);Ja(Ze,{size:"md"}),U(()=>{Xe(q,1,`inline-flex items-center p-4 border-b-2 rounded-t-lg ${e(b)===h.diagram?"text-blue-600 border-blue-600":"border-transparent hover:text-gray-600 hover:border-gray-300"}`),Pe(q,"aria-selected",e(b)===h.diagram)}),r(i,z)};v(ze,i=>{(d()===y.schema||t.subpath==="workflows")&&i(je)})}var xe=o(ze,2),ue=a(xe);ue.__click=()=>s(b,h.attachments,!0);var E=a(ue),j=a(E);Na(j,{size:"md"});var W=o(j,2),$=a(W),G=o(xe,2);{var Q=i=>{var z=Uo(),q=a(z);q.__click=()=>s(b,h.roles_explorer,!0);var He=a(q),Ze=a(He);Rr(Ze,{size:"md"}),U(()=>{Xe(q,1,`inline-flex items-center p-4 border-b-2 rounded-t-lg ${e(b)===h.roles_explorer?"text-blue-600 border-blue-600":"border-transparent hover:text-gray-600 hover:border-gray-300"}`),Pe(q,"aria-selected",e(b)===h.roles_explorer)}),r(i,z)};v(G,i=>{d()===y.user&&i(Q)})}var Te=o(G,2);{var qe=i=>{var z=Io(),q=a(z);q.__click=()=>s(b,h.permissions_explorer,!0);var He=a(q),Ze=a(He);Rr(Ze,{size:"md"}),U(()=>{Xe(q,1,`inline-flex items-center p-4 border-b-2 rounded-t-lg ${e(b)===h.permissions_explorer?"text-blue-600 border-blue-600":"border-transparent hover:text-gray-600 hover:border-gray-300"}`),Pe(q,"aria-selected",e(b)===h.permissions_explorer)}),r(i,z)};v(Te,i=>{d()===y.role&&i(qe)})}var Me=o(Te,2),pe=a(Me);pe.__click=()=>s(b,h.history,!0);var he=a(pe),ce=a(he);Ba(ce,{size:"md"});var Be=o(Me,2);{var Se=i=>{var z=Vo(),q=a(z);q.__click=Ve;var He=a(q),Ze=a(He);Ha(Ze,{size:"md",class:"text-primary"}),U(()=>{q.disabled=e(X)||!e(Z),Xt(q,e(X)||!e(Z)?"cursor: not-allowed":"cursor: pointer")}),r(i,z)};v(Be,i=>{Ae&&i(Se)})}var Je=o(Be,2);{var Ge=i=>{var z=Bo(),q=p(z),He=a(q);He.__click=J;var Ze=a(He),xt=a(Ze);Kr(xt,{size:"md",class:"text-red-500"});var de=o(q,2);{var Le=we=>{var Ct=No(),Mt=a(Ct);Mt.__click=Y;var Wt=a(Mt),zt=a(Wt);Ka(zt,{size:"md",class:"text-red-500"}),U(()=>{Mt.disabled=e(X),Xt(Mt,e(X)?"cursor: not-allowed":"cursor: pointer")}),r(we,Ct)};v(de,we=>{[y.space,y.folder].includes(d())||we(Le)})}U(()=>{He.disabled=e(X),Xt(He,e(X)?"cursor: not-allowed":"cursor: pointer")}),r(i,z)};v(Je,i=>{Ie&&!Fe&&w().length===0&&i(Ge)})}var Oe=o(Je,2),nt=a(Oe);nt.__click=T,nt.disabled=k,Xt(nt,"cursor: pointer");var dt=a(nt),_t=a(dt);Wa(_t,{size:"md",class:"text-primary"});var Re=o(O,2),lt=a(Re),Pt=a(lt);{var Vt=i=>{{let z=Qe(()=>{var de,Le,we;return((we=(Le=(de=F())==null?void 0:de.payload)==null?void 0:Le.body)==null?void 0:we.index_attributes)??null}),q=Qe(()=>{var de,Le,we;return((we=(Le=(de=F())==null?void 0:de.payload)==null?void 0:Le.body)==null?void 0:we.sort_by)??null}),He=Qe(()=>{var de,Le,we;return((we=(Le=(de=F())==null?void 0:de.payload)==null?void 0:Le.body)==null?void 0:we.sort_type)??null}),Ze=Qe(()=>{var de,Le,we;return((we=(Le=(de=F())==null?void 0:de.payload)==null?void 0:Le.body)==null?void 0:we.query)??null}),xt=Qe(()=>zo(t.space_name,t.subpath));wa(i,{get space_name(){return t.space_name},get subpath(){return t.subpath},get folderColumns(){return e(z)},get sort_by(){return e(q)},get sort_order(){return e(He)},get query(){return e(Ze)},get canDelete(){return Ie},get exact_subpath(){return e(xt)}})}},ar=i=>{{let z=Qe(()=>({"Resource type":d(),...F()}));Da(i,{get entry(){return e(z)}})}};v(Pt,i=>{[y.folder,y.space].includes(d())?i(Vt):i(ar,!1)})}var Ft=o(lt,2),$t=a(Ft);{var Nt=i=>{hr(i,{get mode(){return yr.text},get content(){return e(c)},set content(z){s(c,z,!0)}})};v($t,i=>{(e(c).text||e(c).json)&&i(Nt)})}var Bt=o($t,2);{var Zr=i=>{var z=Wo(),q=a(z);Kt(q,{get code(){return e(fe)}}),r(i,z)};v(Bt,i=>{e(fe)&&i(Zr)})}var sr=o(Ft,2),Xr=a(sr);fr(Xr,()=>e(g),i=>{var z=Go(),q=p(z);{var He=de=>{var Le=Ho(),we=p(Le);Br(we,{isCreate:!1,get formData(){return e(c).json},set formData(pt){e(c).json=pt},get validateFn(){return Ce},set validateFn(pt){Ce=pt}});var Ct=o(we,2);{var Mt=pt=>{ja(pt,{get formData(){return e(c).json},set formData(wt){e(c).json=wt},get validateFn(){return K},set validateFn(wt){K=wt}})},Wt=pt=>{var wt=I(),Jt=p(wt);{var qt=ut=>{Fa(ut,{get formData(){return e(c).json},set formData(Lt){e(c).json=Lt},get validateFn(){return K},set validateFn(Lt){K=Lt}})},nr=ut=>{var Lt=I(),la=p(Lt);{var ia=Ut=>{Vr(Ut,{readOnly:!1,get formData(){return e(c).json},set formData(It){e(c).json=It},get validateFn(){return K},set validateFn(It){K=It}})},da=Ut=>{var It=I(),ua=p(It);{var ca=lr=>{ko(lr,{get space_name(){return t.space_name},get subpath(){return t.subpath},get shortname(){return F().shortname},get meta(){return e(c).json},get formData(){return e(re)},set formData(va){s(re,va,!0)}})};v(ua,lr=>{d()===y.ticket&&lr(ca)},!0)}r(Ut,It)};v(la,Ut=>{d()===y.permission?Ut(ia):Ut(da,!1)},!0)}r(ut,Lt)};v(Jt,ut=>{d()===y.role?ut(qt):ut(nr,!1)},!0)}r(pt,wt)};v(Ct,pt=>{d()===y.user?pt(Mt):pt(Wt,!1)})}var zt=o(Ct,2);{var na=pt=>{Zt(pt,{class:"p-4 max-w-4xl mx-auto my-2",children:(wt,Jt)=>{var qt=Jo(),nr=o(p(qt),2);Pa(nr,{isCreate:!1,get selectedSchema(){return B},get selectedResourceType(){return d()},set selectedResourceType(ut){d(ut)},get selectedWorkflow(){return e(c).json.workflow_shortname},set selectedWorkflow(ut){e(c).json.workflow_shortname=ut},get selectedInputMode(){return e(D)},set selectedInputMode(ut){s(D,ut,!0)},get contentType(){return e(c).json.payload.content_type},set contentType(ut){e(c).json.payload.content_type=ut},get content(){return e(c).json.payload.body},set content(ut){e(c).json.payload.body=ut}}),r(wt,qt)},$$slots:{default:!0}})};v(zt,pt=>{var wt,Jt,qt;(qt=(Jt=(wt=e(c))==null?void 0:wt.json)==null?void 0:Jt.payload)!=null&&qt.body&&pt(na)})}r(de,Le)};v(q,de=>{e(c).json&&de(He)})}var Ze=o(q,2);{var xt=de=>{var Le=Ko(),we=a(Le);Kt(we,{get code(){return e(fe)}}),r(de,Le)};v(Ze,de=>{e(fe)&&de(xt)})}r(i,z)});var br=o(sr,2);{var ea=i=>{var z=Qo(),q=a(z);{var He=de=>{Mo(de,{get shortname(){return F().shortname},get properties(){return F().payload.body.properties}})};v(q,de=>{d()===y.schema&&de(He)})}var Ze=o(q,2);{var xt=de=>{{let Le=Qe(()=>{var we,Ct;return(Ct=(we=F())==null?void 0:we.payload)==null?void 0:Ct.body});Fo(de,{get shortname(){return F().shortname},get workflowContent(){return e(Le)}})}};v(Ze,de=>{t.subpath==="workflows"&&de(xt)})}U(()=>Xe(z,1,Tt(e(b)===h.diagram?"":"hidden"))),r(i,z)};v(br,i=>{(d()===y.schema||t.subpath==="workflows")&&i(ea)})}var or=o(br,2),ta=a(or);{let i=Qe(()=>ht(F()).attachments);Xs(ta,{get resource_type(){return d()},get space_name(){return t.space_name},get subpath(){return t.subpath},get parent_shortname(){return F().shortname},get attachments(){return e(i)},refreshEntry:u})}var xr=o(or,2);{var ra=i=>{var z=Yo(),q=a(z);Eo(q,{get roles(){return e(c).json.roles}}),U(()=>Xe(z,1,Tt(e(b)===h.roles_explorer?"":"hidden"))),r(i,z)};v(xr,i=>{e(b)===h.roles_explorer&&i(ra)})}var wr=o(xr,2);{var aa=i=>{var z=Zo(),q=a(z);Yr(q,{get permissions(){return e(c).json.permissions}}),U(()=>Xe(z,1,Tt(e(b)===h.permissions_explorer?"":"hidden"))),r(i,z)};v(wr,i=>{e(b)===h.permissions_explorer&&i(aa)})}var kr=o(wr,2),sa=a(kr);fr(sa,()=>e(g),i=>{uo(i,{get space_name(){return t.space_name},get subpath(){return t.subpath},get shortname(){return F().shortname}})});var jr=o(ee,2);Rt(jr,{size:"md",title:"Confirm Deletion",get open(){return e(oe)},set open(i){s(oe,i,!0)},children:(i,z)=>{var q=Xo(),He=p(q),Ze=o(a(He)),xt=a(Ze),de=o(Ze),Le=o(He,2),we=a(Le);bt(we,{color:"alternative",onclick:()=>s(oe,!1),children:(Mt,Wt)=>{var zt=be("Cancel");r(Mt,zt)},$$slots:{default:!0}});var Ct=o(we,2);bt(Ct,{color:"red",onclick:ke,get disabled(){return e(X)},children:(Mt,Wt)=>{var zt=be();U(()=>te(zt,e(X)?"Deleting...":"Delete")),r(Mt,zt)},$$slots:{default:!0}}),U(()=>{te(xt,F().shortname),te(de,` (${d()??""})?`)}),r(i,q)},$$slots:{default:!0}});var oa=o(jr,2);Rt(oa,{size:"md",title:"Unsaved Changes",get open(){return e(S)},set open(i){s(S,i,!0)},children:(i,z)=>{var q=en(),He=o(p(q),2),Ze=a(He);bt(Ze,{color:"alternative",onclick:De,children:(de,Le)=>{var we=be("Cancel");r(de,we)},$$slots:{default:!0}});var xt=o(Ze,2);bt(xt,{color:"red",onclick:me,children:(de,Le)=>{var we=be("Discard Changes");r(de,we)},$$slots:{default:!0}}),r(i,q)},$$slots:{default:!0}}),U(i=>{Xe(rt,1,`inline-flex items-center p-4 border-b-2 rounded-t-lg ${e(b)===h.list?"text-blue-600 border-blue-600":"border-transparent hover:text-gray-600 hover:border-gray-300"}`),Pe(rt,"aria-selected",e(b)===h.list),Xe(le,1,`inline-flex items-center p-4 border-b-2 rounded-t-lg ${e(b)===h.entry?"text-blue-600 border-blue-600":"border-transparent hover:text-gray-600 hover:border-gray-300"}`),Pe(le,"aria-selected",e(b)===h.entry),Xe(ae,1,`inline-flex items-center p-4 border-b-2 rounded-t-lg ${e(b)===h.form?"text-blue-600 border-blue-600":"border-transparent hover:text-gray-600 hover:border-gray-300"}`),Pe(ae,"aria-selected",e(b)===h.form),Xe(ue,1,`inline-flex items-center p-4 border-b-2 rounded-t-lg ${e(b)===h.attachments?"text-blue-600 border-blue-600":"border-transparent hover:text-gray-600 hover:border-gray-300"}`),Pe(ue,"aria-selected",e(b)===h.attachments),te($,`Attachments ${i??""}`),Xe(pe,1,`inline-flex items-center p-4 border-b-2 rounded-t-lg ${e(b)===h.history?"text-blue-600 border-blue-600":"border-transparent hover:text-gray-600 hover:border-gray-300"}`),Pe(pe,"aria-selected",e(b)===h.history),Xe(lt,1,Tt(e(b)===h.list?"":"hidden")),Xe(Ft,1,Tt(e(b)===h.entry?"":"hidden")),Xe(sr,1,Tt(e(b)===h.form?"":"hidden")),Xe(or,1,Tt(e(b)===h.attachments?"":"hidden")),Xe(kr,1,Tt(e(b)===h.history?"":"hidden"))},[()=>Object.values(F().attachments).flat(1).length?`(${Object.values(F().attachments).flat(1).length})`:""]),r(C,H),jt(),P()}Yt(["click"]);export{xn as E};
