import{D as n,Q as l,S as f,R as h}from"./@edraj-CS4NwVbD.js";import{s as y}from"./spaces-0oyGvpii.js";import{s as m,L as w}from"./toast-B9WDyfyI.js";async function q(e){const r={filter_shortnames:[],type:l.attachments,space_name:"personal",subpath:`people/${e}/protected/avatar`,limit:1,sort_by:"shortname",sort_type:f.ascending,offset:0,search:"@resource_type:media",retrieve_json_payload:!1},t=await n.query(r);return t.records.length===0?null:n.getAttachmentUrl({resource_type:h.media,space_name:"personal",subpath:`people/${e}/protected/`,parent_shortname:"avatar",shortname:t.records[0].attributes.payload.body,ext:""})}async function v(){const e=await n.query({type:l.spaces,space_name:"management",subpath:"/",search:"",limit:100});return e.records=e.records.map(r=>(r.attributes.ordinal===null&&(r.attributes.ordinal=9999),r)),e.records.sort((r,t)=>r.attributes.ordinal-t.attributes.ordinal),y.set(e.records),e}async function b(e,r,t=20,i=0,c=[],s=null,u=!1){const a=await n.query({type:l.search,space_name:e,subpath:r,filter_types:c,exact_subpath:!0,search:"",limit:t,offset:i});if(u==!1&&s!==null){const o=s.records.find(d=>d.shortname===e).attributes.hide_folders;o&&(a.records=a.records.filter(d=>o.includes(d.shortname)===!1))}return a.records=a.records.sort((p,o)=>p.shortname.toLowerCase()<o.shortname.toLowerCase()?-1:p.shortname.toLowerCase()>o.shortname.toLowerCase()?1:0),a}async function _(e,r,t,i){for(const c of i.records)if(c.resource_type==="folder"){const s=`${t}/${c.shortname}`,u=await b(r,s,100);await _(e,r,s,u),e.push(s)}}async function S(e){try{return(await n.query({search:"",type:l.search,space_name:e,subpath:"/workflows"})).records||[]}catch{m(w.warn,"Failed to fetch workflows")}}export{v as a,b,_ as c,S as f,q as g};
