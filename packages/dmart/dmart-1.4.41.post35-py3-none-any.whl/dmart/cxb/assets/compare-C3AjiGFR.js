import{p as Ke,L as xe,b as ye,a7 as Ne,B as S,h as be,F as r,E as i,j as J,k as l,c as d,a2 as Pe,aj as c,R as W,D as He,a8 as N,e as A,l as Je,H as We,a6 as Z}from"./svelte-B2XmcTi_.js";import{C as Ze,L as f,I as q,B as G,u as Ge,v as Qe,w as Xe,l as Q,M as Ye,g as je}from"./flowbite-svelte-BLvjb-sa.js";import{g as et,p as tt}from"./@roxi-CGMFK4i8.js";import{R as M,D as at,a as rt}from"./@edraj-CS4NwVbD.js";function $t(t){return t==null?{}:t.json?structuredClone(t.json):t.text?JSON.parse(t.text):t}var st=S('<span class="text-red-500 text-lg" style="vertical-align: center">*</span>'),lt=S("<!> Shortname",1),nt=S(`<p class="text-xs text-gray-500 mt-1">A shortname (use 'auto' for auto generated shortname)</p>`),ot=S('<div class="p-4 space-y-4"><div class="mb-4"><!> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><!> <!></div> <div><!> <!></div> <div><!> <!></div></div></div> <div class="mb-4"><!> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><!> <!></div> <div><!> <!></div> <div><!> <!></div></div></div></div>'),it=S('<span slot="header" class="font-medium">Translations</span>'),dt=S('<form class="space-y-4"><h2 class="text-2xl font-bold mb-4">Meta Information</h2> <div class="mb-4"><!> <div class="flex"><!> <!></div> <!></div> <div class="mb-4"><div class="flex items-center gap-2"><!> <!></div> <p class="text-xs text-gray-500 mt-1">Whether this item is currently active</p></div> <div class="mb-4"><!> <!> <p class="text-xs text-gray-500 mt-1">A URL-friendly version of the short name</p></div> <!></form>'),ut=S('<span slot="icon" class="text-red-500">!</span>'),ct=S('<div class="space-y-4"><p class="text-sm text-gray-500">Changing the shortname will move this resource to a new location. This may affect existing references to this item.</p> <!> <div><!> <!></div> <div class="flex justify-end gap-2 mt-4"><!> <!></div></div>'),vt=S("<!> <!>",1);function gt(t,n){var te,ae,re,se,le,ne;Ke(n,!0);const a=()=>xe(et,"$goto",Y),p=()=>xe(tt,"$params",Y),[Y,we]=We();a();let e=ye(n,"formData",15),Ae=ye(n,"validateFn",15);e({...e(),shortname:e().shortname||null,is_active:e().is_active,slug:e().slug||null,displayname:{en:((te=e().displayname)==null?void 0:te.en)||null,ar:((ae=e().displayname)==null?void 0:ae.ar)||null,ku:((re=e().displayname)==null?void 0:re.ku)||null},description:{en:((se=e().description)==null?void 0:se.en)||null,ar:((le=e().description)==null?void 0:le.ar)||null,ku:((ne=e().description)==null?void 0:ne.ku)||null}}),(e().is_active===void 0||e().is_active===null)&&e(e().is_active=!0,!0);let F;Ne(()=>{Ae(Se)});function Se(){const $=F.checkValidity();return $||F.reportValidity(),$}let I=N(!1),m=N(""),L=N(!1),B=N(null);function De(){A(m,e().shortname,!0),A(I,!0)}async function Ue(){var $,V,b;if(!(!d(m)||d(m)===e().shortname)){if(!d(m).match(/^[a-zA-Z0-9_]+$/)){A(B,"Shortname can only contain alphanumeric characters, underscores.");return}A(L,!0);try{const u=p().resource_type||p().subpath&&M.folder||M.space;let _=u===M.folder?p().subpath.split("-").slice(0,-1).join("/")||"/":p().subpath;u===M.space&&(_="/"),_=_.replaceAll("-","/");const O={src_space_name:p().space_name,src_subpath:_,src_shortname:e().shortname,dest_space_name:u===M.space?d(m):p().space_name,dest_subpath:_,dest_shortname:d(m)};await at.request({space_name:p().space_name,request_type:rt.move,records:[{resource_type:u,shortname:e().shortname,subpath:_,attributes:O}]});let P="/management/content",w={space_name:p().space_name};u===M.space?window.location.href=d(m):u===M.folder?(P+="/[space_name]/[subpath]",w={...w,subpath:`${_.replaceAll("-","/")}-${d(m)}`}):(P+="/[space_name]/[subpath]/[shortname]/[resource_type]",w={...w,subpath:_.replaceAll("-","/"),shortname:d(m),resource_type:u}),a()(`${P}`,w)}catch(u){A(B,((V=($=u.response.data.error)==null?void 0:$.info[0])==null?void 0:V.failed[0].error)||((b=u.response.data.error)==null?void 0:b.message)||"An error occurred while updating the shortname.",!0)}finally{A(L,!1)}}}var j=vt(),ee=be(j);Ze(ee,{class:"w-full max-w-4xl mx-auto p-4 my-2",children:($,V)=>{var b=dt(),u=r(i(b),2),_=i(u);f(_,{for:"shortname",class:"mb-2",children:(o,U)=>{var y=lt(),T=be(y);{var R=E=>{var K=st();l(E,K)};J(T,E=>{n.isCreate&&E(R)})}l(o,y)},$$slots:{default:!0}});var O=r(_,2),P=i(O);{let o=Pe(()=>!n.isCreate);q(P,{required:!0,id:"shortname",class:"rounded-l-none",placeholder:"Short name",get disabled(){return d(o)},get value(){return e().shortname},set value(U){e(e().shortname=U,!0)}})}var w=r(P,2);G(w,{color:"alternative",class:"rounded-l-none border-l-0",onclick:()=>n.isCreate?e(e().shortname="auto",!0):De(),children:(o,U)=>{var y=c();W(()=>Z(y,n.isCreate?"Auto":"Update")),l(o,y)},$$slots:{default:!0}});var H=r(O,2);{var k=o=>{var U=nt();l(o,U)};J(H,o=>{n.isCreate&&o(k)})}var z=r(u,2),h=i(z),g=i(h);Ge(g,{id:"is_active",get checked(){return e().is_active},set checked(o){e(e().is_active=o,!0)}});var D=r(g,2);f(D,{for:"is_active",class:"mb-0",children:(o,U)=>{var y=c("Active");l(o,y)},$$slots:{default:!0}});var x=r(z,2),oe=i(x);f(oe,{for:"slug",class:"mb-2",children:(o,U)=>{var y=c("Slug");l(o,y)},$$slots:{default:!0}});var Oe=r(oe,2);q(Oe,{id:"slug",placeholder:"url-friendly-name",get value(){return e().slug},set value(o){e(e().slug=o,!0)}});var Te=r(x,2);Qe(Te,{children:(o,U)=>{Xe(o,{header:T=>{var R=c("Displayname and Description Translations");l(T,R)},children:(T,R)=>{var E=ot(),K=i(E),ie=i(K);f(ie,{class:"mb-2",children:(s,C)=>{var v=c("Display name");l(s,v)},$$slots:{default:!0}});var Ce=r(ie,2),de=i(Ce),ue=i(de);f(ue,{class:"text-sm",children:(s,C)=>{var v=c("English");l(s,v)},$$slots:{default:!0}});var Me=r(ue,2);q(Me,{get value(){return e().displayname.en},set value(s){e(e().displayname.en=s,!0)}});var ce=r(de,2),ve=i(ce);f(ve,{class:"text-sm",children:(s,C)=>{var v=c("Arabic");l(s,v)},$$slots:{default:!0}});var qe=r(ve,2);q(qe,{get value(){return e().displayname.ar},set value(s){e(e().displayname.ar=s,!0)}});var Re=r(ce,2),pe=i(Re);f(pe,{class:"text-sm",children:(s,C)=>{var v=c("Kurdish");l(s,v)},$$slots:{default:!0}});var Fe=r(pe,2);q(Fe,{get value(){return e().displayname.ku},set value(s){e(e().displayname.ku=s,!0)}});var Ie=r(K,2),me=i(Ie);f(me,{class:"mb-2",children:(s,C)=>{var v=c("Description");l(s,v)},$$slots:{default:!0}});var Le=r(me,2),_e=i(Le),he=i(_e);f(he,{class:"text-sm",children:(s,C)=>{var v=c("English");l(s,v)},$$slots:{default:!0}});var Be=r(he,2);Q(Be,{rows:3,get value(){return e().description.en},set value(s){e(e().description.en=s,!0)}});var fe=r(_e,2),$e=i(fe);f($e,{class:"text-sm",children:(s,C)=>{var v=c("Arabic");l(s,v)},$$slots:{default:!0}});var Ve=r($e,2);Q(Ve,{rows:3,get value(){return e().description.ar},set value(s){e(e().description.ar=s,!0)}});var ke=r(fe,2),ge=i(ke);f(ge,{class:"text-sm",children:(s,C)=>{var v=c("Kurdish");l(s,v)},$$slots:{default:!0}});var ze=r(ge,2);Q(ze,{rows:3,get value(){return e().description.ku},set value(s){e(e().description.ku=s,!0)}}),l(T,E)},$$slots:{header:!0,default:!0,header:(T,R)=>{var E=it();l(T,E)}}})},$$slots:{default:!0}}),He(b,o=>F=o,()=>F),l($,b)},$$slots:{default:!0}});var Ee=r(ee,2);Ye(Ee,{size:"md",title:"Update Shortname",get open(){return d(I)},set open($){A(I,$,!0)},children:($,V)=>{var b=ct(),u=r(i(b),2);{var _=h=>{je(h,{color:"red",class:"mb-4",children:(g,D)=>{var x=c();W(()=>Z(x,d(B))),l(g,x)},$$slots:{default:!0,icon:(g,D)=>{var x=ut();l(g,x)}}})};J(u,h=>{d(B)&&h(_)})}var O=r(u,2),P=i(O);f(P,{for:"new-shortname",children:(h,g)=>{var D=c("New Shortname");l(h,D)},$$slots:{default:!0}});var w=r(P,2);q(w,{id:"new-shortname",get placeholder(){return e().shortname},get value(){return d(m)},set value(h){A(m,h,!0)}});var H=r(O,2),k=i(H);G(k,{color:"alternative",onclick:()=>A(I,!1),children:(h,g)=>{var D=c("Cancel");l(h,D)},$$slots:{default:!0}});var z=r(k,2);{let h=Pe(()=>!d(m)||d(m)===e().shortname||d(L));G(z,{class:"bg-primary",get disabled(){return d(h)},onclick:Ue,children:(g,D)=>{var x=c();W(()=>Z(x,d(L)?"Updating...":"Update Shortname")),l(g,x)},$$slots:{default:!0}})}l($,b)},$$slots:{default:!0}}),l(t,j),Je(),we()}function pt(t,n){if(t===n)return!0;if(typeof t=="object"&&t!=null&&typeof n=="object"&&n!=null){if(Object.keys(t).length!=Object.keys(n).length)return!1;for(var a in t)if(n.hasOwnProperty(a)){if(!pt(t[a],n[a]))return!1}else return!1;return!0}else return!1}const X=t=>{if(Array.isArray(t))return t.map(a=>typeof a=="object"&&a!==null?X(a):a);let n={};return Object.keys(t).forEach(a=>{Array.isArray(t[a])?n[a]=t[a].map(p=>typeof p=="object"&&p!==null?X(p):p):t[a]===Object(t[a])&&t[a]!==null?n[a]=X(t[a]):(t[a]!==void 0&&t[a]!==null&&typeof t[a]=="string"&&t[a].trim().length!=0||t[a]!==void 0&&t[a]!==null&&typeof t[a]!="string")&&(n[a]=t[a])}),n};export{gt as M,pt as i,$t as j,X as r};
