import{w as f}from"./svelte-B9Ye91X-.js";import{D as u}from"./@edraj-D-9hi9vU.js";import{g as d}from"./svelte-i18n-CZ4cFDVx.js";const S=f(typeof localStorage<"u"&&localStorage.getItem("authToken")||"");var s=(e=>(e.ar="ar",e.en="en",e))(s||{});const a="user",p="ar";function y(){const e=d();return e&&e in s?s[e]:p}let t={signedin:!1,locale:y()},n;const I=typeof localStorage<"u"&&localStorage.getItem(a)||JSON.stringify(t);n=f(JSON.parse(I)||t);async function J(e,m){var l,i;const r=await u.login(e,m);if(r.status=="success"&&r.records.length>0){const o=r.records[0],c=o.attributes.access_token;S.set(c),typeof localStorage<"u"&&localStorage.setItem("authToken",c);const g={signedin:!0,locale:"ar",shortname:o.shortname,localized_displayname:(i=(l=o.attributes)==null?void 0:l.displayname)==null?void 0:i.en,account:o};n.set(g),typeof localStorage<"u"&&(localStorage.setItem(a,JSON.stringify(g)),localStorage.setItem("rowPerPage","15"))}else n.set(t),typeof localStorage<"u"&&localStorage.setItem(a,JSON.stringify(t))}async function O(){var e;typeof localStorage<"u"&&((e=JSON.parse(localStorage.getItem(a)))!=null&&e.signedin)&&(localStorage.removeItem("rowPerPage"),n.set(t),localStorage.removeItem(a),await u.logout())}export{J as a,O as s,n as u};
