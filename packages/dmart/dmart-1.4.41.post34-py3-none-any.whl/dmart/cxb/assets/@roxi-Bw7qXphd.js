const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/scroll-into-view-if-needed-KR58zyjF.js","assets/compute-scroll-into-view-Bl8rNFhg.js"])))=>i.map(i=>d[i]);
var xt=Object.defineProperty;var Ct=(r,e,t)=>e in r?xt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var h=(r,e,t)=>Ct(r,typeof e!="symbol"?e+"":e,t);import{g as _t,w as M,s as St,a as S,d as de,p as te,b as R,m as O,c,e as L,i as re,f as D,h as U,j as Z,k as A,l as se,n as pe,o as Ne,q as ee,r as W,t as N,u as Re,v as Et,x as Ye,y as oe,z as He,A as Pt,B as ne,C as Ce,D as _e,E as At,F as me,G as Pe,H as Ue,I as It,J as Nt,K as Ut,L as he,M as Y,N as Ft,O as kt,P as Se}from"./svelte-B9Ye91X-.js";import{c as X,a as Lt,b as Dt}from"./hookar-BMRD9G9H.js";import{c as Ot}from"./consolite-DlCuI0F9.js";var ge={};const ae=Ot("[rf3]");ae.register("verbose",console.log);ae.levels.verbose=5;const Tt=()=>(Object.assign(ae,Bt()),new Proxy(ae,{get:(r,e)=>r[e.toString()],set:(r,e,t)=>(r[e.toString()]=t,Ht(ae),!0)})),Bt=()=>{if(typeof window>"u"){const r=ge.DEBUG_LEVEL,e=ge.DEBUG_FILTER;return{level:r,filter:e}}else return JSON.parse(localStorage.getItem("__routify.logState")||"{}")},Ht=r=>{const{level:e,filter:t}=r;typeof window>"u"?(ge.DEBUG_LEVEL=e,ge.DEBUG_FILTER=t):localStorage.setItem("__routify.logState",JSON.stringify({filter:t,level:e}))},Me=(r,e)=>((...t)=>{const s=r(...t);return ae.debug(e,{params:t,result:s}),s}),je=r=>({toRouter:(t,s)=>{const n=s.name?`${s.name}/(.+?)`:"(.+?)",a=new RegExp(`(^|;)${n}(;|$)`),o=t.match(a);return o?o[2]:"/"},toBrowser:t=>t.filter(s=>s.url.external()!==""||!s.name).map(s=>(s.name?`${s.name}`:"")+s.url.external()).join(";")});class Mt{constructor(){h(this,"instances",[]);h(this,"routeMaps",{});h(this,"browserAdapter",je());h(this,"urlFromBrowser",e=>Me?Me(this.browserAdapter.toRouter,"calling browserAdapter.toRouter")(ve(),e):this.browserAdapter.toRouter(ve(),e));globalThis.__routify=this,this.log=Tt()}get routers(){return[].concat(...this.instances.map(e=>e.routers))}reset(){this.instances=[],this.routeMaps={},this.browserAdapter=je()}register(e){return this.instances.push(e),this}}const ie=new Mt,Ze="routify-fragment-context",ye=r=>{try{return _t(Ze)}catch(e){if(e.message.includes("lifecycle_outside_component")||e.message.includes("Function called outside component initialization")){if(globalThis._routify_suppress_life_cycle_warning||r)return;console.error(`Routify: Unable to access context.
If you're using Svelte 5, ensure $ helpers are accessed at the root level of your component.`)}else throw e}},jt=()=>ye(!0),et=r=>St(Ze,r),qt=r=>r.ctrlKey||r.metaKey||r.altKey||r.shiftKey||r.button||r.key&&r.key!=="Enter"||r.defaultPrevented,Wt=r=>{try{return JSON.parse(r)}catch{return r}},Vt=r=>{const e={};for(let t in r.dataset)if(t.startsWith("routifyRouteState")){const s=t.replace("routifyRouteState",""),n=s.charAt(0).toLowerCase()+s.slice(1);e[n]=Wt(r.dataset[t])}return e},qe=r=>{const e=r.target.closest("a"),t=e&&e.href;if(!t||e.target||e.host!==location.host)return{};const s=new URL(t);return r.preventDefault(),{url:s.pathname+s.search+s.hash,state:Vt(e)}},Jt=r=>[...r].reduce((e,[t,s])=>(e[t]=s,e),{}),tt=(r,e,t)=>{const s={};Object.entries(e).forEach(([a,o],i)=>{const d=new RegExp(`\\[(...)?${a}\\]|\\:${a}`);if(r.match(d)){const f=Array.isArray(o)?o.join("/"):o;r=r.replace(d,encodeURI(f))}else s[a]=o});const n=t(s);return{path:r,query:n}},ve=()=>(({pathname:r,search:e,hash:t})=>r+e+t)(window.location),We=()=>{globalThis._routify_suppress_helper_warning||console.log("Using helpers outside router context is not supported. Use at own risk.");const r=ie.routers[0],e=r.activeRoute.get()||r.pendingRoute.get();return{elem:null,anchorLocation:null,options:null,childFragments:M(e.allFragments),node:r.rootNode,fragment:e.allFragments[0],isActive:M(!1),isVisible:M(!1),inline:null,router:r,route:e,parentContext:null,onDestroy:null,decorators:[],scrollLock:null,isInline:null,mounted:null}},we={get router(){return(ye()||We()).router},get fragment(){return ye()||We()}},Ve=(r,e)=>{const t=M(r,e);return Object.assign(t,{get:()=>S(t)})},zt=(...r)=>r.map(e=>JSON.stringify([e==null?void 0:e.allFragments,e==null?void 0:e.url])).reduce((e,t)=>e===t&&t),rt=r=>typeof r=="function"&&!r.prototype,st=(r,e)=>rt(r)?r(...e):r,Kt=(r,e)=>{const t=rt(e);e=t||Array.isArray(e)?e:[e];const s=t?e([...r]):[...r,...e];if(!Array.isArray(s))throw new Error("anonymous callback did not return array");return s},nt=(r,e)=>new Promise((t,s)=>{try{const n=r.subscribe(a=>{e(a)&&(t(a),setTimeout(()=>n))})}catch(n){s(n)}}),ot=()=>{let r,e;const t=new Promise((s,n)=>{r=s,e=n});return Object.assign(t,{resolve:r,reject:e})},Gt=r=>"/"+r.replace(/^\/+/,""),Qt=(r,e)=>{console.warn("Failed to rebuild routes",{context:r,childContexts:e});const t="Infinite loop detected while trying to compose components. This is likely an error in Routify.";throw new Error(t)},at=(r,e)=>{const t=[r,...r.ancestors],s=[e,...e.ancestors],n=t.find(f=>s.includes(f)),a=t.indexOf(n),o=s.indexOf(n),i=t.slice(0,a).reverse(),d=s.slice(0,o).reverse();return{mrca:n,index1:a,index2:o,lineage1:t,lineage2:s,descendants1:i,descendants2:d}},$t=(r,e)=>{const{index1:t,index2:s,lineage2:n}=at(r,e),a=t,o=a?"../".repeat(a):"",i=s,d=n.slice(0,i).reverse().map(f=>f.name).join("/");return o+d},Xt={subscribe:(r,e)=>{const{router:t}=we;return de(Yt,s=>(n,a,o)=>{o={...{mode:"push",state:{}},...o};const d=s(n,a,o);return t.url[o.mode](d,o.state),""}).subscribe(r,e)}},Yt={subscribe:(r,e)=>{const{fragment:t,router:s}=we;return de(t.params,n=>(a,o,i)=>{const d=it(s,t.fragment);if(!(globalThis.HTMLElement&&a instanceof HTMLElement))return d(a,o,i);const f=a.getAttribute("href");a.setAttribute("href",d(f,n,i))}).subscribe(r,e)}},it=(r,e)=>(t,s={},n={})=>{let a=typeof t=="string"?t:t===null?"$leaf":t==null?void 0:t.path;e=e||r.activeRoute.get().leaf;const o=e.route;n.strict=n.strict??!0;const i=r.rootNode.traverse(e.node.path);r.rootNode.path!=="/"&&a.startsWith(r.rootNode.path)&&(a=a.substring(r.rootNode.path.length));const d=o==null?void 0:o.leaf.node.path,f=a.replace("$leaf",d||e.node.path),u=((f.startsWith("/")?r.rootNode.path:"")+f).replace(/^\/+/,"/"),m=!u.startsWith("/")&&!u.startsWith(".");let p,w={};if(m)p=i.root.instance.nodeIndex.find(I=>I.meta.name===P);else{const I=i.getChainTo(u,{...n,allowDynamic:!n.strict});w=Object.assign({},...I.map(T=>T.params)||[]),p=I.pop().node}if(!p){console.error("could not find destination node",f);return}const E=at(p,r.rootNode).mrca,P=("/"+$t(E,p)).replace(/\/index$/,"/"),g={...w,...Zt(p,o||r.activeRoute.get()),...s},v=g["#"];delete g["#"];const x=tt(P,g,I=>r.queryHandler.stringify(I,o)),F=r.getExternalUrl(x.path+x.query).replace(/\/$/,"")||"/";return v?F+"#"+v:F},Zt=(r,e)=>{const t=e.allFragments.map(s=>s.node.getChainToNode(r)&&s.params);return Object.assign({},...t)},er={subscribe:(r,e)=>we.router.params.subscribe(r,e)},tr=r=>Object.fromEntries(Object.entries(r).filter(([,e])=>e!==void 0)),rr=de(Xt,r=>e=>r("$leaf",tr(e)));de([rr,er],([r,e])=>t=>r(t({...e})));const ms={subscribe:r=>we.router.activeRoute.subscribe(r)},sr=r=>r instanceof Array?r.map(decodeURI):decodeURI(r),lt=r=>Object.entries(r).reduce((e,[t,s])=>({...e,[t]:sr(s)}),{});class nr{constructor(){this.map=new Map}async fetch(e,t){return this.map.has(e)||this.map.set(e,t.hydrate()),this._handlePromise(e,t),this.map.get(e)}async _handlePromise(e,t){var a;const s=await this.map.get(e),n=(a=t.clear)==null?void 0:a.call(t,s);typeof n=="number"?setTimeout(()=>this.map.delete(e),n):n&&this.map.delete(e)}}class Ae{constructor(e,t,s="",n={}){this.route=e,this.node=t,this.load=void 0,this.urlFragment=s,this.params=n,this.renderContext=ot(),Object.defineProperty(this,"route",{enumerable:!1}),this.params=lt({...this.node.meta.isDefault,...n})}}const or=["pushState","replaceState","popState"],ar=new nr;let ir=0;class lr{constructor(e,t,s,n={}){h(this,"allFragments",[]);h(this,"fragments",[]);h(this,"load",{status:200,error:null,maxage:null,props:{},redirect:null});h(this,"prevRoute");h(this,"nextRoute");if(this.sourceUrl=typeof t=="string"?new URL(t,"http://localhost"):t,this.router=e,this.mode=s,this.state=n,this.state.createdAt=new Date,this.state.id=this.state.id??Date.now()+"-"+ir++,!e.rootNode){const a=new Error("Can't navigate without a rootNode. Have you imported routes?");throw Object.assign(a,{routify:{router:e}}),a}if(!or.includes(s))throw new Error("url.mode must be pushState, replaceState or popState");this.allFragments=this._createFragments(this.sourceUrl.pathname),this.params={...this.queryParams,...this.fragmentParams},this.fragments=this.router.transformFragments.run(this.allFragments),this.url=this._createUrl(),this.rendered=Promise.all(this.fragments.map(a=>a.renderContext)),this.log=e.log.createChild("[route]"),this.log.debug("created",this)}get fragmentParams(){return this.allFragments.reduce((e,t)=>({...e,...t.params}),{})}get queryParams(){return this.router.queryHandler.parse(this.sourceUrl.search,this)}get leaf(){return[...this.fragments].pop()}get isPendingOrPrefetch(){return this===this.router.pendingRoute.get()||this.state.prefetch}get isActive(){return this.router.activeRoute.get()===this}async loadRoute(){const e=[this.runBeforeUrlChangeHooks,this.loadComponents,this.runPreloads];for(const t of e){const s=await t.bind(this)();if(!this.isPendingOrPrefetch||!s)return!1}return this.log.debug("loaded route",this),!0}async loadComponents(){this.log.debug("load components",this);const e=this.fragments.map(s=>s.node),t=e.map(s=>s.children.find(n=>n.meta.isDecorator||n.meta.isInlineWrapper)).filter(Boolean);return await Promise.all([...e,...t].map(s=>s.loadModule())),!0}async runPreloads(){var t;this.log.debug("run preloads",this);const e=this.router.activeRoute.get();for(const[s,n]of this.fragments.entries()){if(!this.isPendingOrPrefetch)return!1;const a=e==null?void 0:e.fragments[s],o=n.node===(a==null?void 0:a.node),i={route:this,url:it(this.router,n),prevRoute:e,isNew:!o,fetch,fragment:n};if((t=n.node.module)!=null&&t.load){const d=JSON.stringify([this.params,n.node.id]),f=await ar.fetch(d,{hydrate:()=>n.node.module.load(i),clear:l=>(l==null?void 0:l.expire)||!this.state.prefetch});if(n.load={...o&&a.load,...f},Object.assign(this.load,n.load),this.load.redirect&&!this.state.prefetch)return this.router.url.replace(this.load.redirect,{redirectedBy:this})}}return this}async runBeforeUrlChangeHooks(){return await this.router.beforeUrlChange.run({route:this})}get meta(){return this.fragments.reduce((e,t)=>({...e,...t.node.meta}),{})}createFragment(e,t="",s={}){return new Ae(this,e,t,s)}_createFragments(e){const t=this.router.rootNode;return this.router.rootNode.getChainTo(e,{rootNode:t,allowDynamic:!0,includeIndex:!0,navigableChildrenOnly:!0}).map(a=>this.createFragment(a.node,a.fragment,a.params))}_createUrl(){const e=o=>this.router.queryHandler.stringify(o,this),t=this.allFragments.map((o,i)=>i?o.node.name:"").join("/"),s=tt(t,this.params,e),a=this.router.options.trailingSlash==="always"||this.router.options.trailingSlash==="preserve"&&this.sourceUrl.pathname.endsWith("/")||this.router.options.trailingSlash==="contextual"&&[...this.allFragments].pop().node.name==="index"?"/":"";return s.path.replace(/\/index$/,"")+a+s.query+this.sourceUrl.hash}}class ct{constructor(e,t){this.router=e,this.log=this.router.log}install(){}uninstall(){}reflect(){}}const cr=(r,e,t)=>new Promise(s=>{let n;n=r.subscribe(a=>{n&&(typeof e>"u"||a===e||a==e||typeof e=="function"&&e(a))&&s(a)})}),Je=(r,e)=>JSON.stringify(S(r))!==JSON.stringify(e)&&r.set(e),ur=r=>JSON.parse(JSON.stringify(r)),hr=(r,e)=>{const t=new Map,s=(n,a)=>{const o=r();t.has(n)||t.set(n,new Map);const i=t.get(n);return i.has(o)||i.set(o,n.bind(e||a||void 0)()),i.get(o)};return s.storage=t,s},dr=r=>{const{subscribe:e,set:t,update:s}=M(r);return{subscribe:e,set:t,update:s,get:()=>S({subscribe:e})}};class fr{constructor(e,t,s){h(this,"parent");h(this,"meta",{});h(this,"id");this.instance=s,this.name=e||"",s.nodeIndex.push(this),this.module=t,this._cacheByName=hr(()=>this.name,this),Object.defineProperty(this,"_cacheByName",{enumerable:!1}),Object.defineProperty(this,"instance",{enumerable:!1}),Object.defineProperty(this,"parent",{enumerable:!1})}appendChild(e){e.instance&&(e.parent=this)}createChild(e,t){const s=this.instance.createNode(e,t);return this.appendChild(s),s}clone(){var t;const e=this.instance.createNode(this.name,this.module);return(t=this.parent)==null||t.appendChild(e),Object.assign(e,this),e.meta={...this.meta},e}deepClone(){const e=this.clone();return this.children.forEach(t=>e.appendChild(t.deepClone())),e}get descendants(){return this.instance.nodeIndex.filter(e=>e.ancestors.find(t=>t===this))}remove(){const{nodeIndex:e}=this.instance,t=e.findIndex(s=>s===this);e.splice(t,1)}get ancestors(){let e=this;const t=[];for(;e=e.parent;)t.push(e);return t}get root(){let e=this;for(;e.parent;)e=e.parent;return e}get isRoot(){return this===this.root}get children(){return this.instance.nodeIndex.filter(e=>e.parent===this).sort((e,t)=>(e.meta.order||0)-(t.meta.order||0))}get navigableChildren(){return this.children.filter(e=>!e.meta.noRoute)}get linkableChildren(){return this.navigableChildren.filter(e=>e.meta.order!=!1)}get level(){var e;return(((e=this.parent)==null?void 0:e.level)||0)+1}_getRegex(){return this.instance.utils.getRegexFromName(this.name)}get regex(){return this._cacheByName(this._getRegex)}_getParamKeys(){return this.instance.utils.getFieldsFromName(this.name)}get paramKeys(){return this._cacheByName(this._getParamKeys)}_getSpecificity(){return[this.name.replace(/\[.+?\]/g,"").length,this.paramKeys.length]}get specificity(){return this._cacheByName(this._getSpecificity)}getParams(e){if(e.match(/^\.+$/))return{};const t=this.instance.utils.getValuesFromPath(this.regex,e);return this.instance.utils.mapFieldsWithValues(this.paramKeys,t)}traverse(e,t){var n;return!e.startsWith("/")&&!e.startsWith(".")?this.root.instance.nodeIndex.find(a=>a.meta.name===e):(n=this.getChainTo(e,t))==null?void 0:n.pop().node}getChainTo(e,t){t={allowDynamic:!1,includeIndex:!1,navigableChildrenOnly:!1,silent:!1,...t};const s=t.navigableChildrenOnly?"navigableChildren":"children",n=e.startsWith("/")?t.rootNode||this.root:this,a=e.split("/").filter(l=>l!==".").filter(Boolean);let o={node:n,stepsToLeaf:a,params:{},fragment:""};const i=[o];let d=!1,f=!1;for(;o.stepsToLeaf.length;){const[l,...u]=o.stepsToLeaf,m=l===".."?o.node.parent:!d&&o.node[s].find(p=>p.name===l)||t.allowDynamic&&!f&&[...o.node[s]].sort((p,w)=>w.specificity[0]-p.specificity[0]||w.specificity[1]-p.specificity[1]).filter(({meta:p})=>p.dynamic&&!p.dynamicSpread).find(p=>p.regex.test(l))||t.allowDynamic&&o.node[s].find(p=>p.meta.dynamicSpread);if(m){const p={node:m,params:m.meta.dynamicSpread?[l]:m.meta.dynamic?m.getParams(l):{},stepsToLeaf:u,fragment:l};o=p,i.push(p)}else if(t.allowDynamic)if(o.node.meta.dynamicSpread)o.params.push(l),o.fragment+=`/${l}`,o.stepsToLeaf.shift(),f=!1,d=!1;else{if(i.pop(),o=[...i].pop(),f=d,d=!0,!o&&t.silent)return null;if(!o&&!t.silent)throw new Error(`Could not find path "${e}" from ${this.name}`)}else{if(!t.silent||t.silent==="report"){const p=i.map(E=>E.node.name||"root").join("/"),w=new Error(`${p} could not travel to ${l}`);if(w.name="404",t.silent==="report")console.error(w);else throw w}return null}}try{t.includeIndex&&o.node.getDefaults().forEach(l=>{const u={node:l,params:{},stepsToLeaf:[],fragment:""};i.push(u)})}catch{}return i.forEach(l=>{l.params=Array.isArray(l.params)?{[l.node.name.replace(/\[\.\.\.(.+)\]/,"$1")]:l.params}:l.params}),i}getChainToNode(e){const t=[];do if(t.unshift(e),e===this)return t;while(e=e.parent)}getDefaults(e="children"){const t=this[e].find(s=>s.meta.isDefault||s.name==="index");return t?[t,...t.getDefaults(e)]:[]}toJSON(){return{...this,children:[...this.children]}}get path(){return"/"+[this,...this.ancestors].reverse().map(e=>e.name).filter(Boolean).join("/")}}function mr(r,e){var l;te(e,!1);let t=R(e,"node",8),s=R(e,"passthrough",8);const n={...ye(),node:t()};et(n);let a=O((l=t().module)==null?void 0:l.default);!c(a)&&t().asyncModule&&t().asyncModule().then(u=>L(a,u.default)),re();var o=D(),i=U(o);{var d=u=>{var m=D(),p=U(m);pe(p,()=>c(a),(w,E)=>{E(w,Ne(s,{get context(){return n},children:(P,g)=>{var v=D(),y=U(v);ee(y,e,"default",{},null),A(P,v)},$$slots:{default:!0}}))}),A(u,m)},f=u=>{var m=D(),p=U(m);ee(p,e,"default",{},null),A(u,m)};Z(i,u=>{c(a)?u(d):u(f,!1)})}A(r,o),se()}function Fe(r,e){let t=R(e,"context",8,null),s=R(e,"Parent",8,null);t(),s();var n=D(),a=U(n);ee(a,e,"default",{},null),A(r,n)}const pr=Object.freeze(Object.defineProperty({__proto__:null,default:Fe},Symbol.toStringTag,{value:"Module"}));class ut extends fr{constructor(t,s,n,a){super(t,s,n);h(this,"asyncModule");h(this,"module");h(this,"importTree",t=>{const s=[[this,t]];for(;s.length;){const[n,a]=s.pop(),{children:o,...i}=a;Object.assign(n,i);for(const d of o){const f=n.createChild(a.name||a.rootName||"");s.push([f,d])}}return this});this.module=s,this.asyncModule=a,!s&&!a&&(this.meta.isNoop=!0)}get pages(){return console.log("DEPRECATED node.pages: use .linkableChildren instead"),this.pagesWithIndex.filter(t=>t.name!=="index")}get title(){const t=()=>this.name.replace(/-/g," ").replace(/\b\w/g,n=>n.toUpperCase());return this.meta.title||t()}get pagesWithIndex(){return console.log("DEPRECATED node.pagesWithIndex: use .linkableChildren instead"),this.children.filter(t=>!t.meta.fallback).filter(t=>!t.name.startsWith("_")).filter(t=>!t.name.includes("[")).filter(t=>{var s;return((s=t.meta)==null?void 0:s.order)!==!1})}get hasComponent(){return!!(this.module||this.asyncModule)}async getRawComponent(){const t=await this.loadModule();return t==null?void 0:t.default}async asyncLoadModule(){let t=[];return(this.meta.bundle||typeof window>"u")&&(t=this.children.map(s=>s.loadModule())),[this.module]=await Promise.all([this.asyncModule(),...t]),this.module}loadModule(){return!this.module&&!this.asyncModule&&(this.module=pr),this.module||this.asyncLoadModule()}get component(){const t=this;return function(s){return s.props={...s.props,passthrough:s.props,node:t},new mr({...s})}}get _fallback(){var t;return this.children.find(s=>s.meta.fallback)||((t=this.parent)==null?void 0:t._fallback)}}const gr=/\[(.+?)\]/gm;class yr{constructor(e=gr){h(this,"getFieldsFromName",e=>[...e.matchAll(this.RE)].map(t=>t[1]));h(this,"getRegexFromName",e=>new RegExp("^"+e.replace(this.RE,"(.+)")+"$"));h(this,"getValuesFromPath",(e,t)=>(t.match(e)||[]).slice(1));h(this,"mapFieldsWithValues",(e,t)=>this.haveEqualLength(e,t)&&e.reduce((s,n,a)=>(s[n]=t[a],s),{}));h(this,"haveEqualLength",(e,t)=>{if(e.length!==t.length)throw new Error(`fields and values should be of same length
fields: ${JSON.stringify(e)}
values: ${JSON.stringify(t)}`);return!0});this.RE=e}}class vr{constructor(){h(this,"NodeConstructor");h(this,"NodeType");h(this,"nodeIndex",[]);h(this,"rootNodes",{});h(this,"utils",new yr)}createNode(e,t){return new this.NodeConstructor(e,t,this)}}class Rr extends vr{constructor(t){super();h(this,"NodeConstructor",ut);h(this,"mode","runtime");h(this,"routers",[]);h(this,"rootNodes",{});this.options=t,t.routes&&(this.rootNodes[t.routes.rootName||"unnamed"]=this.createNode(t.routes.rootName).importTree(t.routes)),this.global=ie.register(this),Object.defineProperty(this,"routers",{enumerable:!1}),this.log=this.global.log}}let Ee=!1;const wr={interceptHistory:!0};class br extends ct{constructor(t,s){super(t);h(this,"_reflect",()=>{const{mode:t}=S(this.router.activeRoute),s=t!="popState"?this._getRouterUrl():null,n=this._createState(),a=t==="popState"?"replaceState":t;this.log.debug("pushing internal state to browser history",{mode:t,url:s,state:n,currentBrowserUrl:ve(),currentInternalUrl:this.router.url.internal()}),history[`${a}Native`](n,"",s)});const{instance:n,urlRewrites:a}=t,{urlFromBrowser:o,browserAdapter:i}=n.global;s={...wr,...s},history.onPushstate||(this.log.debug("polyfill history hooks"),xr());const d=f=>function(l,u,m){var E;if(!((l==null?void 0:l.useRoutify)??s.interceptHistory))return history[`${f}StateNative`](l,u,m);const w=((E=l==null?void 0:l.routify)==null?void 0:E.router)??!1;if(w===!1)m=i.toRouter(m,t);else if(w!==t.name)return!1;for(const P of a)m=P.toInternal(m,{router:t});t.url[f](m)};this.absorb=()=>{var l,u,m;const f=(m=(u=(l=history.state)==null?void 0:l.routify)==null?void 0:u.router)==null?void 0:m[t.name];t.url.replace(o(t),f||{})},this._pushstateHandler=d("push"),this._replacestateHandler=d("replace"),this._popstateHandler=f=>{var l,u;return t.url.pop(o(t),(u=(l=f.state)==null?void 0:l.routify)==null?void 0:u.router[t.name])}}install(){this.hooks=[history.onPushstate(this._pushstateHandler),history.onReplacestate(this._replacestateHandler),history.onPopstate(this._popstateHandler)],this.router.activeRoute.get()?this.reflect():this.absorb()}uninstall(){this.hooks.forEach(t=>t()),setTimeout(()=>this.reflect())}reflect(){Ee||(Ee=!0,setTimeout(()=>{Ee=!1,this._reflect()}))}_getRouterUrl(){const{routers:t,browserAdapter:s}=this.router.instance.global,n=i=>i.urlReflector instanceof this.constructor,a=t.filter(n);let o=s.toBrowser(a);return Gt(o)}_createState(){var n,a;const t={...(n=this.router.activeRoute.get())==null?void 0:n.state};t.redirectedBy=(a=t.redirectedBy)==null?void 0:a.url;const s={...history.state};return s.routify=s.routify||{router:{}},s.routify.router[this.router.name]=t,s}}function xr(){const r={onPushstate:X(),onReplacestate:X(),onPopstate:X()};Object.assign(history,r);const{pushState:e,replaceState:t}=history;return history.pushStateNative=e,history.replaceStateNative=t,history.pushState=r.onPushstate.run,history.replaceState=r.onReplacestate.run,window.addEventListener("popstate",r.onPopstate.run),!0}class Cr extends ct{install(){this.router.url.replace("/")}}const _r=r=>{const e=r.match(/^(.+?)(\+)?$/),[,t,s]=e;return{name:t,prepend:s}},Sr=(r,e)=>{const t=n=>r.indexOf(n),s={boolean(n,a){const o=t(a);return s.number(o,a)},number(n,a){const i=r.indexOf(a)-n;r.splice(i,n)},string(n,a){const o=t(a),i=r.slice(0,o+1);let d;const{name:f,prepend:l}=_r(n);for(;i.length;){d=i.pop();const u=d.node.children.find(m=>m.meta.moduleName===f);u&&(l||r.splice(0,t(a)),r.unshift(e.createFragment(u)),i.splice(0))}}};return s},Er=r=>e=>{const{reset:t}=e.node.meta;t&&r[typeof t](t,e)},Pr=()=>({transformFragments:r=>{const{route:e}=r[0],t=[...r],s=Sr(t,e);return r.forEach(Er(s)),t}}),Ar=()=>({urlRewrite:[{toExternal:r=>r.replace(/\/index(?=$|\?|#)/,""),toInternal:r=>r}]}),ht=r=>{const e=r.parentElement;return e?e.dataset.hasOwnProperty("routifyScrollLock")?e:ht(e):null};function Ir(r){let e=0,t=null;return new Promise(s=>{requestAnimationFrame(n);function n(){const{top:a,left:o}=r.getBoundingClientRect(),i=a+"/"+o;e++,i===t&&e>2?s():(t=i,requestAnimationFrame(n))}})}const Nr=(r,e,t)=>{r(),new ResizeObserver(()=>{});const s=new MutationObserver(n=>{n.some(o=>o.type==="childList"||o.type==="characterData")&&r()});return s.observe(document.body,{childList:!0,subtree:!0,characterData:!0}),setTimeout(()=>s.disconnect(),t),s},Ur=r=>{r.oldBehavior=r.oldBehavior||r.style.scrollBehavior},ze=r=>{r.oldBehavior?r.style.scrollBehavior=r.oldBehavior:r.style.removeProperty("scroll-behavior"),delete r.oldBehavior},Fr=r=>{const e=[];let t=r.parentElement;for(;t;)e.push(t),t=t.parentElement;return e};class kr{constructor(e){h(this,"elem");h(this,"ctx");h(this,"isInstant");h(this,"scrollTarget");this.ctx=e,this.route=e.route}async init(){var a,o,i;const{ctx:e}=this,{anchor:t,parent:s}=await nt(e.elem,Boolean);this.scrollTarget=t||s;const n=(a=e.route)==null?void 0:a.sourceUrl.hash.slice(1);this.hashElem=n&&((o=globalThis.document)==null?void 0:o.getElementById(n)),this.elem=this.hashElem||this.scrollTarget,this.isInstant=((i=e.route)==null?void 0:i.state.dontsmoothscroll)||!e.wasVisible,this.scrollLock=await this.getNearestScrollLock()}async getNearestScrollLock(){const e=await st(this.ctx.scrollLock,[this.ctx,this.scrollTarget,this]),t=Array.isArray(e)?[...e]:[e];let s=this.elem.parentElement;for(;s&&!t.includes(s);)s=s.parentElement;return s}async handleScrollInstructions(){return Nr(()=>this.ctx.inline.scrollIntoView(this.elem,this.isInstant,{boundary:this.scrollLock}),!0,300),Ir(this.elem)}}const Lr=(r,e,t)=>t.filter(s=>s.scrollLock===r.scrollLock).pop()===r,Dr=(r,e)=>{let t=r.parentElement;for(;t!=null&&t.scrollTo&&e!==t;){const s=t.style.scrollBehavior;t.style.scrollBehavior="auto",t.scrollTo(0,0),t.style.scrollBehavior=s,t=t.parentElement}};class Or{constructor(){h(this,"queue",[])}async push(e){const t=new kr(e);this.queue.push({scrollCtx:t,promise:t.init()})}async processQueue(e){console.debug("processing scroll queue",this.queue),this.queue=this.queue.filter(({scrollCtx:o})=>o.route===e),await Promise.all(this.queue.map(({promise:o})=>o));const t=this.queue.map(({scrollCtx:o})=>o).filter(o=>o.elem);await new Promise(o=>setTimeout(o,0));const s=o=>!o.ctx.isInline&&!o.hashElem,n=o=>o.ctx.isInline||o.hashElem,a=(o,i,d)=>o.ctx.inline.shouldScroll(o,i,d,Lr);this.processRegularQueue(t.filter(s)),this.processInlineAndHashQueue(t.filter(n).filter(a))}processRegularQueue(e){for(const t of e)console.debug("scroll to top",t.ctx.node.name,t),Dr(t.elem,t.scrollLock)}async processInlineAndHashQueue(e){const t=e.shift();for(const s of e)s.isInstant=!0,await s.handleScrollInstructions();t&&await t.handleScrollInstructions()}}const Ie=new Or,Tr=r=>{const e=[];for(;r;)e.push(r),r=r.parentContext;return e};function Br(r,e){te(e,!1);const t=O();let s=R(e,"context",8);R(e,"isRoot",8)();const a=l=>l.sourceUrl.hash&&l.leaf===s().fragment,o=()=>Tr(s()).every(l=>S(l.isActive)),i=()=>{var l;return((l=s().parentContext)==null?void 0:l.lastActiveChildContext)===s()||s().node.isRoot&&s().route.prevRoute};W(()=>(c(t),N(s())),()=>{(l=>{L(t,l.route)})(s())}),W(()=>(c(t),N(s()),Ie),()=>{if(c(t)&&!c(t).state.dontScroll&&(a(c(t))||o()&&!i())){const{debug:l}=s().router.log;l("scrollQueue.push",s().node.id||"unnamed",s()),Ie.push(s())}}),Re(),re();var d=D(),f=U(d);ee(f,e,"default",{},null),A(r,d),se()}const Hr=()=>({onMount:({context:r})=>{r.decorators.push(Br)},afterRouteRendered:r=>!r.route.state.dontScroll&&Ie.processQueue(r.route)}),dt=(r,e)=>{e=e||{name:"",beforeRouterInit:[],afterRouterInit:[],urlRewrite:[],beforeUrlChange:[],afterUrlChange:[],afterRouteRendered:[],transformFragments:[],onMount:[],onDestroy:[]};const{plugins:t,...s}=r;return[...t||[],s].forEach(a=>{var o;(o=a.plugins)==null||o.forEach(i=>dt(i,e)),delete a.plugins,Object.entries(a).forEach(([i,d])=>{Array.isArray(e[i])?e[i].push(...[d].flat().filter(Boolean)):e[i]=d||e[i]})}),e},Mr=r=>Object.fromEntries(Object.entries(r).filter(([e,t])=>t!=null)),jr=[Pr(),Hr(),Ar()];class ke{constructor(e){h(this,"pendingRoute",Ve(null));h(this,"activeRoute",Ve(null));h(this,"_urlReflector",null);h(this,"_claimed",!1);h(this,"urlRewrites",[]);h(this,"context");h(this,"beforeRouterInit",X());h(this,"afterRouterInit",X());h(this,"beforeUrlChange",Lt());h(this,"afterUrlChange",X());h(this,"afterRouteRendered",X());h(this,"transformFragments",Dt());h(this,"onMount",X());h(this,"onDestroy",X());h(this,"parentElem",null);h(this,"queryHandler",{parse:(e,t)=>lt(Jt(new URLSearchParams(e))),stringify:(e,t)=>{const s=new URLSearchParams(e).toString();return s?`?${s}`:""}});h(this,"clickHandler",{});h(this,"url",{internal:()=>this.url.getPending()||this.url.getActive(),external:()=>this.getExternalUrl(),getActive:()=>{var e;return(e=S(this.activeRoute))==null?void 0:e.url},getPending:()=>{var e;return(e=S(this.pendingRoute))==null?void 0:e.url},toString:()=>this.url.internal(),set:this._setUrl.bind(this),push:(e,t={})=>this._setUrl(e,"pushState",!1,t),replace:(e,t={})=>this._setUrl(e,"replaceState",!1,t),pop:(e,t={})=>this._setUrl(e,"popState",!1,t)});h(this,"ready",async()=>!this.pendingRoute.get()&&this.activeRoute.get()||cr(this.activeRoute,e=>!!e));h(this,"rendered",async()=>{await this.ready(),await this.activeRoute.get().rendered});h(this,"history",new Map);h(this,"setParentElem",e=>{this.parentElem=e});h(this,"getExternalUrl",e=>{const t=S(this.pendingRoute)||S(this.activeRoute);return e=e||(t==null?void 0:t.url),this.urlRewrites.reduce((n,a)=>a.toExternal(n,{router:this}),e).replace(/\/index$/,"")});h(this,"getInternalUrl",e=>this.urlRewrites.reduce((t,s)=>s.toInternal(t,{router:this}),e));h(this,"lastRoute");var n,a,o;if(this.parentCmpCtx=jt(),this.instance=e.instance||((o=(a=(n=this.parentCmpCtx)==null?void 0:n.route)==null?void 0:a.router)==null?void 0:o.instance)||ie.instances[0]||new Rr({}),this.log=this.instance.log.createChild(this.name||"[unnamed instance]"),this.log.debug("initiated router"),e.rootNode&&(this.log.warn("rootNode is deprecated. Use routes instead"),e.routes=e.rootNode),!e.routes)throw new Error("Router must be initiated with routes prop");const{subscribe:t,set:s}=M(this);this.subscribe=t,this.triggerStore=()=>s(this),this.init(e),this.params=de(this.activeRoute,i=>i.params),this.afterRouteRendered.next(()=>{this._urlReflector.reflect(),this.afterUrlChange(()=>this._urlReflector.reflect())}),this.onDestroy(()=>this._urlReflector.reflect()),this.activeRoute.get=()=>S(this.activeRoute),this.pendingRoute.get=()=>S(this.pendingRoute)}init(e){var k;const t=!this.options;e.plugins=[...jr,...e.plugins||[]].filter(Boolean),e=Mr(e),this.options=dt({...this.options,...e});let{instance:s,rootNode:n,name:a,routes:o,urlRewrite:i,urlReflector:d,url:f,passthrough:l,beforeUrlChange:u,afterUrlChange:m,afterRouteRendered:p,transformFragments:w,onMount:E,onDestroy:P,beforeRouterInit:g,afterRouterInit:v,queryHandler:y,clickHandler:x,anchor:F}=this.options;y&&(this.queryHandler=y),x&&(this.clickHandler=x),u.forEach(this.beforeUrlChange),w.forEach(this.transformFragments),m.forEach(this.afterUrlChange),p.forEach(this.afterRouteRendered),E.forEach(this.onMount),P.forEach(this.onDestroy),g.forEach(this.beforeRouterInit),v.forEach(this.afterRouterInit),this.anchor=F||"wrapper",this.beforeRouterInit.run({router:this,firstInit:t}),this.name=a??this.name,this.urlRewrites=i??this.urlRewrites,l&&!(l instanceof ke)&&(l=((k=this.parentCmpCtx)==null?void 0:k.route.router)||l),this.passthrough=l||this.passthrough,ie.instances.forEach(B=>{const b=B.routers.indexOf(this);b!==-1&&B.routers.splice(b,1)}),this.instance.routers.push(this),o&&!this.rootNode&&this.importRoutes(o),this.rootNode=n??this.rootNode??this.instance.rootNodes[this.name||"default"],this.url.getActive()&&(this.log.debug("router was created with activeUrl"),this._setUrl(this.url.getActive(),"pushState",!0));const I=Array.isArray(d)?d[0]:d;(!this.urlReflector||d&&!(this.urlReflector instanceof I))&&(d=d||(typeof window<"u"?br:Cr),this.setUrlReflector(d)),f&&this.url.replace(f),this.triggerStore(),this.afterRouterInit.run({router:this,firstInit:t})}importRoutes(e){this.rootNode=e instanceof ut?e:this.instance.createNode().importTree(e),this.instance.rootNodes[e.rootName||e.name||"unnamed"]=this.rootNode}async _setUrl(e,t,s,n={}){s||(e=this.getInternalUrl(e)),e=e||"/",n=n||{};const a=this.history.get(n.id);if(a!=null&&a.meta.history)return a.mode="popState",a.state.cached=!0,this.setActiveRoute(a,null),!0;this.log.debug("set url",{url:e,mode:t,prev:this.url.internal(),browserOld:globalThis.document&&ve(),state:n});const o=this.pendingRoute.get()||this.activeRoute.get();!this.rootNode&&this.instance.global.routeMaps[this.name]&&this.importRoutes(await this.instance.global.routeMaps[this.name]());const i=new lr(this,e,t,n),d=i.loadRoute();if(!n.prefetch){if(zt(o,i))return this.log.debug("current route is identical - skip",o,i),!1;{i.log.debug("set pending route",i),this.pendingRoute.set(i);const f=await d;return this.pendingRoute.get()===i&&this.pendingRoute.set(null),f&&this.setActiveRoute(i,a),await new Promise(l=>setTimeout(l)),!0}}}setActiveRoute(e,t){this.log.debug("set active route",this),this.history.set(e.state.id,e),this.history.size>100&&this.history.delete([...this.history.keys()][0]),this.lastRoute=this.activeRoute.get(),e.mode!=="popState"&&this.lastRoute?(this.lastRoute.nextRoute=e,e.prevRoute=this.lastRoute):t&&(e.nextRoute=t.nextRoute,e.prevRoute=t.prevRoute),this.activeRoute.set(e),this.afterUrlChange.run({route:e,history:[...this.history.values()].reverse()});const s=qr(e.fragments.map(n=>n.renderContext.then(a=>a.mounted)));if(typeof window<"u"){const n=setTimeout(()=>{var i;if(!e.isActive)return;const a=s.findIndex(d=>!d.isResolved),o=`Failed to render ${e.fragments[a].node.name} (${(i=e.fragments[a].node.file)==null?void 0:i.path}) within 5s. Ensure the parent component renders a <slot />`;console.warn(o)},5e3);Promise.all(s).then(()=>{clearTimeout(n),this.afterRouteRendered.run({route:e})})}this.log.debug("unset pending route",this)}destroy(){this.log.debug("destroying router"),this.instance.routers=this.instance.routers.filter(e=>e!==this),this.onDestroy.run({router:this})}get urlReflector(){return this._urlReflector}setUrlReflector(e){var n;const[t,s]=Array.isArray(e)?e:[e,{}];(n=this._urlReflector)==null||n.uninstall(),this._urlReflector=new t(this,s),this._urlReflector.install(),this.triggerStore()}goBack(){this.go(-1)}goForward(){this.go(1)}go(e){const t=e>0?"nextRoute":"prevRoute";let s=this.activeRoute.get();for(;e;)s=s[t],e+=e>0?-1:1;s&&this._setUrl(s.url,"popState",!1,s.state)}}function qr(r){return r.map(e=>(e.isResolved=!1,e.then(()=>e.isResolved=!0),e))}const Wr=r=>{r.name=r.name||r.routes.name.replace(/^_+/,"");const e=ie.routers.find(t=>t.name==(r.name||""));if(e){if(!e._claimed)return e.init(r),e;e.destroy(),console.error(`Router with name "${r.name}" already exists`,ie.routers)}return new ke(r)};function ft(r,e){var l;te(e,!1);let t=R(e,"decorators",12,null),s=R(e,"isRoot",8,!0),n=R(e,"context",8);t(t()||n().decorators);const a=[...t()].sort((u,m)=>(u.order||0)-(m.order||0));let o=O(a[0]),i=O(a.slice(1));for(;c(o)&&!((l=c(o))!=null&&l.shouldRender({context:n(),isRoot:s(),decorators:t()}));)(u=>{var m=Et(u);L(o,m[0]),L(i,m.slice(1))})([...c(i)]);s()&&Ye(()=>n().onDestroy.run()),re();var d=D(),f=U(d);pe(f,()=>c(o)?c(o).component:Fe,(u,m)=>{m(u,Ne({get context(){return n()},get isRoot(){return s()}},()=>{var p;return(p=c(o))==null?void 0:p.props},{children:(p,w)=>{var E=D(),P=U(E);{var g=y=>{var x=D(),F=U(x);ft(F,{get decorators(){return c(i)},get context(){return n()},isRoot:!1,children:(I,T)=>{var k=D(),B=U(k);ee(B,e,"default",{},null),A(I,k)},$$slots:{default:!0}}),A(y,x)},v=y=>{var x=D(),F=U(x);ee(F,e,"default",{},null),A(y,x)};Z(P,y=>{c(i),oe(()=>c(i).length)?y(g):y(v,!1)})}A(p,E)},$$slots:{default:!0}}))}),A(r,d),se()}const Vr="modulepreload",Jr=function(r){return"/cxb/"+r},Ke={},zr=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){let o=function(f){return Promise.all(f.map(l=>Promise.resolve(l).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),d=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=o(t.map(f=>{if(f=Jr(f),f in Ke)return;Ke[f]=!0;const l=f.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${u}`))return;const m=document.createElement("link");if(m.rel=l?"stylesheet":Vr,l||(m.as="script"),m.crossOrigin="",m.href=f,d&&m.setAttribute("nonce",d),document.head.appendChild(m),l)return new Promise((p,w)=>{m.addEventListener("load",p),m.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(o){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o}return n.then(o=>{for(const i of o||[])i.status==="rejected"&&a(i.reason);return e().catch(a)})},Ge=r=>typeof r>"u"?{}:{isInline:()=>!!r,...r},Kr=(r,e,t)=>{const s=Fr(r);return s.forEach(Ur),e&&s.forEach(n=>n.style.scrollBehavior="auto"),t.boundary?zr(()=>import("./scroll-into-view-if-needed-KR58zyjF.js"),__vite__mapDeps([0,1])).then(n=>(setTimeout(()=>s.forEach(ze),0),n.default(r,{scrollMode:"if-needed",...t}))):(setTimeout(()=>s.forEach(ze),0),r.scrollIntoView(t))},Gr=r=>({isInline:()=>!1,scrollIntoView:Kr,context:"browser",params:{},...r,wrapper:void 0,shouldScroll:typeof r.shouldScroll=="function"?r.shouldScroll:typeof r.shouldScroll>"u"?(e,t,s,n)=>n(e,t,s):()=>!!r.shouldScroll}),Qe={recursive:!0,shouldRender:()=>!0,order:0},$e={recursive:!1,shouldRender:({context:r})=>r.isInline},mt=r=>"component"in r?{...Qe,...r}:{...Qe,component:r},pt=r=>"component"in r?{...$e,...r}:{...$e,component:r},Qr=r=>e=>r.node===e.node&&Object.entries(r.params).every(([t,s])=>e.fragment.params[t]===s),Xe=r=>r.navigableChildren.find(e=>e.meta.isDefault),$r=(r,e)=>{var n;const t=(n=e.node)==null?void 0:n.children.find(a=>a.meta.isDecorator),s=()=>{const a=t.module.decorator||{};r.push({component:t.module.default,recursive:a.recursive??t.meta.recursive??!0,order:t.meta.order||0,shouldRender:a.shouldRender??t.meta.shouldRender??(()=>!0),props:a.props||{}})};if(t)return t.module?s():(console.warn(`Dynamic import of "${t.id}" may cause issues.`),t.loadModule().then(s))},Xr=(r,e)=>{var n;const t=(n=e.node)==null?void 0:n.children.find(a=>a.meta.isInlineWrapper),s=()=>r.push(pt(t.module.default));if(t)if(t.module)s();else return console.warn(`Dynamic import of "${t.id}" may cause issues.`),t.loadModule().then(s)};function gt(r){return r?r.isInline?r:gt(r.parentContext):null}const Yr=(r,e,t)=>{var s,n;return[!r.isInline&&((n=S((s=gt(r))==null?void 0:s.elem))==null?void 0:n.parent),ht(t.elem)]},Zr=(r,e)=>r.find(Qr(e))||r.find(t=>t.node===(e==null?void 0:e.node)),es=(r,e)=>{const t={};return r.paramKeys.forEach(s=>{e&&s in e&&(t[s]=e[s].shift())}),t};class yt{constructor({router:e}){h(this,"childContexts",M([]));h(this,"childFragments",M([]));h(this,"activeChildContext",M(null));h(this,"lastActiveChildContext",null);h(this,"decorators",[]);h(this,"anchorLocation");this.router=e,this.route=e.activeRoute.get(),this.anchorLocation=e.anchor}get descendants(){return S(this.childContexts).reduce((e,t)=>[...e,...t.descendants],S(this.childContexts))}buildChildContexts(e,t){var E;const{childFragments:s}=this,{inline:n,decorator:a,props:o,anchor:i,options:d,scrollLock:f=Yr}=e,l=(E=S(s)[0])==null?void 0:E.node,u=(this==null?void 0:this.node)||l.parent,m=[...(u==null?void 0:u.navigableChildren)||[]];l&&!m.includes(l)&&m.unshift(l);const p=ur((n==null?void 0:n.params)||{});Object.entries(p).forEach(([P,g])=>{const v=m.findIndex(x=>x.paramKeys.includes(P)),y=new Array(g.length-1).fill(m[v]);m.splice(v+1,0,...y)});const w=m.map(P=>new be({node:P,paramsPool:p,rawInlineInputFromSlot:n,parentContext:this,newDecorators:t,contextOptions:d,scrollLock:f,anchorLocation:i,props:o}));this.childContexts.set(w)}updateChildren(){const e=S(this.activeChildContext);S(this.childContexts).forEach(t=>t.update(e))}}class be extends yt{constructor({node:t,paramsPool:s,rawInlineInputFromSlot:n,parentContext:a,newDecorators:o,contextOptions:i,scrollLock:d,anchorLocation:f,router:l,props:u}){super({router:l||a.router});h(this,"node");h(this,"isActive",M(!1));h(this,"isVisible",M(!1));h(this,"wasVisible",!1);h(this,"isInline",!1);h(this,"inline");h(this,"elem",dr(null));h(this,"route");h(this,"childContexts",M([]));h(this,"onDestroy",X());h(this,"mounted",ot());h(this,"routerContext");this.anchorLocation=f||"parent",this.node=t,this.props=u,t||console.trace("node");const m=es(t,s);this.fragment=new Ae(null,t,null,m),this.childFragments=M(Xe(t)?[new Ae(null,Xe(t))]:[]),this.params=M({}),this.inline=Gr({...Ge(n),...Ge(t.meta.inline)}),a instanceof be?(this.routerContext=a.routerContext,this.parentContext=a):this.routerContext=a,this.decorators=o,this.options=i||{},this.scrollLock=d,this._resetCounter=M(0)}get parentOrRouterContext(){return this.parentContext||this.routerContext}get ancestors(){const t=[];let s=this.parentContext;for(;s;)t.push(s),s=s.parentContext;return t}get allProps(){var t;return Object.assign({},(t=this.parentContext)==null?void 0:t.allProps,this.props)}reset(){this._resetCounter.update(t=>t+1)}setToActive(){const t=this.parentOrRouterContext,[s,...n]=S(t.childFragments);this.fragment=s,this.childFragments.set(n),this.route=t.route,s.renderContext.resolve(this),t.lastActiveChildContext=S(t.activeChildContext),t.activeChildContext.set(this),this.isInline=this.inline.isInline(this.node,this)}update(t){this.router.log.verbose("updating renderContext",this.node.name);const s=typeof window<"u"?"browser":"ssr";this.isInline=this.inline.isInline(this.node,t);const n=t&&!t.isInline,a=["always",s].includes(this.inline.context),o=this.isInline&&!n&&a,i=!t&&this.node.name==="index";this.wasVisible=S(this.isVisible),Je(this.isActive,this===t||!t&&this.node.meta.isDefault),Je(this.isVisible,S(this.isActive)||o||i),S(this.isVisible)||this.elem.set(null),this.updateParams()}updateParams(){let t=this;const s=[];for(;t;)s.push(t),t=t.parentContext;s.reverse(),this.params.set(Object.assign({},...s.map(n=>n.fragment.params)))}}var ts=ne("<div><!></div>"),rs=ne("<div></div> <!>",1),ss=ne("<div></div>"),ns=ne('<div class="anchor-backstop" data-routify-anchor-backstop=""></div>'),os=ne("<!> <!> <!>",1);function vt(r,e){const t=He(e,["children","$$slots","$$events","$$legacy"]),s=He(t,["context","onMount"]);te(e,!1);let n=R(e,"context",8);const a=n().anchorLocation;let o=R(e,"onMount",8,g=>g);const i=typeof window<"u";let d=O(),f=O(!1);const l=n()instanceof be?n().node.name||"unnamed":n().router.name||"defaultRouter",u=g=>{const v=g.nextElementSibling;if("routifyAnchorBackstop"in v.dataset)throw console.warn("found no children in",g.parentElement),new Error("AnchorLocation is set to firstChild, but no children were found");return v&&"routifyAnchorLocator"in v.dataset?u(v):v},m={wrapper:g=>{g.dataset.routifyAnchorWrapper=l,o()(g)},parent:g=>{g.dataset.routifyAnchorParent=l,o()(g.parentElement)},header:g=>{g.dataset.routifyAnchorHeader=l,o()(g.parentElement,g)},firstChild:g=>{const v=u(g);v.dataset.routifyAnchorNextSibling=l,o()(g.parentElement,v)},custom:g=>{const v=a(g);v.dataset.routifyAnchorCustom=l,v.dataset.hasOwnProperty("routifyAnchorLocator")&&(n().node||n().router).log.warn(`Selected anchor element is an anchor locator. Use '!elem.dataset.hasOwnProperty("routifyAnchorLocator")' to ensure a valid selection.`),o()(g.parentElement,v)}};Pt(()=>{if(c(f))return;const g=typeof a=="function"?"custom":a;if(!m[g])throw new Error(`Anchor location "${g}" is not valid. Wrapper options: 'wrapper', 'parent', 'header', 'firstChild', or a function that returns a valid element.`);const v=m[g];v(c(d)),L(f,!0)}),re();var p=D(),w=U(p);{var E=g=>{var v=ts();Ce(v,()=>({"data-routify-anchor-wrapper":l,...s}));var y=At(v);ee(y,e,"default",{},null),_e(v,x=>L(d,x),()=>c(d)),A(g,v)},P=g=>{var v=D(),y=U(v);{var x=I=>{var T=rs(),k=U(T);Ce(k,()=>({"data-routify-anchor-header":l,...s})),_e(k,b=>L(d,b),()=>c(d));var B=me(k,2);ee(B,e,"default",{},null),A(I,T)},F=I=>{var T=os(),k=U(T);{var B=H=>{var V=ss();Ce(V,()=>({"data-routify-anchor-locator":!0,class:"anchor",...s})),_e(V,Q=>L(d,Q),()=>c(d)),A(H,V)};Z(k,H=>{!c(f)&&i&&H(B)})}var b=me(k,2);ee(b,e,"default",{},null);var j=me(b,2);{var C=H=>{var V=ns();A(H,V)};Z(j,H=>{!c(f)&&i&&H(C)})}A(I,T)};Z(y,I=>{a==="header"?I(x):I(F,!1)},!0)}A(g,v)};Z(w,g=>{a==="wrapper"?g(E):g(P,!1)})}A(r,p),se()}var as=ne("<div></div>"),is=ne("<!> <!>",1);function ls(r,e){te(e,!1);const t=()=>he(c(d),"$_resetCounter",n),s=()=>he(c(o),"$childFragments",n),[n,a]=Ue(),o=O(),i=O(),d=O(),f=O(),l=O();let u=R(e,"context",8);const m=typeof window<"u";let p=O(!1);et(u());const w=(y,x)=>{var F;return y&&(y.__routify_meta={...y&&y.__routify_meta,renderContext:{...(F=y.__routify_meta)==null?void 0:F.renderContext,...x}}),y},E=async(y,x)=>{u().parentContext&&await nt(u().parentContext.elem,Boolean),u().elem.set({anchor:x,parent:y}),y=w(y,{parent:u()}),x&&(x=w(x,{anchor:u()}))},P=y=>{L(p,!0),u().mounted.resolve(u()),u().router.log.verbose("render",u().node.path,u())};W(()=>(c(o),c(i),c(d),N(u())),()=>{(y=>{Pe(L(o,y.childFragments),"$childFragments",n),L(i,y.fragment),Pe(L(d,y._resetCounter),"$_resetCounter",n)})(u())}),W(()=>N(u()),()=>{L(f,u().node.navigableChildren.some(y=>y.meta.inline))}),W(()=>(c(i),N(u())),()=>{var y;L(l,{...c(i).params,...(y=c(i).load)==null?void 0:y.props,...u().props})}),Re(),re();var g=D(),v=U(g);pe(v,()=>u().decorators.length?ft:Fe,(y,x)=>{x(y,{get context(){return u()},children:(F,I)=>{var T=D(),k=U(T);It(k,()=>(N(u()),oe(()=>u().node.loadModule())),null,B=>{var b=D(),j=U(b);Nt(j,()=>(c(i),t(),oe(()=>(c(i).node.meta["param-is-page"]&&JSON.stringify(c(i).params))+t().toString())),C=>{vt(C,{get context(){return u()},onMount:E,children:(H,V)=>{var Q=is(),_=U(Q);pe(_,()=>u().node.module.default,(q,$)=>{$(q,Ne(()=>c(l),{get context(){return u()},children:Ut,$$slots:{default:(z,K)=>{const le=Y(()=>K.props),ce=Y(()=>K.inline),ue=Y(()=>K.multi),Le=Y(()=>K.decorator),De=Y(()=>K.anchor),Oe=Y(()=>K.options),Te=Y(()=>K.scrollLock);var Be=D(),wt=U(Be);{var bt=xe=>{{let fe=Y(()=>(N(c(ce)),N(c(ue)),N(c(Le)),N(c(le)),N(c(Oe)),N(c(Te)),N(c(De)),N(u()),oe(()=>({inline:c(ce)||c(ue),decorator:c(Le),props:c(le),options:c(Oe),scrollLock:c(Te),anchor:c(De)||u().anchorLocation}))));Rt(xe,{get options(){return c(fe)},get context(){return u()}})}};Z(wt,xe=>{s(),c(f),N(c(ce)),N(c(ue)),oe(()=>{var fe;return s().length||(c(f)||c(ce)||c(ue))&&!((fe=c(ce)||c(ue))!=null&&fe.single)})&&xe(bt)})}A(z,Be)}}}))});var J=me(_,2);{var G=q=>{var $=as();Ft($,z=>P==null?void 0:P()),A(q,$)};Z(J,q=>{!c(p)&&m&&q(G)})}A(H,Q)},$$slots:{default:!0}})}),A(B,b)}),A(F,T)},$$slots:{default:!0}})}),A(r,g),se(),a()}function Rt(r,e){var T,k,B;te(e,!1);const t=()=>he(l,"$childFragments",n),s=()=>he(v,"$childContexts",n),[n,a]=Ue();let o=R(e,"context",8),i=R(e,"options",8),d=O(null),f=O(1);const{childFragments:l}=o(),{decorator:u}=i(),m=((T=i().inline)==null?void 0:T.wrapper)&&pt(i().inline.wrapper),p=o().decorators.filter(b=>b.recursive),w=Kt(p,[u,m]).filter(Boolean).map(mt);let E=O(!((k=$r(w,o()))!=null&&k.then(()=>{L(E,!0)}))),P=O(!((B=Xr(w,o()))!=null&&B.then(()=>{L(P,!0)})));const g=()=>o().buildChildContexts(i(),w),{childContexts:v}=o(),y=b=>{o().router.log.verbose("handle children",b);const j=C=>C.renderContext.then(H=>H.isActive.set(!1));b.length&&o().route?x(o()):b.forEach(j),o().updateChildren()},x=(b,j)=>{const[C,...H]=S(b.childFragments),V=S(b.childContexts),Q=Zr(V,C);if(!Q)return j&&Qt(b,V),b.buildChildContexts(i(),w),x(b,!0);Q.setToActive(),b.childContexts.set(V)};W(()=>(N(i()),c(f),c(d)),()=>{const{props:b,...j}=i(),C=JSON.stringify(j);L(f,C!==c(d)?c(f)+1:c(f)),L(d,C)}),W(()=>c(f),()=>{c(f)&&g()}),W(()=>(c(f),t()),()=>{y(c(f)&&t())}),Re(),re();var F=D(),I=U(F);kt(I,1,()=>(s(),c(E),c(P),N(S),oe(()=>s().filter(b=>c(E)&&c(P)&&S(b.isVisible)))),b=>b,(b,j,C,H)=>{ls(b,{get context(){return c(j)}})}),A(r,F),se(),a()}function ps(r,e){te(e,!1);const t=()=>he(c(a),"$activeRoute",s),[s,n]=Ue(),a=O();let o=R(e,"router",12,null),i=R(e,"routes",8,null),d=R(e,"decorator",8,null),f=R(e,"urlReflector",8,null),l=R(e,"instance",8,null),u=R(e,"urlRewrite",8,null),m=R(e,"url",8,null),p=R(e,"name",8,null),w=R(e,"rootNode",8,null),E=R(e,"passthrough",8,null),P=R(e,"beforeRouterInit",8,null),g=R(e,"afterRouterInit",8,null),v=R(e,"beforeUrlChange",8,null),y=R(e,"afterUrlChange",8,null),x=R(e,"transformFragments",8,null),F=R(e,"onDestroy",8,null),I=R(e,"plugins",8,null),T=R(e,"queryHandler",8,null),k=R(e,"anchor",8,"wrapper"),B=R(e,"clickHandler",24,()=>({})),b=R(e,"props",24,()=>({}));const j={instance:l(),rootNode:w(),name:p(),routes:i(),urlRewrite:u(),urlReflector:f(),passthrough:E(),beforeRouterInit:P(),afterRouterInit:g(),beforeUrlChange:v(),afterUrlChange:y(),transformFragments:x(),onDestroy:F(),plugins:I(),queryHandler:T(),clickHandler:B(),anchor:k()};o(o()||Wr(j)),o(o()._claimed=!0,!0);const C=O(new yt({router:o()}));o(o().context=c(C),!0),Se(C,c(C).anchorLocation=k()),o().onMount.run({context:c(C),router:o()}),Se(C,c(C).decorators=c(C).decorators.map(mt));const H=_=>{var G;_=o().anchor==="parent"||o().anchor==="wrapper"?_:_.parentElement,o().setParentElem(_),_.__routify_meta={..._.__routify_meta,router:o()};let J=st(((G=o().clickHandler)==null?void 0:G.elem)||_,[_]);o().passthrough||(J.addEventListener("click",Q),J.addEventListener("keydown",Q),J.addEventListener("mouseover",V))},V=_=>{var z,K,le;const{url:J,state:G}=qe(_),q=((K=(z=o().clickHandler).callback)==null?void 0:K.call(z,_,J))??J;typeof q=="string"&&((le=_.target.closest("[data-routify-prefetch-data]"))==null?void 0:le.dataset.routifyPrefetchData)==="hover"&&o().url.push(q,{prefetch:!0,...G})},Q=_=>{var $,z;if(qt(_))return;const{url:J,state:G}=qe(_),q=((z=($=o().clickHandler).callback)==null?void 0:z.call($,_,J))??J;typeof q=="string"&&o().url.push(q,G)};typeof window<"u"&&Ye(()=>o().destroy()),W(()=>(N(m()),N(o())),()=>{m()&&m()!==o().url.internal()&&o().url.replace(m())}),W(()=>N(o()),()=>{Pe(L(a,o().activeRoute),"$activeRoute",s)}),W(()=>(c(C),t()),()=>{var _;c(C).childFragments.set(((_=t())==null?void 0:_.fragments)||[])}),W(()=>t(),()=>{Se(C,c(C).route=t())}),W(()=>(N(o()),c(C)),()=>{var _;(_=o().log)==null||_.debug("before render",S(c(C).childFragments))}),Re(),re(),vt(r,{onMount:H,style:"display: contents",get context(){return c(C)},children:(_,J)=>{var G=D(),q=U(G);{var $=z=>{{let K=Y(()=>({decorator:d(),props:b()}));Rt(z,{get context(){return c(C)},get options(){return c(K)}})}};Z(q,z=>{t()&&z($)})}A(_,G)},$$slots:{default:!0}}),se(),n()}const cs=()=>{var r=console.warn;console.warn=function(){var e=Array.prototype.slice.call(arguments);if(!(typeof e[0]=="string"&&(e[0].match(/<.+> was created with unknown prop 'context'/)||e[0].match(/<.+> was created with unknown prop 'isRoot'/)||e[0].match(/<.+> received an unexpected slot "default"\./)))){var t=new Error().stack,s=t.split(`
`)[2];s&&e.push(s.trim()),r.apply(console,e)}}};cs();export{ps as R,zr as _,ms as a,Wr as c,Xt as g,er as p};
