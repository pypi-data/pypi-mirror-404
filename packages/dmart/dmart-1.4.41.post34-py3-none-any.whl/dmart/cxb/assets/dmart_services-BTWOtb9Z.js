import{D as n,Q as i,S as h,R as f}from"./@edraj-D-9hi9vU.js";import{s as m}from"./spaces-5QYuv6aM.js";import{s as y,L as w}from"./toast-nP_bUL2P.js";async function $(e){const r={filter_shortnames:[],type:i.attachments,space_name:"personal",subpath:`people/${e}/protected/avatar`,limit:1,sort_by:"shortname",sort_type:h.ascending,offset:0,search:"@resource_type:media",retrieve_json_payload:!1},t=await n.query(r);return t.records.length===0?null:n.getAttachmentUrl({resource_type:f.media,space_name:"personal",subpath:`people/${e}/protected/`,parent_shortname:"avatar",shortname:t.records[0].attributes.payload.body,ext:""})}async function q(){const e=await n.query({type:i.spaces,space_name:"management",subpath:"/",search:"",limit:100});return e.records=e.records.map(r=>(r.attributes.ordinal===null&&(r.attributes.ordinal=9999),r)),e.records.sort((r,t)=>r.attributes.ordinal-t.attributes.ordinal),m.set(e.records),e}async function _(e,r,t=20,l=0,s=[],c=null,d=!1){const a=await n.query({type:i.search,space_name:e,subpath:r,filter_types:s,exact_subpath:!0,search:"",limit:t,offset:l});if(d==!1&&c!==null){const o=c.records.find(p=>p.shortname===e).attributes.hide_folders;o&&(a.records=a.records.filter(p=>o.includes(p.shortname)===!1))}return a.records=a.records.sort((u,o)=>u.shortname.toLowerCase()<o.shortname.toLowerCase()?-1:u.shortname.toLowerCase()>o.shortname.toLowerCase()?1:0),a}async function b(e,r,t,l){for(const s of l.records)if(s.resource_type==="folder"){const c=await _(r,s.shortname);await b(e,r,`${t}/${s.shortname}`,c),e.push(`${t}/${s.shortname}`)}}async function v(e){try{return(await n.query({search:"",type:i.search,space_name:e,subpath:"/workflows"})).records||[]}catch{y(w.warn,"Failed to fetch workflows")}}export{q as a,_ as b,b as c,v as f,$ as g};
