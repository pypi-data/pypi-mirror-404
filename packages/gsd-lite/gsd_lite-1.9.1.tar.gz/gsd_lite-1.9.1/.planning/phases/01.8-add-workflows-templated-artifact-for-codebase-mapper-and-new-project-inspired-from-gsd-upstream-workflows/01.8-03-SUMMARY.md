---
phase: 01.8-add-workflows-templated-artifacts
plan: 03
subsystem: workflows
tags: [protocol-routing, workflow-integration, utility-workflows, soft-gates]

# Dependency graph
requires:
  - phase: 01.8-add-workflows-templated-artifacts
    plan: 02
    provides: map-codebase.md and new-project.md workflows
provides:
  - PROTOCOL.md updated with Utility Workflows routing section
  - Soft gate patterns documented (suggest, don't block)
  - Natural language triggers for workflow invocation
affects: [agents can now suggest map-codebase and new-project workflows appropriately]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Utility workflow routing with soft gates (suggest, not mandatory)"
    - "Natural language triggers for workflow invocation"
    - "Standalone utilities separate from core loop"

key-files:
  created: []
  modified:
    - src/gsd_lite/template/PROTOCOL.md

key-decisions:
  - "Utility Workflows section added after Secondary Routing"
  - "Soft gates pattern: workflows are helpful but not mandatory"
  - "Natural language triggers documented: 'map the codebase', 'start a new project'"
  - "File Guide table updated with ARCHITECTURE.md and PROJECT.md entries"
  - "Both workflows standalone (not part of moodboard/whiteboard/execution core loop)"

patterns-established:
  - "Utility workflow routing: Condition-based suggestions with natural language triggers"
  - "Soft gates vs hard gates: Utility workflows suggest, core workflows require"
  - "Router table format: Workflow | When to Suggest | Output"

# Metrics
duration: 1min
completed: 2026-01-31
---

# Phase 01.8 Plan 03: Router Integration Summary

**PROTOCOL.md updated with Utility Workflows section, enabling agents to suggest map-codebase and new-project workflows via natural language triggers**

## Performance

- **Duration:** 1 min
- **Started:** 2026-01-31T18:22:14Z
- **Completed:** 2026-01-31T18:22:28Z
- **Tasks:** 2 (1 auto task + 1 human verification checkpoint)
- **Files modified:** 1

## Accomplishments

- Added Utility Workflows section to PROTOCOL.md after Secondary Routing
- Documented soft gate pattern: workflows are helpful but not mandatory
- Added natural language triggers for workflow invocation
- Updated File Guide table with ARCHITECTURE.md and PROJECT.md entries
- Human verification confirmed phase coherence

## Task Commits

Each task was committed atomically:

1. **Task 1: Update PROTOCOL.md with utility workflow routing** - `bddbc22` (feat)
2. **Task 2: Human verification of Phase 1.8 outputs** - User approved (no code changes)

## Files Created/Modified

- `src/gsd_lite/template/PROTOCOL.md` - Added Utility Workflows section with routing hints

## Decisions Made

**Utility Workflows routing structure:**
- Added new section after Secondary Routing (not mixed with core loop routing)
- Table format: Workflow | When to Suggest | Output
- map-codebase.md: Suggest when ARCHITECTURE.md missing AND codebase exists
- new-project.md: Suggest when PROJECT.md missing AND user states new vision

**Soft gates pattern:**
- Utility workflows are helpful but not mandatory (unlike core loop workflows)
- Agent suggests when conditions met, user decides whether to run
- Natural language triggers documented: "map the codebase", "start a new project", "what's in this repo"
- Invocation can be explicit ("run map-codebase workflow") or natural ("help me understand this codebase")

**File Guide updates:**
- Added ARCHITECTURE.md (Codebase structure) → gsd-lite/ARCHITECTURE.md
- Added PROJECT.md (Project vision) → gsd-lite/PROJECT.md
- Both files output to user's working directory, not template directory

**Did NOT change:**
- Primary Routing table (core loop workflows)
- Secondary Routing table (housekeeping workflow)
- Safety Protocol section
- Any existing content

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None

## User Setup Required

None - PROTOCOL.md routing logic is self-contained.

## Next Phase Readiness

**Phase 1.8 complete.** All outputs verified and coherent:

1. Templates created (01.8-01):
   - ARCHITECTURE.md template (67 lines, 4 sections)
   - PROJECT.md template (52 lines, 5 sections)
   - Both generalized for any project type

2. Workflows created (01.8-02):
   - map-codebase.md workflow (302 lines, 5-step process)
   - new-project.md workflow (423 lines, 6-step process)
   - Both follow GSD-lite patterns (coaching, first-turn, sticky notes)

3. Router integration (01.8-03):
   - PROTOCOL.md updated with Utility Workflows section
   - Soft gates documented
   - Natural language triggers documented

**Ready for next phase.** Users can now:
- Map existing codebases naturally ("what's in this repo?")
- Initialize new projects conversationally ("I want to start a new project")
- Agent suggests workflows when conditions met (soft gates)

No blockers.

---
*Phase: 01.8-add-workflows-templated-artifacts*
*Completed: 2026-01-31*
