[project]
name = "xvisio"
version = "0.1.0"
description = "ROS-free Python SDK for Xvisio XR-50 devices"
authors = ["Andy Park <andypark.purdue@gmail.com>"]
channels = ["conda-forge"]
platforms = ["linux-64", "linux-aarch64"]

[activation.env]
CMAKE_PREFIX_PATH = "$CONDA_PREFIX"
LD_LIBRARY_PATH = "$CONDA_PREFIX/lib:/usr/lib"
PKG_CONFIG_PATH = "$CONDA_PREFIX/lib/pkgconfig"

[dependencies]
# Build tools
cmake = ">=3.16,<4"
ninja = ">=1.12,<2"
# Python build dependencies
python = ">=3.10,<3.13"
nanobind = ">=2.8.0,<3"
scikit-build-core = ">=0.11.5,<0.12"
pip = ">=25.1,<26"

[pypi-dependencies]
numpy = ">=1.26.0"
spatialmath-python = ">=1.1.0"
viser = ">=0.1.0"
# Publishing tools
build = ">=1.0.0"
twine = ">=5.0.0"

[tasks]
# Development install with automatic rebuild on import
install = "pip install -e . --no-build-isolation"
install-rebuild = "pip install -C editable.rebuild=true -e . --no-build-isolation"
build = "pip install --no-build-isolation ."
# Run host setup script (requires sudo)
host-setup = "sudo ./scripts/setup_host.sh"
# Build distributions
build-wheel = "python -m build --wheel"
build-sdist = "python -m build --sdist"
build-dist = "python -m build"
# Setup PyPI credentials (run once to create ~/.pypirc)
setup-pypirc = "bash scripts/setup_pypirc.sh"
# Upload to PyPI (requires credentials configured in ~/.pypirc)
# Note: TestPyPI only accepts source distributions, not platform-specific wheels
upload-testpypi = "bash scripts/upload_testpypi.sh"
upload-pypi = "bash scripts/upload_pypi.sh"
# Version management
version = "python scripts/version.py"
# Demo scripts
demo_pose_imu = "python examples/demo_pose_imu.py"
demo_pose_visualization = "python examples/demo_pose_visualization.py"
benchmark_pose_rate = "python examples/benchmark_pose_rate.py"

[feature.dev.dependencies]
pytest = ">=7.0"
black = ">=24.0"
isort = ">=5.13.0"

[feature.dev.tasks]
test = "pytest test/"
lint = "black --check python/ examples/ && isort --check python/ examples/"
format = "black python/ examples/ && isort python/ examples/"

[environments]
default = { features = ["dev"] }

