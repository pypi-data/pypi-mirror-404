[project]
name = "smart-media-manager"
version = "0.5.45"
description = "A macOS CLI that audits media folders, fixes extensions, and imports into Apple Photos"
readme = "README.md"
requires-python = ">=3.12"
dependencies = [
    "filetype>=1.2.0",
    "puremagic>=1.30",
    "isbinary>=1.0.1",
    "python-magic>=0.4.27",
    "pyfsig>=1.1.1",
    "pillow>=12.0.0",
    "rawpy>=0.25.1",
]

[project.optional-dependencies]
# Optional dependencies for enhanced media detection
# Note: binwalk is installed via Homebrew, not pip
# Note: rawpy moved to main dependencies (no longer optional)
enhanced = []

[dependency-groups]
dev = [
    "pytest>=8.4.2",
    "pytest-cov>=7.0.0",
    "pytest-mypy-plugins>=3.2.0",
    "ruff>=0.6.0",
]

[project.scripts]
smart-media-manager = "smart_media_manager.cli:run"

[build-system]
requires = ["setuptools>=64", "wheel"]
build-backend = "setuptools.build_meta"

[tool.setuptools.packages.find]
include = ["smart_media_manager"]

[tool.setuptools.package-data]
smart_media_manager = ["*.json"]

[tool.uv]
default-groups = ["dev"]

[tool.pytest.ini_options]
markers = [
    "minimal: Minimal CI tests that run with small samples (under 300KB)",
    "e2e: End-to-end tests that require large sample files",
    "slow: Tests that take significant time to run",
    "requires_raw: Tests requiring RAW sample files",
    "requires_large: Tests requiring large sample files",
]
# Default: run all tests except e2e (which need large samples)
addopts = "-v --tb=short -m 'not e2e'"
# Restrict test collection to tests/ directory only
testpaths = ["tests"]
