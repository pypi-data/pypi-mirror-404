from agrossuite import agros

from .scenario import AgrosTestCase

import numpy as np


class TestMatrixSolversGeneral(AgrosTestCase):
    @classmethod
    def setUpGeneral(self):
        # read reference matrix and rhs from file
        self.reference_sln = [693270595.3500192, 832732039.7319043, 710830223.4056776, 842292146.2453935, 701767345.5497259, 837785083.5234934, 761664953.7736759, 774535923.3996234, 767924855.3705108, 1000000000.0, 1000000000.0, 1000000000.0, 908509611.3588233, 916159366.2695594, 913277599.0491229, 730634923.5186653, 852486051.4827355, 720466527.0367895, 847193130.6754293, 789435574.9736537, 781713040.0510061, 1000000000.0, 1000000000.0, 921660019.8424865, 918825760.894945, 1000000000.0, 836483642.8743762, 912481112.2700988, 1000000000.0, 844392028.1984577, 916998059.299392, 1000000000.0, 821224753.7498246, 903987355.6491321, 1000000000.0, 828803659.6652658, 908075909.0132527, 704513562.909772, 767938073.867001, 717472392.995432, 778568910.62125, 679159846.4238375, 747371114.0106965, 691752832.8230155, 757529453.462271, 552967146.5802238, 630277107.3901069, 591261228.0965178, 614824029.215603, 666640373.7844487, 640497527.260033, 433166989.0182355, 561235457.8921368, 496816002.4199192, 492658711.2187316, 595185674.1446937, 543508043.0067616, 670096281.7494161, 693283138.3879352, 626632138.1543663, 647869829.6790175, 706996692.1365178, 829034500.8084716, 661640763.6612197, 741736450.1106287, 684723778.1465597, 786061005.4141959, 765443394.980275, 700658535.5754073, 733657559.4091554, 902208720.9017112, 785455855.7610401, 843233527.0495191, 613958789.7383753, 652108140.9801283, 637982617.1670952, 697048184.7046988, 632651693.5255468, 666894072.0298352, 672303110.3922597, 728584655.0321374, 545403292.6837022, 553038062.8054414, 598661716.4708717, 612366981.0782454, 439448637.5236198, 435940364.6798379, 492328212.5936674, 494267504.31326383, 532133582.07524794, 538400789.9638276, 573178310.660687, 585580781.1471218, 449326288.17311114, 443833964.1601102, 490827029.82248473, 491143752.01917356, 464448293.3592513, 564024302.2700166, 514584618.5181998, 456098078.8353483, 547892060.9785832, 502249110.07941574, 487345229.0924709, 596894371.9000713, 542791731.9478714, 474450444.0477106, 580460760.0135518, 528046601.2793317, 612904258.1953852, 593092673.4981292, 651336674.3486669, 632404184.2673341, 423227229.8567634, 423053698.16906685, 357185186.0096237, 343051867.4353887, 390609151.71951824, 383655835.9180244, 423122131.5177037, 350129564.3717266, 387124500.6286844, 423005013.0603937, 328822675.36353, 376751593.12342954, 423016238.2362453, 335949923.2169485, 380199035.0387049, 287717226.1290196, 257890693.32446766, 322903991.62639505, 301153413.1912926, 272883925.95609474, 312068329.02880627, 227411343.57344472, 279074276.78152275, 242733100.77926102, 290156376.01609695, 117980295.43404703, 189666924.02932224, 154258556.3482381, 173735181.98638657, 224199794.40148222, 199191495.97969893, 0.0, 117999153.63998026, 60086791.45996312, 60083787.34313261, 154272642.97579572, 107902762.45872077, 257963901.7899278, 224225960.02854532, 272921875.1432462, 248772332.4095421, 227551325.38411027, 173791912.28977147, 242841505.171592, 199235480.7346107, 329332478.84200084, 343286998.2294144, 336315515.38401836, 279362755.4270359, 301290377.1194353, 290365527.4797746, 424310409.1047679, 423597650.23651147, 423893647.61051697, 377599933.3428253, 384022898.7860865, 380781634.0038722, 350244636.76324034, 312136057.43395543, 423381594.95099384, 387300586.7952592, 291395956.181144, 394392843.21641123, 314195962.02350426, 392797605.9693848, 302269182.99610883, 392979422.7118327, 344534559.1131696, 354408947.36739695, 348884692.8662303, 441597129.04298735, 429384323.2643583, 434903894.25912994, 339908085.15246975, 395870455.56127805, 326818706.8577467, 393750946.3498217, 368220463.8653792, 360898084.8935175, 422880013.0566618, 425459792.43451554, 368513057.4632525, 404453016.50250345, 381821396.66872853, 413197843.6189902, 343855331.8440355, 389285081.40370524, 355895322.21050155, 396529585.61388254, 293263123.8625761, 331486468.95734763, 316535727.46545434, 349617930.33583194, 247241340.68214193, 296620820.9472597, 270183220.19661784, 313824446.13672715, 139769465.93600768, 230938869.955212, 186453082.55725068, 195325943.82066363, 262154942.98063222, 228903516.9382698, 0.0, 170883538.99864697, 98526851.77267689, 80192334.33837108, 199828600.11103603, 142662538.2898212, 273503429.15760726, 294833258.22955614, 234144142.2483427, 252945483.66279963, 692867404.6689576, 774397325.0085322, 709269407.0648143, 768288590.4535514, 700092505.4538611, 769528715.1005291, 735030772.4306374, 739951174.5238261, 736080934.6026196, 846281810.8968576, 818727999.617147, 829945321.6608483, 811348221.854007, 794446645.0241227, 800713688.1207056, 734039255.9119867, 778945015.8499475, 720529990.9549274, 771224374.1671203, 757363612.9153721, 746938273.3731551, 816621097.4652154, 813707076.1132914, 798675551.4324116, 793454959.3335305, 856436770.77108, 790521718.7064096, 824621523.7942367, 829270836.129979, 781733182.4573426, 806862241.8594936, 901556168.9510218, 805975861.4297035, 854594487.2566781, 717855586.7329313, 754746437.1276282, 725272358.4086189, 754429507.4666924, 711763584.4425406, 758441167.0661403, 654415847.1357431, 625957524.2932572, 685075188.0299797, 667964117.5044857, 598786273.0724117, 546260153.5951064, 625689694.432098, 585373751.430542, 682185943.120421, 702601290.0196203, 647598222.0719335, 663880616.9599442, 904659323.7979357, 902036689.7415333, 923076895.7359828, 908888652.9447914, 912763276.2276725, 903823554.4408035, 901473923.3423322, 914636577.7082604, 906775578.2499517, 912373168.7031202, 904212991.8899611, 906171291.6413088, 905704367.1968889, 905417235.1334763, 903708786.7812966, 948872157.7773539, 929466523.6263697, 935167293.2054598, 917385664.2538736, 938437883.6920561, 925246117.3694099, 915109382.4858965, 906929654.0499667, 921712947.9298668, 911320610.593883, 948716177.5529532, 960370156.3628666, 954665493.4774349, 929143913.2454206, 943488437.2343785, 936154870.466789, 1000000000.0, 1000000000.0, 1000000000.0, 973175196.6979502, 979518942.3932375, 976483151.4193264, 971902835.8838642, 966022528.3943442, 959736855.5156548, 951257199.9680843, 1000000000.0, 1000000000.0, 985332702.8094026, 982413264.7235056, 1000000000.0, 950347149.3799335, 971266282.5419264, 1000000000.0, 961631665.801068, 979159401.8452845, 925852719.6743288, 946716203.7063482, 1000000000.0, 938119833.3277822, 960960598.7654666, 934808257.0129446, 947150190.1113218, 911712878.3667057, 922976946.1226752, 489451171.3637857, 458859628.95772505, 415238097.60227823, 381710137.9248905, 453458934.7863264, 421291414.639887, 464986424.93714076, 391533182.19406146, 429352257.85895085, 467838615.3385167, 383653881.5917831, 426647509.3360881, 330498358.49151254, 294451030.3977044, 374421662.5130199, 339622219.2525119, 307720243.30902827, 351136981.50357264, 289662586.3097786, 338171285.41013485, 250843476.3049342, 205335771.06196094, 270414249.97407717, 247369264.59257206, 250152789.56298402, 140239113.5506519, 244962896.60974935, 163187310.05595878, 374457129.5556317, 310341287.9714624, 348585107.4982525, 304595398.3125784, 446401404.97211516, 352427700.2168738, 407622849.07252795, 326499845.1570085, 612656446.202792, 492885960.69232935, 549243944.4621714, 533040620.6257106, 435803016.5828614, 481057271.3294573, 753505214.1935292, 596458740.9793625, 671432350.1787071, 685914576.5810496, 546277290.1319836, 612555643.7138044, 447473737.93908507, 399788155.31318027, 533957288.2167899, 492063294.45397586, 676270381.1008744, 820445898.3998774, 701785425.4006658, 835042836.4243034, 688942874.2976502, 827692177.7979466, 745626849.9385242, 765815551.877905, 755610311.079982, 1000000000.0, 1000000000.0, 903760076.299152, 911769445.9702184, 907621222.2733203, 728037655.8098848, 850244911.5910664, 714812092.1406016, 842584491.9116663, 786801138.0196524, 776207933.5703319, 1000000000.0, 1000000000.0, 920295855.9597145, 915990962.5140277, 1000000000.0, 834529422.13565, 911464998.6568886, 1000000000.0, 842342443.7774746, 915849179.575233, 1000000000.0, 819082389.649365, 903041582.3511242, 1000000000.0, 826808679.790205, 907118377.0723997, 701058274.131219, 765156987.3075268, 714452923.9527978, 775890583.7572829, 674753612.6287901, 744166333.8563781, 687839176.6921444, 754575669.9579208, 546214989.1002306, 622092003.3442796, 583790133.9722617, 609220789.3519893, 660922697.6237358, 634836731.371592, 547215567.6707008, 485349973.78572327, 484785408.13404614, 584247462.5291668, 534091487.75430435, 661335877.7286013, 687543536.3656765, 610570577.0340912, 635699388.3193866, 1130854687.0384824, 1176144897.5036595, 1176693611.2278361, 1220598976.695773, 1154075186.985199, 1198830831.9402845, 1153140280.2490056, 1198657534.5915759, 1176307807.001282, 1224229659.431979, 1264176987.3157997, 1244546074.7350616, 1199864652.3873842, 1242463802.54335, 1221603669.4003322, 1220153816.292882, 1261763093.372226, 1198717466.0358229, 1241552468.3603687, 1241161366.0238378, 1220259625.9315288, 1301549853.6889143, 1283160384.083515, 1281907373.2235816, 1262540312.934411, 1336784964.6125047, 1280894830.5781388, 1309504879.9578447, 1319407759.63909, 1271372091.2748659, 1295829382.2247841, 1370301708.9443104, 1299785133.0645237, 1336270726.1480188, 1353739432.4334207, 1290357057.7660284, 1322975461.7704275, 1220097772.4410365, 1251053270.0306292, 1220110427.344541, 1246107207.3358617, 1220102539.9637454, 1260973783.403057, 1220097558.2945242, 1256006215.6660373, 1133746001.5959036, 1155337035.67598, 1144631167.3265054, 1177511067.8274863, 1188145799.6661143, 1182859520.2190435, 1045847779.5453072, 1088049708.8918257, 1067037338.0938486, 1089538096.0142508, 1121866722.6976578, 1105816965.2512124, 1165980037.706729, 1193411990.29005, 1109215018.4100523, 1137882676.159083, 1542616379.935602, 1473410078.8869317, 1527818054.8153, 1475932664.8483255, 1535400453.1231942, 1474536150.450877, 1512083797.8805192, 1503960759.012282, 1507966681.1093926, 1406795325.081146, 1388786033.7103693, 1426212391.6773205, 1443582537.20396, 1434859760.8244035, 1511648426.4721832, 1479543008.6961386, 1519892253.9785395, 1477600349.1369786, 1496334124.6563995, 1500077849.8518217, 1441356541.7924519, 1424328266.1037502, 1461226743.649111, 1452374655.672042, 1473730232.7054174, 1514649798.146365, 1495356609.519043, 1457844604.3839731, 1497925500.428654, 1478864376.0153499, 1503435925.2487526, 1543119995.6059349, 1524753056.4524505, 1488953686.1851764, 1529710363.0847108, 1510665460.3345532, 1546518359.3687837, 1531683578.2214737, 1530407805.729263, 1515086917.516528, 1571162004.6236176, 1558579943.7545278, 1560068235.2387164, 1546160296.0560243, 1587800664.7934208, 1566682817.8768778, 1579334892.5793862, 1580896204.157371, 1557286597.8559701, 1570730055.6770601, 1593192172.4780788, 1581251801.4050894, 1590362334.0134294, 1591898516.9453511, 1574680414.506491, 1585875931.7393641, 1549584101.5693233, 1540386650.1074216, 1565542413.4822662, 1557974687.8139126, 0.0, 0.0, 101799117.36105429, 116687756.7418771, 51787874.127572, 60373442.39404963, 0.0, 108681424.9194541, 55584391.28676347, 0.0, 126210838.80537091, 67181091.41011891, 196544493.5289174, 220159063.1683885, 150044852.34029937, 169821352.60853037, 208046021.8174666, 159465124.65960068, 233095953.4439798, 181428035.60919732, 279043205.606192, 311491052.70800835, 249958976.50332358, 272983952.2381847, 335393487.7523079, 385108659.02690244, 307508431.468121, 348825017.8541863, 213632424.59996784, 246445916.1237632, 205060716.654156, 227357210.28111285, 230883253.03654772, 283998834.4424729, 222244118.39883104, 265326455.32308576, 119265853.50231032, 110229399.92062011, 114695741.59438676, 175994006.27682194, 162782832.67795298, 169348036.74181348, 0.0, 0.0, 0.0, 60625513.564379275, 55971105.455443285, 58261211.184994616, 105907512.94698377, 156333022.49561453, 0.0, 53789721.133171774, 228621704.95585227, 330198294.50962484, 207873755.71089324, 270003457.4656571, 218262652.74038178, 300386060.97982043, 280403006.28531176, 239302008.69861206, 259967506.24574837, 378118945.87023675, 300004680.52881, 339574067.85875785, 186977792.08301607, 207383139.03685367, 197448649.8671675, 239016542.02383295, 197210023.63985837, 218389560.05147162, 217496435.30424905, 259339211.1584658, 107135396.1902536, 112570993.0270515, 158095249.2392244, 165959934.648, 0.0, 0.0, 54453742.19861949, 57271338.461322725, 96237636.24149282, 101690202.35790704, 142278200.8336595, 150200911.1965635, 0.0, 0.0, 48822985.06883532, 51637419.71597983, 0.0, 107429621.09605117, 54604949.78474748, 0.0, 101826296.85065418, 51705405.86255071, 118736498.35421021, 60498400.556283645, 0.0, 113059523.12209736, 57531105.651974425, 158508025.1324946, 150396870.86996138, 174757021.58988392, 166623884.56239867, 1092031264.3342593, 1096244337.6107116, 1257548717.7633414, 1344777986.5285313, 1179810168.6880043, 1231861157.8375762, 1090692890.8876522, 1301413495.7972736, 1204297595.57101, 1121484173.1985536, 1427485301.1728878, 1292213297.1955092, 1106906691.5360308, 1386943200.587432, 1261456909.7957416, 1387471750.3428514, 1515069174.21244, 1326246803.20508, 1438158134.9568303, 1455415167.3915937, 1384375481.716614, 1611784723.1076844, 1532688402.971317, 1567028860.5529218, 1487522799.6988256, 1706992251.4458954, 1632198505.510174, 1674772869.0716438, 1669109625.609101, 1580963575.5187664, 1629300152.2371097, 1735030472.0035555, 1696636608.3280497, 1722596554.6191669, 1728458679.4873178, 1670289810.2335, 1705198257.432807, 1512752432.649048, 1578513390.8347132, 1455191596.914024, 1523183179.760733, 1600496692.6998866, 1656528642.8466363, 1560881916.6826246, 1622549780.2941523, 1435141108.7712235, 1351169836.4628518, 1394633854.2767315, 1527268712.2323203, 1439101819.7250452, 1486197437.9646091, 1192062587.3713677, 1122148541.350934, 1152786793.4717045, 1322728726.6798258, 1246600942.7219906, 1284062593.6819954, 1305266038.9763644, 1385777335.881506, 1101991176.5155954, 1211574955.6789324, 1035371619.8743786, 936170554.2029425, 992295385.4899846, 895047393.9703816, 1014381320.8737199, 916115285.7052356, 985375202.8257588, 944659237.2033631, 965580990.4286922, 790437469.6045604, 818230780.8673196, 889144313.6979048, 843600214.1741366, 866690724.388815, 944601780.7744844, 851931987.7827991, 969037339.2274246, 873426500.2960541, 900011137.6556511, 922723893.0248696, 742985267.6286334, 764717621.7858721, 799847329.2213354, 820895782.6906095, 722265946.240669, 866743255.751401, 798651146.276944, 727875609.5707943, 856987289.6576743, 795810812.3750311, 901528480.86936, 829326443.8393955, 729986591.9023093, 881555131.6470585, 809372151.2089143, 983611463.1008384, 928103895.0796446, 963191570.8924096, 912530716.5266399, 1029142661.3067334, 968169567.340941, 1005671660.1326078, 946691193.4113334, 1135339405.9435756, 1063854147.327362, 1099810960.2529979, 1084692448.9735305, 1025227145.6684104, 1054721676.1415174, 1133315204.0956402, 1179869655.1765757, 1181678782.7946901, 1099769551.6701546, 1141380734.2253523, 1027872069.7111027, 996560516.9709295, 1084925396.5268943, 1057276187.0815076, 659549900.2801696, 566624725.0708233, 675488407.6259948, 579285349.9950124, 614871877.2633132, 629309631.4782548, 514939474.945436, 525205144.26793003, 632340748.3289784, 561731309.9680611, 645144286.2575247, 560744938.4302795, 597327287.3814727, 604188239.2394228, 525595234.5030355, 514467353.4080574, 627439433.6864005, 607508040.624688, 590318846.2664295, 560253729.8026463, 672087355.1294957, 665385323.6171204, 681284204.413133, 652600315.6426979, 654952927.1653308, 622106131.3572935, 710850144.6751686, 688189262.4652127, 724265390.3381871, 757278966.9907559, 701525196.582165, 732476236.9823964, 748775663.1173022, 783959295.5214114, 691626533.4896963, 672295463.8367233, 712623110.3700392, 964331275.0979383, 1259820473.8655798, 1001370015.1926713, 1222007132.3948185, 982638005.4738611, 1240757190.6660883, 1123989706.8926337, 1118289305.3834727, 1120752437.2007601, 1471181721.7897527, 1394456865.7174275, 1433832999.4415839, 1374768501.549468, 1313670636.4179838, 1344507517.2000465, 1040106481.8884124, 1185800922.2560327, 1020513692.3011296, 1203668023.8080401, 1115793208.5291617, 1116622308.1546452, 1310100319.8560407, 1353191433.0912683, 1250473723.317643, 1282301081.4964478, 1218764812.4604626, 1053485361.8246, 1139562294.183376, 1265257771.1049438, 1121974869.106802, 1196591438.9999914, 900767722.2127794, 1015333292.199231, 1170747212.2533877, 979940435.7036325, 1079227182.8801384, 859528092.8493603, 960250209.8690654, 953604146.3137513, 1041091108.3512518, 645718529.8029565, 777717483.2955171, 757161334.8225429, 872710852.2718877, 350227016.9846449, 714812172.6087365, 543590440.8313074, 503663952.0932324, 788486871.8245826, 653461649.8591838, 0.0, 558408626.5425516, 301624643.7496743, 182992635.15503445, 638189053.9780194, 426822742.6483054, 866741178.5689412, 910457410.9408199, 777144487.1667112, 822366105.006766, 344353604.01427275, 183403623.54281542, 397184672.44652116, 217212397.65408263, 266745849.23535645, 310454146.19188255, 0.0, 0.0, 94203836.59261471, 114731066.92345087, 226733666.5291911, 117001147.51943989, 287742268.35565865, 150206676.15181845, 173111284.2503385, 220970999.5250738, 0.0, 0.0, 59166883.51030603, 76085590.53763603, 0.0, 203942373.85645384, 107950322.83709313, 0.0, 158706599.45117146, 81415309.2158687, 0.0, 302837000.3645401, 185182401.0186421, 0.0, 253217035.41369918, 140921832.56903794, 363719911.7214614, 288361020.0577945, 296625647.43006605, 230424433.1913744, 487688165.5507235, 402632942.0336749, 427726529.03107, 345866603.19486505, 632852398.8165762, 499035187.8187961, 568441517.7242266, 564043473.9812306, 434619980.47678065, 501465653.8122813, 695731256.4521598, 558148557.8352629, 629590711.0976121, 424406668.52658445, 363243190.11275774, 480765762.1937823, 956245028.1422234, 838405868.6389351, 827454092.9755099, 719836572.7577658, 894712165.1230484, 781652966.6481233, 895104733.9834179, 772475765.413747, 836485652.4779646, 790016264.7758688, 672508927.0969495, 733735166.9646811, 671343584.2253644, 576670918.6551358, 753448409.7702388, 651957139.4483689, 624007018.830372, 702037530.9908454, 531101113.7977185, 605312804.4071811, 551085369.0759212, 431949314.7043725, 560350074.1931144, 480831399.6109051, 556003074.801466, 359776925.90025276, 553298065.5123417, 386511427.8532808, 750837894.8585058, 657437361.2844872, 709178207.985132, 637065334.2820758, 839922217.0102859, 714190848.0811965, 795657668.4977692, 683095619.7281817, 1039806957.339668, 934361632.7926322, 987930069.4284567, 947381253.6285566, 848658368.2170027, 898207098.0770802, 1078878542.5036595, 1137054267.1081226, 1120804463.520018, 1010570513.943573, 1066862094.8018088, 880409258.6437, 799705572.7933347, 1018118424.5657, 952727684.4960556, 0.0, 0.0, 308072308.9537877, 326675301.2108669, 159998649.32973343, 169844066.40875548, 0.0, 316598606.22521806, 164310406.67411909, 0.0, 337938731.6616043, 176170570.1542418, 572489660.2434803, 607377580.9154998, 445401130.56264263, 472177128.43912876, 589391600.8755605, 458034705.0267133, 626198163.0752876, 487477585.68668246, 780465402.6384221, 841950935.5602354, 694651564.4747472, 736530416.6311071, 948401207.0339257, 1038788003.9430119, 865072284.5525675, 942753005.9725299, 648234373.7450124, 716061938.1735579, 608980265.5637165, 652132659.5791937, 738851459.1770526, 849084916.0660406, 691139845.4363614, 781573350.7429494, 469619665.4479642, 364840867.6002976, 406012686.74613047, 615093095.58889, 515056879.72070134, 559288460.6474248, 0.0, 0.0, 300175850.23195595, 195136177.28186396, 225952464.15800682, 333337017.8372413, 477791673.3960318, 0.0, 174428896.62276396, 1330130449.5730302, 1257163170.7720358, 1406243928.2814972, 1409246287.931833, 1369636829.9925585, 1339968814.44919, 1293489555.3940768, 1406434824.9265978, 1353582765.932836, 1422700624.55953, 1322469672.3345401, 1222679294.9666286, 1414715376.1310444, 1329410530.6042795, 1470713358.19185, 1514568718.5953271, 1439918164.8717482, 1466878232.1740036, 1492621900.3172815, 1452551011.2437065, 1557032332.2429986, 1499441080.7905357, 1536170895.6095374, 1482625897.1855738, 1626573646.0871253, 1587391015.8653102, 1608427379.521728, 1598686574.63706, 1555798276.1128366, 1578085823.5177424, 1648033072.9357226, 1625550349.315351, 1639375613.4322653, 1642537617.5300748, 1610312942.7433646, 1628411891.1329548, 1538130431.2942393, 1563834222.289441, 1507449865.245459, 1532120795.7219026, 1583487089.2654724, 1606814894.3924882, 1563295944.8580208, 1588492742.706066, 1525358285.8138459, 1473801107.4911366, 1501462986.5051792, 1555987142.3338473, 1507519064.457948, 1533946540.2897816, 1459945886.1665928, 1399592741.0142949, 1431105029.2983766, 1492784076.076739, 1437556503.3378696, 1466768698.849613, 1442121469.8326254, 1476304040.389518, 1365736455.2710183, 1405155289.2454908, 1613823460.5982404, 1602509460.8765924, 1603579785.342384, 1594939313.943719, 1610331195.128161, 1600488313.4967246, 1607801451.2190402, 1598795002.1653776, 1604911963.387394, 1596905871.411645, 1590335734.3843565, 1595492987.8979094, 1599001172.652841, 1592140248.152606, 1597395784.4671254, 1579986489.2992468, 1572650490.73398, 1593495825.6974707, 1585721224.6500125, 1576083389.5246549, 1589235256.3876736, 1567328931.0581343, 1581061448.7011592, 1569732927.3029978, 1582996100.1805007, 1525054055.253415, 1551866636.8410854, 1538129152.6978123, 1548804436.2293942, 1563026881.4554827, 1555573108.483203, 1495637402.2493482, 1539246809.7658982, 1517248736.6780462, 1579756374.9281635, 1565904351.589911, 1579460458.4964576, 1571057739.6770918, 1581047643.3033814, 1560806027.484464, 1611969517.5258434, 1618092876.2002175, 1597783133.7754924, 1601664965.8157525, 1628382384.0297625, 1638116264.1525757, 1622135831.2113054, 1630238801.8453598, 1607182101.6297615, 1595114299.535783, 1620201843.9921186, 1615590362.8491275, 1080934158.6632311, 1042327181.5226208, 1106099600.4478562, 1065416155.6627574, 1061260131.6469318, 1085447283.538891, 1006610485.0090442, 1026600026.9804648, 1024131073.0936633, 1045864290.1147937, 1029667419.9718136, 994425428.2796768, 1055433402.5082142, 1018702767.8665905, 1011660162.1770105, 1036663944.1200935, 962968142.0153862, 985571544.2772825, 978143258.9845026, 1001640928.1941831, 911029857.1199306, 967533889.5215201, 937854844.3723155, 938309596.3944702, 981537667.085233, 958954518.2939844, 880538994.8813164, 952402189.1561756, 914653461.2115078, 1032018355.3980557, 999154179.653973, 1030774063.3004205, 1005611400.2467619, 1033508530.1356394, 992370009.5498205, 1105639509.4117014, 1119056778.8246915, 1069091509.9644102, 1076687068.0345478, 1141403883.1645896, 1160238325.2161255, 1092963489.4413328, 1062043540.024474, 1123380488.6063428, 1618095929.1759598, 1684903326.846135, 1609583647.985794, 1690655837.8378563, 1656458991.0535195, 1656392458.8379202, 1714390071.6904867, 1725486937.9516907, 1703922655.5137267, 1713287097.4508839, 1632637715.1287146, 1674066454.9942584, 1625852607.3475857, 1679407116.4132533, 1656439741.8733265, 1656534420.4340389, 1692672659.243502, 1703197110.8620253, 1686056367.3863983, 1694882511.4577115, 1669193837.9336593, 1649239913.315479, 1662982747.0581517, 1681309662.9456449, 1661595068.5792117, 1674486296.5968616, 1657887729.252864, 1637449966.5037575, 1652261700.6185524, 1595905416.2641602, 1627177749.2356403, 1614733347.9055803, 1641908385.3067055, 1576538074.0910523, 1612628750.2017517, 1530798157.647751, 1478605318.1132917, 1566964955.2682168, 1533885309.8115344, 1486997336.871097, 1409171607.551077, 1577492576.2686138, 1597795826.1137333, 1553921739.1694107, 966141260.4760308, 934433096.7909832, 955817706.5352434, 929577862.8728768, 961173049.6914198, 932683190.4318275, 949293570.5193926, 942180272.4136143, 946143712.0116237, 908110916.4931935, 911669052.0916532, 921923070.9281664, 918163627.7397625, 921065008.0438625, 943741131.471639, 919259771.6628691, 950031831.4218738, 925093989.2560066, 931618340.8623543, 937355722.1090564, 893376899.4544615, 901876337.4361858, 906571240.662459, 913275638.0720205, 871435185.1586033, 915442337.0555742, 894461515.2132491, 883065771.5933383, 917515594.3973281, 900883866.9378167, 859010290.9353598, 913206955.6258496, 887558374.8033788, 952928497.7398309, 934842499.2102429, 948248657.9267393, 933246564.928325, 957818429.6349194, 936493915.1843883, 979937988.9601265, 993003127.5584109, 966899378.1252111, 976021021.1918639, 1004093706.5591066, 1024618231.3318657, 992280549.317895, 1009124644.9341942, 967515277.008313, 958230062.5186288, 984499137.6203638, 976241190.7529902, 635830866.8200505, 723241058.4216318, 655136390.3129487, 769847103.5575863, 678762121.1763703, 710953683.5936875, 819300676.1034625, 903175778.2733938, 769913724.6489142, 833256457.6898587, 597980610.7601999, 635772731.3977417, 616788759.2238587, 678714311.4086047, 616765613.5116668, 647415491.9295367, 674591914.8059292, 744125756.0191332, 655052944.3494252, 710873357.5601231, 545592278.2975808, 527434852.5738636, 536494585.3042136, 608893729.6795783, 580875240.5326196, 594823263.4966629, 483879686.8815254, 474965852.2169675, 479411236.2718737, 509445754.0377397, 518417179.2107534, 553293043.2296678, 567035342.9387858, 466161775.573313, 470547684.4547008, 527691551.50764, 475362440.3681977, 518539313.1422958, 470738803.6658976, 536904427.7891399, 480044764.44087315, 581035540.8032355, 567115523.554996, 595070785.1358993, 886330528.7881771, 874496950.6388552, 895266987.8799632, 896787977.234649, 880826196.8394487, 895343208.7205139, 866331351.932209, 899702873.8213867, 870169679.6213859, 846882024.8725929, 877862552.8813246, 857931002.9947702, 859362304.7198349, 868798563.7341506, 832570487.1471183, 844939397.2507634, 851444292.8413398, 835722101.3216072, 846862810.037817, 831135154.5793407, 859867204.3403294, 845349948.4957848, 877835672.0759249, 865538189.5428869, 872860555.7150131, 860799014.9933585, 884764738.439669, 873115645.8630968, 892393460.7535648, 899204880.7211441, 885554229.9846578, 892791836.8174052, 897970013.6440845, 903604152.216587, 887970007.92842, 880471016.2763407, 895077770.2831472, 636167639.7586344, 723817010.4595537, 657497673.046262, 771219181.9641768, 679147615.0530832, 712736451.5264918, 770713347.7066864, 834182255.5581415, 594372150.0803118, 634648299.9764754, 615137364.1580501, 678454149.4723461, 614360967.6594074, 646405089.8752848, 655274647.7592075, 711451524.9325745, 528200752.8541488, 537650868.3654913, 580774419.0163202, 595583583.9338534, 425250093.616551, 424720133.7967264, 476489094.4257285, 480875532.9725494, 509663781.3889125, 518866332.0467373, 551678635.8184241, 566141236.928625, 426773342.6169458, 425921219.0572282, 468093796.74296343, 472220600.3499041, 429226768.3098021, 530947160.7295733, 479870805.95510083, 427855914.08921516, 520223937.41808337, 473876001.6057307, 430962986.7934356, 541848024.5704464, 486116509.9331458, 582897219.5276941, 567206812.501299, 598767080.9321651, 362845921.2358649, 346435453.169444, 395209852.3464205, 386455339.15227264, 354610457.5534647, 390768186.7248902, 338303646.8602802, 382245685.2106785, 295576847.3659588, 262396217.16624013, 329645567.315652, 305103628.8693334, 279056272.9300952, 317388458.38078684, 245587178.868226, 292778920.25983727, 192755181.87517568, 156153327.22354677, 228042157.48842055, 201611633.51263362, 156506196.23758358, 109171850.0998867, 263633569.4505838, 228572321.8481419, 279702633.5908612, 254066922.98659143, 247362886.54149723, 202554884.10348642, 348936278.7050916, 342105920.3060964, 306930385.5852027, 295489495.51757795, 389687077.3221633, 387249722.1919168, 355855726.0514633, 318316356.64977247, 392353667.46000683, 1391187742.8570886, 1314802281.1768336, 1393229744.8853536, 1337998771.5366654, 1391992258.7877572, 1325840903.643888, 1354757452.097857, 1366679884.6286933, 1360356315.3678472, 1273684675.21474, 1247649550.9269893, 1271283125.5329716, 1307059832.5450013, 1288320912.5135307, 1397124117.9433696, 1365721197.373594, 1394927826.268879, 1351306834.4780915, 1381644711.7276735, 1373769278.4562547, 1332743394.2139592, 1302217118.9707434, 1349387713.3935127, 1327477723.8904855, 1396947462.9677281, 1414532921.1196146, 1405176108.0661402, 1364577510.1423254, 1390259404.7584767, 1377252005.4395201, 1461182803.872161, 1459385215.675445, 1428984094.6149988, 1438283799.688725, 1432742088.864584, 1435399496.0933766, 1424674068.219588, 1416599297.7464724, 1403414567.676642, 1470629556.339248, 1465051172.358562, 1453440332.8267643, 1445279192.2978184, 1485551196.968013, 1443220749.8862407, 1465336799.691238, 1477572739.2496378, 1438899802.5271692, 1458918654.7121944, 1453783653.8582017, 1480167440.6062896, 1494253316.256001, 1448221244.5153067, 1472477681.3362384, 1419185788.884394, 1417556251.9384456, 1424162713.5988815, 1421409949.3266037, 1580211893.6939454, 1563921650.1136513, 1575990371.0970614, 1554269192.8174984, 1572883098.7822948, 1566231225.1031098, 1541097662.6087701, 1523692956.6306982, 1553324772.044537, 1540098433.6108687, 1586844472.7429721, 1578898702.284677, 1583829339.2521667, 1572118010.914922, 1583265647.6293418, 1578555855.0011666, 1567841888.0447617, 1555767494.4842246, 1573752695.6684513, 1564522839.336811, 1587077209.2349796, 1589623895.961299, 1588402943.792136, 1579203364.0609071, 1585206150.4872832, 1582389645.4222655, 1593086932.4847982, 1593096755.2985768, 1593089425.957207, 1591629490.5126715, 1592236099.338833, 1591932334.1426463, 1591625768.8867025, 1590705623.227748, 1589648151.1731875, 1587632842.6143456, 1593191288.81571, 1593138756.499885, 1592800894.5741854, 1592529425.107357, 1593193988.3283095, 1589959264.904516, 1592385098.383852, 1593195098.4002492, 1590860913.9581726, 1592609902.911185, 1593204227.0960622, 1588934977.148114, 1592144978.956268, 1585907465.9886444, 1587940643.3968463, 1583556310.4062634, 1221163299.352021, 1360421426.9704986, 1199380883.2675617, 1310025844.339627, 1209261002.8716655, 1334782768.0951343, 1296551562.7820387, 1257999249.619938, 1276413451.1466134, 1414546965.916225, 1356127918.5042295, 1385322951.87896, 1185909629.4380662, 1265285955.402028, 1191620953.6607563, 1286745203.1737118, 1227233062.4645598, 1241551937.4882786, 1300373560.7171779, 1327618219.242798, 1197413472.561471, 1237026142.1468499, 1230924257.2723033, 1267962640.4696424, 1165374297.3544831, 1208139423.4542322, 1108017469.5304737, 1154532971.944067, 1147345630.1866677, 1190818445.9655826, 1068442738.5601672, 1118941292.0554044, 1063158551.1810062, 985318482.7116894, 1084896328.3049474, 1027411014.6501446, 1027678976.5314869, 903088351.408114, 1043667945.8551971, 943195262.6297423, 1134505056.1890008, 1139788579.5315077, 1132544495.0846608, 1131941096.6530542, 1383026020.960263, 1432053695.965333, 1386990004.294995, 1442944951.1310656, 1408482161.940108, 1416246916.5457807, 1453784543.2284963, 1467150632.9741495, 1375763711.9019816, 1410231046.307559, 1379287884.7974885, 1421143925.4893146, 1393424066.9781492, 1400874223.9118934, 1426203199.4991155, 1440123472.899905, 1374625525.746983, 1391027069.9016159, 1392720725.5222704, 1408890214.157337, 1355974255.9077349, 1372639963.1643126, 1339850271.6578465, 1357574714.3485794, 1358120500.3721142, 1375803418.2919939, 1320983518.1376226, 1338765995.8848681, 1327007749.0674374, 1296406279.5226116, 1333364945.6676347, 1308770004.176252, 1320805219.4306808, 1283902195.3100998, 1355895462.4044445, 1356884807.5918632, 1355176063.7138193, 1569942819.0250845, 1589235991.187475, 1576479595.6125946, 1589763686.5754926, 1573296195.3728492, 1589406440.4303327, 1580962901.2234333, 1584114923.0258749, 1582523356.739566, 1594862277.9377224, 1595805433.0717428, 1594581118.476478, 1593363057.786957, 1593851170.3031683, 1582199213.5056062, 1590802633.636161, 1579456283.9248931, 1590245487.9620495, 1587209381.3248458, 1585690125.8218234, 1593810419.3268206, 1594224821.2252588, 1592995473.9942229, 1593106157.2687106, 1593089182.3519664, 1588757642.4223325, 1592007088.931525, 1593383555.7387779, 1589745732.4246035, 1592430640.4998837, 1593024872.0061817, 1587863422.8561192, 1591748630.353121, 1575491868.9053755, 1583278850.7126074, 1578980655.149095, 1585276577.2379954, 1571768284.9973269, 1581245711.856174, 1560532938.785842, 1551190740.7133439, 1568618999.5975158, 1562414821.6597984, 1540586374.7726264, 1522834458.0189812, 1551201972.9872763, 1538027628.8344338, 1569000396.9936936, 1574320370.8334656, 1556394939.7007732, 1563023014.2607718, 1556643952.293712, 1525024863.0772045, 1563659853.285355, 1532901403.9977667, 1541877539.959795, 1549371004.2955618, 1506193239.2515936, 1514448160.4934945, 1540462425.283367, 1509152751.4682503, 1548905974.586799, 1517071297.0700195, 1525701737.7047548, 1533969892.0129824, 1490793716.4489613, 1498248833.1306002, 1515248047.5277834, 1490251075.8864083, 1511739165.2279139, 1489840708.7356539, 1519693299.7290487, 1492151105.7290235, 1554117481.7359815, 1536457622.224487, 1547314566.6632533, 1530856794.0530858, 1560809789.1433306, 1542461233.9629085, 1576011018.6439774, 1583872669.5776405, 1566194615.1298738, 1573976706.4037151, 1583657447.8043363, 1590671881.820237, 1566894613.6008492, 1557808334.9258258, 1574602510.911975, 1179223633.8160424, 1032307030.9615124, 1199986780.4344444, 1027894138.8888066, 1110488703.033051, 1120431118.3753352, 942636590.6247362, 919363634.7299042, 1140674891.3064065, 1054267265.6789153, 1159297842.4155424, 1041129647.9895886, 1098870551.0067914, 1103181463.1464262, 1006715142.0183836, 972136696.0391465, 1162940788.601776, 1120672061.7478926, 1110419948.6649065, 1065003358.5906446, 1211804344.9122918, 1173308495.5450466, 1244507078.4710047, 1204470769.9608157, 1195106974.7638214, 1153898714.1150973, 1289356033.512492, 1250887248.8417037, 1303743989.6950023, 1354813171.6058466, 1274201334.9258215, 1322565016.4409018, 1332638363.8912551, 1385587711.2972147, 1245509215.4336734, 1220001831.7937462, 1271148494.5332253, 1709859197.5105574, 1760226401.6928687, 1724849137.5024893, 1761100740.719798, 1717643811.2147713, 1760913989.2699146, 1739851635.2685404, 1746326899.6655111, 1743301607.680251, 1775338146.7888355, 1772083847.5548756, 1774372110.8329158, 1771739848.3106306, 1769579536.197613, 1771089356.377615, 1737097541.6973896, 1759822526.578357, 1731366192.1772695, 1760749882.6550522, 1750790078.8694313, 1748847471.7143033, 1764827279.2116725, 1768866191.6814446, 1764393281.1819236, 1767339146.4575744, 1751503560.9008148, 1745133331.5822356, 1751816683.5819483, 1758944038.5646205, 1752962613.8700747, 1758652917.6934628, 1727403048.8408265, 1736265061.6938014, 1743452124.5387824, 1736539799.1387224, 1744235164.270764, 1711254971.8809447, 1731624383.3384125, 1724974558.6062217, 1741787052.898727, 1679245007.5433533, 1708325322.6661742, 1695990643.8476236, 1720419183.316441, 1592605450.5778892, 1670485953.2157683, 1634694440.456858, 1640508207.9218967, 1692626881.3514535, 1668297688.7968345, 1616785960.5625107, 1551262715.2195413, 1536016407.8967466, 1645082639.058497, 1595563412.7145998, 1700423537.5210307, 1713617159.4463735, 1669178993.8865716, 1685554313.858359, 780872540.8868456, 950992180.1282493, 757718046.1887848, 947466838.5478919, 869574528.2278075, 856851655.7511377, 1026320838.9267135, 1030455676.5156716, 847764386.2930113, 976929495.0308385, 811246901.8838099, 960466905.1081063, 914222159.5683568, 888322089.5876731, 1036173088.2362859, 1027758054.3093517, 991515823.8535918, 1059825050.3474134, 980285488.9175388, 1043414261.6655272, 1011545835.504209, 1085943888.7963066, 832891129.8898317, 916334553.712488, 838175147.8826352, 912057460.1324414, 833551305.4623336, 927973883.8254982, 653358630.6783726, 597118318.0340394, 745223330.8325337, 723020602.1963679, 565117470.9984535, 451357048.86575675, 717831727.847709, 776056144.9020184, 663485010.2154895, 1602967943.241522, 1667269976.961481, 1644703765.382753, 1702787877.9877267, 1638027130.1216514, 1677673062.247476, 1690410060.1025426, 1719715349.2275085, 1495023304.8934395, 1558331921.698581, 1553305970.312347, 1619563708.0602856, 1527744359.8250558, 1588371083.09718, 1586513402.971347, 1646547553.345042, 1415860440.5395415, 1420943597.209304, 1493293830.333875, 1513014162.7839339, 1324701507.254958, 1307681162.6986632, 1409971940.6925156, 1412240544.1088645, 1454294466.375767, 1473688041.1270761, 1361928854.8890734, 1342876678.8824508, 1510874909.5114846, 1455685238.9595292, 1462963962.0270875, 1410536264.4684613, 1553985225.6191502, 1497479583.8952749, 1560003251.1508677, 1510542483.3560147, 1603148021.0835493]

    @classmethod
    def tearDownClass(self):
        pass

    @classmethod
    def model(self, solver, matrix_solver=""):
        problem = agros.problem(clear = True)
        problem.coordinate_type = "axisymmetric"
        problem.mesh_type = "triangle"

        electrostatic = problem.field("electrostatic")
        electrostatic.analysis_type = "steadystate"
        electrostatic.matrix_solver = solver
        electrostatic.number_of_refinements = 1
        electrostatic.polynomial_order = 2
        electrostatic.adaptivity_type = "disabled"
        electrostatic.solver = "linear"

        electrostatic.matrix_solver_parameters['external_solver'] = matrix_solver

        electrostatic.add_boundary("Source", "electrostatic_potential", {"electrostatic_potential" : 1e9})
        electrostatic.add_boundary("Ground", "electrostatic_potential", {"electrostatic_potential" : 0})
        electrostatic.add_boundary("Neumann", "electrostatic_surface_charge_density", {"electrostatic_surface_charge_density" : 0})
        electrostatic.add_material("Air", {"electrostatic_permittivity" : 1, "electrostatic_charge_density" : 1})
        electrostatic.add_material("Dielectric 1", {"electrostatic_permittivity" : 3, "electrostatic_charge_density" : 20})
        electrostatic.add_material("Dielectric 2", {"electrostatic_permittivity" : 4, "electrostatic_charge_density" : 30})

        geometry = problem.geometry()
        geometry.add_edge(0, 0.2, 0, 0.08, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.01, 0.08, 0.01, 0, boundaries = {"electrostatic" : "Source"})
        geometry.add_edge(0.01, 0, 0.03, 0, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.03, 0, 0.03, 0.08)
        geometry.add_edge(0.03, 0.08, 0.05, 0.08)
        geometry.add_edge(0.05, 0, 0.03, 0, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.05, 0.08, 0.05, 0, boundaries = {"electrostatic" : "Ground"})
        geometry.add_edge(0.06, 0, 0.06, 0.08, boundaries = {"electrostatic" : "Ground"})
        geometry.add_edge(0.05, 0.08, 0.06, 0.08, boundaries = {"electrostatic" : "Ground"})
        geometry.add_edge(0.06, 0, 0.2, 0, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.2, 0, 0, 0.2, angle = 90, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.01, 0.08, 0.03, 0.08)
        geometry.add_edge(0.01, 0.08, 0, 0.08, boundaries = {"electrostatic" : "Source"})

        geometry.add_label(0.019, 0.021, materials = {"electrostatic" : "Dielectric 1"})
        geometry.add_label(0.0379, 0.051, materials = {"electrostatic" : "Dielectric 2"})
        geometry.add_label(0.0284191, 0.123601, materials = {"electrostatic" : "Air"})

        computation = problem.computation()
        computation.solve()
        solution = computation.solution("electrostatic")

        return solution.solution()


class TestMatrixSolversInternal(TestMatrixSolversGeneral):
    def setUp(self):
        self.setUpGeneral()

    def tearDown(self):
        self.tearDownClass()

    def test_dealii(self):
        # deal.II
        sln = self.model("dealii")
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "dealii sln failed.")


class TestMatrixSolversExternalMUMPS(TestMatrixSolversGeneral):
    def setUp(self):
        self.setUpGeneral()

    def tearDown(self):
        self.tearDownClass()

    def test_external_mumps(self):
        # MUMPS
        sln = self.model("external_plugin", "MUMPS")
        # print(len(self.reference_sln))
        # print(len(sln))
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "MUMPS (external) sln failed.")

class TestMatrixSolversExternalAMGCL(TestMatrixSolversGeneral):
    def setUp(self):
        self.setUpGeneral()

    def tearDown(self):
        self.tearDownClass()

    def test_external_amgcl(self):
        # AMGCL
        sln = self.model("external_plugin", "AMGCL")
        # print(len(self.reference_sln))
        # print(len(sln))
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "AMGCL (external) sln failed.")
