{
  "version": "1.0.0",
  "created": "2026-01-25",
  "description": "Vulnerability embeddings database for MIESC RAG system",
  "sources": [
    "SWC Registry (Smart Contract Weakness Classification)",
    "Damn Vulnerable DeFi",
    "Real-world audit examples"
  ],
  "categories": [
    {
      "id": "reentrancy",
      "name": "Reentrancy",
      "swc_id": "SWC-107",
      "cwe_id": "CWE-841",
      "description": "Calling external contracts before updating state",
      "keywords": ["call", "external", "callback", "fallback", "state", "balance"],
      "severity": "critical",
      "exploits": ["The DAO Hack ($60M, 2016)"]
    },
    {
      "id": "access-control",
      "name": "Access Control",
      "swc_id": "SWC-105",
      "cwe_id": "CWE-284",
      "description": "Missing or insufficient access controls",
      "keywords": ["owner", "admin", "onlyOwner", "modifier", "authorization"],
      "severity": "critical",
      "exploits": ["Parity Multisig ($150M, 2017)"]
    },
    {
      "id": "integer-overflow",
      "name": "Integer Overflow/Underflow",
      "swc_id": "SWC-101",
      "cwe_id": "CWE-190",
      "description": "Arithmetic operations exceeding type bounds",
      "keywords": ["overflow", "underflow", "SafeMath", "unchecked", "arithmetic"],
      "severity": "high",
      "exploits": ["BEC Token ($900M theoretical, 2018)"]
    },
    {
      "id": "flash-loan",
      "name": "Flash Loan Attack",
      "swc_id": "SWC-133",
      "cwe_id": null,
      "description": "Manipulation using borrowed funds within single transaction",
      "keywords": ["flashLoan", "reserves", "price", "TWAP", "oracle", "manipulation"],
      "severity": "critical",
      "exploits": ["bZx ($8M, 2020)", "Harvest Finance ($34M, 2020)", "Warp Finance ($7.7M, 2020)"]
    },
    {
      "id": "governance",
      "name": "Governance Attack",
      "swc_id": null,
      "cwe_id": "CWE-284",
      "description": "Flash loan voting or governance manipulation",
      "keywords": ["vote", "governance", "proposal", "quorum", "timelock", "delegate"],
      "severity": "critical",
      "exploits": ["Beanstalk ($182M, 2022)", "Build Finance ($470K, 2022)"]
    },
    {
      "id": "oracle-manipulation",
      "name": "Oracle Manipulation",
      "swc_id": "SWC-133",
      "cwe_id": null,
      "description": "Price oracle manipulation or stale data usage",
      "keywords": ["oracle", "price", "latestRoundData", "TWAP", "Chainlink", "spot"],
      "severity": "critical",
      "exploits": ["Mango Markets ($114M, 2022)", "Cream Finance ($130M, 2021)"]
    },
    {
      "id": "bridge",
      "name": "Bridge Vulnerability",
      "swc_id": null,
      "cwe_id": "CWE-347",
      "description": "Cross-chain message validation issues",
      "keywords": ["bridge", "cross-chain", "signature", "replay", "nonce", "message"],
      "severity": "critical",
      "exploits": ["Ronin ($624M, 2022)", "Wormhole ($326M, 2022)", "Nomad ($190M, 2022)"]
    },
    {
      "id": "delegatecall",
      "name": "Delegatecall Injection",
      "swc_id": "SWC-112",
      "cwe_id": "CWE-829",
      "description": "Arbitrary delegatecall to untrusted contracts",
      "keywords": ["delegatecall", "proxy", "storage", "context", "implementation"],
      "severity": "critical",
      "exploits": ["Parity Wallet ($30M, 2017)"]
    },
    {
      "id": "unchecked-call",
      "name": "Unchecked Return Value",
      "swc_id": "SWC-104",
      "cwe_id": "CWE-252",
      "description": "Not checking return values of external calls",
      "keywords": ["call", "send", "transfer", "return", "success", "SafeERC20"],
      "severity": "medium"
    },
    {
      "id": "tx-origin",
      "name": "tx.origin Authorization",
      "swc_id": "SWC-115",
      "cwe_id": "CWE-477",
      "description": "Using tx.origin for authorization",
      "keywords": ["tx.origin", "msg.sender", "phishing", "authorization"],
      "severity": "high"
    },
    {
      "id": "timestamp",
      "name": "Timestamp Dependence",
      "swc_id": "SWC-116",
      "cwe_id": "CWE-829",
      "description": "Using block timestamp for critical logic",
      "keywords": ["block.timestamp", "now", "deadline", "randomness", "miner"],
      "severity": "medium"
    },
    {
      "id": "selfdestruct",
      "name": "Unprotected Selfdestruct",
      "swc_id": "SWC-106",
      "cwe_id": "CWE-284",
      "description": "Selfdestruct without access control",
      "keywords": ["selfdestruct", "suicide", "destroy", "kill"],
      "severity": "critical",
      "exploits": ["Parity Kill Bug ($150M frozen, 2017)"]
    }
  ],
  "patterns": {
    "reentrancy": {
      "vulnerable": [
        "msg.sender.call{value:",
        "(bool success,) = ",
        "payable(msg.sender).call",
        "AFTER external call"
      ],
      "safe": [
        "nonReentrant",
        "ReentrancyGuard",
        "BEFORE external call",
        "locked = true"
      ]
    },
    "access-control": {
      "vulnerable": [
        "function.*public",
        "function.*external",
        "no modifier"
      ],
      "safe": [
        "onlyOwner",
        "onlyRole",
        "AccessControl",
        "Ownable"
      ]
    },
    "flash-loan": {
      "vulnerable": [
        "getReserves()",
        "slot0()",
        "reserve0 / reserve1",
        "balanceOf(address(this))"
      ],
      "safe": [
        "TWAP",
        "observe(",
        "consult(",
        "latestRoundData",
        "AggregatorV3"
      ]
    }
  },
  "defi_protocols": [
    {
      "name": "Uniswap V2",
      "type": "AMM",
      "patterns": ["getReserves", "swap", "addLiquidity", "removeLiquidity"]
    },
    {
      "name": "Uniswap V3",
      "type": "Concentrated AMM",
      "patterns": ["slot0", "observe", "positions", "swap"]
    },
    {
      "name": "Aave",
      "type": "Lending",
      "patterns": ["deposit", "borrow", "repay", "liquidate", "flashLoan"]
    },
    {
      "name": "Compound",
      "type": "Lending",
      "patterns": ["mint", "redeem", "borrow", "repayBorrow", "liquidateBorrow"]
    },
    {
      "name": "OpenZeppelin Governor",
      "type": "Governance",
      "patterns": ["propose", "castVote", "queue", "execute", "cancel"]
    }
  ]
}
