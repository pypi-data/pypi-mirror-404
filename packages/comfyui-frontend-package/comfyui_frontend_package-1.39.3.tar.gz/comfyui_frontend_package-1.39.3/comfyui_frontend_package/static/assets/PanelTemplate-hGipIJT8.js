import{i as e,n as t}from"./rolldown-runtime-BKYq3fBv.js";import{C as n,Cr as r,Er as i,Gr as a,Lt as o,Nn as s,Qn as c,Rr as l,Rt as u,Xn as d,Xr as f,Zn as p,ai as m,ar as h,si as g,sr as _,w as v}from"./vendor-primevue-Cg-HmKZY.js";import{fn as y,hn as b}from"./vendor-other-CoxDvJ0a.js";import{n as x,r as S}from"./vendor-vue-J4jYbuLn.js";import{an as C,dn as w,i as T,ln as E,on as D,r as O,un as k}from"./api-CJ30itpV.js";import{n as A,r as j}from"./i18n-gOSvTADh.js";function useExternalLink(){let e=d(()=>String(A.global.locale.value)),t=d(()=>e.value===`zh`||e.value===`zh-TW`),n=d(()=>w()?E().getPlatform()===`darwin`?`macos`:`windows`:null),buildDocsUrl=(e,r={})=>{let{includeLocale:i=!1,platform:a=!1}=r,o=`https://docs.comfy.org`;i&&t.value&&(o+=`/zh-CN`);let s=e.startsWith(`/`)?e:`/${e}`;return o+=s,a&&n.value&&(o=o.endsWith(`/`)?o:`${o}/`,o+=n.value),o};return{buildDocsUrl,staticUrls:{discord:`https://www.comfy.org/discord`,github:`https://github.com/comfyanonymous/ComfyUI`,githubIssues:`https://github.com/comfyanonymous/ComfyUI/issues`,githubFrontend:`https://github.com/Comfy-Org/ComfyUI_frontend`,githubElectron:`https://github.com/Comfy-Org/electron`,forum:`https://forum.comfy.org/`,comfyOrg:`https://www.comfy.org/`},docsPaths:{partnerNodesPricing:`/tutorials/partner-nodes/pricing`}}}var M=t((()=>{s(),k(),j()})),N,P=t((()=>{y(),S(),C(),T(),k(),N=x(`systemStats`,()=>{let fetchSystemStatsData=async()=>{try{return await O.getSystemStats()}catch(e){throw console.error(`Error fetching system stats:`,e),e}},{state:e,isLoading:t,error:n,isReady:r,execute:i}=b(fetchSystemStatsData,null,{immediate:!0});function getFormFactor(){if(D)return`cloud`;if(!e.value?.system?.os)return`other`;let t=e.value.system.os.toLowerCase();if(w()){if(t.includes(`windows`))return`desktop-windows`;if(t.includes(`darwin`)||t.includes(`mac`))return`desktop-mac`}else{if(t.includes(`windows`))return`git-windows`;if(t.includes(`darwin`)||t.includes(`mac`))return`git-mac`;if(t.includes(`linux`))return`git-linux`}return`other`}return{systemStats:e,isLoading:t,error:n,isInitialized:r,refetchSystemStats:i,getFormFactor}})}));function appendJsonExt(e){return e.toLowerCase().endsWith(`.json`)||(e+=`.json`),e}function highlightQuery(e,t){if(!t)return e;let n=t.replace(/[.*+?^${}()|[\]\\]/g,`\\$&`),r=RegExp(`(${n})`,`gi`);return e.replace(r,`<span class="highlight">$1</span>`)}function formatNumberWithSuffix(e,{precision:t=1,roundToInt:n=!1}={}){let r=[``,`k`,`m`,`b`,`t`],i=Math.abs(e);if(i<1e3)return n?Math.round(e).toString():e.toFixed(t);let a=Math.min(Math.floor(Math.log10(i)/3),r.length-1);return`${(e/1e3**a).toFixed(t)}${r[a]}`}function formatSize(e){if(e==null)return`-`;let t=e;if(t===0)return`0 B`;let n=1024,r=[`B`,`KB`,`MB`,`GB`],i=Math.floor(Math.log(t)/Math.log(n));return`${parseFloat((t/n**+i).toFixed(2))} ${r[i]}`}function formatCommitHash(e){return/^[a-f0-9]{40}$/i.test(e)?e.slice(0,7):e}function getFilenameDetails(e){return e.includes(`.`)?{filename:e.split(`.`).slice(0,-1).join(`.`),suffix:e.split(`.`).pop()??null}:{filename:e,suffix:null}}function getPathDetails(e){let t=e.split(`/`).slice(0,-1).join(`/`),n=e.split(`/`).pop()??e;return{directory:t,fullFilename:n,...getFilenameDetails(n)}}function normalizeI18nKey(e){return typeof e==`string`?e.replace(/\./g,`_`):``}function processDynamicPrompt(e){function stripComments(e){return e.replace(/\/\*[\s\S]*?\*\/|\/\/.*/g,``)}let t=0,n=``;e=stripComments(e);let handleEscape=()=>`\\`+e[t++];function parseChoiceBlock(){let n=[],r=``,i=0;for(;t<e.length;){let a=e[t++];if(a===`\\`){r+=handleEscape();continue}else if(a===`{`)i++;else if(a===`}`){if(!i)break;i--}else if(a===`|`&&!i){n.push(r),r=``;continue}r+=a}n.push(r);let a=n[Math.floor(Math.random()*n.length)];return processDynamicPrompt(a)}for(;t<e.length;){let r=e[t++];r===`\\`?n+=handleEscape():r===`{`?n+=parseChoiceBlock():n+=r}return n.replace(/\\([{}|])/g,`$1`)}function isValidUrl(e){try{return new URL(e),!0}catch{return!1}}function parseFilePath(e){if(!e?.trim())return{filename:``,subfolder:``};let t=e.replace(/[\\/]+/g,`/`).replace(/^\//,``).replace(/\/$/,``),n=t.lastIndexOf(`/`);return n===-1?{filename:t,subfolder:``}:{filename:t.slice(n+1),subfolder:t.slice(0,n)}}function formatDate(e,t){return e.replace(new RegExp(I,`g`),e=>e===`yy`?(t.getFullYear()+``).substring(2):e===`yyyy`?t.getFullYear().toString():e[0]in F?(F[e[0]](t)+``).padStart(e.length,`0`):e)}function formatMetronomeCurrency(e,t){return t===`usd`?(e/100).toFixed(2):e.toString()}function usdToMicros(e){return Math.round(e*1e6)}function linkifyHtml(e){return e?e.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%?=~_|])|(\bwww\.[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%?=~_|])/gi,(e,t,n,r)=>{let i=t||r;return`<a href="${r?`http://${i}`:i}" target="_blank" rel="noopener noreferrer" class="text-primary-400 hover:underline">${i}</a>`}):``}function nl2br(e){return e?e.replace(/\n/g,`<br />`):``}function formatVersionAnchor(e){return`v${e.replace(/\./g,`-`)}`}function stringToLocale(e){return[`en`,`es`,`fr`,`ja`,`ko`,`ru`,`zh`].includes(e)?e:`en`}function formatDuration(e){if(!e||e<0)return`0s`;let t=Math.floor(e/1e3),n=Math.floor(t/3600),r=Math.floor(t%3600/60),i=Math.floor(t%60),a=[];return n>0&&a.push(`${n}h`),r>0&&a.push(`${r}m`),(i>0||a.length===0)&&a.push(`${i}s`),a.join(` `)}function truncateFilename(e,t=20){if(!e||e.length<=t)return e;let n=e.lastIndexOf(`.`),r=n>-1?e.substring(0,n):e,i=n>-1?e.substring(n):``;if(r.length<=t)return e;let a=Math.floor((t-3)/2);return`${r.substring(0,a)}...${r.substring(r.length-a)}${i}`}function getMediaTypeFromFilename(e){if(!e)return`image`;let t=e.split(`.`).pop()?.toLowerCase();return!t||L.includes(t)?`image`:R.includes(t)?`video`:z.includes(t)?`audio`:B.includes(t)?`3D`:`image`}var F,I,paramsToCacheKey,generateUUID,isCivitaiModelUrl,downloadUrlToHfRepoUrl,L,R,z,B,V=t((()=>{F={d:e=>e.getDate(),M:e=>e.getMonth()+1,h:e=>e.getHours(),m:e=>e.getMinutes(),s:e=>e.getSeconds()},I=Object.keys(F).map(e=>e+e+`?`).join(`|`)+`|yyy?y?`,paramsToCacheKey=e=>typeof e==`string`?e:typeof e==`object`&&e?Object.keys(e).sort((e,t)=>e.localeCompare(t)).map(t=>`${t}:${e[t]}`).join(`&`):String(e),generateUUID=()=>typeof crypto<`u`&&typeof crypto.randomUUID==`function`?crypto.randomUUID():`xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx`.replace(/[xy]/g,e=>{let t=Math.random()*16|0;return(e===`x`?t:t&3|8).toString(16)}),isCivitaiModelUrl=e=>{if(!isValidUrl(e)||!e.includes(`civitai.com`))return!1;let t=new URL(e).pathname;return/^\/api\/download\/models\/(\d+)$/.test(t)||/^\/api\/v1\/models\/(\d+)$/.test(t)||/^\/api\/v1\/models-versions\/(\d+)$/.test(t)},downloadUrlToHfRepoUrl=e=>{try{let t=new URL(e).pathname;return`https://huggingface.co/${/^(.*?)(?:\/resolve\/|\/blob\/|$)/.exec(t)?.[1]?.replace(/^\//,``)||``}`}catch{return e}},L=[`png`,`jpg`,`jpeg`,`gif`,`webp`,`bmp`],R=[`mp4`,`webm`,`mov`,`avi`],z=[`mp3`,`wav`,`ogg`,`flac`],B=[`obj`,`fbx`,`gltf`,`glb`]})),H,U,W,G=t((()=>{S(),s(),H=[],U=[`pysssss.Locking`,`pysssss.SnapToGrid`,`pysssss.FaviconStatus`,`KJNodes.browserstatus`],W=x(`extension`,()=>{let e=f({}),t=d(()=>Object.values(e.value)),n=f(new Set),r=d(()=>Array.from(n.value).filter(t=>!(t in e.value))),isExtensionInstalled=t=>t in e.value,isExtensionEnabled=e=>!n.value.has(e),i=d(()=>t.value.filter(e=>isExtensionEnabled(e.name)));function isExtensionReadOnly(e){return U.includes(e)||H.includes(e)}function registerExtension(t){if(!t.name)throw Error(`Extensions must have a 'name' property.`);if(e.value[t.name])throw Error(`Extension named '${t.name}' already registered.`);n.value.has(t.name)&&console.warn(`Extension ${t.name} is disabled.`),e.value[t.name]=a(t)}function loadDisabledExtensionNames(e){n.value=new Set(e);for(let e of U)n.value.add(e);for(let e of H)n.value.delete(e)}let o=f([]);function captureCoreExtensions(){o.value=t.value.map(e=>e.name)}function isCoreExtension(e){return o.value.includes(e)}return{extensions:t,enabledExtensions:i,inactiveDisabledExtensionNames:r,isExtensionInstalled,isExtensionEnabled,isExtensionReadOnly,registerExtension,loadDisabledExtensionNames,captureCoreExtensions,isCoreExtension,hasThirdPartyExtensions:d(()=>t.value.some(e=>!isCoreExtension(e.name)))}})})),K,q,J=t((()=>{s(),o(),n(),K={class:`flex h-full w-full flex-col gap-2`},q=_({__name:`PanelTemplate`,props:{value:{},class:{}},setup(e){let t=e;return(e,n)=>(r(),c(m(v),{value:t.value,class:g([`h-full w-full`,t.class])},{default:l(()=>[p(`div`,K,[i(e.$slots,`header`),h(m(u),{class:`h-0 grow pr-2`},{default:l(()=>[i(e.$slots,`default`)]),_:3}),i(e.$slots,`footer`)])]),_:3},8,[`value`,`class`]))}})})),Y,X=t((()=>{J(),J(),Y=q}));export{usdToMicros as A,nl2br as C,processDynamicPrompt as D,parseFilePath as E,N as M,M as N,stringToLocale as O,useExternalLink as P,linkifyHtml as S,paramsToCacheKey as T,getPathDetails as _,appendJsonExt as a,isCivitaiModelUrl as b,formatDate as c,formatNumberWithSuffix as d,formatSize as f,getMediaTypeFromFilename as g,getFilenameDetails as h,W as i,P as j,truncateFilename as k,formatDuration as l,generateUUID as m,X as n,downloadUrlToHfRepoUrl as o,formatVersionAnchor as p,G as r,formatCommitHash as s,Y as t,formatMetronomeCurrency as u,highlightQuery as v,normalizeI18nKey as w,isValidUrl as x,V as y};
//# sourceMappingURL=PanelTemplate-hGipIJT8.js.map