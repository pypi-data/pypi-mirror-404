import{i as e,n as t}from"./rolldown-runtime-BKYq3fBv.js";import{$n as n,Cr as r,Fr as i,G as a,Gn as o,K as ee,Nn as s,Qt as te,Rr as c,Tr as l,Vn as u,Xn as d,Xr as f,Zn as p,Zt as m,ai as h,ar as g,er as _,ir as v,si as y,sr as b,ui as x,vr as S,zr as ne}from"./vendor-primevue-Cg-HmKZY.js";import{ot as C,st as re}from"./vendor-other-CoxDvJ0a.js";import{an as w,on as ie}from"./api-CJ30itpV.js";import{r as T,s as E}from"./i18n-gOSvTADh.js";import{n as ae,t as D}from"./useErrorHandling-tavTBerX.js";import{n as O,r as k}from"./tailwindUtil-F1kyO01s.js";import{n as A,t as j}from"./Button-YQy7RkKq.js";import{Ao as oe,Eo as M,Fo as se,Mo as N,Po as P,To as F,an as I,in as ce,jo as L,ko as le,zo as ue}from"./dialogService-DvYmp2_F.js";import{n as R,t as z}from"./_plugin-vue_export-helper-Ckv1EJQX.js";import{n as de,t as fe}from"./SubscribeButton-CNO16TVz.js";import{n as pe,t as me}from"./subscriptionCheckoutUtil-PXjozi8b.js";import{n as he,t as ge}from"./CloudBadge-vCjVtcuF.js";var _e=t((()=>{``+new URL(`images/cloud-subscription.webm`,import.meta.url).href})),ve=t((()=>{})),B,toRankedPlanKey,getPlanRank,isPlanDowngrade,ye=t((()=>{B=[`yearly-pro`,`yearly-creator`,`yearly-standard`,`monthly-pro`,`monthly-creator`,`monthly-standard`].reduce((e,t,n)=>e.set(t,n),new Map),toRankedPlanKey=(e,t)=>e===`founder`?null:`${t}-${e}`,getPlanRank=({tierKey:e,billingCycle:t})=>{let n=toRankedPlanKey(e,t);return n?B.get(n)??1/0:1/0},isPlanDowngrade=({current:e,target:t})=>{let n=getPlanRank(e);return getPlanRank(t)>n}})),V,H,U,W,G,K,q,J,Y,X,Z,be,xe,Se,Ce,we,Te,Ee,De,Oe,ke,Ae,je,Me,Ne,Pe,Fe,Ie,Le,Re,ze,Be,Ve,He,Ue,We,Ge,Ke,qe,Je,Ye,Xe,Ze,Qe,$e=t((()=>{s(),k(),m(),a(),C(),A(),le(),D(),T(),L(),ue(),me(),ye(),w(),V={class:`flex flex-col gap-8`},H={class:`flex justify-center`},U={class:`flex items-center gap-2`},W={key:0,class:`bg-primary-background text-white text-[11px] px-1 py-0.5 rounded-full flex items-center font-bold`},G={class:`flex flex-col xl:flex-row items-stretch gap-6`},K={class:`p-8 pb-0 flex flex-col gap-8`},q={class:`flex flex-row items-center gap-2 justify-between`},J={class:`font-inter text-base font-bold leading-normal text-base-foreground`},Y={key:0,class:`rounded-full bg-base-foreground px-1.5 text-[11px] font-bold uppercase text-base-background h-5 tracking-tight flex items-center`},X={class:`flex flex-col`},Z={class:`flex flex-col gap-2`},be={class:`flex flex-row items-baseline gap-2`},xe={class:`font-inter text-[32px] font-semibold leading-normal text-base-foreground`},Se={class:`font-inter text-xl leading-normal text-base-foreground`},Ce={class:`flex items-center gap-2`},we={class:`text-sm text-muted-foreground`},Te={class:`flex flex-col gap-4 pb-0 flex-1`},Ee={class:`flex flex-row items-center justify-between`},De={class:`font-inter text-sm font-normal leading-normal text-foreground`},Oe={class:`flex flex-row items-center gap-1`},ke={class:`font-inter text-sm font-bold leading-normal text-base-foreground`},Ae={class:`flex flex-row items-center justify-between`},je={class:`text-sm font-normal text-foreground`},Me={class:`font-inter text-sm font-bold leading-normal text-base-foreground`},Ne={class:`flex flex-row items-center justify-between`},Pe={class:`text-sm font-normal text-foreground`},Fe={class:`flex flex-row items-center justify-between`},Ie={class:`text-sm font-normal text-foreground`},Le={class:`flex flex-row items-center justify-between`},Re={class:`text-sm font-normal text-foreground`},ze={key:0,class:`pi pi-check text-xs text-success-foreground`},Be={key:1,class:`pi pi-times text-xs text-foreground`},Ve={class:`flex flex-col gap-2`},He={class:`flex flex-row items-start justify-between`},Ue={class:`flex flex-col gap-2`},We={class:`text-sm font-normal text-foreground leading-relaxed`},Ge={class:`flex flex-row items-center gap-2 group pt-2`},Ke={class:`font-inter text-sm font-bold leading-normal text-base-foreground`},qe={class:`flex flex-col p-8`},Je={class:`flex flex-col gap-2`},Ye={class:`text-sm text-base-foreground leading-normal`},Xe={href:`https://cloud.comfy.org/?template=video_wan2_2_14B_fun_camera`,target:`_blank`,rel:`noopener noreferrer`,class:`text-sm text-azure-600 hover:text-azure-400 no-underline flex gap-1`},Ze={class:`underline`},Qe=b({__name:`PricingTable`,setup(e){let getCheckoutTier=(e,t)=>t===`yearly`?`${e}-yearly`:e,t=[{label:E(`subscription.yearly`),value:`yearly`},{label:E(`subscription.monthly`),value:`monthly`}],i=[{id:`STANDARD`,key:`standard`,name:E(`subscription.tiers.standard.name`),pricing:P.standard,maxDuration:E(`subscription.maxDuration.standard`),customLoRAs:!1,isPopular:!1},{id:`CREATOR`,key:`creator`,name:E(`subscription.tiers.creator.name`),pricing:P.creator,maxDuration:E(`subscription.maxDuration.creator`),customLoRAs:!0,isPopular:!0},{id:`PRO`,key:`pro`,name:E(`subscription.tiers.pro.name`),pricing:P.pro,maxDuration:E(`subscription.maxDuration.pro`),customLoRAs:!0,isPopular:!1}],{n:a}=re(),{isActiveSubscription:s,subscriptionTier:m,isYearlySubscription:b}=N(),{accessBillingPortal:S,reportError:C}=oe(),{wrapWithErrorHandlingAsync:w}=ae(),T=f(!1),D=f(null),k=f(),A=f(`yearly`),M=d(()=>m.value?se[m.value]:null),F=d(()=>M.value?{tierKey:M.value,billingCycle:b.value?`yearly`:`monthly`}:null),isCurrentPlan=e=>{if(!M.value)return!1;let t=A.value===`yearly`;return M.value===e&&b.value===t},togglePopover=e=>{k.value.toggle(e)},getButtonLabel=e=>{if(isCurrentPlan(e.key))return E(`subscription.currentPlan`);let t=A.value===`yearly`?E(`subscription.tierNameYearly`,{name:e.name}):e.name;return s.value?E(`subscription.changeTo`,{plan:t}):E(`subscription.subscribeTo`,{plan:t})},getButtonSeverity=e=>isCurrentPlan(e.key)?`secondary`:e.key===`creator`?`primary`:`secondary`,getButtonTextClass=e=>e.key===`creator`?`font-inter text-sm font-bold leading-normal text-base-background`:`font-inter text-sm font-bold leading-normal text-primary-foreground`,getPrice=e=>e.pricing[A.value],getAnnualTotal=e=>e.pricing.yearly*12,getCreditsDisplay=e=>e.pricing.credits*(A.value===`yearly`?12:1),I=w(async e=>{if(!(!ie||T.value||isCurrentPlan(e))){T.value=!0,D.value=e;try{if(s.value){let t=getCheckoutTier(e,A.value),n={tierKey:e,billingCycle:A.value};F.value&&isPlanDowngrade({current:F.value,target:n})?await S():await S(t)}else await pe(e,A.value)}finally{T.value=!1,D.value=null}}},C);return(e,s)=>(r(),_(`div`,V,[p(`div`,H,[g(h(ee),{modelValue:A.value,"onUpdate:modelValue":s[0]||=e=>A.value=e,options:t,"option-label":`label`,"option-value":`value`,"allow-empty":!1,unstyled:``,pt:{root:{class:`flex gap-1 bg-secondary-background rounded-lg p-1.5`},pcToggleButton:{root:({context:e})=>({class:[`w-36  h-8 rounded-md transition-colors cursor-pointer border-none outline-none ring-0 text-sm font-medium flex items-center justify-center`,e.active?`bg-base-foreground text-base-background`:`bg-transparent text-muted-foreground hover:bg-secondary-background-hover`]}),label:{class:`flex items-center gap-2 `}}}},{option:c(({option:e})=>[p(`div`,U,[p(`span`,null,x(e.label),1),e.value===`yearly`?(r(),_(`div`,W,` -20% `)):n(``,!0)])]),_:1},8,[`modelValue`,`pt`])]),p(`div`,G,[(r(),_(o,null,l(i,e=>p(`div`,{key:e.id,class:y(h(O)(`flex-1 flex flex-col rounded-2xl border border-border-default bg-base-background shadow-[0_0_12px_rgba(0,0,0,0.1)]`,e.isPopular?`border-muted-foreground`:``))},[p(`div`,K,[p(`div`,q,[p(`span`,J,x(e.name),1),e.isPopular?(r(),_(`div`,Y,x(h(E)(`subscription.mostPopular`)),1)):n(``,!0)]),p(`div`,X,[p(`div`,Z,[p(`div`,be,[p(`span`,xe,[ne(p(`span`,{class:`line-through text-2xl text-muted-foreground`},` $`+x(e.pricing.monthly),513),[[u,A.value===`yearly`]]),v(` $`+x(getPrice(e)),1)]),p(`span`,Se,x(h(E)(`subscription.usdPerMonth`)),1)]),p(`div`,Ce,[p(`span`,we,x(A.value===`yearly`?h(E)(`subscription.billedYearly`,{total:`$${getAnnualTotal(e)}`}):h(E)(`subscription.billedMonthly`)),1)])])]),p(`div`,Te,[p(`div`,Ee,[p(`span`,De,x(A.value===`yearly`?h(E)(`subscription.yearlyCreditsLabel`):h(E)(`subscription.monthlyCreditsLabel`)),1),p(`div`,Oe,[s[1]||=p(`i`,{class:`icon-[lucide--component] text-amber-400 text-sm`},null,-1),p(`span`,ke,x(h(a)(getCreditsDisplay(e))),1)])]),p(`div`,Ae,[p(`span`,je,x(h(E)(`subscription.maxDurationLabel`)),1),p(`span`,Me,x(e.maxDuration),1)]),p(`div`,Ne,[p(`span`,Pe,x(h(E)(`subscription.gpuLabel`)),1),s[2]||=p(`i`,{class:`pi pi-check text-xs text-success-foreground`},null,-1)]),p(`div`,Fe,[p(`span`,Ie,x(h(E)(`subscription.addCreditsLabel`)),1),s[3]||=p(`i`,{class:`pi pi-check text-xs text-success-foreground`},null,-1)]),p(`div`,Le,[p(`span`,Re,x(h(E)(`subscription.customLoRAsLabel`)),1),e.customLoRAs?(r(),_(`i`,ze)):(r(),_(`i`,Be))]),p(`div`,Ve,[p(`div`,He,[p(`div`,Ue,[p(`span`,We,x(h(E)(`subscription.videoEstimateLabel`)),1),p(`div`,Ge,[s[4]||=p(`i`,{class:`pi pi-question-circle text-xs text-muted-foreground group-hover:text-base-foreground`},null,-1),p(`span`,{class:`text-sm font-normal text-muted-foreground cursor-pointer group-hover:text-base-foreground`,onClick:togglePopover},x(h(E)(`subscription.videoEstimateHelp`)),1)])]),p(`span`,Ke,` ~`+x(h(a)(e.pricing.videoEstimate)),1)])])])]),p(`div`,qe,[g(j,{variant:getButtonSeverity(e),disabled:T.value||isCurrentPlan(e.key),loading:D.value===e.key,class:y(h(O)(`h-10 w-full`,getButtonTextClass(e),e.key===`creator`?`bg-base-foreground border-transparent hover:bg-inverted-background-hover`:`bg-secondary-background border-transparent hover:bg-secondary-background-hover focus:bg-secondary-background-selected`)),onClick:()=>h(I)(e.key)},{default:c(()=>[v(x(getButtonLabel(e)),1)]),_:2},1032,[`variant`,`disabled`,`loading`,`class`,`onClick`])])],2)),64))]),g(h(te),{ref_key:`popover`,ref:k,"append-to":`body`,"auto-z-index":!0,"base-z-index":1e3,dismissable:!0,"close-on-escape":!0,unstyled:``,pt:{root:{class:`rounded-lg border border-interface-stroke bg-interface-panel-surface shadow-lg p-4 max-w-xs`}}},{default:c(()=>[p(`div`,Je,[p(`p`,Ye,x(h(E)(`subscription.videoEstimateExplanation`)),1),p(`a`,Xe,[p(`span`,Ze,x(h(E)(`subscription.videoEstimateTryTemplate`)),1),s[5]||=p(`span`,{class:`no-underline`,innerHTML:`â†’`},null,-1)])])]),_:1},512)]))}})})),et,tt=t((()=>{$e(),$e(),et=Qe}));function _sfc_render(e,t){return r(),_(`div`,rt,[p(`div`,it,[t[0]||=p(`i`,{class:`pi pi-check text-xs text-text-primary`},null,-1),p(`span`,at,x(e.$t(`subscription.benefits.benefit1`)),1)]),p(`div`,ot,[t[1]||=p(`i`,{class:`pi pi-check text-xs text-text-primary`},null,-1),p(`span`,st,x(e.$t(`subscription.benefits.benefit2`)),1)])])}var nt,rt,it,at,ot,st,ct,lt=t((()=>{s(),R(),nt={},rt={class:`flex flex-col items-start gap-0 self-stretch`},it={class:`flex items-center gap-2 py-2`},at={class:`text-sm text-text-primary`},ot={class:`flex items-center gap-2 py-2`},st={class:`text-sm text-text-primary`},ct=z(nt,[[`render`,_sfc_render]])})),ut,dt,ft,pt,mt,ht,gt,_t,vt,yt,bt,Q,xt,St,Ct,wt,Tt,Et,Dt,Ot=t((()=>{s(),_e(),he(),A(),ve(),tt(),de(),lt(),L(),ce(),F(),ut={key:0,class:`relative flex flex-col p-4 pt-8 md:p-16 !overflow-y-auto h-full gap-8`},dt={class:`text-center`},ft={class:`text-xl lg:text-2xl text-muted-foreground m-0`},pt={class:`flex flex-col items-center gap-2`},mt={class:`text-sm text-text-secondary m-0`},ht={class:`flex items-center gap-1.5`},gt={class:`text-sm text-text-secondary`},_t={key:1,class:`legacy-dialog relative grid h-full grid-cols-5`},vt={class:`col-span-3 flex flex-col justify-between p-8`},yt={class:`flex flex-col gap-6`},bt={class:`inline-flex items-center gap-2`},Q={class:`text-sm text-text-primary`},xt={class:`flex items-baseline gap-2`},St={class:`text-4xl font-bold`},Ct={class:`text-xl`},wt={class:`flex flex-col pt-8`},Tt=3e3,Et=3,Dt=b({__name:`SubscriptionRequiredDialogContent`,props:{onClose:{type:Function}},emits:[`close`],setup(e,{emit:t}){let n=e,a=t,{fetchStatus:o,isActiveSubscription:ee,isSubscriptionEnabled:s}=N(),te=new Intl.NumberFormat(navigator.language||`en-US`,{style:`currency`,currency:`USD`,minimumFractionDigits:0,maximumFractionDigits:0}).format(20),l=M(),u=I(),f=d(()=>s()),m=null,y=0,stopPolling=()=>{m&&=(clearInterval(m),null)},startPolling=()=>{stopPolling(),y=0;let poll=async()=>{try{await o(),y++,y>=Et&&stopPolling()}catch(e){console.error(`[SubscriptionDialog] Failed to poll subscription status`,e),stopPolling()}};poll(),m=window.setInterval(()=>{poll()},Tt)},handleWindowFocus=()=>{f.value&&startPolling()};i(f,e=>{e?window.addEventListener(`focus`,handleWindowFocus):(window.removeEventListener(`focus`,handleWindowFocus),stopPolling())},{immediate:!0}),i(()=>ee.value,e=>{e&&f.value&&a(`close`,!0)});let handleSubscribed=()=>{a(`close`,!0)},handleClose=()=>{stopPolling(),n.onClose()},handleContactUs=async()=>{u?.trackHelpResourceClicked({resource_type:`help_feedback`,is_external:!0,source:`subscription`}),await l.execute(`Comfy.ContactSupport`)},handleViewEnterprise=()=>{u?.trackHelpResourceClicked({resource_type:`docs`,is_external:!0,source:`subscription`}),window.open(`https://www.comfy.org/cloud/enterprise`,`_blank`)};return S(()=>{stopPolling(),window.removeEventListener(`focus`,handleWindowFocus)}),(e,t)=>f.value?(r(),_(`div`,ut,[g(j,{size:`icon`,variant:`muted-textonly`,class:`rounded-full shrink-0 text-text-secondary hover:bg-white/10 absolute right-2.5 top-2.5`,"aria-label":e.$t(`g.close`),onClick:handleClose},{default:c(()=>t[0]||=[p(`i`,{class:`pi pi-times text-xl`},null,-1)]),_:1},8,[`aria-label`]),p(`div`,dt,[p(`h2`,ft,x(e.$t(`subscription.description`)),1)]),g(et,{class:`flex-1`}),p(`div`,pt,[p(`p`,mt,x(e.$t(`subscription.haveQuestions`)),1),p(`div`,ht,[g(j,{variant:`muted-textonly`,class:`h-6 p-1 text-sm text-text-secondary hover:text-base-foreground`,onClick:handleContactUs},{default:c(()=>[v(x(e.$t(`subscription.contactUs`))+` `,1),t[1]||=p(`i`,{class:`pi pi-comments`},null,-1)]),_:1}),p(`span`,gt,x(e.$t(`g.or`)),1),g(j,{variant:`muted-textonly`,class:`h-6 p-1 text-sm text-text-secondary hover:text-base-foreground`,onClick:handleViewEnterprise},{default:c(()=>[v(x(e.$t(`subscription.viewEnterprise`))+` `,1),t[2]||=p(`i`,{class:`pi pi-external-link`},null,-1)]),_:1})])])])):(r(),_(`div`,_t,[g(j,{size:`icon`,variant:`muted-textonly`,class:`rounded-full absolute top-2.5 right-2.5 z-10 h-8 w-8 p-0 text-white hover:bg-white/20`,"aria-label":e.$t(`g.close`),onClick:handleClose},{default:c(()=>t[3]||=[p(`i`,{class:`pi pi-times`},null,-1)]),_:1},8,[`aria-label`]),t[4]||=p(`div`,{class:`relative col-span-2 flex items-center justify-center overflow-hidden rounded-sm`},[p(`video`,{autoplay:``,loop:``,muted:``,playsinline:``,class:`h-full min-w-[125%] object-cover p-0`,style:{"margin-left":`-20%`}},[p(`source`,{src:``+new URL(`images/cloud-subscription.webm`,import.meta.url).href,type:`video/webm`})])],-1),p(`div`,vt,[p(`div`,null,[p(`div`,yt,[p(`div`,bt,[p(`div`,Q,x(e.$t(`subscription.required.title`)),1),g(ge,{"reverse-order":``,"no-padding":``,"background-color":`var(--p-dialog-background)`,"use-subscription":``})]),p(`div`,xt,[p(`span`,St,x(h(te)),1),p(`span`,Ct,x(e.$t(`subscription.perMonth`)),1)])]),g(ct,{class:`mt-6 text-muted`})]),p(`div`,wt,[g(fe,{class:`py-2 px-4 rounded-lg`,pt:{root:{style:`background: var(--color-accent-blue, #0B8CE9);`},label:{class:`font-inter font-[700] text-sm`}},onSubscribed:handleSubscribed})])])]))}})})),kt=t((()=>{})),$;t((()=>{Ot(),Ot(),kt(),R(),$=z(Dt,[[`__scopeId`,`data-v-80c6bb1c`]])}))();export{$ as default};
//# sourceMappingURL=SubscriptionRequiredDialogContent-C_VM4mSl.js.map