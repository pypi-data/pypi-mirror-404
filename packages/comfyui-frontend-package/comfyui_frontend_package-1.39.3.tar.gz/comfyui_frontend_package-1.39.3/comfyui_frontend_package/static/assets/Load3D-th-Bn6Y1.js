import{i as e,n as t}from"./rolldown-runtime-BKYq3fBv.js";import{$n as n,Cr as r,Mr as i,Nn as a,Or as o,Qn as s,Rr as c,Un as l,Wr as u,Xn as d,Xr as f,Zn as p,ai as m,ar as h,br as g,er as _,mr as v,si as y,sr as b,ui as x,xr as S,zr as C}from"./vendor-primevue-Cg-HmKZY.js";import{r as ee,s as w}from"./i18n-gOSvTADh.js";import{n as T,t as E}from"./tailwindUtil-F1kyO01s.js";import{n as D,t as O}from"./Button-YQy7RkKq.js";import{$r as k,Jr as A,Qr as j,Sr as M,Yr as N,at as P,ci as te,da as F,ei as I,fo as L,it as ne,li as R,ni as re,oi as z,po as ie,si as B,ua as V,xr as H}from"./dialogService-DvYmp2_F.js";import{n as U,t as W}from"./_plugin-vue_export-helper-Ckv1EJQX.js";import{n as G,t as ae}from"./Load3DControls-CVZJIGKN.js";var K,oe,q,J=t((()=>{a(),M(),z(),K={key:0,class:`pointer-events-none absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm`},oe={class:`rounded-lg border-2 border-dashed border-blue-400 bg-blue-500/20 px-6 py-4 text-lg font-medium text-blue-100`},q=b({__name:`Load3DScene`,props:{initializeLoad3d:{type:Function},cleanup:{type:Function},loading:{type:Boolean},loadingMessage:{},onModelDrop:{type:Function},isPreview:{type:Boolean}},setup(e){let t=e,i=f(null),{isDragging:a,dragMessage:o,handleDragOver:s,handleDragLeave:c,handleDrop:u}=B({onModelDrop:async e=>{t.onModelDrop&&await t.onModelDrop(e)},disabled:d(()=>t.isPreview)});return g(()=>{i.value&&t.initializeLoad3d(i.value)}),S(()=>{t.cleanup()}),(e,t)=>(r(),_(`div`,{ref_key:`container`,ref:i,class:`relative h-full w-full min-h-[200px]`,"data-capture-wheel":`true`,onPointerdown:t[0]||=l(()=>{},[`stop`]),onPointermove:t[1]||=l(()=>{},[`stop`]),onPointerup:t[2]||=l(()=>{},[`stop`]),onMousedown:t[3]||=l(()=>{},[`stop`]),onMousemove:t[4]||=l(()=>{},[`stop`]),onMouseup:t[5]||=l(()=>{},[`stop`]),onContextmenu:t[6]||=l(()=>{},[`stop`,`prevent`]),onDragover:t[7]||=l((...e)=>m(s)&&m(s)(...e),[`prevent`,`stop`]),onDragleave:t[8]||=l((...e)=>m(c)&&m(c)(...e),[`stop`]),onDrop:t[9]||=l((...e)=>m(u)&&m(u)(...e),[`prevent`,`stop`])},[h(H,{loading:e.loading,"loading-message":e.loadingMessage},null,8,[`loading`,`loading-message`]),!e.isPreview&&m(a)?(r(),_(`div`,K,[p(`div`,oe,x(m(o)),1)])):n(``,!0)],544))}})})),Y,se=t((()=>{J(),J(),Y=q})),X,Z,Q,ce,le=t((()=>{a(),D(),E(),X={class:`relative rounded-lg bg-backdrop/30`},Z={class:`flex flex-col gap-2`},Q={key:2,class:`mt-1 text-center text-xs text-base-foreground`},ce=b({__name:`RecordingControls`,props:{hasRecording:{type:Boolean},hasRecordingModifiers:{},isRecording:{type:Boolean},isRecordingModifiers:{},recordingDuration:{},recordingDurationModifiers:{}},emits:v([`startRecording`,`stopRecording`,`exportRecording`,`clearRecording`],[`update:hasRecording`,`update:isRecording`,`update:recordingDuration`]),setup(e,{emit:t}){let a=i(e,`hasRecording`),l=i(e,`isRecording`),u=i(e,`recordingDuration`),d=t;function toggleRecording(){l.value?d(`stopRecording`):d(`startRecording`)}function handleExportRecording(){d(`exportRecording`)}function handleClearRecording(){d(`clearRecording`)}function formatDuration(e){let t=Math.floor(e/60),n=Math.floor(e%60);return`${t.toString().padStart(2,`0`)}:${n.toString().padStart(2,`0`)}`}return(e,t)=>{let i=o(`tooltip`);return r(),_(`div`,X,[p(`div`,Z,[C((r(),s(O,{size:`icon`,variant:`textonly`,class:y(m(T)(`rounded-full`,l.value&&`text-red-500 recording-button-blink`)),"aria-label":l.value?e.$t(`load3d.stopRecording`):e.$t(`load3d.startRecording`),onClick:toggleRecording},{default:c(()=>[p(`i`,{class:y([`pi`,l.value?`pi-circle-fill`:`pi-video`,`text-lg text-base-foreground`])},null,2)]),_:1},8,[`class`,`aria-label`])),[[i,{value:l.value?e.$t(`load3d.stopRecording`):e.$t(`load3d.startRecording`),showDelay:300},void 0,{right:!0}]]),a.value&&!l.value?C((r(),s(O,{key:0,size:`icon`,variant:`textonly`,class:`rounded-full`,"aria-label":e.$t(`load3d.exportRecording`),onClick:handleExportRecording},{default:c(()=>t[0]||=[p(`i`,{class:`pi pi-download text-lg text-base-foreground`},null,-1)]),_:1},8,[`aria-label`])),[[i,{value:e.$t(`load3d.exportRecording`),showDelay:300},void 0,{right:!0}]]):n(``,!0),a.value&&!l.value?C((r(),s(O,{key:1,size:`icon`,variant:`textonly`,class:`rounded-full`,"aria-label":e.$t(`load3d.clearRecording`),onClick:handleClearRecording},{default:c(()=>t[1]||=[p(`i`,{class:`pi pi-trash text-lg text-base-foreground`},null,-1)]),_:1},8,[`aria-label`])),[[i,{value:e.$t(`load3d.clearRecording`),showDelay:300},void 0,{right:!0}]]):n(``,!0),u.value&&u.value>0&&!l.value?(r(),_(`div`,Q,x(formatDuration(u.value)),1)):n(``,!0)])])}}})})),ue=t((()=>{})),de,fe=t((()=>{le(),le(),ue(),U(),de=W(ce,[[`__scopeId`,`data-v-24c77a32`]])})),pe,$,me,he=t((()=>{a(),N(),D(),ee(),j(),V(),pe={class:`relative rounded-lg bg-backdrop/30`},$={class:`flex flex-col gap-2`},me=b({__name:`ViewerControls`,props:{node:{}},setup(e){let openIn3DViewer=()=>{let t={node:e.node};F().showDialog({key:`global-load3d-viewer`,title:w(`load3d.viewer.title`),component:A,props:t,dialogComponentProps:{style:`width: 80vw; height: 80vh;`,maximizable:!0,onClose:async()=>{await k().handleViewerClose(t.node)}}})};return(e,t)=>{let n=o(`tooltip`);return r(),_(`div`,pe,[p(`div`,$,[C((r(),s(O,{size:`icon`,variant:`textonly`,class:`rounded-full`,"aria-label":m(w)(`load3d.openIn3DViewer`),onClick:openIn3DViewer},{default:c(()=>t[0]||=[p(`i`,{class:`pi pi-expand text-lg text-base-foreground`},null,-1)]),_:1},8,[`aria-label`])),[[n,{value:m(w)(`load3d.openIn3DViewer`),showDelay:300},void 0,{right:!0}]])])])}}})})),ge,_e=t((()=>{he(),he(),ge=me})),ve,ye,be,xe=t((()=>{a(),G(),se(),R(),fe(),_e(),I(),L(),P(),ve={class:`pointer-events-none absolute top-0 left-0 size-full`},ye={key:1,class:`pointer-events-auto absolute top-12 right-2 z-20`},be=b({__name:`Load3D`,props:{widget:{},nodeId:{}},setup(e){let t=e;function isComponentWidget(e){return`node`in e&&e.node!==void 0}let i=f(null);isComponentWidget(t.widget)?i.value=t.widget.node:t.nodeId&&g(()=>{i.value=ne.rootGraph?.getNodeById(t.nodeId)||null});let{sceneConfig:a,modelConfig:o,cameraConfig:c,lightConfig:v,isRecording:b,isPreview:x,isSplatModel:S,isPlyModel:C,hasSkeleton:ee,hasRecording:w,recordingDuration:T,animations:E,playing:D,selectedSpeed:O,selectedAnimation:k,animationProgress:A,animationDuration:j,loading:M,loadingMessage:N,initializeLoad3d:P,handleMouseEnter:F,handleMouseLeave:I,handleStartRecording:L,handleStopRecording:R,handleExportRecording:z,handleClearRecording:B,handleSeek:V,handleBackgroundImageUpdate:H,handleExportModel:U,handleModelDrop:W,cleanup:G}=re(i),K=d(()=>ie().get(`Comfy.Load3D.3DViewerEnable`));return(e,t)=>(r(),_(`div`,{class:`relative size-full`,onMouseenter:t[13]||=(...e)=>m(F)&&m(F)(...e),onMouseleave:t[14]||=(...e)=>m(I)&&m(I)(...e),onPointerdown:t[15]||=l(()=>{},[`stop`]),onPointermove:t[16]||=l(()=>{},[`stop`]),onPointerup:t[17]||=l(()=>{},[`stop`])},[i.value?(r(),s(Y,{key:0,"initialize-load3d":m(P),cleanup:m(G),loading:m(M),"loading-message":m(N),"on-model-drop":m(x)?void 0:m(W),"is-preview":m(x)},null,8,[`initialize-load3d`,`cleanup`,`loading`,`loading-message`,`on-model-drop`,`is-preview`])):n(``,!0),p(`div`,ve,[h(ae,{"scene-config":m(a),"onUpdate:sceneConfig":t[0]||=e=>u(a)?a.value=e:null,"model-config":m(o),"onUpdate:modelConfig":t[1]||=e=>u(o)?o.value=e:null,"camera-config":m(c),"onUpdate:cameraConfig":t[2]||=e=>u(c)?c.value=e:null,"light-config":m(v),"onUpdate:lightConfig":t[3]||=e=>u(v)?v.value=e:null,"is-splat-model":m(S),"is-ply-model":m(C),"has-skeleton":m(ee),onUpdateBackgroundImage:m(H),onExportModel:m(U)},null,8,[`scene-config`,`model-config`,`camera-config`,`light-config`,`is-splat-model`,`is-ply-model`,`has-skeleton`,`onUpdateBackgroundImage`,`onExportModel`]),m(E)&&m(E).length>0?(r(),s(te,{key:0,animations:m(E),"onUpdate:animations":t[4]||=e=>u(E)?E.value=e:null,playing:m(D),"onUpdate:playing":t[5]||=e=>u(D)?D.value=e:null,"selected-speed":m(O),"onUpdate:selectedSpeed":t[6]||=e=>u(O)?O.value=e:null,"selected-animation":m(k),"onUpdate:selectedAnimation":t[7]||=e=>u(k)?k.value=e:null,"animation-progress":m(A),"onUpdate:animationProgress":t[8]||=e=>u(A)?A.value=e:null,"animation-duration":m(j),"onUpdate:animationDuration":t[9]||=e=>u(j)?j.value=e:null,onSeek:m(V)},null,8,[`animations`,`playing`,`selected-speed`,`selected-animation`,`animation-progress`,`animation-duration`,`onSeek`])):n(``,!0)]),K.value&&i.value?(r(),_(`div`,ye,[h(ge,{node:i.value},null,8,[`node`])])):n(``,!0),m(x)?n(``,!0):(r(),_(`div`,{key:2,class:y([`pointer-events-auto absolute right-2 z-20`,{"top-12":!K.value,"top-24":K.value}])},[h(de,{"is-recording":m(b),"onUpdate:isRecording":t[10]||=e=>u(b)?b.value=e:null,"has-recording":m(w),"onUpdate:hasRecording":t[11]||=e=>u(w)?w.value=e:null,"recording-duration":m(T),"onUpdate:recordingDuration":t[12]||=e=>u(T)?T.value=e:null,onStartRecording:m(L),onStopRecording:m(R),onExportRecording:m(z),onClearRecording:m(B)},null,8,[`is-recording`,`has-recording`,`recording-duration`,`onStartRecording`,`onStopRecording`,`onExportRecording`,`onClearRecording`])],2))],32))}})})),Se,Ce=t((()=>{xe(),xe(),Se=be}));export{Ce as n,Se as t};
//# sourceMappingURL=Load3D-th-Bn6Y1.js.map