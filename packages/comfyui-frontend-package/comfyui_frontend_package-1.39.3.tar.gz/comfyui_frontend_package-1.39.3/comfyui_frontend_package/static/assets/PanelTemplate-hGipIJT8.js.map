{"version":3,"file":"PanelTemplate-hGipIJT8.js","names":[],"sources":["../../src/composables/useExternalLink.ts","../../src/stores/systemStatsStore.ts","../../packages/shared-frontend-utils/src/formatUtil.ts","../../src/stores/extensionStore.ts","../../src/components/dialog/content/setting/PanelTemplate.vue","../../src/components/dialog/content/setting/PanelTemplate.vue"],"sourcesContent":["import { computed } from 'vue'\n\nimport { electronAPI, isElectron } from '@/utils/envUtil'\nimport { i18n } from '@/i18n'\n\n/**\n * Composable for building docs.comfy.org URLs with automatic locale and platform detection\n *\n * @example\n * ```ts\n * const { buildDocsUrl } = useExternalLink()\n *\n * // Simple usage\n * const changelogUrl = buildDocsUrl('/changelog', { includeLocale: true })\n * // => 'https://docs.comfy.org/zh-CN/changelog' (if Chinese)\n *\n * // With platform detection\n * const desktopUrl = buildDocsUrl('/installation/desktop', {\n *   includeLocale: true,\n *   platform: true\n * })\n * // => 'https://docs.comfy.org/zh-CN/installation/desktop/macos' (if Chinese + macOS)\n * ```\n */\nexport function useExternalLink() {\n  const locale = computed(() => String(i18n.global.locale.value))\n\n  const isChinese = computed(() => {\n    return locale.value === 'zh' || locale.value === 'zh-TW'\n  })\n\n  const platform = computed(() => {\n    if (!isElectron()) {\n      return null\n    }\n\n    const electronPlatform = electronAPI().getPlatform()\n    return electronPlatform === 'darwin' ? 'macos' : 'windows'\n  })\n\n  /**\n   * Build a docs.comfy.org URL with optional locale and platform\n   *\n   * @param path - The path after the domain (e.g., '/installation/desktop')\n   * @param options - Options for building the URL\n   * @param options.includeLocale - Whether to include locale prefix (default: false)\n   * @param options.platform - Whether to include platform suffix (default: false)\n   * @returns The complete docs URL\n   *\n   * @example\n   * ```ts\n   * buildDocsUrl('/changelog') // => 'https://docs.comfy.org/changelog'\n   * buildDocsUrl('/changelog', { includeLocale: true }) // => 'https://docs.comfy.org/zh-CN/changelog' (if Chinese)\n   * buildDocsUrl('/installation/desktop', { includeLocale: true, platform: true })\n   * // => 'https://docs.comfy.org/zh-CN/installation/desktop/macos' (if Chinese + macOS)\n   * ```\n   */\n  const buildDocsUrl = (\n    path: string,\n    options: {\n      includeLocale?: boolean\n      platform?: boolean\n    } = {}\n  ): string => {\n    const { includeLocale = false, platform: includePlatform = false } = options\n\n    let url = 'https://docs.comfy.org'\n\n    if (includeLocale && isChinese.value) {\n      url += '/zh-CN'\n    }\n\n    const normalizedPath = path.startsWith('/') ? path : `/${path}`\n    url += normalizedPath\n\n    if (includePlatform && platform.value) {\n      url = url.endsWith('/') ? url : `${url}/`\n      url += platform.value\n    }\n\n    return url\n  }\n\n  const staticUrls = {\n    // Static external URLs\n    discord: 'https://www.comfy.org/discord',\n    github: 'https://github.com/comfyanonymous/ComfyUI',\n    githubIssues: 'https://github.com/comfyanonymous/ComfyUI/issues',\n    githubFrontend: 'https://github.com/Comfy-Org/ComfyUI_frontend',\n    githubElectron: 'https://github.com/Comfy-Org/electron',\n    forum: 'https://forum.comfy.org/',\n    comfyOrg: 'https://www.comfy.org/'\n  }\n\n  /** Common doc paths for use with buildDocsUrl */\n  const docsPaths = {\n    partnerNodesPricing: '/tutorials/partner-nodes/pricing'\n  }\n\n  return {\n    buildDocsUrl,\n    staticUrls,\n    docsPaths\n  }\n}\n","import { useAsyncState } from '@vueuse/core'\nimport { defineStore } from 'pinia'\n\nimport { isCloud } from '@/platform/distribution/types'\nimport type { SystemStats } from '@/schemas/apiSchema'\nimport { api } from '@/scripts/api'\nimport { isElectron } from '@/utils/envUtil'\n\nexport const useSystemStatsStore = defineStore('systemStats', () => {\n  const fetchSystemStatsData = async () => {\n    try {\n      return await api.getSystemStats()\n    } catch (err) {\n      console.error('Error fetching system stats:', err)\n      throw err\n    }\n  }\n\n  const {\n    state: systemStats,\n    isLoading,\n    error,\n    isReady: isInitialized,\n    execute: refetchSystemStats\n  } = useAsyncState<SystemStats | null>(\n    fetchSystemStatsData,\n    null, // initial value\n    {\n      immediate: true\n    }\n  )\n\n  function getFormFactor(): string {\n    if (isCloud) {\n      return 'cloud'\n    }\n\n    if (!systemStats.value?.system?.os) {\n      return 'other'\n    }\n\n    const os = systemStats.value.system.os.toLowerCase()\n    const isDesktop = isElectron()\n\n    if (isDesktop) {\n      if (os.includes('windows')) {\n        return 'desktop-windows'\n      }\n      if (os.includes('darwin') || os.includes('mac')) {\n        return 'desktop-mac'\n      }\n    } else {\n      // Git/source installation\n      if (os.includes('windows')) {\n        return 'git-windows'\n      }\n      if (os.includes('darwin') || os.includes('mac')) {\n        return 'git-mac'\n      }\n      if (os.includes('linux')) {\n        return 'git-linux'\n      }\n    }\n\n    return 'other'\n  }\n\n  return {\n    systemStats,\n    isLoading,\n    error,\n    isInitialized,\n    refetchSystemStats,\n    getFormFactor\n  }\n})\n","import type { operations } from '@comfyorg/registry-types'\n\nexport function formatCamelCase(str: string): string {\n  // Check if the string is camel case\n  const isCamelCase = /^([A-Z][a-z]*)+$/.test(str)\n\n  if (!isCamelCase) {\n    return str // Return original string if not camel case\n  }\n\n  // Split the string into words, keeping acronyms together\n  const words = str.split(/(?=[A-Z][a-z])|\\d+/)\n\n  // Process each word\n  const processedWords = words.map((word) => {\n    // If the word is all uppercase and longer than one character, it's likely an acronym\n    if (word.length > 1 && word === word.toUpperCase()) {\n      return word // Keep acronyms as is\n    }\n    // For other words, ensure the first letter is capitalized\n    return word.charAt(0).toUpperCase() + word.slice(1)\n  })\n\n  // Join the words with spaces\n  return processedWords.join(' ')\n}\n\nexport function appendJsonExt(path: string) {\n  if (!path.toLowerCase().endsWith('.json')) {\n    path += '.json'\n  }\n  return path\n}\n\nexport function highlightQuery(text: string, query: string) {\n  if (!query) return text\n\n  // Escape special regex characters in the query string\n  const escapedQuery = query.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n\n  const regex = new RegExp(`(${escapedQuery})`, 'gi')\n  return text.replace(regex, '<span class=\"highlight\">$1</span>')\n}\n\nexport function formatNumberWithSuffix(\n  num: number,\n  {\n    precision = 1,\n    roundToInt = false\n  }: { precision?: number; roundToInt?: boolean } = {}\n): string {\n  const suffixes = ['', 'k', 'm', 'b', 't']\n  const absNum = Math.abs(num)\n\n  if (absNum < 1000) {\n    return roundToInt ? Math.round(num).toString() : num.toFixed(precision)\n  }\n\n  const exp = Math.min(Math.floor(Math.log10(absNum) / 3), suffixes.length - 1)\n  const formattedNum = (num / Math.pow(1000, exp)).toFixed(precision)\n\n  return `${formattedNum}${suffixes[exp]}`\n}\n\nexport function formatSize(value?: number) {\n  if (value === null || value === undefined) {\n    return '-'\n  }\n\n  const bytes = value\n  if (bytes === 0) return '0 B'\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(2))} ${sizes[i]}`\n}\n\n/**\n * Formats a commit hash by truncating long (40-char) hashes to 7 chars.\n * Returns the original string if not a valid full commit hash.\n */\nexport function formatCommitHash(value: string): string {\n  if (/^[a-f0-9]{40}$/i.test(value)) {\n    return value.slice(0, 7)\n  }\n  return value\n}\n\n/**\n * Returns various filename components.\n * Example:\n * - fullFilename: 'file.txt'\n * - filename: 'file'\n * - suffix: 'txt'\n */\nexport function getFilenameDetails(fullFilename: string) {\n  if (fullFilename.includes('.')) {\n    return {\n      filename: fullFilename.split('.').slice(0, -1).join('.'),\n      suffix: fullFilename.split('.').pop() ?? null\n    }\n  } else {\n    return { filename: fullFilename, suffix: null }\n  }\n}\n\n/**\n * Returns various path components.\n * Example:\n * - path: 'dir/file.txt'\n * - directory: 'dir'\n * - fullFilename: 'file.txt'\n * - filename: 'file'\n * - suffix: 'txt'\n */\nexport function getPathDetails(path: string) {\n  const directory = path.split('/').slice(0, -1).join('/')\n  const fullFilename = path.split('/').pop() ?? path\n  return { directory, fullFilename, ...getFilenameDetails(fullFilename) }\n}\n\n/**\n * Normalizes a string to be used as an i18n key.\n * Replaces dots with underscores.\n */\nexport function normalizeI18nKey(key: string) {\n  return typeof key === 'string' ? key.replace(/\\./g, '_') : ''\n}\n\n/**\n * Takes a dynamic prompt in the format {opt1|opt2|{optA|optB}|} and randomly replaces groups. Supports C style comments.\n * @param input The dynamic prompt to process\n * @returns\n */\nexport function processDynamicPrompt(input: string): string {\n  /*\n   * Strips C-style line and block comments from a string\n   */\n  function stripComments(str: string) {\n    return str.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g, '')\n  }\n\n  let i = 0\n  let result = ''\n  input = stripComments(input)\n\n  const handleEscape = () => {\n    const nextChar = input[i++]\n    return '\\\\' + nextChar\n  }\n\n  function parseChoiceBlock() {\n    // Parse the content inside {}\n    const options: string[] = []\n    let choice = ''\n    let depth = 0\n\n    while (i < input.length) {\n      const char = input[i++]\n\n      if (char === '\\\\') {\n        choice += handleEscape()\n        continue\n      } else if (char === '{') {\n        depth++\n      } else if (char === '}') {\n        if (!depth) break\n        depth--\n      } else if (char === '|') {\n        if (!depth) {\n          options.push(choice)\n          choice = ''\n          continue\n        }\n      }\n      choice += char\n    }\n\n    options.push(choice)\n\n    const chosenOption = options[Math.floor(Math.random() * options.length)]\n    return processDynamicPrompt(chosenOption)\n  }\n\n  while (i < input.length) {\n    const char = input[i++]\n    if (char === '\\\\') {\n      result += handleEscape()\n    } else if (char === '{') {\n      result += parseChoiceBlock()\n    } else {\n      result += char\n    }\n  }\n\n  return result.replace(/\\\\([{}|])/g, '$1')\n}\n\nexport function isValidUrl(url: string): boolean {\n  try {\n    new URL(url)\n    return true\n  } catch {\n    return false\n  }\n}\n\n/**\n * Parses a filepath into its filename and subfolder components.\n *\n * @example\n * parseFilePath('folder/file.txt')    // → { filename: 'file.txt', subfolder: 'folder' }\n * parseFilePath('/folder/file.txt')   // → { filename: 'file.txt', subfolder: 'folder' }\n * parseFilePath('file.txt')           // → { filename: 'file.txt', subfolder: '' }\n * parseFilePath('folder//file.txt')   // → { filename: 'file.txt', subfolder: 'folder' }\n *\n * @param filepath The filepath to parse\n * @returns Object containing filename and subfolder\n */\nexport function parseFilePath(filepath: string): {\n  filename: string\n  subfolder: string\n} {\n  if (!filepath?.trim()) return { filename: '', subfolder: '' }\n\n  const normalizedPath = filepath\n    .replace(/[\\\\/]+/g, '/') // Normalize path separators\n    .replace(/^\\//, '') // Remove leading slash\n    .replace(/\\/$/, '') // Remove trailing slash\n\n  const lastSlashIndex = normalizedPath.lastIndexOf('/')\n\n  if (lastSlashIndex === -1) {\n    return {\n      filename: normalizedPath,\n      subfolder: ''\n    }\n  }\n\n  return {\n    filename: normalizedPath.slice(lastSlashIndex + 1),\n    subfolder: normalizedPath.slice(0, lastSlashIndex)\n  }\n}\n\n// Simple date formatter\nconst parts = {\n  d: (d: Date) => d.getDate(),\n  M: (d: Date) => d.getMonth() + 1,\n  h: (d: Date) => d.getHours(),\n  m: (d: Date) => d.getMinutes(),\n  s: (d: Date) => d.getSeconds()\n}\nconst format =\n  Object.keys(parts)\n    .map((k) => k + k + '?')\n    .join('|') + '|yyy?y?'\n\nexport function formatDate(text: string, date: Date) {\n  return text.replace(new RegExp(format, 'g'), (text: string): string => {\n    if (text === 'yy') return (date.getFullYear() + '').substring(2)\n    if (text === 'yyyy') return date.getFullYear().toString()\n    if (text[0] in parts) {\n      const p = parts[text[0] as keyof typeof parts](date)\n      return (p + '').padStart(text.length, '0')\n    }\n    return text\n  })\n}\n\n/**\n * Generate a cache key from parameters\n * Sorts the parameters to ensure consistent keys regardless of parameter order\n */\nexport const paramsToCacheKey = (params: unknown): string => {\n  if (typeof params === 'string') return params\n  if (typeof params === 'object' && params !== null)\n    return Object.keys(params)\n      .sort((a, b) => a.localeCompare(b))\n      .map((key) => `${key}:${params[key as keyof typeof params]}`)\n      .join('&')\n\n  return String(params)\n}\n\n/**\n * Generates a RFC4122 compliant UUID v4 using the native crypto API when available\n * @returns A properly formatted UUID string\n */\nexport const generateUUID = (): string => {\n  // Use native crypto.randomUUID() if available (modern browsers)\n  if (\n    typeof crypto !== 'undefined' &&\n    typeof crypto.randomUUID === 'function'\n  ) {\n    return crypto.randomUUID()\n  }\n\n  // Fallback implementation for older browsers\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n    const r = (Math.random() * 16) | 0\n    const v = c === 'x' ? r : (r & 0x3) | 0x8\n    return v.toString(16)\n  })\n}\n\n/**\n * Checks if a URL is a Civitai model URL\n * @example\n * isCivitaiModelUrl('https://civitai.com/api/download/models/1234567890') // true\n * isCivitaiModelUrl('https://civitai.com/api/v1/models/1234567890') // true\n * isCivitaiModelUrl('https://civitai.com/api/v1/models-versions/15342') // true\n * isCivitaiModelUrl('https://example.com/model.safetensors') // false\n */\nexport const isCivitaiModelUrl = (url: string): boolean => {\n  if (!isValidUrl(url)) return false\n  if (!url.includes('civitai.com')) return false\n\n  const urlObj = new URL(url)\n  const pathname = urlObj.pathname\n\n  return (\n    /^\\/api\\/download\\/models\\/(\\d+)$/.test(pathname) ||\n    /^\\/api\\/v1\\/models\\/(\\d+)$/.test(pathname) ||\n    /^\\/api\\/v1\\/models-versions\\/(\\d+)$/.test(pathname)\n  )\n}\n\n/**\n * Converts a Hugging Face download URL to a repository page URL\n * @param url The download URL to convert\n * @returns The repository page URL or the original URL if conversion fails\n * @example\n * downloadUrlToHfRepoUrl(\n *  'https://huggingface.co/bfl/FLUX.1/resolve/main/flux1-canny-dev.safetensors?download=true'\n * ) // https://huggingface.co/bfl/FLUX.1\n */\nexport const downloadUrlToHfRepoUrl = (url: string): string => {\n  try {\n    const urlObj = new URL(url)\n    const pathname = urlObj.pathname\n\n    // Use regex to match everything before /resolve/ or /blob/\n    const regex = /^(.*?)(?:\\/resolve\\/|\\/blob\\/|$)/\n    const repoPathMatch = regex.exec(pathname)\n\n    // Extract the repository path and remove leading slash if present\n    const repoPath = repoPathMatch?.[1]?.replace(/^\\//, '') || ''\n\n    return `https://huggingface.co/${repoPath}`\n  } catch (error) {\n    return url\n  }\n}\n\n/**\n * Converts Metronome's integer amount back to a formatted currency string.\n * For USD, converts from cents to dollars.\n * For all other currencies (including custom pricing units), returns the amount as is.\n * This is specific to Metronome's API requirements.\n *\n * @param amount - The amount in Metronome's integer format (cents for USD, base units for others)\n * @param currency - The currency to convert\n * @returns The formatted amount in currency with 2 decimal places for USD\n * @example\n * formatMetronomeCurrency(123, 'usd') // returns \"1.23\" (cents to USD)\n * formatMetronomeCurrency(1000, 'jpy') // returns \"1000\" (yen)\n */\nexport function formatMetronomeCurrency(\n  amount: number,\n  currency: string\n): string {\n  if (currency === 'usd') {\n    return (amount / 100).toFixed(2)\n  }\n  return amount.toString()\n}\n\n/**\n * Converts a USD amount to microdollars (1/1,000,000 of a dollar).\n * This conversion is commonly used in financial systems to avoid floating-point precision issues\n * by representing monetary values as integers.\n *\n * @param usd - The amount in US dollars to convert\n * @returns The amount in microdollars (multiplied by 1,000,000)\n * @example\n * usdToMicros(1.23) // returns 1230000\n */\nexport function usdToMicros(usd: number): number {\n  return Math.round(usd * 1_000_000)\n}\n\n/**\n * Converts URLs in a string to HTML links.\n * @param text - The string to convert\n * @returns The string with URLs converted to HTML links\n * @example\n * linkifyHtml('Visit https://example.com for more info') // returns 'Visit <a href=\"https://example.com\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"text-primary-400 hover:underline\">https://example.com</a> for more info'\n */\nexport function linkifyHtml(text: string): string {\n  if (!text) return ''\n  const urlRegex =\n    /(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%?=~_|])|(\\bwww\\.[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%?=~_|])/gi\n  return text.replace(urlRegex, (_match, p1, _p2, p3) => {\n    const url = p1 || p3\n    const href = p3 ? `http://${url}` : url\n    return `<a href=\"${href}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"text-primary-400 hover:underline\">${url}</a>`\n  })\n}\n\n/**\n * Converts newline characters to HTML <br> tags.\n * @param text - The string to convert\n * @returns The string with newline characters converted to <br> tags\n * @example\n * nl2br('Hello\\nWorld') // returns 'Hello<br />World'\n */\nexport function nl2br(text: string): string {\n  if (!text) return ''\n  return text.replace(/\\n/g, '<br />')\n}\n\n/**\n * Converts a version string to an anchor-safe format by replacing dots with dashes.\n * @param version The version string (e.g., \"1.0.0\", \"2.1.3-beta.1\")\n * @returns The anchor-safe version string (e.g., \"v1-0-0\", \"v2-1-3-beta-1\")\n * @example\n * formatVersionAnchor(\"1.0.0\") // returns \"v1-0-0\"\n * formatVersionAnchor(\"2.1.3-beta.1\") // returns \"v2-1-3-beta-1\"\n */\nexport function formatVersionAnchor(version: string): string {\n  return `v${version.replace(/\\./g, '-')}`\n}\n\n/**\n * Supported locale types for the application (from OpenAPI schema)\n */\ntype SupportedLocale = NonNullable<\n  operations['getReleaseNotes']['parameters']['query']['locale']\n>\n\n/**\n * Converts a string to a valid locale type with 'en' as default\n * @param locale - The locale string to validate and convert\n * @returns A valid SupportedLocale type, defaults to 'en' if invalid\n * @example\n * stringToLocale('fr') // returns 'fr'\n * stringToLocale('invalid') // returns 'en'\n * stringToLocale('') // returns 'en'\n */\nexport function stringToLocale(locale: string): SupportedLocale {\n  const supportedLocales: SupportedLocale[] = [\n    'en',\n    'es',\n    'fr',\n    'ja',\n    'ko',\n    'ru',\n    'zh'\n  ]\n  return supportedLocales.includes(locale as SupportedLocale)\n    ? (locale as SupportedLocale)\n    : 'en'\n}\n\nexport function formatDuration(milliseconds: number): string {\n  if (!milliseconds || milliseconds < 0) return '0s'\n\n  const totalSeconds = Math.floor(milliseconds / 1000)\n  const hours = Math.floor(totalSeconds / 3600)\n  const minutes = Math.floor((totalSeconds % 3600) / 60)\n  const remainingSeconds = Math.floor(totalSeconds % 60)\n\n  const parts: string[] = []\n\n  if (hours > 0) {\n    parts.push(`${hours}h`)\n  }\n  if (minutes > 0) {\n    parts.push(`${minutes}m`)\n  }\n  if (remainingSeconds > 0 || parts.length === 0) {\n    parts.push(`${remainingSeconds}s`)\n  }\n\n  return parts.join(' ')\n}\n\nconst IMAGE_EXTENSIONS = ['png', 'jpg', 'jpeg', 'gif', 'webp', 'bmp'] as const\nconst VIDEO_EXTENSIONS = ['mp4', 'webm', 'mov', 'avi'] as const\nconst AUDIO_EXTENSIONS = ['mp3', 'wav', 'ogg', 'flac'] as const\nconst THREE_D_EXTENSIONS = ['obj', 'fbx', 'gltf', 'glb'] as const\n\nconst MEDIA_TYPES = ['image', 'video', 'audio', '3D'] as const\ntype MediaType = (typeof MEDIA_TYPES)[number]\n\n// Type guard helper for checking array membership\ntype ImageExtension = (typeof IMAGE_EXTENSIONS)[number]\ntype VideoExtension = (typeof VIDEO_EXTENSIONS)[number]\ntype AudioExtension = (typeof AUDIO_EXTENSIONS)[number]\ntype ThreeDExtension = (typeof THREE_D_EXTENSIONS)[number]\n\n/**\n * Truncates a filename while preserving the extension\n * @param filename The filename to truncate\n * @param maxLength Maximum length for the filename without extension\n * @returns Truncated filename with extension preserved\n */\nexport function truncateFilename(\n  filename: string,\n  maxLength: number = 20\n): string {\n  if (!filename || filename.length <= maxLength) {\n    return filename\n  }\n\n  const lastDotIndex = filename.lastIndexOf('.')\n  const nameWithoutExt =\n    lastDotIndex > -1 ? filename.substring(0, lastDotIndex) : filename\n  const extension = lastDotIndex > -1 ? filename.substring(lastDotIndex) : ''\n\n  // If the name without extension is short enough, return as is\n  if (nameWithoutExt.length <= maxLength) {\n    return filename\n  }\n\n  // Calculate how to split the truncation\n  const halfLength = Math.floor((maxLength - 3) / 2) // -3 for '...'\n  const start = nameWithoutExt.substring(0, halfLength)\n  const end = nameWithoutExt.substring(nameWithoutExt.length - halfLength)\n\n  return `${start}...${end}${extension}`\n}\n\n/**\n * Determines the media type from a filename's extension (singular form)\n * @param filename The filename to analyze\n * @returns The media type: 'image', 'video', 'audio', or '3D'\n */\nexport function getMediaTypeFromFilename(\n  filename: string | null | undefined\n): MediaType {\n  if (!filename) return 'image'\n  const ext = filename.split('.').pop()?.toLowerCase()\n  if (!ext) return 'image'\n\n  // Type-safe array includes check using type assertion\n  if (IMAGE_EXTENSIONS.includes(ext as ImageExtension)) return 'image'\n  if (VIDEO_EXTENSIONS.includes(ext as VideoExtension)) return 'video'\n  if (AUDIO_EXTENSIONS.includes(ext as AudioExtension)) return 'audio'\n  if (THREE_D_EXTENSIONS.includes(ext as ThreeDExtension)) return '3D'\n\n  return 'image'\n}\n","import { defineStore } from 'pinia'\nimport { computed, markRaw, ref } from 'vue'\n\nimport type { ComfyExtension } from '@/types/comfy'\n\n/**\n * These extensions are always active, even if they are disabled in the setting.\n */\nconst ALWAYS_ENABLED_EXTENSIONS: readonly string[] = []\n\nconst ALWAYS_DISABLED_EXTENSIONS: readonly string[] = [\n  // pysssss.Locking is replaced by pin/unpin in ComfyUI core.\n  // https://github.com/Comfy-Org/litegraph.js/pull/117\n  'pysssss.Locking',\n  // pysssss.SnapToGrid is replaced by Comfy.Graph.AlwaysSnapToGrid in ComfyUI core.\n  // pysssss.SnapToGrid tries to write global app.shiftDown state, which is no longer\n  // allowed since v1.3.12.\n  // https://github.com/Comfy-Org/ComfyUI_frontend/issues/1176\n  'pysssss.SnapToGrid',\n  // Favicon status is implemented in ComfyUI core in v1.20.\n  // https://github.com/Comfy-Org/ComfyUI_frontend/pull/3880\n  'pysssss.FaviconStatus',\n  'KJNodes.browserstatus'\n]\n\nexport const useExtensionStore = defineStore('extension', () => {\n  // For legacy reasons, the name uniquely identifies an extension\n  const extensionByName = ref<Record<string, ComfyExtension>>({})\n  const extensions = computed(() => Object.values(extensionByName.value))\n  // Not using computed because disable extension requires reloading of the page.\n  // Dynamically update this list won't affect extensions that are already loaded.\n  const disabledExtensionNames = ref<Set<string>>(new Set())\n\n  // Disabled extension names that are currently not in the extension list.\n  // If a node pack is disabled in the backend, we shouldn't remove the configuration\n  // of the frontend extension disable list, in case the node pack is re-enabled.\n  const inactiveDisabledExtensionNames = computed(() => {\n    return Array.from(disabledExtensionNames.value).filter(\n      (name) => !(name in extensionByName.value)\n    )\n  })\n\n  const isExtensionInstalled = (name: string) => name in extensionByName.value\n\n  const isExtensionEnabled = (name: string) =>\n    !disabledExtensionNames.value.has(name)\n  const enabledExtensions = computed(() => {\n    return extensions.value.filter((ext) => isExtensionEnabled(ext.name))\n  })\n\n  function isExtensionReadOnly(name: string) {\n    return (\n      ALWAYS_DISABLED_EXTENSIONS.includes(name) ||\n      ALWAYS_ENABLED_EXTENSIONS.includes(name)\n    )\n  }\n\n  function registerExtension(extension: ComfyExtension) {\n    if (!extension.name) {\n      throw new Error(\"Extensions must have a 'name' property.\")\n    }\n\n    if (extensionByName.value[extension.name]) {\n      throw new Error(`Extension named '${extension.name}' already registered.`)\n    }\n\n    if (disabledExtensionNames.value.has(extension.name)) {\n      console.warn(`Extension ${extension.name} is disabled.`)\n    }\n\n    extensionByName.value[extension.name] = markRaw(extension)\n  }\n\n  function loadDisabledExtensionNames(names: string[]) {\n    disabledExtensionNames.value = new Set(names)\n    for (const name of ALWAYS_DISABLED_EXTENSIONS) {\n      disabledExtensionNames.value.add(name)\n    }\n    for (const name of ALWAYS_ENABLED_EXTENSIONS) {\n      disabledExtensionNames.value.delete(name)\n    }\n  }\n\n  /**\n   * Core extensions are extensions that are defined in the core package.\n   * See /extensions/core/index.ts for the list.\n   */\n  const coreExtensionNames = ref<string[]>([])\n  function captureCoreExtensions() {\n    coreExtensionNames.value = extensions.value.map((ext) => ext.name)\n  }\n\n  function isCoreExtension(name: string) {\n    return coreExtensionNames.value.includes(name)\n  }\n\n  const hasThirdPartyExtensions = computed(() => {\n    return extensions.value.some((ext) => !isCoreExtension(ext.name))\n  })\n\n  return {\n    extensions,\n    enabledExtensions,\n    inactiveDisabledExtensionNames,\n    isExtensionInstalled,\n    isExtensionEnabled,\n    isExtensionReadOnly,\n    registerExtension,\n    loadDisabledExtensionNames,\n    captureCoreExtensions,\n    isCoreExtension,\n    hasThirdPartyExtensions\n  }\n})\n","<template>\n  <TabPanel :value=\"props.value\" class=\"h-full w-full\" :class=\"props.class\">\n    <div class=\"flex h-full w-full flex-col gap-2\">\n      <slot name=\"header\" />\n      <ScrollPanel class=\"h-0 grow pr-2\">\n        <slot />\n      </ScrollPanel>\n      <slot name=\"footer\" />\n    </div>\n  </TabPanel>\n</template>\n\n<script setup lang=\"ts\">\nimport ScrollPanel from 'primevue/scrollpanel'\nimport TabPanel from 'primevue/tabpanel'\n\nconst props = defineProps<{\n  value: string\n  class?: string\n}>()\n</script>\n","<template>\n  <TabPanel :value=\"props.value\" class=\"h-full w-full\" :class=\"props.class\">\n    <div class=\"flex h-full w-full flex-col gap-2\">\n      <slot name=\"header\" />\n      <ScrollPanel class=\"h-0 grow pr-2\">\n        <slot />\n      </ScrollPanel>\n      <slot name=\"footer\" />\n    </div>\n  </TabPanel>\n</template>\n\n<script setup lang=\"ts\">\nimport ScrollPanel from 'primevue/scrollpanel'\nimport TabPanel from 'primevue/tabpanel'\n\nconst props = defineProps<{\n  value: string\n  class?: string\n}>()\n</script>\n"],"mappings":"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"}