import{i as e,n as t}from"./rolldown-runtime-BKYq3fBv.js";import{$n as n,Bt as r,Cr as i,Gn as a,Mr as o,Nn as s,Or as c,Qn as l,Rr as u,Tr as d,Un as f,Vn as p,Xn as m,Xr as h,Zn as g,ai as _,ar as v,br as y,er as b,ir as x,mr as S,si as C,sr as w,ui as T,xr as E,zr as D,zt as O}from"./vendor-primevue-Cg-HmKZY.js";import{r as k,s as A}from"./i18n-gOSvTADh.js";import{n as j,t as M}from"./tailwindUtil-F1kyO01s.js";import{n as N,t as P}from"./Button-YQy7RkKq.js";import{fo as ee,po as F}from"./dialogService-DvYmp2_F.js";var I,te,L,R=t((()=>{s(),O(),N(),I={class:`relative show-slider`},te={class:`absolute top-0 left-12 rounded-lg bg-interface-menu-surface p-4 shadow-lg w-[150px]`},L=w({__name:`PopupSlider`,props:S({icon:{default:`pi-expand`},tooltipText:{},min:{default:10},max:{default:150},step:{default:1}},{modelValue:{},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let t=o(e,`modelValue`),n=h(!1),toggleSlider=()=>{n.value=!n.value},closeSlider=e=>{e.target.closest(`.show-slider`)||(n.value=!1)};return y(()=>{document.addEventListener(`click`,closeSlider)}),E(()=>{document.removeEventListener(`click`,closeSlider)}),(e,a)=>{let o=c(`tooltip`);return i(),b(`div`,I,[D((i(),l(P,{size:`icon`,variant:`textonly`,class:`rounded-full`,"aria-label":e.tooltipText,onClick:toggleSlider},{default:u(()=>[g(`i`,{class:C([`pi`,e.icon,`text-lg text-base-foreground`])},null,2)]),_:1},8,[`aria-label`])),[[o,{value:e.tooltipText,showDelay:300},void 0,{right:!0}]]),D(g(`div`,te,[v(_(r),{modelValue:t.value,"onUpdate:modelValue":a[0]||=e=>t.value=e,class:`w-full`,min:e.min,max:e.max,step:e.step},null,8,[`modelValue`,`min`,`max`,`step`])],512),[[p,n.value]])])}}})})),z,B=t((()=>{R(),R(),z=L})),V,H,U=t((()=>{s(),B(),N(),V={class:`flex flex-col`},H=w({__name:`CameraControls`,props:{cameraType:{},cameraTypeModifiers:{},fov:{},fovModifiers:{}},emits:[`update:cameraType`,`update:fov`],setup(e){let t=o(e,`cameraType`),r=o(e,`fov`),a=m(()=>t.value===`perspective`),switchCamera=()=>{t.value=t.value===`perspective`?`orthographic`:`perspective`};return(e,t)=>{let o=c(`tooltip`);return i(),b(`div`,V,[D((i(),l(P,{size:`icon`,variant:`textonly`,class:`rounded-full`,"aria-label":e.$t(`load3d.switchCamera`),onClick:switchCamera},{default:u(()=>t[1]||=[g(`i`,{class:C([`pi`,`pi-camera`,`text-lg text-base-foreground`])},null,-1)]),_:1},8,[`aria-label`])),[[o,{value:e.$t(`load3d.switchCamera`),showDelay:300},void 0,{right:!0}]]),a.value?(i(),l(z,{key:0,modelValue:r.value,"onUpdate:modelValue":t[0]||=e=>r.value=e,"tooltip-text":e.$t(`load3d.fov`)},null,8,[`modelValue`,`tooltip-text`])):n(``,!0)])}}})})),W,ne=t((()=>{U(),U(),W=H})),G,K,q,J,Y,X=t((()=>{s(),N(),G={class:`flex flex-col`},K={class:`show-export-formats relative`},q={class:`absolute top-0 left-12 rounded-lg bg-interface-menu-surface shadow-lg`},J={class:`flex flex-col`},Y=w({__name:`ExportControls`,emits:[`exportModel`],setup(e,{emit:t}){let n=t,r=h(!1),o=[{label:`GLB`,value:`glb`},{label:`OBJ`,value:`obj`},{label:`STL`,value:`stl`}];function toggleExportFormats(){r.value=!r.value}function exportModel(e){n(`exportModel`,e),r.value=!1}function closeExportFormatsList(e){e.target.closest(`.show-export-formats`)||(r.value=!1)}return y(()=>{document.addEventListener(`click`,closeExportFormatsList)}),E(()=>{document.removeEventListener(`click`,closeExportFormatsList)}),(e,t)=>{let n=c(`tooltip`);return i(),b(`div`,G,[g(`div`,K,[D((i(),l(P,{size:`icon`,variant:`textonly`,class:`rounded-full`,"aria-label":e.$t(`load3d.exportModel`),onClick:toggleExportFormats},{default:u(()=>t[0]||=[g(`i`,{class:`pi pi-download text-lg text-base-foreground`},null,-1)]),_:1},8,[`aria-label`])),[[n,{value:e.$t(`load3d.exportModel`),showDelay:300},void 0,{right:!0}]]),D(g(`div`,q,[g(`div`,J,[(i(),b(a,null,d(o,e=>v(P,{key:e.value,variant:`textonly`,class:`text-base-foreground`,onClick:t=>exportModel(e.value)},{default:u(()=>[x(T(e.label),1)]),_:2},1032,[`onClick`])),64))])],512),[[p,r.value]])])])}}})})),Z,re=t((()=>{X(),X(),Z=Y})),Q,ie,ae,oe,se=t((()=>{s(),O(),N(),ee(),Q={class:`flex flex-col`},ie={key:0,class:`show-light-intensity relative`},ae={class:`absolute top-0 left-12 rounded-lg bg-black/50 p-4 shadow-lg`,style:{width:`150px`}},oe=w({__name:`LightControls`,props:{lightIntensity:{},lightIntensityModifiers:{},materialMode:{},materialModeModifiers:{}},emits:[`update:lightIntensity`,`update:materialMode`],setup(e){let t=o(e,`lightIntensity`),a=o(e,`materialMode`),s=m(()=>a.value===`original`),d=h(!1),f=F().get(`Comfy.Load3D.LightIntensityMaximum`),x=F().get(`Comfy.Load3D.LightIntensityMinimum`),S=F().get(`Comfy.Load3D.LightAdjustmentIncrement`);function toggleLightIntensity(){d.value=!d.value}function closeLightSlider(e){e.target.closest(`.show-light-intensity`)||(d.value=!1)}return y(()=>{document.addEventListener(`click`,closeLightSlider)}),E(()=>{document.removeEventListener(`click`,closeLightSlider)}),(e,a)=>{let o=c(`tooltip`);return i(),b(`div`,Q,[s.value?(i(),b(`div`,ie,[D((i(),l(P,{size:`icon`,variant:`textonly`,class:`rounded-full`,"aria-label":e.$t(`load3d.lightIntensity`),onClick:toggleLightIntensity},{default:u(()=>a[1]||=[g(`i`,{class:`pi pi-sun text-lg text-base-foreground`},null,-1)]),_:1},8,[`aria-label`])),[[o,{value:e.$t(`load3d.lightIntensity`),showDelay:300},void 0,{right:!0}]]),D(g(`div`,ae,[v(_(r),{modelValue:t.value,"onUpdate:modelValue":a[0]||=e=>t.value=e,class:`w-full`,min:_(x),max:_(f),step:_(S)},null,8,[`modelValue`,`min`,`max`,`step`])],512),[[p,d.value]])])):n(``,!0)])}}})})),ce,le=t((()=>{se(),se(),ce=oe})),ue,de,fe,pe,me,he,ge,_e,ve,ye=t((()=>{s(),N(),k(),M(),ue={class:`flex flex-col`},de={class:`show-up-direction relative`},fe={class:`absolute top-0 left-12 rounded-lg bg-interface-menu-surface shadow-lg`},pe={class:`flex flex-col`},me={key:0,class:`show-material-mode relative`},he={class:`absolute top-0 left-12 rounded-lg bg-interface-menu-surface shadow-lg`},ge={class:`flex flex-col`},_e={key:1},ve=w({__name:`ModelControls`,props:S({hideMaterialMode:{type:Boolean,default:!1},isPlyModel:{type:Boolean,default:!1},hasSkeleton:{type:Boolean,default:!1}},{materialMode:{},materialModeModifiers:{},upDirection:{},upDirectionModifiers:{},showSkeleton:{type:Boolean},showSkeletonModifiers:{}}),emits:[`update:materialMode`,`update:upDirection`,`update:showSkeleton`],setup(e){let t=o(e,`materialMode`),r=o(e,`upDirection`),s=o(e,`showSkeleton`),f=h(!1),S=h(!1),w=[`original`,`-x`,`+x`,`-y`,`+y`,`-z`,`+z`],O=m(()=>{let t=[`original`,`normal`,`wireframe`];return e.isPlyModel&&t.splice(1,0,`pointCloud`),t});function toggleUpDirection(){f.value=!f.value,S.value=!1}function selectUpDirection(e){r.value=e,f.value=!1}function toggleMaterialMode(){S.value=!S.value,f.value=!1}function selectMaterialMode(e){t.value=e,S.value=!1}function formatMaterialMode(e){return A(`load3d.materialModes.${e}`)}function closeSceneSlider(e){let t=e.target;t.closest(`.show-up-direction`)||(f.value=!1),t.closest(`.show-material-mode`)||(S.value=!1)}return y(()=>{document.addEventListener(`click`,closeSceneSlider)}),E(()=>{document.removeEventListener(`click`,closeSceneSlider)}),(e,o)=>{let m=c(`tooltip`);return i(),b(`div`,ue,[g(`div`,de,[D((i(),l(P,{size:`icon`,variant:`textonly`,class:`rounded-full`,"aria-label":_(A)(`load3d.upDirection`),onClick:toggleUpDirection},{default:u(()=>o[1]||=[g(`i`,{class:`pi pi-arrow-up text-lg text-base-foreground`},null,-1)]),_:1},8,[`aria-label`])),[[m,{value:_(A)(`load3d.upDirection`),showDelay:300},void 0,{right:!0}]]),D(g(`div`,fe,[g(`div`,pe,[(i(),b(a,null,d(w,e=>v(P,{key:e,variant:`textonly`,class:C(_(j)(`text-base-foreground`,r.value===e&&`bg-blue-500`)),onClick:t=>selectUpDirection(e)},{default:u(()=>[x(T(e.toUpperCase()),1)]),_:2},1032,[`class`,`onClick`])),64))])],512),[[p,f.value]])]),e.hideMaterialMode?n(``,!0):(i(),b(`div`,me,[D((i(),l(P,{size:`icon`,variant:`textonly`,class:`rounded-full`,"aria-label":_(A)(`load3d.materialMode`),onClick:toggleMaterialMode},{default:u(()=>o[2]||=[g(`i`,{class:`pi pi-box text-lg text-base-foreground`},null,-1)]),_:1},8,[`aria-label`])),[[m,{value:_(A)(`load3d.materialMode`),showDelay:300},void 0,{right:!0}]]),D(g(`div`,he,[g(`div`,ge,[(i(!0),b(a,null,d(O.value,e=>(i(),l(P,{key:e,variant:`textonly`,class:C(_(j)(`whitespace-nowrap text-base-foreground`,t.value===e&&`bg-blue-500`)),onClick:t=>selectMaterialMode(e)},{default:u(()=>[x(T(formatMaterialMode(e)),1)]),_:2},1032,[`class`,`onClick`]))),128))])],512),[[p,S.value]])])),e.hasSkeleton?(i(),b(`div`,_e,[D((i(),l(P,{size:`icon`,variant:`textonly`,class:C(_(j)(`rounded-full`,s.value&&`bg-blue-500`)),"aria-label":_(A)(`load3d.showSkeleton`),onClick:o[0]||=e=>s.value=!s.value},{default:u(()=>o[3]||=[g(`i`,{class:`pi pi-sitemap text-lg text-base-foreground`},null,-1)]),_:1},8,[`class`,`aria-label`])),[[m,{value:_(A)(`load3d.showSkeleton`),showDelay:300},void 0,{right:!0}]])])):n(``,!0)])}}})})),be,xe=t((()=>{ye(),ye(),be=ve})),Se,Ce,$,we,Te,Ee,De,Oe=t((()=>{s(),B(),N(),M(),Se={class:`flex flex-col`},Ce={key:0},$=[`value`],we={key:1},Te={key:2},Ee={key:4},De=w({__name:`SceneControls`,props:{showGrid:{type:Boolean},showGridModifiers:{},backgroundColor:{},backgroundColorModifiers:{},backgroundImage:{},backgroundImageModifiers:{},backgroundRenderMode:{default:`tiled`},backgroundRenderModeModifiers:{},fov:{},fovModifiers:{}},emits:S([`updateBackgroundImage`],[`update:showGrid`,`update:backgroundColor`,`update:backgroundImage`,`update:backgroundRenderMode`,`update:fov`]),setup(e,{emit:t}){let r=t,a=o(e,`showGrid`),s=o(e,`backgroundColor`),d=o(e,`backgroundImage`),f=o(e,`backgroundRenderMode`),p=o(e,`fov`),v=m(()=>d.value&&d.value!==``),y=h(null),x=h(null),toggleGrid=()=>{a.value=!a.value},updateBackgroundColor=e=>{s.value=e},openColorPicker=()=>{y.value?.click()},openImagePicker=()=>{x.value?.click()},uploadBackgroundImage=e=>{let t=e.target;t.files&&t.files[0]&&r(`updateBackgroundImage`,t.files[0])},removeBackgroundImage=()=>{r(`updateBackgroundImage`,null)},toggleBackgroundRenderMode=()=>{f.value=f.value===`panorama`?`tiled`:`panorama`};return(e,t)=>{let r=c(`tooltip`);return i(),b(`div`,Se,[D((i(),l(P,{variant:`textonly`,size:`icon`,class:C(_(j)(`rounded-full`,a.value&&`ring-2 ring-white/50`)),"aria-label":e.$t(`load3d.showGrid`),onClick:toggleGrid},{default:u(()=>t[2]||=[g(`i`,{class:`pi pi-table text-lg text-base-foreground`},null,-1)]),_:1},8,[`class`,`aria-label`])),[[r,{value:e.$t(`load3d.showGrid`),showDelay:300},void 0,{right:!0}]]),v.value?n(``,!0):(i(),b(`div`,Ce,[D((i(),l(P,{variant:`textonly`,size:`icon`,class:`rounded-full`,"aria-label":e.$t(`load3d.backgroundColor`),onClick:openColorPicker},{default:u(()=>[t[3]||=g(`i`,{class:`pi pi-palette text-lg text-base-foreground`},null,-1),g(`input`,{ref_key:`colorPickerRef`,ref:y,type:`color`,value:s.value,class:`pointer-events-none absolute m-0 h-0 w-0 p-0 opacity-0`,onInput:t[0]||=e=>updateBackgroundColor(e.target.value)},null,40,$)]),_:1},8,[`aria-label`])),[[r,{value:e.$t(`load3d.backgroundColor`),showDelay:300},void 0,{right:!0}]])])),v.value?n(``,!0):(i(),b(`div`,we,[D((i(),l(P,{variant:`textonly`,size:`icon`,class:`rounded-full`,"aria-label":e.$t(`load3d.uploadBackgroundImage`),onClick:openImagePicker},{default:u(()=>[t[4]||=g(`i`,{class:`pi pi-image text-lg text-base-foreground`},null,-1),g(`input`,{ref_key:`imagePickerRef`,ref:x,type:`file`,accept:`image/*`,class:`pointer-events-none absolute m-0 h-0 w-0 p-0 opacity-0`,onChange:uploadBackgroundImage},null,544)]),_:1},8,[`aria-label`])),[[r,{value:e.$t(`load3d.uploadBackgroundImage`),showDelay:300},void 0,{right:!0}]])])),v.value?(i(),b(`div`,Te,[D((i(),l(P,{variant:`textonly`,size:`icon`,class:C(_(j)(`rounded-full`,f.value===`panorama`&&`ring-2 ring-white/50`)),"aria-label":e.$t(`load3d.panoramaMode`),onClick:toggleBackgroundRenderMode},{default:u(()=>t[5]||=[g(`i`,{class:`pi pi-globe text-lg text-base-foreground`},null,-1)]),_:1},8,[`class`,`aria-label`])),[[r,{value:e.$t(`load3d.panoramaMode`),showDelay:300},void 0,{right:!0}]])])):n(``,!0),v.value&&f.value===`panorama`?(i(),l(z,{key:3,modelValue:p.value,"onUpdate:modelValue":t[1]||=e=>p.value=e,"tooltip-text":e.$t(`load3d.fov`)},null,8,[`modelValue`,`tooltip-text`])):n(``,!0),v.value?(i(),b(`div`,Ee,[D((i(),l(P,{variant:`textonly`,size:`icon`,class:`rounded-full`,"aria-label":e.$t(`load3d.removeBackgroundImage`),onClick:removeBackgroundImage},{default:u(()=>t[6]||=[g(`i`,{class:`pi pi-times text-lg text-base-foreground`},null,-1)]),_:1},8,[`aria-label`])),[[r,{value:e.$t(`load3d.removeBackgroundImage`),showDelay:300},void 0,{right:!0}]])])):n(``,!0)])}}})})),ke,Ae=t((()=>{Oe(),Oe(),ke=De})),je,Me,Ne,Pe,Fe,Ie,Le=t((()=>{s(),ne(),re(),le(),xe(),Ae(),N(),M(),je={class:`show-menu relative`},Me={class:`absolute top-0 left-12 rounded-lg bg-interface-menu-surface shadow-lg`},Ne={class:`flex flex-col`},Pe={class:`whitespace-nowrap text-base-foreground`},Fe={class:`rounded-lg bg-smoke-700/30`},Ie=w({__name:`Load3DControls`,props:S({isSplatModel:{type:Boolean,default:!1},isPlyModel:{type:Boolean,default:!1},hasSkeleton:{type:Boolean,default:!1}},{sceneConfig:{},sceneConfigModifiers:{},modelConfig:{},modelConfigModifiers:{},cameraConfig:{},cameraConfigModifiers:{},lightConfig:{},lightConfigModifiers:{}}),emits:S([`updateBackgroundImage`,`exportModel`],[`update:sceneConfig`,`update:modelConfig`,`update:cameraConfig`,`update:lightConfig`]),setup(e,{emit:t}){let r=o(e,`sceneConfig`),s=o(e,`modelConfig`),c=o(e,`cameraConfig`),x=o(e,`lightConfig`),S=h(!1),w=h(`scene`),O={scene:`load3d.scene`,model:`load3d.model`,camera:`load3d.camera`,light:`load3d.light`,export:`load3d.export`},k=m(()=>e.isSplatModel?[`scene`,`model`,`camera`]:[`scene`,`model`,`camera`,`light`,`export`]),A=m(()=>w.value===`scene`&&!!r.value),M=m(()=>w.value===`model`&&!!s.value),N=m(()=>w.value===`camera`&&!!c.value),ee=m(()=>w.value===`light`&&!!x.value&&!!s.value),F=m(()=>w.value===`export`),toggleMenu=()=>{S.value=!S.value},selectCategory=e=>{w.value=e,S.value=!1},getCategoryIcon=e=>`${{scene:`pi pi-image`,model:`pi pi-box`,camera:`pi pi-camera`,light:`pi pi-sun`,export:`pi pi-download`}[e]} text-base-foreground text-lg`,I=t,handleBackgroundImageUpdate=e=>{I(`updateBackgroundImage`,e)},handleExportModel=e=>{I(`exportModel`,e)},closeSlider=e=>{e.target.closest(`.show-menu`)||(S.value=!1)};return y(()=>{document.addEventListener(`click`,closeSlider)}),E(()=>{document.removeEventListener(`click`,closeSlider)}),(e,t)=>(i(),b(`div`,{class:`pointer-events-auto absolute top-12 left-2 z-20 flex flex-col rounded-lg bg-backdrop/30`,onPointerdown:t[12]||=f(()=>{},[`stop`]),onPointermove:t[13]||=f(()=>{},[`stop`]),onPointerup:t[14]||=f(()=>{},[`stop`]),onWheel:t[15]||=f(()=>{},[`stop`])},[g(`div`,je,[v(P,{variant:`textonly`,size:`icon`,"aria-label":e.$t(`menu.showMenu`),class:`rounded-full`,onClick:toggleMenu},{default:u(()=>t[16]||=[g(`i`,{class:`pi pi-bars text-lg text-base-foreground`},null,-1)]),_:1},8,[`aria-label`]),D(g(`div`,Me,[g(`div`,Ne,[(i(!0),b(a,null,d(k.value,t=>(i(),l(P,{key:t,variant:`textonly`,class:C(_(j)(`flex w-full items-center justify-start`,w.value===t&&`bg-button-active-surface`)),onClick:e=>selectCategory(t)},{default:u(()=>[g(`i`,{class:C(getCategoryIcon(t))},null,2),g(`span`,Pe,T(e.$t(O[t])),1)]),_:2},1032,[`class`,`onClick`]))),128))])],512),[[p,S.value]])]),D(g(`div`,Fe,[A.value?(i(),l(ke,{key:0,"show-grid":r.value.showGrid,"onUpdate:showGrid":t[0]||=e=>r.value.showGrid=e,"background-color":r.value.backgroundColor,"onUpdate:backgroundColor":t[1]||=e=>r.value.backgroundColor=e,"background-image":r.value.backgroundImage,"onUpdate:backgroundImage":t[2]||=e=>r.value.backgroundImage=e,"background-render-mode":r.value.backgroundRenderMode,"onUpdate:backgroundRenderMode":t[3]||=e=>r.value.backgroundRenderMode=e,fov:c.value.fov,"onUpdate:fov":t[4]||=e=>c.value.fov=e,onUpdateBackgroundImage:handleBackgroundImageUpdate},null,8,[`show-grid`,`background-color`,`background-image`,`background-render-mode`,`fov`])):n(``,!0),M.value?(i(),l(be,{key:1,"material-mode":s.value.materialMode,"onUpdate:materialMode":t[5]||=e=>s.value.materialMode=e,"up-direction":s.value.upDirection,"onUpdate:upDirection":t[6]||=e=>s.value.upDirection=e,"show-skeleton":s.value.showSkeleton,"onUpdate:showSkeleton":t[7]||=e=>s.value.showSkeleton=e,"hide-material-mode":e.isSplatModel,"is-ply-model":e.isPlyModel,"has-skeleton":e.hasSkeleton},null,8,[`material-mode`,`up-direction`,`show-skeleton`,`hide-material-mode`,`is-ply-model`,`has-skeleton`])):n(``,!0),N.value?(i(),l(W,{key:2,"camera-type":c.value.cameraType,"onUpdate:cameraType":t[8]||=e=>c.value.cameraType=e,fov:c.value.fov,"onUpdate:fov":t[9]||=e=>c.value.fov=e},null,8,[`camera-type`,`fov`])):n(``,!0),ee.value?(i(),l(ce,{key:3,"light-intensity":x.value.intensity,"onUpdate:lightIntensity":t[10]||=e=>x.value.intensity=e,"material-mode":s.value.materialMode,"onUpdate:materialMode":t[11]||=e=>s.value.materialMode=e},null,8,[`light-intensity`,`material-mode`])):n(``,!0),F.value?(i(),l(Z,{key:4,onExportModel:handleExportModel})):n(``,!0)],512),[[p,w.value]])],32))}})})),Re,ze=t((()=>{Le(),Le(),Re=Ie}));export{ze as n,Re as t};
//# sourceMappingURL=Load3DControls-CVZJIGKN.js.map