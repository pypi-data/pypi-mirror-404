{"version":3,"file":"WidgetInputNumber-BehYYh3r.js","names":[],"sources":["../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumberInput.vue","../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumberInput.vue","../../src/renderer/extensions/vueNodes/widgets/composables/useNumberStepCalculation.ts","../../src/renderer/extensions/vueNodes/widgets/composables/useNumberWidgetButtonPt.ts","../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumberSlider.vue","../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumberSlider.vue","../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumberSlider.vue","../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumber.vue","../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumber.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { onClickOutside } from '@vueuse/core'\nimport { computed, ref, useTemplateRef } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nimport Button from '@/components/ui/button/Button.vue'\nimport { evaluateInput } from '@/lib/litegraph/src/utils/widget'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\nimport { cn } from '@/utils/tailwindUtil'\nimport {\n  INPUT_EXCLUDED_PROPS,\n  filterWidgetProps\n} from '@/utils/widgetPropFilter'\n\nimport { WidgetInputBaseClass } from './layout'\nimport WidgetLayoutField from './layout/WidgetLayoutField.vue'\n\nconst { n } = useI18n()\n\nconst props = defineProps<{\n  widget: SimplifiedWidget<number>\n}>()\n\nconst widgetContainer = useTemplateRef<HTMLDivElement>('widgetContainer')\nconst inputField = useTemplateRef<HTMLInputElement>('inputField')\nconst textEdit = ref(false)\nonClickOutside(widgetContainer, () => {\n  if (textEdit.value) {\n    textEdit.value = false\n  }\n})\n\nconst decimalSeparator = computed(() => n(1.1).replace(/\\p{Number}/gu, ''))\nconst groupSeparator = computed(() => n(11111).replace(/\\p{Number}/gu, ''))\nfunction unformatValue(value: string) {\n  return value\n    .replaceAll(groupSeparator.value, '')\n    .replaceAll(decimalSeparator.value, '.')\n}\n\nconst modelValue = defineModel<number>({ default: 0 })\n\nconst formattedValue = computed(() => {\n  const unformattedValue = dragValue.value ?? modelValue.value\n  if ((unformattedValue as unknown) === '' || !isFinite(unformattedValue))\n    return `${unformattedValue}`\n\n  return n(unformattedValue, {\n    useGrouping: useGrouping.value,\n    minimumFractionDigits: precision.value,\n    maximumFractionDigits: precision.value\n  })\n})\n\nfunction updateValue(e: UIEvent) {\n  const { target } = e\n  if (!(target instanceof HTMLInputElement)) return\n  const parsed = evaluateInput(unformatValue(target.value))\n  if (parsed !== undefined)\n    modelValue.value = Math.min(\n      filteredProps.value.max,\n      Math.max(filteredProps.value.min, parsed)\n    )\n  else target.value = formattedValue.value\n\n  textEdit.value = false\n}\n\nconst canDecrement = computed(\n  () =>\n    modelValue.value > filteredProps.value.min &&\n    !props.widget.options?.disabled\n)\nconst canIncrement = computed(\n  () =>\n    modelValue.value < filteredProps.value.max &&\n    !props.widget.options?.disabled\n)\n\nconst filteredProps = computed(() =>\n  filterWidgetProps(props.widget.options, INPUT_EXCLUDED_PROPS)\n)\n\n// Get the precision value for proper number formatting\nconst precision = computed(() => {\n  const p = props.widget.options?.precision\n  // Treat negative or non-numeric precision as undefined\n  return typeof p === 'number' && p >= 0 ? p : undefined\n})\n\n// Calculate the step value based on precision or widget options\nconst stepValue = computed(() => {\n  // Use step2 (correct input spec value) if available\n  if (props.widget.options?.step2 !== undefined) {\n    return Number(props.widget.options.step2)\n  }\n  // Use step / 10 for custom large step values (> 10) to match litegraph behavior\n  // This is important for extensions like Impact Pack that use custom step values (e.g., 640)\n  // We skip default step values (1, 10) to avoid affecting normal widgets\n  const step = props.widget.options?.step\n  if (step !== undefined && step > 10) {\n    return Number(step) / 10\n  }\n  // Otherwise, derive from precision\n  if (precision.value !== undefined) {\n    if (precision.value === 0) {\n      return 1\n    }\n    // For precision > 0, step = 1 / (10^precision)\n    // precision 1 → 0.1, precision 2 → 0.01, etc.\n    return Number((1 / Math.pow(10, precision.value)).toFixed(precision.value))\n  }\n  // Default to 'any' for unrestricted stepping\n  return 0\n})\n\n// Disable grouping separators by default unless explicitly enabled by the node author\nconst useGrouping = computed(() => {\n  return props.widget.options?.useGrouping === true\n})\n\n// Check if increment/decrement buttons should be disabled due to precision limits\nconst buttonsDisabled = computed(() => {\n  const currentValue = modelValue.value ?? 0\n  return (\n    !Number.isFinite(currentValue) ||\n    Math.abs(currentValue) > Number.MAX_SAFE_INTEGER\n  )\n})\n\nfunction updateValueBy(delta: number) {\n  modelValue.value = Math.min(\n    filteredProps.value.max,\n    Math.max(filteredProps.value.min, modelValue.value + delta)\n  )\n}\n\nconst dragValue = ref<number>()\nconst dragDelta = ref(0)\nfunction handleMouseDown(e: PointerEvent) {\n  if (e.button > 0) return\n  if (props.widget.options?.disabled) return\n  const { target } = e\n  if (!(target instanceof HTMLElement)) return\n  target.setPointerCapture(e.pointerId)\n  dragValue.value = modelValue.value\n  dragDelta.value = 0\n}\nfunction handleMouseMove(e: PointerEvent) {\n  if (dragValue.value === undefined) return\n  dragDelta.value += e.movementX\n  const unclippedValue =\n    dragValue.value + ((dragDelta.value / 10) | 0) * stepValue.value\n  dragDelta.value %= 10\n  dragValue.value = Math.min(\n    filteredProps.value.max,\n    Math.max(filteredProps.value.min, unclippedValue)\n  )\n}\nfunction handleMouseUp() {\n  const newValue = dragValue.value\n  if (newValue === undefined) return\n\n  if (newValue === modelValue.value) {\n    textEdit.value = true\n    inputField.value?.focus()\n    inputField.value?.setSelectionRange(0, -1)\n  }\n\n  modelValue.value = newValue\n  dragValue.value = undefined\n  dragDelta.value = 0\n}\n\nconst buttonTooltip = computed(() => {\n  if (buttonsDisabled.value) {\n    return 'Increment/decrement disabled: value exceeds JavaScript precision limit (±2^53)'\n  }\n  return null\n})\n\nconst sliderWidth = computed(() => {\n  const { max, min, step } = filteredProps.value\n  if (\n    min === undefined ||\n    max === undefined ||\n    step === undefined ||\n    (max - min) / step >= 100\n  )\n    return 0\n  const value = dragValue.value ?? modelValue.value\n  const ratio = (value - min) / (max - min)\n  return (ratio * 100).toFixed(0)\n})\n</script>\n\n<template>\n  <WidgetLayoutField :widget>\n    <div\n      ref=\"widgetContainer\"\n      v-tooltip=\"buttonTooltip\"\n      v-bind=\"filteredProps\"\n      :aria-label=\"widget.name\"\n      :class=\"cn(WidgetInputBaseClass, 'grow text-xs flex h-7 relative')\"\n    >\n      <div\n        class=\"absolute size-full rounded-lg pointer-events-none overflow-clip\"\n      >\n        <div\n          class=\"bg-primary-background/15 size-full\"\n          :style=\"{ width: `${sliderWidth}%` }\"\n        />\n      </div>\n      <Button\n        v-if=\"!buttonsDisabled\"\n        data-testid=\"decrement\"\n        class=\"h-full w-8 rounded-r-none hover:bg-base-foreground/20 disabled:opacity-30\"\n        variant=\"muted-textonly\"\n        :disabled=\"!canDecrement\"\n        tabindex=\"-1\"\n        @click=\"modelValue -= stepValue\"\n      >\n        <i class=\"pi pi-minus\" />\n      </Button>\n      <div class=\"relative min-w-[4ch] flex-1 py-1.5 my-0.25\">\n        <input\n          ref=\"inputField\"\n          :aria-valuenow=\"dragValue ?? modelValue\"\n          :aria-valuemin=\"filteredProps.min\"\n          :aria-valuemax=\"filteredProps.max\"\n          :class=\"\n            cn(\n              'bg-transparent border-0 focus:outline-0 p-1 truncate text-sm absolute inset-0'\n            )\n          \"\n          inputmode=\"decimal\"\n          :value=\"formattedValue\"\n          role=\"spinbutton\"\n          tabindex=\"0\"\n          :disabled=\"widget.options?.disabled\"\n          autocomplete=\"off\"\n          autocorrect=\"off\"\n          spellcheck=\"false\"\n          @blur=\"updateValue\"\n          @keyup.enter=\"updateValue\"\n          @keydown.up.prevent=\"updateValueBy(stepValue)\"\n          @keydown.down.prevent=\"updateValueBy(-stepValue)\"\n          @keydown.page-up.prevent=\"updateValueBy(10 * stepValue)\"\n          @keydown.page-down.prevent=\"updateValueBy(-10 * stepValue)\"\n          @dragstart.prevent\n        />\n        <div\n          :class=\"\n            cn(\n              'absolute inset-0 z-10 cursor-ew-resize',\n              textEdit && 'hidden pointer-events-none'\n            )\n          \"\n          @pointerdown=\"handleMouseDown\"\n          @pointermove=\"handleMouseMove\"\n          @pointerup=\"handleMouseUp\"\n          @pointercancel=\"\n            () => {\n              dragValue = undefined\n              dragDelta = 0\n            }\n          \"\n        />\n      </div>\n\n      <slot />\n      <Button\n        v-if=\"!buttonsDisabled\"\n        data-testid=\"increment\"\n        class=\"h-full w-8 rounded-l-none hover:bg-base-foreground/20 disabled:opacity-30\"\n        variant=\"muted-textonly\"\n        :disabled=\"!canIncrement\"\n        tabindex=\"-1\"\n        @click=\"modelValue += stepValue\"\n      >\n        <i class=\"pi pi-plus\" />\n      </Button>\n    </div>\n  </WidgetLayoutField>\n</template>\n","<script setup lang=\"ts\">\nimport { onClickOutside } from '@vueuse/core'\nimport { computed, ref, useTemplateRef } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nimport Button from '@/components/ui/button/Button.vue'\nimport { evaluateInput } from '@/lib/litegraph/src/utils/widget'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\nimport { cn } from '@/utils/tailwindUtil'\nimport {\n  INPUT_EXCLUDED_PROPS,\n  filterWidgetProps\n} from '@/utils/widgetPropFilter'\n\nimport { WidgetInputBaseClass } from './layout'\nimport WidgetLayoutField from './layout/WidgetLayoutField.vue'\n\nconst { n } = useI18n()\n\nconst props = defineProps<{\n  widget: SimplifiedWidget<number>\n}>()\n\nconst widgetContainer = useTemplateRef<HTMLDivElement>('widgetContainer')\nconst inputField = useTemplateRef<HTMLInputElement>('inputField')\nconst textEdit = ref(false)\nonClickOutside(widgetContainer, () => {\n  if (textEdit.value) {\n    textEdit.value = false\n  }\n})\n\nconst decimalSeparator = computed(() => n(1.1).replace(/\\p{Number}/gu, ''))\nconst groupSeparator = computed(() => n(11111).replace(/\\p{Number}/gu, ''))\nfunction unformatValue(value: string) {\n  return value\n    .replaceAll(groupSeparator.value, '')\n    .replaceAll(decimalSeparator.value, '.')\n}\n\nconst modelValue = defineModel<number>({ default: 0 })\n\nconst formattedValue = computed(() => {\n  const unformattedValue = dragValue.value ?? modelValue.value\n  if ((unformattedValue as unknown) === '' || !isFinite(unformattedValue))\n    return `${unformattedValue}`\n\n  return n(unformattedValue, {\n    useGrouping: useGrouping.value,\n    minimumFractionDigits: precision.value,\n    maximumFractionDigits: precision.value\n  })\n})\n\nfunction updateValue(e: UIEvent) {\n  const { target } = e\n  if (!(target instanceof HTMLInputElement)) return\n  const parsed = evaluateInput(unformatValue(target.value))\n  if (parsed !== undefined)\n    modelValue.value = Math.min(\n      filteredProps.value.max,\n      Math.max(filteredProps.value.min, parsed)\n    )\n  else target.value = formattedValue.value\n\n  textEdit.value = false\n}\n\nconst canDecrement = computed(\n  () =>\n    modelValue.value > filteredProps.value.min &&\n    !props.widget.options?.disabled\n)\nconst canIncrement = computed(\n  () =>\n    modelValue.value < filteredProps.value.max &&\n    !props.widget.options?.disabled\n)\n\nconst filteredProps = computed(() =>\n  filterWidgetProps(props.widget.options, INPUT_EXCLUDED_PROPS)\n)\n\n// Get the precision value for proper number formatting\nconst precision = computed(() => {\n  const p = props.widget.options?.precision\n  // Treat negative or non-numeric precision as undefined\n  return typeof p === 'number' && p >= 0 ? p : undefined\n})\n\n// Calculate the step value based on precision or widget options\nconst stepValue = computed(() => {\n  // Use step2 (correct input spec value) if available\n  if (props.widget.options?.step2 !== undefined) {\n    return Number(props.widget.options.step2)\n  }\n  // Use step / 10 for custom large step values (> 10) to match litegraph behavior\n  // This is important for extensions like Impact Pack that use custom step values (e.g., 640)\n  // We skip default step values (1, 10) to avoid affecting normal widgets\n  const step = props.widget.options?.step\n  if (step !== undefined && step > 10) {\n    return Number(step) / 10\n  }\n  // Otherwise, derive from precision\n  if (precision.value !== undefined) {\n    if (precision.value === 0) {\n      return 1\n    }\n    // For precision > 0, step = 1 / (10^precision)\n    // precision 1 → 0.1, precision 2 → 0.01, etc.\n    return Number((1 / Math.pow(10, precision.value)).toFixed(precision.value))\n  }\n  // Default to 'any' for unrestricted stepping\n  return 0\n})\n\n// Disable grouping separators by default unless explicitly enabled by the node author\nconst useGrouping = computed(() => {\n  return props.widget.options?.useGrouping === true\n})\n\n// Check if increment/decrement buttons should be disabled due to precision limits\nconst buttonsDisabled = computed(() => {\n  const currentValue = modelValue.value ?? 0\n  return (\n    !Number.isFinite(currentValue) ||\n    Math.abs(currentValue) > Number.MAX_SAFE_INTEGER\n  )\n})\n\nfunction updateValueBy(delta: number) {\n  modelValue.value = Math.min(\n    filteredProps.value.max,\n    Math.max(filteredProps.value.min, modelValue.value + delta)\n  )\n}\n\nconst dragValue = ref<number>()\nconst dragDelta = ref(0)\nfunction handleMouseDown(e: PointerEvent) {\n  if (e.button > 0) return\n  if (props.widget.options?.disabled) return\n  const { target } = e\n  if (!(target instanceof HTMLElement)) return\n  target.setPointerCapture(e.pointerId)\n  dragValue.value = modelValue.value\n  dragDelta.value = 0\n}\nfunction handleMouseMove(e: PointerEvent) {\n  if (dragValue.value === undefined) return\n  dragDelta.value += e.movementX\n  const unclippedValue =\n    dragValue.value + ((dragDelta.value / 10) | 0) * stepValue.value\n  dragDelta.value %= 10\n  dragValue.value = Math.min(\n    filteredProps.value.max,\n    Math.max(filteredProps.value.min, unclippedValue)\n  )\n}\nfunction handleMouseUp() {\n  const newValue = dragValue.value\n  if (newValue === undefined) return\n\n  if (newValue === modelValue.value) {\n    textEdit.value = true\n    inputField.value?.focus()\n    inputField.value?.setSelectionRange(0, -1)\n  }\n\n  modelValue.value = newValue\n  dragValue.value = undefined\n  dragDelta.value = 0\n}\n\nconst buttonTooltip = computed(() => {\n  if (buttonsDisabled.value) {\n    return 'Increment/decrement disabled: value exceeds JavaScript precision limit (±2^53)'\n  }\n  return null\n})\n\nconst sliderWidth = computed(() => {\n  const { max, min, step } = filteredProps.value\n  if (\n    min === undefined ||\n    max === undefined ||\n    step === undefined ||\n    (max - min) / step >= 100\n  )\n    return 0\n  const value = dragValue.value ?? modelValue.value\n  const ratio = (value - min) / (max - min)\n  return (ratio * 100).toFixed(0)\n})\n</script>\n\n<template>\n  <WidgetLayoutField :widget>\n    <div\n      ref=\"widgetContainer\"\n      v-tooltip=\"buttonTooltip\"\n      v-bind=\"filteredProps\"\n      :aria-label=\"widget.name\"\n      :class=\"cn(WidgetInputBaseClass, 'grow text-xs flex h-7 relative')\"\n    >\n      <div\n        class=\"absolute size-full rounded-lg pointer-events-none overflow-clip\"\n      >\n        <div\n          class=\"bg-primary-background/15 size-full\"\n          :style=\"{ width: `${sliderWidth}%` }\"\n        />\n      </div>\n      <Button\n        v-if=\"!buttonsDisabled\"\n        data-testid=\"decrement\"\n        class=\"h-full w-8 rounded-r-none hover:bg-base-foreground/20 disabled:opacity-30\"\n        variant=\"muted-textonly\"\n        :disabled=\"!canDecrement\"\n        tabindex=\"-1\"\n        @click=\"modelValue -= stepValue\"\n      >\n        <i class=\"pi pi-minus\" />\n      </Button>\n      <div class=\"relative min-w-[4ch] flex-1 py-1.5 my-0.25\">\n        <input\n          ref=\"inputField\"\n          :aria-valuenow=\"dragValue ?? modelValue\"\n          :aria-valuemin=\"filteredProps.min\"\n          :aria-valuemax=\"filteredProps.max\"\n          :class=\"\n            cn(\n              'bg-transparent border-0 focus:outline-0 p-1 truncate text-sm absolute inset-0'\n            )\n          \"\n          inputmode=\"decimal\"\n          :value=\"formattedValue\"\n          role=\"spinbutton\"\n          tabindex=\"0\"\n          :disabled=\"widget.options?.disabled\"\n          autocomplete=\"off\"\n          autocorrect=\"off\"\n          spellcheck=\"false\"\n          @blur=\"updateValue\"\n          @keyup.enter=\"updateValue\"\n          @keydown.up.prevent=\"updateValueBy(stepValue)\"\n          @keydown.down.prevent=\"updateValueBy(-stepValue)\"\n          @keydown.page-up.prevent=\"updateValueBy(10 * stepValue)\"\n          @keydown.page-down.prevent=\"updateValueBy(-10 * stepValue)\"\n          @dragstart.prevent\n        />\n        <div\n          :class=\"\n            cn(\n              'absolute inset-0 z-10 cursor-ew-resize',\n              textEdit && 'hidden pointer-events-none'\n            )\n          \"\n          @pointerdown=\"handleMouseDown\"\n          @pointermove=\"handleMouseMove\"\n          @pointerup=\"handleMouseUp\"\n          @pointercancel=\"\n            () => {\n              dragValue = undefined\n              dragDelta = 0\n            }\n          \"\n        />\n      </div>\n\n      <slot />\n      <Button\n        v-if=\"!buttonsDisabled\"\n        data-testid=\"increment\"\n        class=\"h-full w-8 rounded-l-none hover:bg-base-foreground/20 disabled:opacity-30\"\n        variant=\"muted-textonly\"\n        :disabled=\"!canIncrement\"\n        tabindex=\"-1\"\n        @click=\"modelValue += stepValue\"\n      >\n        <i class=\"pi pi-plus\" />\n      </Button>\n    </div>\n  </WidgetLayoutField>\n</template>\n","import { computed, toValue } from 'vue'\nimport type { MaybeRefOrGetter } from 'vue'\n\ninterface NumberWidgetOptions {\n  step?: number\n  step2?: number\n  precision?: number\n}\n\n/**\n * Shared composable for calculating step values in number input widgets\n * Handles both explicit step2 values and precision-derived steps\n */\nexport function useNumberStepCalculation(\n  options: NumberWidgetOptions | undefined,\n  precisionArg: MaybeRefOrGetter<number | undefined>,\n  returnUndefinedForDefault = false\n) {\n  return computed(() => {\n    const precision = toValue(precisionArg)\n    // Use step2 (correct input spec value) if available\n    if (options?.step2 !== undefined) {\n      return Number(options.step2)\n    }\n    // Use step / 10 for custom large step values (> 10) to match litegraph behavior\n    // This is important for extensions like Impact Pack that use custom step values (e.g., 640)\n    // We skip default step values (1, 10) to avoid affecting normal widgets\n    const step = options?.step\n    if (step !== undefined && step > 10) {\n      return Number(step) / 10\n    }\n\n    if (precision === undefined) {\n      return returnUndefinedForDefault ? undefined : 0\n    }\n\n    if (precision === 0) return 1\n\n    // For precision > 0, step = 1 / (10^precision)\n    const calculatedStep = 1 / Math.pow(10, precision)\n    return returnUndefinedForDefault\n      ? calculatedStep\n      : Number(calculatedStep.toFixed(precision))\n  })\n}\n","import { cn } from '@comfyorg/tailwind-utils'\n\nconst sharedButtonClasses = cn(\n  'inline-flex items-center justify-center border-0 bg-transparent text-inherit transition-colors duration-150 ease-in-out ',\n  'hover:bg-node-component-surface-hovered active:bg-node-component-surface-selected',\n  'disabled:bg-node-component-disabled disabled:text-node-icon-disabled disabled:cursor-not-allowed'\n)\n\nexport function useNumberWidgetButtonPt(options?: {\n  roundedLeft?: boolean\n  roundedRight?: boolean\n}) {\n  const { roundedLeft = false, roundedRight = false } = options ?? {}\n\n  const increment = cn(sharedButtonClasses, roundedRight && 'rounded-r-lg')\n  const decrement = cn(sharedButtonClasses, roundedLeft && 'rounded-l-lg')\n\n  return {\n    incrementButton: {\n      class: increment\n    },\n    decrementButton: {\n      class: decrement\n    }\n  }\n}\n","<template>\n  <WidgetLayoutField :widget=\"widget\">\n    <div :class=\"cn(WidgetInputBaseClass, 'flex items-center gap-2 pl-3 pr-2')\">\n      <Slider\n        :model-value=\"[modelValue]\"\n        v-bind=\"filteredProps\"\n        class=\"flex-grow text-xs\"\n        :step=\"stepValue\"\n        :aria-label=\"widget.name\"\n        @update:model-value=\"updateLocalValue\"\n      />\n      <InputNumber\n        :key=\"timesEmptied\"\n        :model-value=\"modelValue\"\n        v-bind=\"filteredProps\"\n        :step=\"stepValue\"\n        :min-fraction-digits=\"precision\"\n        :max-fraction-digits=\"precision\"\n        :aria-label=\"widget.name\"\n        size=\"small\"\n        pt:pc-input-text:root=\"min-w-[4ch] bg-transparent border-none text-center truncate\"\n        class=\"w-16\"\n        :pt=\"sliderNumberPt\"\n        @update:model-value=\"handleNumberInputUpdate\"\n      />\n    </div>\n  </WidgetLayoutField>\n</template>\n\n<script setup lang=\"ts\">\nimport InputNumber from 'primevue/inputnumber'\nimport { computed, ref } from 'vue'\n\nimport Slider from '@/components/ui/slider/Slider.vue'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\nimport { cn } from '@/utils/tailwindUtil'\nimport {\n  STANDARD_EXCLUDED_PROPS,\n  filterWidgetProps\n} from '@/utils/widgetPropFilter'\n\nimport { useNumberStepCalculation } from '../composables/useNumberStepCalculation'\nimport { useNumberWidgetButtonPt } from '../composables/useNumberWidgetButtonPt'\nimport { WidgetInputBaseClass } from './layout'\nimport WidgetLayoutField from './layout/WidgetLayoutField.vue'\n\nconst { widget } = defineProps<{\n  widget: SimplifiedWidget<number>\n}>()\n\nconst modelValue = defineModel<number>({ default: 0 })\n\nconst timesEmptied = ref(0)\n\nconst updateLocalValue = (newValue: number[] | undefined): void => {\n  if (newValue?.length) modelValue.value = newValue[0]\n}\n\nconst handleNumberInputUpdate = (newValue: number | undefined) => {\n  if (newValue !== undefined) {\n    updateLocalValue([newValue])\n    return\n  }\n  timesEmptied.value += 1\n}\n\nconst filteredProps = computed(() =>\n  filterWidgetProps(widget.options, STANDARD_EXCLUDED_PROPS)\n)\n\nconst p = widget.options?.precision\nconst precision = typeof p === 'number' && p >= 0 ? p : undefined\n\n// Calculate the step value based on precision or widget options\nconst stepValue = useNumberStepCalculation(widget.options, precision, true)\n\nconst sliderNumberPt = useNumberWidgetButtonPt({\n  roundedLeft: true,\n  roundedRight: true\n})\n</script>\n\n<style scoped>\n:deep(.p-inputnumber-button.p-disabled .pi),\n:deep(.p-inputnumber-button.p-disabled .p-icon) {\n  color: var(--color-node-icon-disabled) !important;\n}\n</style>\n","<template>\n  <WidgetLayoutField :widget=\"widget\">\n    <div :class=\"cn(WidgetInputBaseClass, 'flex items-center gap-2 pl-3 pr-2')\">\n      <Slider\n        :model-value=\"[modelValue]\"\n        v-bind=\"filteredProps\"\n        class=\"flex-grow text-xs\"\n        :step=\"stepValue\"\n        :aria-label=\"widget.name\"\n        @update:model-value=\"updateLocalValue\"\n      />\n      <InputNumber\n        :key=\"timesEmptied\"\n        :model-value=\"modelValue\"\n        v-bind=\"filteredProps\"\n        :step=\"stepValue\"\n        :min-fraction-digits=\"precision\"\n        :max-fraction-digits=\"precision\"\n        :aria-label=\"widget.name\"\n        size=\"small\"\n        pt:pc-input-text:root=\"min-w-[4ch] bg-transparent border-none text-center truncate\"\n        class=\"w-16\"\n        :pt=\"sliderNumberPt\"\n        @update:model-value=\"handleNumberInputUpdate\"\n      />\n    </div>\n  </WidgetLayoutField>\n</template>\n\n<script setup lang=\"ts\">\nimport InputNumber from 'primevue/inputnumber'\nimport { computed, ref } from 'vue'\n\nimport Slider from '@/components/ui/slider/Slider.vue'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\nimport { cn } from '@/utils/tailwindUtil'\nimport {\n  STANDARD_EXCLUDED_PROPS,\n  filterWidgetProps\n} from '@/utils/widgetPropFilter'\n\nimport { useNumberStepCalculation } from '../composables/useNumberStepCalculation'\nimport { useNumberWidgetButtonPt } from '../composables/useNumberWidgetButtonPt'\nimport { WidgetInputBaseClass } from './layout'\nimport WidgetLayoutField from './layout/WidgetLayoutField.vue'\n\nconst { widget } = defineProps<{\n  widget: SimplifiedWidget<number>\n}>()\n\nconst modelValue = defineModel<number>({ default: 0 })\n\nconst timesEmptied = ref(0)\n\nconst updateLocalValue = (newValue: number[] | undefined): void => {\n  if (newValue?.length) modelValue.value = newValue[0]\n}\n\nconst handleNumberInputUpdate = (newValue: number | undefined) => {\n  if (newValue !== undefined) {\n    updateLocalValue([newValue])\n    return\n  }\n  timesEmptied.value += 1\n}\n\nconst filteredProps = computed(() =>\n  filterWidgetProps(widget.options, STANDARD_EXCLUDED_PROPS)\n)\n\nconst p = widget.options?.precision\nconst precision = typeof p === 'number' && p >= 0 ? p : undefined\n\n// Calculate the step value based on precision or widget options\nconst stepValue = useNumberStepCalculation(widget.options, precision, true)\n\nconst sliderNumberPt = useNumberWidgetButtonPt({\n  roundedLeft: true,\n  roundedRight: true\n})\n</script>\n\n<style scoped>\n:deep(.p-inputnumber-button.p-disabled .pi),\n:deep(.p-inputnumber-button.p-disabled .p-icon) {\n  color: var(--color-node-icon-disabled) !important;\n}\n</style>\n","<template>\n  <WidgetLayoutField :widget=\"widget\">\n    <div :class=\"cn(WidgetInputBaseClass, 'flex items-center gap-2 pl-3 pr-2')\">\n      <Slider\n        :model-value=\"[modelValue]\"\n        v-bind=\"filteredProps\"\n        class=\"flex-grow text-xs\"\n        :step=\"stepValue\"\n        :aria-label=\"widget.name\"\n        @update:model-value=\"updateLocalValue\"\n      />\n      <InputNumber\n        :key=\"timesEmptied\"\n        :model-value=\"modelValue\"\n        v-bind=\"filteredProps\"\n        :step=\"stepValue\"\n        :min-fraction-digits=\"precision\"\n        :max-fraction-digits=\"precision\"\n        :aria-label=\"widget.name\"\n        size=\"small\"\n        pt:pc-input-text:root=\"min-w-[4ch] bg-transparent border-none text-center truncate\"\n        class=\"w-16\"\n        :pt=\"sliderNumberPt\"\n        @update:model-value=\"handleNumberInputUpdate\"\n      />\n    </div>\n  </WidgetLayoutField>\n</template>\n\n<script setup lang=\"ts\">\nimport InputNumber from 'primevue/inputnumber'\nimport { computed, ref } from 'vue'\n\nimport Slider from '@/components/ui/slider/Slider.vue'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\nimport { cn } from '@/utils/tailwindUtil'\nimport {\n  STANDARD_EXCLUDED_PROPS,\n  filterWidgetProps\n} from '@/utils/widgetPropFilter'\n\nimport { useNumberStepCalculation } from '../composables/useNumberStepCalculation'\nimport { useNumberWidgetButtonPt } from '../composables/useNumberWidgetButtonPt'\nimport { WidgetInputBaseClass } from './layout'\nimport WidgetLayoutField from './layout/WidgetLayoutField.vue'\n\nconst { widget } = defineProps<{\n  widget: SimplifiedWidget<number>\n}>()\n\nconst modelValue = defineModel<number>({ default: 0 })\n\nconst timesEmptied = ref(0)\n\nconst updateLocalValue = (newValue: number[] | undefined): void => {\n  if (newValue?.length) modelValue.value = newValue[0]\n}\n\nconst handleNumberInputUpdate = (newValue: number | undefined) => {\n  if (newValue !== undefined) {\n    updateLocalValue([newValue])\n    return\n  }\n  timesEmptied.value += 1\n}\n\nconst filteredProps = computed(() =>\n  filterWidgetProps(widget.options, STANDARD_EXCLUDED_PROPS)\n)\n\nconst p = widget.options?.precision\nconst precision = typeof p === 'number' && p >= 0 ? p : undefined\n\n// Calculate the step value based on precision or widget options\nconst stepValue = useNumberStepCalculation(widget.options, precision, true)\n\nconst sliderNumberPt = useNumberWidgetButtonPt({\n  roundedLeft: true,\n  roundedRight: true\n})\n</script>\n\n<style scoped>\n:deep(.p-inputnumber-button.p-disabled .pi),\n:deep(.p-inputnumber-button.p-disabled .p-icon) {\n  color: var(--color-node-icon-disabled) !important;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\n\nimport type {\n  SimplifiedControlWidget,\n  SimplifiedWidget\n} from '@/types/simplifiedWidget'\n\nimport WidgetInputNumberInput from './WidgetInputNumberInput.vue'\nimport WidgetInputNumberSlider from './WidgetInputNumberSlider.vue'\nimport WidgetWithControl from './WidgetWithControl.vue'\n\nconst props = defineProps<{\n  widget: SimplifiedWidget<number>\n}>()\n\nconst modelValue = defineModel<number>({ default: 0 })\n\nconst hasControlAfterGenerate = computed(() => {\n  return !!props.widget.controlWidget\n})\n</script>\n\n<template>\n  <WidgetWithControl\n    v-if=\"hasControlAfterGenerate\"\n    v-model=\"modelValue\"\n    :widget=\"widget as SimplifiedControlWidget<number>\"\n    :component=\"\n      widget.type === 'slider'\n        ? WidgetInputNumberSlider\n        : WidgetInputNumberInput\n    \"\n  />\n  <component\n    :is=\"\n      widget.type === 'slider'\n        ? WidgetInputNumberSlider\n        : WidgetInputNumberInput\n    \"\n    v-else\n    v-model=\"modelValue\"\n    :widget=\"widget\"\n    v-bind=\"$attrs\"\n  />\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\n\nimport type {\n  SimplifiedControlWidget,\n  SimplifiedWidget\n} from '@/types/simplifiedWidget'\n\nimport WidgetInputNumberInput from './WidgetInputNumberInput.vue'\nimport WidgetInputNumberSlider from './WidgetInputNumberSlider.vue'\nimport WidgetWithControl from './WidgetWithControl.vue'\n\nconst props = defineProps<{\n  widget: SimplifiedWidget<number>\n}>()\n\nconst modelValue = defineModel<number>({ default: 0 })\n\nconst hasControlAfterGenerate = computed(() => {\n  return !!props.widget.controlWidget\n})\n</script>\n\n<template>\n  <WidgetWithControl\n    v-if=\"hasControlAfterGenerate\"\n    v-model=\"modelValue\"\n    :widget=\"widget as SimplifiedControlWidget<number>\"\n    :component=\"\n      widget.type === 'slider'\n        ? WidgetInputNumberSlider\n        : WidgetInputNumberInput\n    \"\n  />\n  <component\n    :is=\"\n      widget.type === 'slider'\n        ? WidgetInputNumberSlider\n        : WidgetInputNumberInput\n    \"\n    v-else\n    v-model=\"modelValue\"\n    :widget=\"widget\"\n    v-bind=\"$attrs\"\n  />\n</template>\n"],"mappings":"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"}