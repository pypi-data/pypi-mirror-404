{"version":3,"file":"previousFullPath-p7j9JQSU.js","names":[],"sources":["../../src/platform/cloud/onboarding/utils/previousFullPath.ts"],"sourcesContent":["import type { LocationQuery } from 'vue-router'\n\nconst decodeQueryParam = (value: string): string | null => {\n  try {\n    return decodeURIComponent(value)\n  } catch {\n    return null\n  }\n}\n\nconst isSafeInternalRedirectPath = (path: string): boolean => {\n  // Must be a relative in-app path. Disallow protocol-relative URLs (\"//evil.com\").\n  return path.startsWith('/') && !path.startsWith('//')\n}\n\nexport const getSafePreviousFullPath = (\n  query: LocationQuery\n): string | null => {\n  const raw = query.previousFullPath\n  const value = Array.isArray(raw) ? raw[0] : raw\n  if (!value) return null\n\n  const decoded = decodeQueryParam(value)\n  if (!decoded) return null\n\n  return isSafeInternalRedirectPath(decoded) ? decoded : null\n}\n"],"mappings":"4IAEM,iBAAoB,GAAiC,CACzD,GAAI,CACF,OAAO,mBAAmB,EAAM,MAC1B,CACN,OAAO,OAIL,2BAA8B,GAE3B,EAAK,WAAW,IAAI,EAAI,CAAC,EAAK,WAAW,KAAK,CAG1C,wBACX,GACkB,CAClB,IAAM,EAAM,EAAM,iBACZ,EAAQ,MAAM,QAAQ,EAAI,CAAG,EAAI,GAAK,EAC5C,GAAI,CAAC,EAAO,OAAO,KAEnB,IAAM,EAAU,iBAAiB,EAAM,CAGvC,OAFK,GAEE,2BAA2B,EAAQ,CAAG,EAAU"}