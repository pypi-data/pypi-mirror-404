import{i as e,n as t}from"./rolldown-runtime-BKYq3fBv.js";import{an as n,i as r,on as i,r as a}from"./api-CJ30itpV.js";import{i as o,r as s}from"./useErrorHandling-tavTBerX.js";import{Ho as c,Vo as l,bi as u,xi as d}from"./dialogService-DvYmp2_F.js";var useSessionCookie,f=t((()=>{s(),n(),r(),l(),useSessionCookie=()=>{let createSession=async()=>{if(!i)return;let{flags:e}=o();try{let t=c(),n;if(e.teamWorkspacesEnabled){let e=await t.getIdToken();if(!e){console.warn(`Failed to create session cookie:`,`No Firebase token available for session creation`);return}n={Authorization:`Bearer ${e}`}}else{let e=await t.getAuthHeader();if(!e){console.warn(`Failed to create session cookie:`,`No auth header available for session creation`);return}n=e}let r=await fetch(a.apiURL(`/auth/session`),{method:`POST`,credentials:`include`,headers:{...n,"Content-Type":`application/json`}});if(!r.ok){let e=await r.json().catch(()=>({}));console.warn(`Failed to create session cookie:`,e.message||r.statusText)}}catch(e){console.warn(`Failed to create session cookie:`,e)}},deleteSession=async()=>{if(i)try{let e=await fetch(a.apiURL(`/auth/session`),{method:`DELETE`,credentials:`include`});if(!e.ok){let t=await e.json().catch(()=>({}));console.warn(`Failed to delete session cookie:`,t.message||e.statusText)}}catch(e){console.warn(`Failed to delete session cookie:`,e)}};return{createSession,deleteSession}}}));t((()=>{f(),u(),d().registerExtension({name:`Comfy.Cloud.SessionCookie`,onAuthUserResolved:async()=>{let{createSession:e}=useSessionCookie();await e()},onAuthTokenRefreshed:async()=>{let{createSession:e}=useSessionCookie();await e()},onAuthUserLogout:async()=>{let{deleteSession:e}=useSessionCookie();await e()}})}))();
//# sourceMappingURL=cloudSessionCookie-BX0BTRc5.js.map