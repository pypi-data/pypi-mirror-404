{"version":3,"file":"SubscriptionPanelContentWorkspace-927KK1ZO.js","names":[],"sources":["../../src/platform/cloud/subscription/components/SubscriptionPanelContentWorkspace.vue","../../src/platform/cloud/subscription/components/SubscriptionPanelContentWorkspace.vue","../../src/platform/cloud/subscription/components/SubscriptionPanelContentWorkspace.vue"],"sourcesContent":["<template>\n  <div class=\"grow overflow-auto pt-6\">\n    <div class=\"rounded-2xl border border-interface-stroke p-6\">\n      <div>\n        <div\n          class=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between md:gap-2\"\n        >\n          <!-- OWNER Unsubscribed State -->\n          <template v-if=\"showSubscribePrompt\">\n            <div class=\"flex flex-col gap-2\">\n              <div class=\"text-sm font-bold text-text-primary\">\n                {{ $t('subscription.workspaceNotSubscribed') }}\n              </div>\n              <div class=\"text-sm text-text-secondary\">\n                {{ $t('subscription.subscriptionRequiredMessage') }}\n              </div>\n            </div>\n            <Button\n              variant=\"primary\"\n              size=\"lg\"\n              class=\"ml-auto rounded-lg px-4 py-2 text-sm font-normal\"\n              @click=\"handleSubscribeWorkspace\"\n            >\n              {{ $t('subscription.subscribeNow') }}\n            </Button>\n          </template>\n\n          <!-- MEMBER View - read-only, no subscription data yet -->\n          <template v-else-if=\"isMemberView\">\n            <div class=\"flex flex-col gap-2\">\n              <div class=\"text-sm font-bold text-text-primary\">\n                {{ $t('subscription.workspaceNotSubscribed') }}\n              </div>\n              <div class=\"text-sm text-text-secondary\">\n                {{ $t('subscription.contactOwnerToSubscribe') }}\n              </div>\n            </div>\n          </template>\n\n          <!-- Normal Subscribed State (Owner with subscription) -->\n          <template v-else>\n            <div class=\"flex flex-col gap-2\">\n              <div class=\"text-sm font-bold text-text-primary\">\n                {{ subscriptionTierName }}\n              </div>\n              <div class=\"flex items-baseline gap-1 font-inter font-semibold\">\n                <span class=\"text-2xl\">${{ tierPrice }}</span>\n                <span class=\"text-base\">{{ $t('subscription.perMonth') }}</span>\n              </div>\n              <div\n                v-if=\"isActiveSubscription\"\n                class=\"text-sm text-text-secondary\"\n              >\n                <template v-if=\"isCancelled\">\n                  {{\n                    $t('subscription.expiresDate', {\n                      date: formattedEndDate\n                    })\n                  }}\n                </template>\n                <template v-else>\n                  {{\n                    $t('subscription.renewsDate', {\n                      date: formattedRenewalDate\n                    })\n                  }}\n                </template>\n              </div>\n            </div>\n\n            <div\n              v-if=\"isActiveSubscription && permissions.canManageSubscription\"\n              class=\"flex flex-wrap gap-2 md:ml-auto\"\n            >\n              <Button\n                size=\"lg\"\n                variant=\"secondary\"\n                class=\"rounded-lg px-4 text-sm font-normal text-text-primary bg-interface-menu-component-surface-selected\"\n                @click=\"\n                  async () => {\n                    await authActions.accessBillingPortal()\n                  }\n                \"\n              >\n                {{ $t('subscription.managePayment') }}\n              </Button>\n              <Button\n                size=\"lg\"\n                variant=\"primary\"\n                class=\"rounded-lg px-4 text-sm font-normal text-text-primary\"\n                @click=\"showSubscriptionDialog\"\n              >\n                {{ $t('subscription.upgradePlan') }}\n              </Button>\n              <Button\n                v-tooltip=\"{ value: $t('g.moreOptions'), showDelay: 300 }\"\n                variant=\"secondary\"\n                size=\"lg\"\n                :aria-label=\"$t('g.moreOptions')\"\n                @click=\"planMenu?.toggle($event)\"\n              >\n                <i class=\"pi pi-ellipsis-h\" />\n              </Button>\n              <Menu ref=\"planMenu\" :model=\"planMenuItems\" :popup=\"true\" />\n            </div>\n          </template>\n        </div>\n      </div>\n\n      <div class=\"flex flex-col lg:flex-row gap-6 pt-9\">\n        <div class=\"flex flex-col shrink-0\">\n          <div class=\"flex flex-col gap-3\">\n            <div\n              :class=\"\n                cn(\n                  'relative flex flex-col gap-6 rounded-2xl p-5',\n                  'bg-modal-panel-background'\n                )\n              \"\n            >\n              <Button\n                variant=\"muted-textonly\"\n                size=\"icon-sm\"\n                class=\"absolute top-4 right-4\"\n                :loading=\"isLoadingBalance\"\n                @click=\"handleRefresh\"\n              >\n                <i class=\"pi pi-sync text-text-secondary text-sm\" />\n              </Button>\n\n              <div class=\"flex flex-col gap-2\">\n                <div class=\"text-sm text-muted\">\n                  {{ $t('subscription.totalCredits') }}\n                </div>\n                <Skeleton v-if=\"isLoadingBalance\" width=\"8rem\" height=\"2rem\" />\n                <div v-else class=\"text-2xl font-bold\">\n                  {{ showZeroState ? '0' : totalCredits }}\n                </div>\n              </div>\n\n              <!-- Credit Breakdown -->\n              <table class=\"text-sm text-muted\">\n                <tbody>\n                  <tr>\n                    <td class=\"pr-4 font-bold text-left align-middle\">\n                      <Skeleton\n                        v-if=\"isLoadingBalance\"\n                        width=\"5rem\"\n                        height=\"1rem\"\n                      />\n                      <span v-else>{{\n                        showZeroState ? '0 / 0' : includedCreditsDisplay\n                      }}</span>\n                    </td>\n                    <td class=\"align-middle\" :title=\"creditsRemainingLabel\">\n                      {{ creditsRemainingLabel }}\n                    </td>\n                  </tr>\n                  <tr>\n                    <td class=\"pr-4 font-bold text-left align-middle\">\n                      <Skeleton\n                        v-if=\"isLoadingBalance\"\n                        width=\"3rem\"\n                        height=\"1rem\"\n                      />\n                      <span v-else>{{\n                        showZeroState ? '0' : prepaidCredits\n                      }}</span>\n                    </td>\n                    <td\n                      class=\"align-middle\"\n                      :title=\"$t('subscription.creditsYouveAdded')\"\n                    >\n                      {{ $t('subscription.creditsYouveAdded') }}\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n\n              <div class=\"flex items-center justify-between\">\n                <a\n                  href=\"https://platform.comfy.org/profile/usage\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  class=\"text-sm underline text-center text-muted\"\n                >\n                  {{ $t('subscription.viewUsageHistory') }}\n                </a>\n                <Button\n                  v-if=\"isActiveSubscription && !showZeroState\"\n                  variant=\"secondary\"\n                  class=\"p-2 min-h-8 rounded-lg text-sm font-normal text-text-primary bg-interface-menu-component-surface-selected\"\n                  @click=\"handleAddApiCredits\"\n                >\n                  {{ $t('subscription.addCredits') }}\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"flex flex-col gap-2\">\n          <div class=\"text-sm text-text-primary\">\n            {{ $t('subscription.yourPlanIncludes') }}\n          </div>\n\n          <div class=\"flex flex-col gap-0\">\n            <div\n              v-for=\"benefit in tierBenefits\"\n              :key=\"benefit.key\"\n              class=\"flex items-center gap-2 py-2\"\n            >\n              <i\n                v-if=\"benefit.type === 'feature'\"\n                class=\"pi pi-check text-xs text-text-primary\"\n              />\n              <span\n                v-else-if=\"benefit.type === 'metric' && benefit.value\"\n                class=\"text-sm font-normal whitespace-nowrap text-text-primary\"\n              >\n                {{ benefit.value }}\n              </span>\n              <span class=\"text-sm text-muted\">\n                {{ benefit.label }}\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- View More Details - Outside main content -->\n    <div class=\"flex items-center gap-2 py-4\">\n      <i class=\"pi pi-external-link text-muted\"></i>\n      <a\n        href=\"https://www.comfy.org/cloud/pricing\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        class=\"text-sm underline hover:opacity-80 text-muted\"\n      >\n        {{ $t('subscription.viewMoreDetailsPlans') }}\n      </a>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { storeToRefs } from 'pinia'\nimport Menu from 'primevue/menu'\nimport Skeleton from 'primevue/skeleton'\nimport { computed, onBeforeUnmount, onMounted, ref } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nimport Button from '@/components/ui/button/Button.vue'\nimport { useFirebaseAuthActions } from '@/composables/auth/useFirebaseAuthActions'\nimport { useDialogService } from '@/services/dialogService'\nimport { useSubscription } from '@/platform/cloud/subscription/composables/useSubscription'\nimport { useSubscriptionActions } from '@/platform/cloud/subscription/composables/useSubscriptionActions'\nimport { useSubscriptionCredits } from '@/platform/cloud/subscription/composables/useSubscriptionCredits'\nimport { useSubscriptionDialog } from '@/platform/cloud/subscription/composables/useSubscriptionDialog'\nimport {\n  DEFAULT_TIER_KEY,\n  TIER_TO_KEY,\n  getTierCredits,\n  getTierFeatures,\n  getTierPrice\n} from '@/platform/cloud/subscription/constants/tierPricing'\nimport { useWorkspaceUI } from '@/platform/workspace/composables/useWorkspaceUI'\nimport { useTeamWorkspaceStore } from '@/platform/workspace/stores/teamWorkspaceStore'\nimport { cn } from '@/utils/tailwindUtil'\n\nconst authActions = useFirebaseAuthActions()\nconst workspaceStore = useTeamWorkspaceStore()\nconst { isWorkspaceSubscribed, isInPersonalWorkspace } =\n  storeToRefs(workspaceStore)\nconst { subscribeWorkspace } = workspaceStore\nconst { permissions, workspaceRole } = useWorkspaceUI()\nconst { t, n } = useI18n()\nconst { showBillingComingSoonDialog } = useDialogService()\n\n// Show subscribe prompt to owners without active subscription\nconst showSubscribePrompt = computed(() => {\n  if (workspaceRole.value !== 'owner') return false\n  if (isInPersonalWorkspace.value) return !isActiveSubscription.value\n  return !isWorkspaceSubscribed.value\n})\n\n// MEMBER view - members can't manage subscription, show read-only zero state\nconst isMemberView = computed(() => !permissions.value.canManageSubscription)\n\n// Show zero state for credits (no real billing data yet)\nconst showZeroState = computed(\n  () => showSubscribePrompt.value || isMemberView.value\n)\n\n// Subscribe workspace - show billing coming soon dialog for team workspaces\nfunction handleSubscribeWorkspace() {\n  if (!isInPersonalWorkspace.value) {\n    showBillingComingSoonDialog()\n    return\n  }\n  subscribeWorkspace('PRO_MONTHLY')\n}\n\nconst {\n  isActiveSubscription,\n  isCancelled,\n  formattedRenewalDate,\n  formattedEndDate,\n  subscriptionTier,\n  subscriptionTierName,\n  subscriptionStatus,\n  isYearlySubscription\n} = useSubscription()\n\nconst { show: showSubscriptionDialog } = useSubscriptionDialog()\n\nconst planMenu = ref<InstanceType<typeof Menu> | null>(null)\n\nconst planMenuItems = computed(() => [\n  {\n    label: t('subscription.cancelSubscription'),\n    icon: 'pi pi-times',\n    command: async () => {\n      await authActions.accessBillingPortal()\n    }\n  }\n])\n\nconst tierKey = computed(() => {\n  const tier = subscriptionTier.value\n  if (!tier) return DEFAULT_TIER_KEY\n  return TIER_TO_KEY[tier] ?? DEFAULT_TIER_KEY\n})\nconst tierPrice = computed(() =>\n  getTierPrice(tierKey.value, isYearlySubscription.value)\n)\n\nconst refillsDate = computed(() => {\n  if (!subscriptionStatus.value?.renewal_date) return ''\n  const date = new Date(subscriptionStatus.value.renewal_date)\n  const day = String(date.getDate()).padStart(2, '0')\n  const month = String(date.getMonth() + 1).padStart(2, '0')\n  const year = String(date.getFullYear()).slice(-2)\n  return `${month}/${day}/${year}`\n})\n\nconst creditsRemainingLabel = computed(() =>\n  isYearlySubscription.value\n    ? t('subscription.creditsRemainingThisYear', {\n        date: refillsDate.value\n      })\n    : t('subscription.creditsRemainingThisMonth', {\n        date: refillsDate.value\n      })\n)\n\nconst planTotalCredits = computed(() => {\n  const credits = getTierCredits(tierKey.value)\n  const total = isYearlySubscription.value ? credits * 12 : credits\n  return n(total)\n})\n\nconst includedCreditsDisplay = computed(\n  () => `${monthlyBonusCredits.value} / ${planTotalCredits.value}`\n)\n\n// Tier benefits for v-for loop\ntype BenefitType = 'metric' | 'feature'\n\ninterface Benefit {\n  key: string\n  type: BenefitType\n  label: string\n  value?: string\n}\n\nconst tierBenefits = computed((): Benefit[] => {\n  const key = tierKey.value\n\n  const benefits: Benefit[] = [\n    {\n      key: 'maxDuration',\n      type: 'metric',\n      value: t(`subscription.maxDuration.${key}`),\n      label: t('subscription.maxDurationLabel')\n    },\n    {\n      key: 'gpu',\n      type: 'feature',\n      label: t('subscription.gpuLabel')\n    },\n    {\n      key: 'addCredits',\n      type: 'feature',\n      label: t('subscription.addCreditsLabel')\n    }\n  ]\n\n  if (getTierFeatures(key).customLoRAs) {\n    benefits.push({\n      key: 'customLoRAs',\n      type: 'feature',\n      label: t('subscription.customLoRAsLabel')\n    })\n  }\n\n  return benefits\n})\n\nconst { totalCredits, monthlyBonusCredits, prepaidCredits, isLoadingBalance } =\n  useSubscriptionCredits()\n\nconst { handleAddApiCredits, handleRefresh } = useSubscriptionActions()\n\n// Focus-based polling: refresh balance when user returns from Stripe checkout\nconst PENDING_TOPUP_KEY = 'pending_topup_timestamp'\nconst TOPUP_EXPIRY_MS = 5 * 60 * 1000 // 5 minutes\n\nfunction handleWindowFocus() {\n  const timestampStr = localStorage.getItem(PENDING_TOPUP_KEY)\n  if (!timestampStr) return\n\n  const timestamp = parseInt(timestampStr, 10)\n\n  // Clear expired tracking (older than 5 minutes)\n  if (Date.now() - timestamp > TOPUP_EXPIRY_MS) {\n    localStorage.removeItem(PENDING_TOPUP_KEY)\n    return\n  }\n\n  // Refresh and clear tracking to prevent repeated calls\n  void handleRefresh()\n  localStorage.removeItem(PENDING_TOPUP_KEY)\n}\n\nonMounted(() => {\n  window.addEventListener('focus', handleWindowFocus)\n})\n\nonBeforeUnmount(() => {\n  window.removeEventListener('focus', handleWindowFocus)\n})\n</script>\n\n<style scoped>\n:deep(.bg-comfy-menu-secondary) {\n  background-color: transparent;\n}\n</style>\n","<template>\n  <div class=\"grow overflow-auto pt-6\">\n    <div class=\"rounded-2xl border border-interface-stroke p-6\">\n      <div>\n        <div\n          class=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between md:gap-2\"\n        >\n          <!-- OWNER Unsubscribed State -->\n          <template v-if=\"showSubscribePrompt\">\n            <div class=\"flex flex-col gap-2\">\n              <div class=\"text-sm font-bold text-text-primary\">\n                {{ $t('subscription.workspaceNotSubscribed') }}\n              </div>\n              <div class=\"text-sm text-text-secondary\">\n                {{ $t('subscription.subscriptionRequiredMessage') }}\n              </div>\n            </div>\n            <Button\n              variant=\"primary\"\n              size=\"lg\"\n              class=\"ml-auto rounded-lg px-4 py-2 text-sm font-normal\"\n              @click=\"handleSubscribeWorkspace\"\n            >\n              {{ $t('subscription.subscribeNow') }}\n            </Button>\n          </template>\n\n          <!-- MEMBER View - read-only, no subscription data yet -->\n          <template v-else-if=\"isMemberView\">\n            <div class=\"flex flex-col gap-2\">\n              <div class=\"text-sm font-bold text-text-primary\">\n                {{ $t('subscription.workspaceNotSubscribed') }}\n              </div>\n              <div class=\"text-sm text-text-secondary\">\n                {{ $t('subscription.contactOwnerToSubscribe') }}\n              </div>\n            </div>\n          </template>\n\n          <!-- Normal Subscribed State (Owner with subscription) -->\n          <template v-else>\n            <div class=\"flex flex-col gap-2\">\n              <div class=\"text-sm font-bold text-text-primary\">\n                {{ subscriptionTierName }}\n              </div>\n              <div class=\"flex items-baseline gap-1 font-inter font-semibold\">\n                <span class=\"text-2xl\">${{ tierPrice }}</span>\n                <span class=\"text-base\">{{ $t('subscription.perMonth') }}</span>\n              </div>\n              <div\n                v-if=\"isActiveSubscription\"\n                class=\"text-sm text-text-secondary\"\n              >\n                <template v-if=\"isCancelled\">\n                  {{\n                    $t('subscription.expiresDate', {\n                      date: formattedEndDate\n                    })\n                  }}\n                </template>\n                <template v-else>\n                  {{\n                    $t('subscription.renewsDate', {\n                      date: formattedRenewalDate\n                    })\n                  }}\n                </template>\n              </div>\n            </div>\n\n            <div\n              v-if=\"isActiveSubscription && permissions.canManageSubscription\"\n              class=\"flex flex-wrap gap-2 md:ml-auto\"\n            >\n              <Button\n                size=\"lg\"\n                variant=\"secondary\"\n                class=\"rounded-lg px-4 text-sm font-normal text-text-primary bg-interface-menu-component-surface-selected\"\n                @click=\"\n                  async () => {\n                    await authActions.accessBillingPortal()\n                  }\n                \"\n              >\n                {{ $t('subscription.managePayment') }}\n              </Button>\n              <Button\n                size=\"lg\"\n                variant=\"primary\"\n                class=\"rounded-lg px-4 text-sm font-normal text-text-primary\"\n                @click=\"showSubscriptionDialog\"\n              >\n                {{ $t('subscription.upgradePlan') }}\n              </Button>\n              <Button\n                v-tooltip=\"{ value: $t('g.moreOptions'), showDelay: 300 }\"\n                variant=\"secondary\"\n                size=\"lg\"\n                :aria-label=\"$t('g.moreOptions')\"\n                @click=\"planMenu?.toggle($event)\"\n              >\n                <i class=\"pi pi-ellipsis-h\" />\n              </Button>\n              <Menu ref=\"planMenu\" :model=\"planMenuItems\" :popup=\"true\" />\n            </div>\n          </template>\n        </div>\n      </div>\n\n      <div class=\"flex flex-col lg:flex-row gap-6 pt-9\">\n        <div class=\"flex flex-col shrink-0\">\n          <div class=\"flex flex-col gap-3\">\n            <div\n              :class=\"\n                cn(\n                  'relative flex flex-col gap-6 rounded-2xl p-5',\n                  'bg-modal-panel-background'\n                )\n              \"\n            >\n              <Button\n                variant=\"muted-textonly\"\n                size=\"icon-sm\"\n                class=\"absolute top-4 right-4\"\n                :loading=\"isLoadingBalance\"\n                @click=\"handleRefresh\"\n              >\n                <i class=\"pi pi-sync text-text-secondary text-sm\" />\n              </Button>\n\n              <div class=\"flex flex-col gap-2\">\n                <div class=\"text-sm text-muted\">\n                  {{ $t('subscription.totalCredits') }}\n                </div>\n                <Skeleton v-if=\"isLoadingBalance\" width=\"8rem\" height=\"2rem\" />\n                <div v-else class=\"text-2xl font-bold\">\n                  {{ showZeroState ? '0' : totalCredits }}\n                </div>\n              </div>\n\n              <!-- Credit Breakdown -->\n              <table class=\"text-sm text-muted\">\n                <tbody>\n                  <tr>\n                    <td class=\"pr-4 font-bold text-left align-middle\">\n                      <Skeleton\n                        v-if=\"isLoadingBalance\"\n                        width=\"5rem\"\n                        height=\"1rem\"\n                      />\n                      <span v-else>{{\n                        showZeroState ? '0 / 0' : includedCreditsDisplay\n                      }}</span>\n                    </td>\n                    <td class=\"align-middle\" :title=\"creditsRemainingLabel\">\n                      {{ creditsRemainingLabel }}\n                    </td>\n                  </tr>\n                  <tr>\n                    <td class=\"pr-4 font-bold text-left align-middle\">\n                      <Skeleton\n                        v-if=\"isLoadingBalance\"\n                        width=\"3rem\"\n                        height=\"1rem\"\n                      />\n                      <span v-else>{{\n                        showZeroState ? '0' : prepaidCredits\n                      }}</span>\n                    </td>\n                    <td\n                      class=\"align-middle\"\n                      :title=\"$t('subscription.creditsYouveAdded')\"\n                    >\n                      {{ $t('subscription.creditsYouveAdded') }}\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n\n              <div class=\"flex items-center justify-between\">\n                <a\n                  href=\"https://platform.comfy.org/profile/usage\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  class=\"text-sm underline text-center text-muted\"\n                >\n                  {{ $t('subscription.viewUsageHistory') }}\n                </a>\n                <Button\n                  v-if=\"isActiveSubscription && !showZeroState\"\n                  variant=\"secondary\"\n                  class=\"p-2 min-h-8 rounded-lg text-sm font-normal text-text-primary bg-interface-menu-component-surface-selected\"\n                  @click=\"handleAddApiCredits\"\n                >\n                  {{ $t('subscription.addCredits') }}\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"flex flex-col gap-2\">\n          <div class=\"text-sm text-text-primary\">\n            {{ $t('subscription.yourPlanIncludes') }}\n          </div>\n\n          <div class=\"flex flex-col gap-0\">\n            <div\n              v-for=\"benefit in tierBenefits\"\n              :key=\"benefit.key\"\n              class=\"flex items-center gap-2 py-2\"\n            >\n              <i\n                v-if=\"benefit.type === 'feature'\"\n                class=\"pi pi-check text-xs text-text-primary\"\n              />\n              <span\n                v-else-if=\"benefit.type === 'metric' && benefit.value\"\n                class=\"text-sm font-normal whitespace-nowrap text-text-primary\"\n              >\n                {{ benefit.value }}\n              </span>\n              <span class=\"text-sm text-muted\">\n                {{ benefit.label }}\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- View More Details - Outside main content -->\n    <div class=\"flex items-center gap-2 py-4\">\n      <i class=\"pi pi-external-link text-muted\"></i>\n      <a\n        href=\"https://www.comfy.org/cloud/pricing\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        class=\"text-sm underline hover:opacity-80 text-muted\"\n      >\n        {{ $t('subscription.viewMoreDetailsPlans') }}\n      </a>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { storeToRefs } from 'pinia'\nimport Menu from 'primevue/menu'\nimport Skeleton from 'primevue/skeleton'\nimport { computed, onBeforeUnmount, onMounted, ref } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nimport Button from '@/components/ui/button/Button.vue'\nimport { useFirebaseAuthActions } from '@/composables/auth/useFirebaseAuthActions'\nimport { useDialogService } from '@/services/dialogService'\nimport { useSubscription } from '@/platform/cloud/subscription/composables/useSubscription'\nimport { useSubscriptionActions } from '@/platform/cloud/subscription/composables/useSubscriptionActions'\nimport { useSubscriptionCredits } from '@/platform/cloud/subscription/composables/useSubscriptionCredits'\nimport { useSubscriptionDialog } from '@/platform/cloud/subscription/composables/useSubscriptionDialog'\nimport {\n  DEFAULT_TIER_KEY,\n  TIER_TO_KEY,\n  getTierCredits,\n  getTierFeatures,\n  getTierPrice\n} from '@/platform/cloud/subscription/constants/tierPricing'\nimport { useWorkspaceUI } from '@/platform/workspace/composables/useWorkspaceUI'\nimport { useTeamWorkspaceStore } from '@/platform/workspace/stores/teamWorkspaceStore'\nimport { cn } from '@/utils/tailwindUtil'\n\nconst authActions = useFirebaseAuthActions()\nconst workspaceStore = useTeamWorkspaceStore()\nconst { isWorkspaceSubscribed, isInPersonalWorkspace } =\n  storeToRefs(workspaceStore)\nconst { subscribeWorkspace } = workspaceStore\nconst { permissions, workspaceRole } = useWorkspaceUI()\nconst { t, n } = useI18n()\nconst { showBillingComingSoonDialog } = useDialogService()\n\n// Show subscribe prompt to owners without active subscription\nconst showSubscribePrompt = computed(() => {\n  if (workspaceRole.value !== 'owner') return false\n  if (isInPersonalWorkspace.value) return !isActiveSubscription.value\n  return !isWorkspaceSubscribed.value\n})\n\n// MEMBER view - members can't manage subscription, show read-only zero state\nconst isMemberView = computed(() => !permissions.value.canManageSubscription)\n\n// Show zero state for credits (no real billing data yet)\nconst showZeroState = computed(\n  () => showSubscribePrompt.value || isMemberView.value\n)\n\n// Subscribe workspace - show billing coming soon dialog for team workspaces\nfunction handleSubscribeWorkspace() {\n  if (!isInPersonalWorkspace.value) {\n    showBillingComingSoonDialog()\n    return\n  }\n  subscribeWorkspace('PRO_MONTHLY')\n}\n\nconst {\n  isActiveSubscription,\n  isCancelled,\n  formattedRenewalDate,\n  formattedEndDate,\n  subscriptionTier,\n  subscriptionTierName,\n  subscriptionStatus,\n  isYearlySubscription\n} = useSubscription()\n\nconst { show: showSubscriptionDialog } = useSubscriptionDialog()\n\nconst planMenu = ref<InstanceType<typeof Menu> | null>(null)\n\nconst planMenuItems = computed(() => [\n  {\n    label: t('subscription.cancelSubscription'),\n    icon: 'pi pi-times',\n    command: async () => {\n      await authActions.accessBillingPortal()\n    }\n  }\n])\n\nconst tierKey = computed(() => {\n  const tier = subscriptionTier.value\n  if (!tier) return DEFAULT_TIER_KEY\n  return TIER_TO_KEY[tier] ?? DEFAULT_TIER_KEY\n})\nconst tierPrice = computed(() =>\n  getTierPrice(tierKey.value, isYearlySubscription.value)\n)\n\nconst refillsDate = computed(() => {\n  if (!subscriptionStatus.value?.renewal_date) return ''\n  const date = new Date(subscriptionStatus.value.renewal_date)\n  const day = String(date.getDate()).padStart(2, '0')\n  const month = String(date.getMonth() + 1).padStart(2, '0')\n  const year = String(date.getFullYear()).slice(-2)\n  return `${month}/${day}/${year}`\n})\n\nconst creditsRemainingLabel = computed(() =>\n  isYearlySubscription.value\n    ? t('subscription.creditsRemainingThisYear', {\n        date: refillsDate.value\n      })\n    : t('subscription.creditsRemainingThisMonth', {\n        date: refillsDate.value\n      })\n)\n\nconst planTotalCredits = computed(() => {\n  const credits = getTierCredits(tierKey.value)\n  const total = isYearlySubscription.value ? credits * 12 : credits\n  return n(total)\n})\n\nconst includedCreditsDisplay = computed(\n  () => `${monthlyBonusCredits.value} / ${planTotalCredits.value}`\n)\n\n// Tier benefits for v-for loop\ntype BenefitType = 'metric' | 'feature'\n\ninterface Benefit {\n  key: string\n  type: BenefitType\n  label: string\n  value?: string\n}\n\nconst tierBenefits = computed((): Benefit[] => {\n  const key = tierKey.value\n\n  const benefits: Benefit[] = [\n    {\n      key: 'maxDuration',\n      type: 'metric',\n      value: t(`subscription.maxDuration.${key}`),\n      label: t('subscription.maxDurationLabel')\n    },\n    {\n      key: 'gpu',\n      type: 'feature',\n      label: t('subscription.gpuLabel')\n    },\n    {\n      key: 'addCredits',\n      type: 'feature',\n      label: t('subscription.addCreditsLabel')\n    }\n  ]\n\n  if (getTierFeatures(key).customLoRAs) {\n    benefits.push({\n      key: 'customLoRAs',\n      type: 'feature',\n      label: t('subscription.customLoRAsLabel')\n    })\n  }\n\n  return benefits\n})\n\nconst { totalCredits, monthlyBonusCredits, prepaidCredits, isLoadingBalance } =\n  useSubscriptionCredits()\n\nconst { handleAddApiCredits, handleRefresh } = useSubscriptionActions()\n\n// Focus-based polling: refresh balance when user returns from Stripe checkout\nconst PENDING_TOPUP_KEY = 'pending_topup_timestamp'\nconst TOPUP_EXPIRY_MS = 5 * 60 * 1000 // 5 minutes\n\nfunction handleWindowFocus() {\n  const timestampStr = localStorage.getItem(PENDING_TOPUP_KEY)\n  if (!timestampStr) return\n\n  const timestamp = parseInt(timestampStr, 10)\n\n  // Clear expired tracking (older than 5 minutes)\n  if (Date.now() - timestamp > TOPUP_EXPIRY_MS) {\n    localStorage.removeItem(PENDING_TOPUP_KEY)\n    return\n  }\n\n  // Refresh and clear tracking to prevent repeated calls\n  void handleRefresh()\n  localStorage.removeItem(PENDING_TOPUP_KEY)\n}\n\nonMounted(() => {\n  window.addEventListener('focus', handleWindowFocus)\n})\n\nonBeforeUnmount(() => {\n  window.removeEventListener('focus', handleWindowFocus)\n})\n</script>\n\n<style scoped>\n:deep(.bg-comfy-menu-secondary) {\n  background-color: transparent;\n}\n</style>\n","<template>\n  <div class=\"grow overflow-auto pt-6\">\n    <div class=\"rounded-2xl border border-interface-stroke p-6\">\n      <div>\n        <div\n          class=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between md:gap-2\"\n        >\n          <!-- OWNER Unsubscribed State -->\n          <template v-if=\"showSubscribePrompt\">\n            <div class=\"flex flex-col gap-2\">\n              <div class=\"text-sm font-bold text-text-primary\">\n                {{ $t('subscription.workspaceNotSubscribed') }}\n              </div>\n              <div class=\"text-sm text-text-secondary\">\n                {{ $t('subscription.subscriptionRequiredMessage') }}\n              </div>\n            </div>\n            <Button\n              variant=\"primary\"\n              size=\"lg\"\n              class=\"ml-auto rounded-lg px-4 py-2 text-sm font-normal\"\n              @click=\"handleSubscribeWorkspace\"\n            >\n              {{ $t('subscription.subscribeNow') }}\n            </Button>\n          </template>\n\n          <!-- MEMBER View - read-only, no subscription data yet -->\n          <template v-else-if=\"isMemberView\">\n            <div class=\"flex flex-col gap-2\">\n              <div class=\"text-sm font-bold text-text-primary\">\n                {{ $t('subscription.workspaceNotSubscribed') }}\n              </div>\n              <div class=\"text-sm text-text-secondary\">\n                {{ $t('subscription.contactOwnerToSubscribe') }}\n              </div>\n            </div>\n          </template>\n\n          <!-- Normal Subscribed State (Owner with subscription) -->\n          <template v-else>\n            <div class=\"flex flex-col gap-2\">\n              <div class=\"text-sm font-bold text-text-primary\">\n                {{ subscriptionTierName }}\n              </div>\n              <div class=\"flex items-baseline gap-1 font-inter font-semibold\">\n                <span class=\"text-2xl\">${{ tierPrice }}</span>\n                <span class=\"text-base\">{{ $t('subscription.perMonth') }}</span>\n              </div>\n              <div\n                v-if=\"isActiveSubscription\"\n                class=\"text-sm text-text-secondary\"\n              >\n                <template v-if=\"isCancelled\">\n                  {{\n                    $t('subscription.expiresDate', {\n                      date: formattedEndDate\n                    })\n                  }}\n                </template>\n                <template v-else>\n                  {{\n                    $t('subscription.renewsDate', {\n                      date: formattedRenewalDate\n                    })\n                  }}\n                </template>\n              </div>\n            </div>\n\n            <div\n              v-if=\"isActiveSubscription && permissions.canManageSubscription\"\n              class=\"flex flex-wrap gap-2 md:ml-auto\"\n            >\n              <Button\n                size=\"lg\"\n                variant=\"secondary\"\n                class=\"rounded-lg px-4 text-sm font-normal text-text-primary bg-interface-menu-component-surface-selected\"\n                @click=\"\n                  async () => {\n                    await authActions.accessBillingPortal()\n                  }\n                \"\n              >\n                {{ $t('subscription.managePayment') }}\n              </Button>\n              <Button\n                size=\"lg\"\n                variant=\"primary\"\n                class=\"rounded-lg px-4 text-sm font-normal text-text-primary\"\n                @click=\"showSubscriptionDialog\"\n              >\n                {{ $t('subscription.upgradePlan') }}\n              </Button>\n              <Button\n                v-tooltip=\"{ value: $t('g.moreOptions'), showDelay: 300 }\"\n                variant=\"secondary\"\n                size=\"lg\"\n                :aria-label=\"$t('g.moreOptions')\"\n                @click=\"planMenu?.toggle($event)\"\n              >\n                <i class=\"pi pi-ellipsis-h\" />\n              </Button>\n              <Menu ref=\"planMenu\" :model=\"planMenuItems\" :popup=\"true\" />\n            </div>\n          </template>\n        </div>\n      </div>\n\n      <div class=\"flex flex-col lg:flex-row gap-6 pt-9\">\n        <div class=\"flex flex-col shrink-0\">\n          <div class=\"flex flex-col gap-3\">\n            <div\n              :class=\"\n                cn(\n                  'relative flex flex-col gap-6 rounded-2xl p-5',\n                  'bg-modal-panel-background'\n                )\n              \"\n            >\n              <Button\n                variant=\"muted-textonly\"\n                size=\"icon-sm\"\n                class=\"absolute top-4 right-4\"\n                :loading=\"isLoadingBalance\"\n                @click=\"handleRefresh\"\n              >\n                <i class=\"pi pi-sync text-text-secondary text-sm\" />\n              </Button>\n\n              <div class=\"flex flex-col gap-2\">\n                <div class=\"text-sm text-muted\">\n                  {{ $t('subscription.totalCredits') }}\n                </div>\n                <Skeleton v-if=\"isLoadingBalance\" width=\"8rem\" height=\"2rem\" />\n                <div v-else class=\"text-2xl font-bold\">\n                  {{ showZeroState ? '0' : totalCredits }}\n                </div>\n              </div>\n\n              <!-- Credit Breakdown -->\n              <table class=\"text-sm text-muted\">\n                <tbody>\n                  <tr>\n                    <td class=\"pr-4 font-bold text-left align-middle\">\n                      <Skeleton\n                        v-if=\"isLoadingBalance\"\n                        width=\"5rem\"\n                        height=\"1rem\"\n                      />\n                      <span v-else>{{\n                        showZeroState ? '0 / 0' : includedCreditsDisplay\n                      }}</span>\n                    </td>\n                    <td class=\"align-middle\" :title=\"creditsRemainingLabel\">\n                      {{ creditsRemainingLabel }}\n                    </td>\n                  </tr>\n                  <tr>\n                    <td class=\"pr-4 font-bold text-left align-middle\">\n                      <Skeleton\n                        v-if=\"isLoadingBalance\"\n                        width=\"3rem\"\n                        height=\"1rem\"\n                      />\n                      <span v-else>{{\n                        showZeroState ? '0' : prepaidCredits\n                      }}</span>\n                    </td>\n                    <td\n                      class=\"align-middle\"\n                      :title=\"$t('subscription.creditsYouveAdded')\"\n                    >\n                      {{ $t('subscription.creditsYouveAdded') }}\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n\n              <div class=\"flex items-center justify-between\">\n                <a\n                  href=\"https://platform.comfy.org/profile/usage\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  class=\"text-sm underline text-center text-muted\"\n                >\n                  {{ $t('subscription.viewUsageHistory') }}\n                </a>\n                <Button\n                  v-if=\"isActiveSubscription && !showZeroState\"\n                  variant=\"secondary\"\n                  class=\"p-2 min-h-8 rounded-lg text-sm font-normal text-text-primary bg-interface-menu-component-surface-selected\"\n                  @click=\"handleAddApiCredits\"\n                >\n                  {{ $t('subscription.addCredits') }}\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"flex flex-col gap-2\">\n          <div class=\"text-sm text-text-primary\">\n            {{ $t('subscription.yourPlanIncludes') }}\n          </div>\n\n          <div class=\"flex flex-col gap-0\">\n            <div\n              v-for=\"benefit in tierBenefits\"\n              :key=\"benefit.key\"\n              class=\"flex items-center gap-2 py-2\"\n            >\n              <i\n                v-if=\"benefit.type === 'feature'\"\n                class=\"pi pi-check text-xs text-text-primary\"\n              />\n              <span\n                v-else-if=\"benefit.type === 'metric' && benefit.value\"\n                class=\"text-sm font-normal whitespace-nowrap text-text-primary\"\n              >\n                {{ benefit.value }}\n              </span>\n              <span class=\"text-sm text-muted\">\n                {{ benefit.label }}\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- View More Details - Outside main content -->\n    <div class=\"flex items-center gap-2 py-4\">\n      <i class=\"pi pi-external-link text-muted\"></i>\n      <a\n        href=\"https://www.comfy.org/cloud/pricing\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        class=\"text-sm underline hover:opacity-80 text-muted\"\n      >\n        {{ $t('subscription.viewMoreDetailsPlans') }}\n      </a>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { storeToRefs } from 'pinia'\nimport Menu from 'primevue/menu'\nimport Skeleton from 'primevue/skeleton'\nimport { computed, onBeforeUnmount, onMounted, ref } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nimport Button from '@/components/ui/button/Button.vue'\nimport { useFirebaseAuthActions } from '@/composables/auth/useFirebaseAuthActions'\nimport { useDialogService } from '@/services/dialogService'\nimport { useSubscription } from '@/platform/cloud/subscription/composables/useSubscription'\nimport { useSubscriptionActions } from '@/platform/cloud/subscription/composables/useSubscriptionActions'\nimport { useSubscriptionCredits } from '@/platform/cloud/subscription/composables/useSubscriptionCredits'\nimport { useSubscriptionDialog } from '@/platform/cloud/subscription/composables/useSubscriptionDialog'\nimport {\n  DEFAULT_TIER_KEY,\n  TIER_TO_KEY,\n  getTierCredits,\n  getTierFeatures,\n  getTierPrice\n} from '@/platform/cloud/subscription/constants/tierPricing'\nimport { useWorkspaceUI } from '@/platform/workspace/composables/useWorkspaceUI'\nimport { useTeamWorkspaceStore } from '@/platform/workspace/stores/teamWorkspaceStore'\nimport { cn } from '@/utils/tailwindUtil'\n\nconst authActions = useFirebaseAuthActions()\nconst workspaceStore = useTeamWorkspaceStore()\nconst { isWorkspaceSubscribed, isInPersonalWorkspace } =\n  storeToRefs(workspaceStore)\nconst { subscribeWorkspace } = workspaceStore\nconst { permissions, workspaceRole } = useWorkspaceUI()\nconst { t, n } = useI18n()\nconst { showBillingComingSoonDialog } = useDialogService()\n\n// Show subscribe prompt to owners without active subscription\nconst showSubscribePrompt = computed(() => {\n  if (workspaceRole.value !== 'owner') return false\n  if (isInPersonalWorkspace.value) return !isActiveSubscription.value\n  return !isWorkspaceSubscribed.value\n})\n\n// MEMBER view - members can't manage subscription, show read-only zero state\nconst isMemberView = computed(() => !permissions.value.canManageSubscription)\n\n// Show zero state for credits (no real billing data yet)\nconst showZeroState = computed(\n  () => showSubscribePrompt.value || isMemberView.value\n)\n\n// Subscribe workspace - show billing coming soon dialog for team workspaces\nfunction handleSubscribeWorkspace() {\n  if (!isInPersonalWorkspace.value) {\n    showBillingComingSoonDialog()\n    return\n  }\n  subscribeWorkspace('PRO_MONTHLY')\n}\n\nconst {\n  isActiveSubscription,\n  isCancelled,\n  formattedRenewalDate,\n  formattedEndDate,\n  subscriptionTier,\n  subscriptionTierName,\n  subscriptionStatus,\n  isYearlySubscription\n} = useSubscription()\n\nconst { show: showSubscriptionDialog } = useSubscriptionDialog()\n\nconst planMenu = ref<InstanceType<typeof Menu> | null>(null)\n\nconst planMenuItems = computed(() => [\n  {\n    label: t('subscription.cancelSubscription'),\n    icon: 'pi pi-times',\n    command: async () => {\n      await authActions.accessBillingPortal()\n    }\n  }\n])\n\nconst tierKey = computed(() => {\n  const tier = subscriptionTier.value\n  if (!tier) return DEFAULT_TIER_KEY\n  return TIER_TO_KEY[tier] ?? DEFAULT_TIER_KEY\n})\nconst tierPrice = computed(() =>\n  getTierPrice(tierKey.value, isYearlySubscription.value)\n)\n\nconst refillsDate = computed(() => {\n  if (!subscriptionStatus.value?.renewal_date) return ''\n  const date = new Date(subscriptionStatus.value.renewal_date)\n  const day = String(date.getDate()).padStart(2, '0')\n  const month = String(date.getMonth() + 1).padStart(2, '0')\n  const year = String(date.getFullYear()).slice(-2)\n  return `${month}/${day}/${year}`\n})\n\nconst creditsRemainingLabel = computed(() =>\n  isYearlySubscription.value\n    ? t('subscription.creditsRemainingThisYear', {\n        date: refillsDate.value\n      })\n    : t('subscription.creditsRemainingThisMonth', {\n        date: refillsDate.value\n      })\n)\n\nconst planTotalCredits = computed(() => {\n  const credits = getTierCredits(tierKey.value)\n  const total = isYearlySubscription.value ? credits * 12 : credits\n  return n(total)\n})\n\nconst includedCreditsDisplay = computed(\n  () => `${monthlyBonusCredits.value} / ${planTotalCredits.value}`\n)\n\n// Tier benefits for v-for loop\ntype BenefitType = 'metric' | 'feature'\n\ninterface Benefit {\n  key: string\n  type: BenefitType\n  label: string\n  value?: string\n}\n\nconst tierBenefits = computed((): Benefit[] => {\n  const key = tierKey.value\n\n  const benefits: Benefit[] = [\n    {\n      key: 'maxDuration',\n      type: 'metric',\n      value: t(`subscription.maxDuration.${key}`),\n      label: t('subscription.maxDurationLabel')\n    },\n    {\n      key: 'gpu',\n      type: 'feature',\n      label: t('subscription.gpuLabel')\n    },\n    {\n      key: 'addCredits',\n      type: 'feature',\n      label: t('subscription.addCreditsLabel')\n    }\n  ]\n\n  if (getTierFeatures(key).customLoRAs) {\n    benefits.push({\n      key: 'customLoRAs',\n      type: 'feature',\n      label: t('subscription.customLoRAsLabel')\n    })\n  }\n\n  return benefits\n})\n\nconst { totalCredits, monthlyBonusCredits, prepaidCredits, isLoadingBalance } =\n  useSubscriptionCredits()\n\nconst { handleAddApiCredits, handleRefresh } = useSubscriptionActions()\n\n// Focus-based polling: refresh balance when user returns from Stripe checkout\nconst PENDING_TOPUP_KEY = 'pending_topup_timestamp'\nconst TOPUP_EXPIRY_MS = 5 * 60 * 1000 // 5 minutes\n\nfunction handleWindowFocus() {\n  const timestampStr = localStorage.getItem(PENDING_TOPUP_KEY)\n  if (!timestampStr) return\n\n  const timestamp = parseInt(timestampStr, 10)\n\n  // Clear expired tracking (older than 5 minutes)\n  if (Date.now() - timestamp > TOPUP_EXPIRY_MS) {\n    localStorage.removeItem(PENDING_TOPUP_KEY)\n    return\n  }\n\n  // Refresh and clear tracking to prevent repeated calls\n  void handleRefresh()\n  localStorage.removeItem(PENDING_TOPUP_KEY)\n}\n\nonMounted(() => {\n  window.addEventListener('focus', handleWindowFocus)\n})\n\nonBeforeUnmount(() => {\n  window.removeEventListener('focus', handleWindowFocus)\n})\n</script>\n\n<style scoped>\n:deep(.bg-comfy-menu-secondary) {\n  background-color: transparent;\n}\n</style>\n"],"mappings":"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"}