{"version":3,"mappings":"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","names":[],"ignoreList":[],"sources":["../../src/i18n.ts"],"sourcesContent":["import { createI18n } from 'vue-i18n'\n\n// ESLint cannot statically resolve dynamic imports with relative paths in template strings,\n// but these are valid ES module imports that Vite processes correctly at build time.\n\n// Import only English locale eagerly as the default/fallback\nimport enCommands from './locales/en/commands.json' with { type: 'json' }\nimport en from './locales/en/main.json' with { type: 'json' }\nimport enNodes from './locales/en/nodeDefs.json' with { type: 'json' }\nimport enSettings from './locales/en/settings.json' with { type: 'json' }\n\nfunction buildLocale<\n  M extends Record<string, unknown>,\n  N extends Record<string, unknown>,\n  C extends Record<string, unknown>,\n  S extends Record<string, unknown>\n>(main: M, nodes: N, commands: C, settings: S) {\n  return {\n    ...main,\n    nodeDefs: nodes,\n    commands: commands,\n    settings: settings\n  } as M & { nodeDefs: N; commands: C; settings: S }\n}\n\n// Locale loader map - dynamically import locales only when needed\nconst localeLoaders: Record<\n  string,\n  () => Promise<{ default: Record<string, unknown> }>\n> = {\n  ar: () => import('./locales/ar/main.json'),\n  es: () => import('./locales/es/main.json'),\n  fa: () => import('./locales/fa/main.json'),\n  fr: () => import('./locales/fr/main.json'),\n  ja: () => import('./locales/ja/main.json'),\n  ko: () => import('./locales/ko/main.json'),\n  ru: () => import('./locales/ru/main.json'),\n  tr: () => import('./locales/tr/main.json'),\n  zh: () => import('./locales/zh/main.json'),\n  'zh-TW': () => import('./locales/zh-TW/main.json'),\n  'pt-BR': () => import('./locales/pt-BR/main.json')\n}\n\nconst nodeDefsLoaders: Record<\n  string,\n  () => Promise<{ default: Record<string, unknown> }>\n> = {\n  ar: () => import('./locales/ar/nodeDefs.json'),\n  es: () => import('./locales/es/nodeDefs.json'),\n  fa: () => import('./locales/fa/nodeDefs.json'),\n  fr: () => import('./locales/fr/nodeDefs.json'),\n  ja: () => import('./locales/ja/nodeDefs.json'),\n  ko: () => import('./locales/ko/nodeDefs.json'),\n  ru: () => import('./locales/ru/nodeDefs.json'),\n  tr: () => import('./locales/tr/nodeDefs.json'),\n  zh: () => import('./locales/zh/nodeDefs.json'),\n  'zh-TW': () => import('./locales/zh-TW/nodeDefs.json'),\n  'pt-BR': () => import('./locales/pt-BR/nodeDefs.json')\n}\n\nconst commandsLoaders: Record<\n  string,\n  () => Promise<{ default: Record<string, unknown> }>\n> = {\n  ar: () => import('./locales/ar/commands.json'),\n  es: () => import('./locales/es/commands.json'),\n  fa: () => import('./locales/fa/commands.json'),\n  fr: () => import('./locales/fr/commands.json'),\n  ja: () => import('./locales/ja/commands.json'),\n  ko: () => import('./locales/ko/commands.json'),\n  ru: () => import('./locales/ru/commands.json'),\n  tr: () => import('./locales/tr/commands.json'),\n  zh: () => import('./locales/zh/commands.json'),\n  'zh-TW': () => import('./locales/zh-TW/commands.json'),\n  'pt-BR': () => import('./locales/pt-BR/commands.json')\n}\n\nconst settingsLoaders: Record<\n  string,\n  () => Promise<{ default: Record<string, unknown> }>\n> = {\n  ar: () => import('./locales/ar/settings.json'),\n  es: () => import('./locales/es/settings.json'),\n  fa: () => import('./locales/fa/settings.json'),\n  fr: () => import('./locales/fr/settings.json'),\n  ja: () => import('./locales/ja/settings.json'),\n  ko: () => import('./locales/ko/settings.json'),\n  ru: () => import('./locales/ru/settings.json'),\n  tr: () => import('./locales/tr/settings.json'),\n  zh: () => import('./locales/zh/settings.json'),\n  'zh-TW': () => import('./locales/zh-TW/settings.json'),\n  'pt-BR': () => import('./locales/pt-BR/settings.json')\n}\n\n// Track which locales have been loaded\nconst loadedLocales = new Set<string>(['en'])\n\n// Track locales currently being loaded to prevent race conditions\nconst loadingLocales = new Map<string, Promise<void>>()\n\n// Store custom nodes i18n data for merging when locales are lazily loaded\nconst customNodesI18nData: Record<string, unknown> = {}\n\n/**\n * Dynamically load a locale and its associated files (nodeDefs, commands, settings)\n */\nexport async function loadLocale(locale: string): Promise<void> {\n  if (loadedLocales.has(locale)) {\n    return\n  }\n\n  // If already loading, return the existing promise to prevent duplicate loads\n  const existingLoad = loadingLocales.get(locale)\n  if (existingLoad) {\n    return existingLoad\n  }\n\n  const loader = localeLoaders[locale]\n  const nodeDefsLoader = nodeDefsLoaders[locale]\n  const commandsLoader = commandsLoaders[locale]\n  const settingsLoader = settingsLoaders[locale]\n\n  if (!loader || !nodeDefsLoader || !commandsLoader || !settingsLoader) {\n    console.warn(`Locale \"${locale}\" is not supported`)\n    return\n  }\n\n  // Create and track the loading promise\n  const loadPromise = (async () => {\n    try {\n      const [main, nodes, commands, settings] = await Promise.all([\n        loader(),\n        nodeDefsLoader(),\n        commandsLoader(),\n        settingsLoader()\n      ])\n\n      const messages = buildLocale(\n        main.default,\n        nodes.default,\n        commands.default,\n        settings.default\n      )\n\n      i18n.global.setLocaleMessage(locale, messages as LocaleMessages)\n      loadedLocales.add(locale)\n\n      if (customNodesI18nData[locale]) {\n        i18n.global.mergeLocaleMessage(locale, customNodesI18nData[locale])\n      }\n    } catch (error) {\n      console.error(`Failed to load locale \"${locale}\":`, error)\n      throw error\n    } finally {\n      // Clean up the loading promise once complete\n      loadingLocales.delete(locale)\n    }\n  })()\n\n  loadingLocales.set(locale, loadPromise)\n  return loadPromise\n}\n\n/**\n * Stores the data for later use when locales are lazily loaded,\n * and immediately merges data for already-loaded locales.\n */\nexport function mergeCustomNodesI18n(i18nData: Record<string, unknown>): void {\n  // Clear existing data and replace with new data\n  for (const key of Object.keys(customNodesI18nData)) {\n    delete customNodesI18nData[key]\n  }\n  Object.assign(customNodesI18nData, i18nData)\n\n  for (const [locale, message] of Object.entries(i18nData)) {\n    if (loadedLocales.has(locale)) {\n      i18n.global.mergeLocaleMessage(locale, message)\n    }\n  }\n}\n\n// Only include English in the initial bundle\nconst messages = {\n  en: buildLocale(en, enNodes, enCommands, enSettings)\n}\n\n// Type for locale messages - inferred from the English locale structure\ntype LocaleMessages = typeof messages.en\n\nexport const i18n = createI18n({\n  // Must set `false`, as Vue I18n Legacy API is for Vue 2\n  legacy: false,\n  locale: navigator.language.split('-')[0] || 'en',\n  fallbackLocale: 'en',\n  escapeParameter: true,\n  messages,\n  // Ignore warnings for locale options as each option is in its own language.\n  // e.g. \"English\", \"中文\", \"Русский\", \"日本語\", \"한국어\", \"Français\", \"Español\"\n  missingWarn: /^(?!settings\\.Comfy_Locale\\.options\\.).+/,\n  fallbackWarn: /^(?!settings\\.Comfy_Locale\\.options\\.).+/\n})\n\n/** Convenience shorthand: i18n.global */\n/** @deprecated use useI18n */\nexport const { t, te, d } = i18n.global\n\n/**\n * Safe translation function that returns the fallback message if the key is not found.\n *\n * @param key - The key to translate.\n * @param fallbackMessage - The fallback message to use if the key is not found.\n */\nexport function st(key: string, fallbackMessage: string) {\n  // The normal defaultMsg overload fails in some cases for custom nodes\n  return te(key) ? t(key) : fallbackMessage\n}\n"],"file":"i18n-gOSvTADh.js"}