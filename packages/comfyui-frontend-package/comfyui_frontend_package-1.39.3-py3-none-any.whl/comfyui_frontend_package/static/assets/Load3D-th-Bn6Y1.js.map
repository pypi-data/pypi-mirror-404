{"version":3,"file":"Load3D-th-Bn6Y1.js","names":[],"sources":["../../src/components/load3d/Load3DScene.vue","../../src/components/load3d/Load3DScene.vue","../../src/components/load3d/controls/RecordingControls.vue","../../src/components/load3d/controls/RecordingControls.vue","../../src/components/load3d/controls/RecordingControls.vue","../../src/components/load3d/controls/ViewerControls.vue","../../src/components/load3d/controls/ViewerControls.vue","../../src/components/load3d/Load3D.vue","../../src/components/load3d/Load3D.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"container\"\n    class=\"relative h-full w-full min-h-[200px]\"\n    data-capture-wheel=\"true\"\n    @pointerdown.stop\n    @pointermove.stop\n    @pointerup.stop\n    @mousedown.stop\n    @mousemove.stop\n    @mouseup.stop\n    @contextmenu.stop.prevent\n    @dragover.prevent.stop=\"handleDragOver\"\n    @dragleave.stop=\"handleDragLeave\"\n    @drop.prevent.stop=\"handleDrop\"\n  >\n    <LoadingOverlay :loading=\"loading\" :loading-message=\"loadingMessage\" />\n    <div\n      v-if=\"!isPreview && isDragging\"\n      class=\"pointer-events-none absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm\"\n    >\n      <div\n        class=\"rounded-lg border-2 border-dashed border-blue-400 bg-blue-500/20 px-6 py-4 text-lg font-medium text-blue-100\"\n      >\n        {{ dragMessage }}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, onUnmounted, ref } from 'vue'\n\nimport LoadingOverlay from '@/components/common/LoadingOverlay.vue'\nimport { useLoad3dDrag } from '@/composables/useLoad3dDrag'\n\nconst props = defineProps<{\n  initializeLoad3d: (containerRef: HTMLElement) => Promise<void>\n  cleanup: () => void\n  loading: boolean\n  loadingMessage: string\n  onModelDrop?: (file: File) => void | Promise<void>\n  isPreview: boolean\n}>()\n\nconst container = ref<HTMLElement | null>(null)\n\nconst { isDragging, dragMessage, handleDragOver, handleDragLeave, handleDrop } =\n  useLoad3dDrag({\n    onModelDrop: async (file) => {\n      if (props.onModelDrop) {\n        await props.onModelDrop(file)\n      }\n    },\n    disabled: computed(() => props.isPreview)\n  })\n\nonMounted(() => {\n  if (container.value) {\n    void props.initializeLoad3d(container.value)\n  }\n})\n\nonUnmounted(() => {\n  props.cleanup()\n})\n</script>\n","<template>\n  <div\n    ref=\"container\"\n    class=\"relative h-full w-full min-h-[200px]\"\n    data-capture-wheel=\"true\"\n    @pointerdown.stop\n    @pointermove.stop\n    @pointerup.stop\n    @mousedown.stop\n    @mousemove.stop\n    @mouseup.stop\n    @contextmenu.stop.prevent\n    @dragover.prevent.stop=\"handleDragOver\"\n    @dragleave.stop=\"handleDragLeave\"\n    @drop.prevent.stop=\"handleDrop\"\n  >\n    <LoadingOverlay :loading=\"loading\" :loading-message=\"loadingMessage\" />\n    <div\n      v-if=\"!isPreview && isDragging\"\n      class=\"pointer-events-none absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm\"\n    >\n      <div\n        class=\"rounded-lg border-2 border-dashed border-blue-400 bg-blue-500/20 px-6 py-4 text-lg font-medium text-blue-100\"\n      >\n        {{ dragMessage }}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, onUnmounted, ref } from 'vue'\n\nimport LoadingOverlay from '@/components/common/LoadingOverlay.vue'\nimport { useLoad3dDrag } from '@/composables/useLoad3dDrag'\n\nconst props = defineProps<{\n  initializeLoad3d: (containerRef: HTMLElement) => Promise<void>\n  cleanup: () => void\n  loading: boolean\n  loadingMessage: string\n  onModelDrop?: (file: File) => void | Promise<void>\n  isPreview: boolean\n}>()\n\nconst container = ref<HTMLElement | null>(null)\n\nconst { isDragging, dragMessage, handleDragOver, handleDragLeave, handleDrop } =\n  useLoad3dDrag({\n    onModelDrop: async (file) => {\n      if (props.onModelDrop) {\n        await props.onModelDrop(file)\n      }\n    },\n    disabled: computed(() => props.isPreview)\n  })\n\nonMounted(() => {\n  if (container.value) {\n    void props.initializeLoad3d(container.value)\n  }\n})\n\nonUnmounted(() => {\n  props.cleanup()\n})\n</script>\n","<template>\n  <div class=\"relative rounded-lg bg-backdrop/30\">\n    <div class=\"flex flex-col gap-2\">\n      <Button\n        v-tooltip.right=\"{\n          value: isRecording\n            ? $t('load3d.stopRecording')\n            : $t('load3d.startRecording'),\n          showDelay: 300\n        }\"\n        size=\"icon\"\n        variant=\"textonly\"\n        :class=\"\n          cn(\n            'rounded-full',\n            isRecording && 'text-red-500 recording-button-blink'\n          )\n        \"\n        :aria-label=\"\n          isRecording ? $t('load3d.stopRecording') : $t('load3d.startRecording')\n        \"\n        @click=\"toggleRecording\"\n      >\n        <i\n          :class=\"[\n            'pi',\n            isRecording ? 'pi-circle-fill' : 'pi-video',\n            'text-lg text-base-foreground'\n          ]\"\n        />\n      </Button>\n\n      <Button\n        v-if=\"hasRecording && !isRecording\"\n        v-tooltip.right=\"{\n          value: $t('load3d.exportRecording'),\n          showDelay: 300\n        }\"\n        size=\"icon\"\n        variant=\"textonly\"\n        class=\"rounded-full\"\n        :aria-label=\"$t('load3d.exportRecording')\"\n        @click=\"handleExportRecording\"\n      >\n        <i class=\"pi pi-download text-lg text-base-foreground\" />\n      </Button>\n\n      <Button\n        v-if=\"hasRecording && !isRecording\"\n        v-tooltip.right=\"{\n          value: $t('load3d.clearRecording'),\n          showDelay: 300\n        }\"\n        size=\"icon\"\n        variant=\"textonly\"\n        class=\"rounded-full\"\n        :aria-label=\"$t('load3d.clearRecording')\"\n        @click=\"handleClearRecording\"\n      >\n        <i class=\"pi pi-trash text-lg text-base-foreground\" />\n      </Button>\n\n      <div\n        v-if=\"recordingDuration && recordingDuration > 0 && !isRecording\"\n        class=\"mt-1 text-center text-xs text-base-foreground\"\n      >\n        {{ formatDuration(recordingDuration) }}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport Button from '@/components/ui/button/Button.vue'\nimport { cn } from '@/utils/tailwindUtil'\n\nconst hasRecording = defineModel<boolean>('hasRecording')\nconst isRecording = defineModel<boolean>('isRecording')\nconst recordingDuration = defineModel<number>('recordingDuration')\n\nconst emit = defineEmits<{\n  (e: 'startRecording'): void\n  (e: 'stopRecording'): void\n  (e: 'exportRecording'): void\n  (e: 'clearRecording'): void\n}>()\n\nfunction toggleRecording() {\n  if (isRecording.value) {\n    emit('stopRecording')\n  } else {\n    emit('startRecording')\n  }\n}\n\nfunction handleExportRecording() {\n  emit('exportRecording')\n}\n\nfunction handleClearRecording() {\n  emit('clearRecording')\n}\n\nfunction formatDuration(seconds: number): string {\n  const minutes = Math.floor(seconds / 60)\n  const remainingSeconds = Math.floor(seconds % 60)\n  return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`\n}\n</script>\n\n<style scoped>\n.recording-button-blink {\n  animation: blink 1s infinite;\n}\n\n@keyframes blink {\n  0%,\n  100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n}\n</style>\n","<template>\n  <div class=\"relative rounded-lg bg-backdrop/30\">\n    <div class=\"flex flex-col gap-2\">\n      <Button\n        v-tooltip.right=\"{\n          value: isRecording\n            ? $t('load3d.stopRecording')\n            : $t('load3d.startRecording'),\n          showDelay: 300\n        }\"\n        size=\"icon\"\n        variant=\"textonly\"\n        :class=\"\n          cn(\n            'rounded-full',\n            isRecording && 'text-red-500 recording-button-blink'\n          )\n        \"\n        :aria-label=\"\n          isRecording ? $t('load3d.stopRecording') : $t('load3d.startRecording')\n        \"\n        @click=\"toggleRecording\"\n      >\n        <i\n          :class=\"[\n            'pi',\n            isRecording ? 'pi-circle-fill' : 'pi-video',\n            'text-lg text-base-foreground'\n          ]\"\n        />\n      </Button>\n\n      <Button\n        v-if=\"hasRecording && !isRecording\"\n        v-tooltip.right=\"{\n          value: $t('load3d.exportRecording'),\n          showDelay: 300\n        }\"\n        size=\"icon\"\n        variant=\"textonly\"\n        class=\"rounded-full\"\n        :aria-label=\"$t('load3d.exportRecording')\"\n        @click=\"handleExportRecording\"\n      >\n        <i class=\"pi pi-download text-lg text-base-foreground\" />\n      </Button>\n\n      <Button\n        v-if=\"hasRecording && !isRecording\"\n        v-tooltip.right=\"{\n          value: $t('load3d.clearRecording'),\n          showDelay: 300\n        }\"\n        size=\"icon\"\n        variant=\"textonly\"\n        class=\"rounded-full\"\n        :aria-label=\"$t('load3d.clearRecording')\"\n        @click=\"handleClearRecording\"\n      >\n        <i class=\"pi pi-trash text-lg text-base-foreground\" />\n      </Button>\n\n      <div\n        v-if=\"recordingDuration && recordingDuration > 0 && !isRecording\"\n        class=\"mt-1 text-center text-xs text-base-foreground\"\n      >\n        {{ formatDuration(recordingDuration) }}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport Button from '@/components/ui/button/Button.vue'\nimport { cn } from '@/utils/tailwindUtil'\n\nconst hasRecording = defineModel<boolean>('hasRecording')\nconst isRecording = defineModel<boolean>('isRecording')\nconst recordingDuration = defineModel<number>('recordingDuration')\n\nconst emit = defineEmits<{\n  (e: 'startRecording'): void\n  (e: 'stopRecording'): void\n  (e: 'exportRecording'): void\n  (e: 'clearRecording'): void\n}>()\n\nfunction toggleRecording() {\n  if (isRecording.value) {\n    emit('stopRecording')\n  } else {\n    emit('startRecording')\n  }\n}\n\nfunction handleExportRecording() {\n  emit('exportRecording')\n}\n\nfunction handleClearRecording() {\n  emit('clearRecording')\n}\n\nfunction formatDuration(seconds: number): string {\n  const minutes = Math.floor(seconds / 60)\n  const remainingSeconds = Math.floor(seconds % 60)\n  return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`\n}\n</script>\n\n<style scoped>\n.recording-button-blink {\n  animation: blink 1s infinite;\n}\n\n@keyframes blink {\n  0%,\n  100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n}\n</style>\n","<template>\n  <div class=\"relative rounded-lg bg-backdrop/30\">\n    <div class=\"flex flex-col gap-2\">\n      <Button\n        v-tooltip.right=\"{\n          value: isRecording\n            ? $t('load3d.stopRecording')\n            : $t('load3d.startRecording'),\n          showDelay: 300\n        }\"\n        size=\"icon\"\n        variant=\"textonly\"\n        :class=\"\n          cn(\n            'rounded-full',\n            isRecording && 'text-red-500 recording-button-blink'\n          )\n        \"\n        :aria-label=\"\n          isRecording ? $t('load3d.stopRecording') : $t('load3d.startRecording')\n        \"\n        @click=\"toggleRecording\"\n      >\n        <i\n          :class=\"[\n            'pi',\n            isRecording ? 'pi-circle-fill' : 'pi-video',\n            'text-lg text-base-foreground'\n          ]\"\n        />\n      </Button>\n\n      <Button\n        v-if=\"hasRecording && !isRecording\"\n        v-tooltip.right=\"{\n          value: $t('load3d.exportRecording'),\n          showDelay: 300\n        }\"\n        size=\"icon\"\n        variant=\"textonly\"\n        class=\"rounded-full\"\n        :aria-label=\"$t('load3d.exportRecording')\"\n        @click=\"handleExportRecording\"\n      >\n        <i class=\"pi pi-download text-lg text-base-foreground\" />\n      </Button>\n\n      <Button\n        v-if=\"hasRecording && !isRecording\"\n        v-tooltip.right=\"{\n          value: $t('load3d.clearRecording'),\n          showDelay: 300\n        }\"\n        size=\"icon\"\n        variant=\"textonly\"\n        class=\"rounded-full\"\n        :aria-label=\"$t('load3d.clearRecording')\"\n        @click=\"handleClearRecording\"\n      >\n        <i class=\"pi pi-trash text-lg text-base-foreground\" />\n      </Button>\n\n      <div\n        v-if=\"recordingDuration && recordingDuration > 0 && !isRecording\"\n        class=\"mt-1 text-center text-xs text-base-foreground\"\n      >\n        {{ formatDuration(recordingDuration) }}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport Button from '@/components/ui/button/Button.vue'\nimport { cn } from '@/utils/tailwindUtil'\n\nconst hasRecording = defineModel<boolean>('hasRecording')\nconst isRecording = defineModel<boolean>('isRecording')\nconst recordingDuration = defineModel<number>('recordingDuration')\n\nconst emit = defineEmits<{\n  (e: 'startRecording'): void\n  (e: 'stopRecording'): void\n  (e: 'exportRecording'): void\n  (e: 'clearRecording'): void\n}>()\n\nfunction toggleRecording() {\n  if (isRecording.value) {\n    emit('stopRecording')\n  } else {\n    emit('startRecording')\n  }\n}\n\nfunction handleExportRecording() {\n  emit('exportRecording')\n}\n\nfunction handleClearRecording() {\n  emit('clearRecording')\n}\n\nfunction formatDuration(seconds: number): string {\n  const minutes = Math.floor(seconds / 60)\n  const remainingSeconds = Math.floor(seconds % 60)\n  return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`\n}\n</script>\n\n<style scoped>\n.recording-button-blink {\n  animation: blink 1s infinite;\n}\n\n@keyframes blink {\n  0%,\n  100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n}\n</style>\n","<template>\n  <div class=\"relative rounded-lg bg-backdrop/30\">\n    <div class=\"flex flex-col gap-2\">\n      <Button\n        v-tooltip.right=\"{\n          value: t('load3d.openIn3DViewer'),\n          showDelay: 300\n        }\"\n        size=\"icon\"\n        variant=\"textonly\"\n        class=\"rounded-full\"\n        :aria-label=\"t('load3d.openIn3DViewer')\"\n        @click=\"openIn3DViewer\"\n      >\n        <i class=\"pi pi-expand text-lg text-base-foreground\" />\n      </Button>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport Load3DViewerContent from '@/components/load3d/Load3dViewerContent.vue'\nimport Button from '@/components/ui/button/Button.vue'\nimport { t } from '@/i18n'\nimport type { LGraphNode } from '@/lib/litegraph/src/LGraphNode'\nimport { useLoad3dService } from '@/services/load3dService'\nimport { useDialogStore } from '@/stores/dialogStore'\n\nconst { node } = defineProps<{\n  node: LGraphNode\n}>()\n\nconst openIn3DViewer = () => {\n  const props = { node: node }\n\n  useDialogStore().showDialog({\n    key: 'global-load3d-viewer',\n    title: t('load3d.viewer.title'),\n    component: Load3DViewerContent,\n    props: props,\n    dialogComponentProps: {\n      style: 'width: 80vw; height: 80vh;',\n      maximizable: true,\n      onClose: async () => {\n        await useLoad3dService().handleViewerClose(props.node)\n      }\n    }\n  })\n}\n</script>\n\n<style scoped></style>\n","<template>\n  <div class=\"relative rounded-lg bg-backdrop/30\">\n    <div class=\"flex flex-col gap-2\">\n      <Button\n        v-tooltip.right=\"{\n          value: t('load3d.openIn3DViewer'),\n          showDelay: 300\n        }\"\n        size=\"icon\"\n        variant=\"textonly\"\n        class=\"rounded-full\"\n        :aria-label=\"t('load3d.openIn3DViewer')\"\n        @click=\"openIn3DViewer\"\n      >\n        <i class=\"pi pi-expand text-lg text-base-foreground\" />\n      </Button>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport Load3DViewerContent from '@/components/load3d/Load3dViewerContent.vue'\nimport Button from '@/components/ui/button/Button.vue'\nimport { t } from '@/i18n'\nimport type { LGraphNode } from '@/lib/litegraph/src/LGraphNode'\nimport { useLoad3dService } from '@/services/load3dService'\nimport { useDialogStore } from '@/stores/dialogStore'\n\nconst { node } = defineProps<{\n  node: LGraphNode\n}>()\n\nconst openIn3DViewer = () => {\n  const props = { node: node }\n\n  useDialogStore().showDialog({\n    key: 'global-load3d-viewer',\n    title: t('load3d.viewer.title'),\n    component: Load3DViewerContent,\n    props: props,\n    dialogComponentProps: {\n      style: 'width: 80vw; height: 80vh;',\n      maximizable: true,\n      onClose: async () => {\n        await useLoad3dService().handleViewerClose(props.node)\n      }\n    }\n  })\n}\n</script>\n\n<style scoped></style>\n","<template>\n  <div\n    class=\"relative size-full\"\n    @mouseenter=\"handleMouseEnter\"\n    @mouseleave=\"handleMouseLeave\"\n    @pointerdown.stop\n    @pointermove.stop\n    @pointerup.stop\n  >\n    <Load3DScene\n      v-if=\"node\"\n      :initialize-load3d=\"initializeLoad3d\"\n      :cleanup=\"cleanup\"\n      :loading=\"loading\"\n      :loading-message=\"loadingMessage\"\n      :on-model-drop=\"isPreview ? undefined : handleModelDrop\"\n      :is-preview=\"isPreview\"\n    />\n    <div class=\"pointer-events-none absolute top-0 left-0 size-full\">\n      <Load3DControls\n        v-model:scene-config=\"sceneConfig\"\n        v-model:model-config=\"modelConfig\"\n        v-model:camera-config=\"cameraConfig\"\n        v-model:light-config=\"lightConfig\"\n        :is-splat-model=\"isSplatModel\"\n        :is-ply-model=\"isPlyModel\"\n        :has-skeleton=\"hasSkeleton\"\n        @update-background-image=\"handleBackgroundImageUpdate\"\n        @export-model=\"handleExportModel\"\n      />\n      <AnimationControls\n        v-if=\"animations && animations.length > 0\"\n        v-model:animations=\"animations\"\n        v-model:playing=\"playing\"\n        v-model:selected-speed=\"selectedSpeed\"\n        v-model:selected-animation=\"selectedAnimation\"\n        v-model:animation-progress=\"animationProgress\"\n        v-model:animation-duration=\"animationDuration\"\n        @seek=\"handleSeek\"\n      />\n    </div>\n    <div\n      v-if=\"enable3DViewer && node\"\n      class=\"pointer-events-auto absolute top-12 right-2 z-20\"\n    >\n      <ViewerControls :node=\"node as LGraphNode\" />\n    </div>\n\n    <div\n      v-if=\"!isPreview\"\n      class=\"pointer-events-auto absolute right-2 z-20\"\n      :class=\"{\n        'top-12': !enable3DViewer,\n        'top-24': enable3DViewer\n      }\"\n    >\n      <RecordingControls\n        v-model:is-recording=\"isRecording\"\n        v-model:has-recording=\"hasRecording\"\n        v-model:recording-duration=\"recordingDuration\"\n        @start-recording=\"handleStartRecording\"\n        @stop-recording=\"handleStopRecording\"\n        @export-recording=\"handleExportRecording\"\n        @clear-recording=\"handleClearRecording\"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, ref } from 'vue'\nimport type { Ref } from 'vue'\n\nimport Load3DControls from '@/components/load3d/Load3DControls.vue'\nimport Load3DScene from '@/components/load3d/Load3DScene.vue'\nimport AnimationControls from '@/components/load3d/controls/AnimationControls.vue'\nimport RecordingControls from '@/components/load3d/controls/RecordingControls.vue'\nimport ViewerControls from '@/components/load3d/controls/ViewerControls.vue'\nimport { useLoad3d } from '@/composables/useLoad3d'\nimport type { LGraphNode } from '@/lib/litegraph/src/LGraphNode'\nimport { useSettingStore } from '@/platform/settings/settingStore'\nimport type { NodeId } from '@/platform/workflow/validation/schemas/workflowSchema'\nimport { app } from '@/scripts/app'\nimport type { ComponentWidget } from '@/scripts/domWidget'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\n\nconst props = defineProps<{\n  widget: ComponentWidget<string[]> | SimplifiedWidget\n  nodeId?: NodeId\n}>()\n\nfunction isComponentWidget(\n  widget: ComponentWidget<string[]> | SimplifiedWidget\n): widget is ComponentWidget<string[]> {\n  return 'node' in widget && widget.node !== undefined\n}\n\nconst node = ref<LGraphNode | null>(null)\n\nif (isComponentWidget(props.widget)) {\n  node.value = props.widget.node\n} else if (props.nodeId) {\n  onMounted(() => {\n    node.value = app.rootGraph?.getNodeById(props.nodeId!) || null\n  })\n}\n\nconst {\n  // configs\n  sceneConfig,\n  modelConfig,\n  cameraConfig,\n  lightConfig,\n\n  // other state\n  isRecording,\n  isPreview,\n  isSplatModel,\n  isPlyModel,\n  hasSkeleton,\n  hasRecording,\n  recordingDuration,\n  animations,\n  playing,\n  selectedSpeed,\n  selectedAnimation,\n  animationProgress,\n  animationDuration,\n  loading,\n  loadingMessage,\n\n  // Methods\n  initializeLoad3d,\n  handleMouseEnter,\n  handleMouseLeave,\n  handleStartRecording,\n  handleStopRecording,\n  handleExportRecording,\n  handleClearRecording,\n  handleSeek,\n  handleBackgroundImageUpdate,\n  handleExportModel,\n  handleModelDrop,\n  cleanup\n} = useLoad3d(node as Ref<LGraphNode | null>)\n\nconst enable3DViewer = computed(() =>\n  useSettingStore().get('Comfy.Load3D.3DViewerEnable')\n)\n</script>\n","<template>\n  <div\n    class=\"relative size-full\"\n    @mouseenter=\"handleMouseEnter\"\n    @mouseleave=\"handleMouseLeave\"\n    @pointerdown.stop\n    @pointermove.stop\n    @pointerup.stop\n  >\n    <Load3DScene\n      v-if=\"node\"\n      :initialize-load3d=\"initializeLoad3d\"\n      :cleanup=\"cleanup\"\n      :loading=\"loading\"\n      :loading-message=\"loadingMessage\"\n      :on-model-drop=\"isPreview ? undefined : handleModelDrop\"\n      :is-preview=\"isPreview\"\n    />\n    <div class=\"pointer-events-none absolute top-0 left-0 size-full\">\n      <Load3DControls\n        v-model:scene-config=\"sceneConfig\"\n        v-model:model-config=\"modelConfig\"\n        v-model:camera-config=\"cameraConfig\"\n        v-model:light-config=\"lightConfig\"\n        :is-splat-model=\"isSplatModel\"\n        :is-ply-model=\"isPlyModel\"\n        :has-skeleton=\"hasSkeleton\"\n        @update-background-image=\"handleBackgroundImageUpdate\"\n        @export-model=\"handleExportModel\"\n      />\n      <AnimationControls\n        v-if=\"animations && animations.length > 0\"\n        v-model:animations=\"animations\"\n        v-model:playing=\"playing\"\n        v-model:selected-speed=\"selectedSpeed\"\n        v-model:selected-animation=\"selectedAnimation\"\n        v-model:animation-progress=\"animationProgress\"\n        v-model:animation-duration=\"animationDuration\"\n        @seek=\"handleSeek\"\n      />\n    </div>\n    <div\n      v-if=\"enable3DViewer && node\"\n      class=\"pointer-events-auto absolute top-12 right-2 z-20\"\n    >\n      <ViewerControls :node=\"node as LGraphNode\" />\n    </div>\n\n    <div\n      v-if=\"!isPreview\"\n      class=\"pointer-events-auto absolute right-2 z-20\"\n      :class=\"{\n        'top-12': !enable3DViewer,\n        'top-24': enable3DViewer\n      }\"\n    >\n      <RecordingControls\n        v-model:is-recording=\"isRecording\"\n        v-model:has-recording=\"hasRecording\"\n        v-model:recording-duration=\"recordingDuration\"\n        @start-recording=\"handleStartRecording\"\n        @stop-recording=\"handleStopRecording\"\n        @export-recording=\"handleExportRecording\"\n        @clear-recording=\"handleClearRecording\"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, ref } from 'vue'\nimport type { Ref } from 'vue'\n\nimport Load3DControls from '@/components/load3d/Load3DControls.vue'\nimport Load3DScene from '@/components/load3d/Load3DScene.vue'\nimport AnimationControls from '@/components/load3d/controls/AnimationControls.vue'\nimport RecordingControls from '@/components/load3d/controls/RecordingControls.vue'\nimport ViewerControls from '@/components/load3d/controls/ViewerControls.vue'\nimport { useLoad3d } from '@/composables/useLoad3d'\nimport type { LGraphNode } from '@/lib/litegraph/src/LGraphNode'\nimport { useSettingStore } from '@/platform/settings/settingStore'\nimport type { NodeId } from '@/platform/workflow/validation/schemas/workflowSchema'\nimport { app } from '@/scripts/app'\nimport type { ComponentWidget } from '@/scripts/domWidget'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\n\nconst props = defineProps<{\n  widget: ComponentWidget<string[]> | SimplifiedWidget\n  nodeId?: NodeId\n}>()\n\nfunction isComponentWidget(\n  widget: ComponentWidget<string[]> | SimplifiedWidget\n): widget is ComponentWidget<string[]> {\n  return 'node' in widget && widget.node !== undefined\n}\n\nconst node = ref<LGraphNode | null>(null)\n\nif (isComponentWidget(props.widget)) {\n  node.value = props.widget.node\n} else if (props.nodeId) {\n  onMounted(() => {\n    node.value = app.rootGraph?.getNodeById(props.nodeId!) || null\n  })\n}\n\nconst {\n  // configs\n  sceneConfig,\n  modelConfig,\n  cameraConfig,\n  lightConfig,\n\n  // other state\n  isRecording,\n  isPreview,\n  isSplatModel,\n  isPlyModel,\n  hasSkeleton,\n  hasRecording,\n  recordingDuration,\n  animations,\n  playing,\n  selectedSpeed,\n  selectedAnimation,\n  animationProgress,\n  animationDuration,\n  loading,\n  loadingMessage,\n\n  // Methods\n  initializeLoad3d,\n  handleMouseEnter,\n  handleMouseLeave,\n  handleStartRecording,\n  handleStopRecording,\n  handleExportRecording,\n  handleClearRecording,\n  handleSeek,\n  handleBackgroundImageUpdate,\n  handleExportModel,\n  handleModelDrop,\n  cleanup\n} = useLoad3d(node as Ref<LGraphNode | null>)\n\nconst enable3DViewer = computed(() =>\n  useSettingStore().get('Comfy.Load3D.3DViewerEnable')\n)\n</script>\n"],"mappings":"+vBCiC2B,IACG,ubAE9B,IAAM,EAAQ,EASR,EAAY,EAAwB,KAAI,CAExC,CAAE,aAAY,cAAa,iBAAgB,kBAAiB,cAChE,EAAc,CACZ,YAAa,KAAO,IAAS,CACvB,EAAM,aACR,MAAM,EAAM,YAAY,EAAI,EAGhC,SAAU,MAAe,EAAM,UAAA,CAChC,CAAA,QAEH,MAAgB,CACV,EAAU,OACP,EAAM,iBAAiB,EAAU,MAAK,EAE9C,CAED,MAAkB,CAChB,EAAM,SAAQ,EACf,mzBGQkB,IACA,6fAEnB,IAAM,EAAe,EAAoB,EAAC,eAAc,CAClD,EAAc,EAAoB,EAAC,cAAa,CAChD,EAAoB,EAAmB,EAAC,oBAAmB,CAE3D,EAAO,EAOb,SAAS,iBAAkB,CACrB,EAAY,MACd,EAAK,gBAAe,CAEpB,EAAK,iBAAgB,CAIzB,SAAS,uBAAwB,CAC/B,EAAK,kBAAiB,CAGxB,SAAS,sBAAuB,CAC9B,EAAK,iBAAgB,CAGvB,SAAS,eAAe,EAAyB,CAC/C,IAAM,EAAU,KAAK,MAAM,EAAU,GAAE,CACjC,EAAmB,KAAK,MAAM,EAAU,GAAE,CAChD,MAAO,GAAG,EAAQ,UAAU,CAAC,SAAS,EAAG,IAAI,CAAC,GAAG,EAAiB,UAAU,CAAC,SAAS,EAAG,IAAI,89CErF/D,IACb,KACD,IAEe,IACF,wIAM/B,IAAM,mBAAuB,CAC3B,IAAM,EAAQ,CAAE,KAAM,EAAA,KAAK,CAE3B,GAAgB,CAAC,WAAW,CAC1B,IAAK,uBACL,MAAO,EAAE,sBAAsB,CAC/B,UAAW,EACJ,QACP,qBAAsB,CACpB,MAAO,6BACP,YAAa,GACb,QAAS,SAAY,CACnB,MAAM,GAAkB,CAAC,kBAAkB,EAAM,KAAI,GAG1D,CAAA,gdE0BwB,KACH,IACM,KACA,KACH,IACD,IAEM,IAEZ,iMAIpB,IAAM,EAAQ,EAKd,SAAS,kBACP,EACqC,CACrC,MAAO,SAAU,GAAU,EAAO,OAAS,IAAA,GAG7C,IAAM,EAAO,EAAuB,KAAI,CAEpC,kBAAkB,EAAM,OAAO,CACjC,EAAK,MAAQ,EAAM,OAAO,KACjB,EAAM,QACf,MAAgB,CACd,EAAK,MAAQ,GAAI,WAAW,YAAY,EAAM,OAAQ,EAAI,MAC3D,CAGH,GAAM,CAEJ,cACA,cACA,eACA,cAGA,cACA,YACA,eACA,aACA,eACA,eACA,oBACA,aACA,UACA,gBACA,oBACA,oBACA,oBACA,UACA,iBAGA,mBACA,mBACA,mBACA,uBACA,sBACA,wBACA,uBACA,aACA,8BACA,oBACA,kBACA,WACE,GAAU,EAA8B,CAEtC,EAAiB,MACrB,IAAiB,CAAC,IAAI,8BAA6B,CACrD"}