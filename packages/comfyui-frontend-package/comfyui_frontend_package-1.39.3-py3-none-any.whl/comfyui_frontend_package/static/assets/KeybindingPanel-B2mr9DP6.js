import{i as e,n as t}from"./rolldown-runtime-BKYq3fBv.js";import{$n as n,Cr as r,En as i,Gn as a,Ir as o,Jt as ee,Mn as s,Nn as c,Or as te,Qn as l,Rr as u,Tn as d,Tr as f,Un as p,Xn as m,Xr as h,Zn as g,_n as _,_t as v,ai as y,an as b,ar as x,er as S,g as C,h as w,ir as T,jn as E,lt as D,on as ne,qt as O,si as re,sr as k,ui as A,ut as ie,vn as ae,vt as j,zr as oe}from"./vendor-primevue-Cg-HmKZY.js";import{ot as se,st as ce}from"./vendor-other-CoxDvJ0a.js";import{n as le,t as M}from"./Button-YQy7RkKq.js";import{n as ue,t as N,w as P,y as F}from"./PanelTemplate-hGipIJT8.js";import{Da as I,Do as L,Ea as R,Eo as z,Fa as B,Ia as V,La as H,Oo as de,Pa as fe,To as pe}from"./dialogService-DvYmp2_F.js";import{n as me,t as he}from"./_plugin-vue_export-helper-Ckv1EJQX.js";import{n as ge,t as _e}from"./keybindingService-DU2IypAc.js";var U,W,G=t((()=>{c(),w(),U={key:0,class:`px-2`},W=k({__name:`KeyComboDisplay`,props:{keyCombo:{},isModified:{type:Boolean,default:!1}},setup(e){let t=m(()=>e.keyCombo.getKeySequences());return(e,i)=>(r(),S(`span`,null,[(r(!0),S(a,null,f(t.value,(i,o)=>(r(),S(a,{key:o},[x(y(C),{severity:e.isModified?`info`:`secondary`},{default:u(()=>[T(A(i),1)]),_:2},1032,[`severity`]),o<t.value.length-1?(r(),S(`span`,U,`+`)):n(``,!0)],64))),128))]))}})})),K,ve=t((()=>{G(),G(),K=W})),q,J,Y,X,Z,Q=t((()=>{c(),s(),v(),D(),O(),b(),_(),w(),d(),se(),I(),le(),H(),B(),_e(),L(),pe(),F(),ue(),ve(),q={class:`actions invisible flex flex-row`},J=[`title`],Y={key:1},X={class:`overflow-hidden text-ellipsis`},Z=k({__name:`KeybindingPanel`,setup(e){let t=h({global:{value:``,matchMode:E.CONTAINS}}),a=de(),s=ge(),c=z(),{t:d}=ce(),f=m(()=>Object.values(c.commands).map(e=>({id:e.id,label:d(`commands.${P(e.id)}.label`,e.label??``),keybinding:a.getKeybindingByCommandId(e.id),source:e.source}))),_=h(null),v=h(!1),b=h(null),w=h(null),D=h(null),O=m(()=>!w.value||w.value.keybinding?.combo?.equals(b.value)||!b.value?null:a.getKeybinding(b.value));function editKeybinding(e){w.value=e,b.value=e.keybinding?e.keybinding.combo:null,v.value=!0}o(()=>{v.value&&setTimeout(()=>{D.value?.$el?.focus()},300)});async function removeKeybinding(e){e.keybinding&&(a.unsetKeybinding(e.keybinding),await s.persistUserKeybindings())}async function captureKeybinding(e){if(!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey)switch(e.key){case`Escape`:cancelEdit();return;case`Enter`:await saveKeybinding();return}b.value=V.fromEvent(e)}function cancelEdit(){v.value=!1,w.value=null,b.value=null}async function saveKeybinding(){let e=w.value?.id,t=b.value;cancelEdit(),!(!t||e==null)&&a.updateKeybindingOnCommand(new fe({commandId:e,combo:t}))&&await s.persistUserKeybindings()}async function resetKeybinding(e){a.resetKeybindingForCommand(e.id)?await s.persistUserKeybindings():console.warn(`No changes made when resetting keybinding for command: ${e.id}`)}let k=i();async function resetAllKeybindings(){a.resetAllKeybindings(),await s.persistUserKeybindings(),k.add({severity:`info`,summary:`Info`,detail:`All keybindings reset`,life:3e3})}return(e,i)=>{let o=te(`tooltip`);return r(),l(N,{value:`Keybinding`,class:`keybinding-panel`},{header:u(()=>[x(R,{modelValue:t.value.global.value,"onUpdate:modelValue":i[0]||=e=>t.value.global.value=e,placeholder:e.$t(`g.searchKeybindings`)+`...`},null,8,[`modelValue`,`placeholder`])]),default:u(()=>[x(y(ie),{selection:_.value,"onUpdate:selection":i[1]||=e=>_.value=e,value:f.value,"global-filter-fields":[`id`,`label`],filters:t.value,"selection-mode":`single`,"striped-rows":``,pt:{header:`px-0`},onRowDblclick:i[2]||=e=>editKeybinding(e.data)},{default:u(()=>[x(y(j),{field:`actions`,header:``},{body:u(t=>[g(`div`,q,[x(M,{variant:`textonly`,size:`icon`,"aria-label":e.$t(`g.edit`),onClick:e=>editKeybinding(t.data)},{default:u(()=>i[4]||=[g(`i`,{class:`pi pi-pencil`},null,-1)]),_:2},1032,[`aria-label`,`onClick`]),x(M,{variant:`textonly`,size:`icon`,"aria-label":e.$t(`g.reset`),disabled:!y(a).isCommandKeybindingModified(t.data.id),onClick:e=>resetKeybinding(t.data)},{default:u(()=>i[5]||=[g(`i`,{class:`pi pi-replay`},null,-1)]),_:2},1032,[`aria-label`,`disabled`,`onClick`]),x(M,{variant:`textonly`,size:`icon`,"aria-label":e.$t(`g.delete`),disabled:!t.data.keybinding,onClick:e=>removeKeybinding(t.data)},{default:u(()=>i[6]||=[g(`i`,{class:`pi pi-trash`},null,-1)]),_:2},1032,[`aria-label`,`disabled`,`onClick`])])]),_:1}),x(y(j),{field:`id`,header:e.$t(`g.command`),sortable:``,class:`max-w-64 2xl:max-w-full`},{body:u(e=>[g(`div`,{class:`truncate`,title:e.data.id},A(e.data.label),9,J)]),_:1},8,[`header`]),x(y(j),{field:`keybinding`,header:e.$t(`g.keybinding`)},{body:u(e=>[e.data.keybinding?(r(),l(K,{key:0,"key-combo":e.data.keybinding.combo,"is-modified":y(a).isCommandKeybindingModified(e.data.id)},null,8,[`key-combo`,`is-modified`])):(r(),S(`span`,Y,`-`))]),_:1},8,[`header`]),x(y(j),{field:`source`,header:e.$t(`g.source`)},{body:u(e=>[g(`span`,X,A(e.data.source||`-`),1)]),_:1},8,[`header`])]),_:1},8,[`selection`,`value`,`filters`]),x(y(ee),{visible:v.value,"onUpdate:visible":i[3]||=e=>v.value=e,class:`min-w-96`,modal:``,header:w.value?.label,onHide:cancelEdit},{footer:u(()=>[x(M,{variant:O.value?`destructive`:`primary`,autofocus:``,onClick:saveKeybinding},{default:u(()=>[g(`i`,{class:re(O.value?`pi pi-pencil`:`pi pi-check`)},null,2),T(` `+A(O.value?e.$t(`g.overwrite`):e.$t(`g.save`)),1)]),_:1},8,[`variant`])]),default:u(()=>[g(`div`,null,[x(y(ne),{ref_key:`keybindingInput`,ref:D,class:`mb-2 text-center`,"model-value":b.value?.toString()??``,placeholder:e.$t(`g.pressKeysForNewBinding`),autocomplete:`off`,fluid:``,onKeydown:p(captureKeybinding,[`stop`,`prevent`])},null,8,[`model-value`,`placeholder`]),O.value?(r(),l(y(ae),{key:0,severity:`warn`},{default:u(()=>[T(A(e.$t(`g.keybindingAlreadyExists`))+` `,1),x(y(C),{severity:`secondary`,value:O.value.commandId},null,8,[`value`])]),_:1})):n(``,!0)])]),_:1},8,[`visible`,`header`]),oe((r(),l(M,{class:`mt-4 w-full`,variant:`destructive-textonly`,onClick:resetAllKeybindings},{default:u(()=>[i[7]||=g(`i`,{class:`pi pi-replay`},null,-1),T(` `+A(e.$t(`g.resetAll`)),1)]),_:1})),[[o,e.$t(`g.resetAllKeybindingsTooltip`)]])]),_:1})}}})})),ye=t((()=>{})),$;t((()=>{Q(),Q(),ye(),me(),$=he(Z,[[`__scopeId`,`data-v-2d30a7ec`]])}))();export{$ as default};
//# sourceMappingURL=KeybindingPanel-B2mr9DP6.js.map