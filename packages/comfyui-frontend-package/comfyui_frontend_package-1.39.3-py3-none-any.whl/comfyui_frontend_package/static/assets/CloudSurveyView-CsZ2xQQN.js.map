{"version":3,"file":"CloudSurveyView-CsZ2xQQN.js","names":[],"sources":["../../src/platform/cloud/onboarding/CloudSurveyView.vue","../../src/platform/cloud/onboarding/CloudSurveyView.vue","../../src/platform/cloud/onboarding/CloudSurveyView.vue"],"sourcesContent":["<template>\n  <div>\n    <Stepper\n      value=\"1\"\n      class=\"flex h-[638px] max-h-[80vh] w-[320px] max-w-[90vw] flex-col\"\n    >\n      <ProgressBar\n        :value=\"progressPercent\"\n        :show-value=\"false\"\n        class=\"mb-8 h-2\"\n      />\n\n      <StepPanels class=\"flex flex-1 flex-col p-0\">\n        <StepPanel\n          v-slot=\"{ activateCallback }\"\n          value=\"1\"\n          class=\"flex min-h-full flex-1 flex-col justify-between bg-transparent\"\n        >\n          <div>\n            <label class=\"mb-8 block text-lg font-medium\">{{\n              t('cloudSurvey_steps_familiarity')\n            }}</label>\n            <div class=\"flex flex-col gap-6\">\n              <div\n                v-for=\"opt in familiarityOptions\"\n                :key=\"opt.value\"\n                class=\"flex items-center gap-3\"\n              >\n                <RadioButton\n                  v-model=\"surveyData.familiarity\"\n                  :input-id=\"`fam-${opt.value}`\"\n                  name=\"familiarity\"\n                  :value=\"opt.value\"\n                />\n                <label\n                  :for=\"`fam-${opt.value}`\"\n                  class=\"cursor-pointer text-sm\"\n                  >{{ opt.label }}</label\n                >\n              </div>\n            </div>\n          </div>\n\n          <div class=\"flex justify-between pt-4\">\n            <span />\n            <Button\n              :disabled=\"!validStep1\"\n              class=\"h-10 w-full border-none text-white\"\n              @click=\"goTo(2, activateCallback)\"\n            >\n              {{ $t('g.next') }}\n            </Button>\n          </div>\n        </StepPanel>\n\n        <StepPanel\n          v-slot=\"{ activateCallback }\"\n          value=\"2\"\n          class=\"flex min-h-full flex-1 flex-col justify-between bg-transparent\"\n        >\n          <div>\n            <label class=\"mb-8 block text-lg font-medium\">{{\n              t('cloudSurvey_steps_purpose')\n            }}</label>\n            <div class=\"flex flex-col gap-6\">\n              <div\n                v-for=\"opt in purposeOptions\"\n                :key=\"opt.value\"\n                class=\"flex items-center gap-3\"\n              >\n                <RadioButton\n                  v-model=\"surveyData.useCase\"\n                  :input-id=\"`purpose-${opt.value}`\"\n                  name=\"purpose\"\n                  :value=\"opt.value\"\n                />\n                <label\n                  :for=\"`purpose-${opt.value}`\"\n                  class=\"cursor-pointer text-sm\"\n                  >{{ opt.label }}</label\n                >\n              </div>\n            </div>\n            <div v-if=\"surveyData.useCase === 'other'\" class=\"mt-4 ml-8\">\n              <InputText\n                v-model=\"surveyData.useCaseOther\"\n                class=\"w-full\"\n                :placeholder=\"\n                  $t('cloudOnboarding.survey.options.industry.otherPlaceholder')\n                \"\n              />\n            </div>\n          </div>\n\n          <div class=\"flex gap-6 pt-4\">\n            <Button\n              variant=\"secondary\"\n              class=\"flex-1 text-white\"\n              @click=\"goTo(1, activateCallback)\"\n            >\n              {{ $t('g.back') }}\n            </Button>\n            <Button\n              :disabled=\"!validStep2\"\n              class=\"h-10 flex-1 text-white\"\n              @click=\"goTo(3, activateCallback)\"\n            >\n              {{ $t('g.next') }}\n            </Button>\n          </div>\n        </StepPanel>\n\n        <StepPanel\n          v-slot=\"{ activateCallback }\"\n          value=\"3\"\n          class=\"flex min-h-full flex-1 flex-col justify-between bg-transparent\"\n        >\n          <div>\n            <label class=\"mb-8 block text-lg font-medium\">{{\n              t('cloudSurvey_steps_industry')\n            }}</label>\n            <div class=\"flex flex-col gap-6\">\n              <div\n                v-for=\"opt in industryOptions\"\n                :key=\"opt.value\"\n                class=\"flex items-center gap-3\"\n              >\n                <RadioButton\n                  v-model=\"surveyData.industry\"\n                  :input-id=\"`industry-${opt.value}`\"\n                  name=\"industry\"\n                  :value=\"opt.value\"\n                />\n                <label\n                  :for=\"`industry-${opt.value}`\"\n                  class=\"cursor-pointer text-sm\"\n                  >{{ opt.label }}</label\n                >\n              </div>\n            </div>\n            <div v-if=\"surveyData.industry === 'other'\" class=\"mt-4 ml-8\">\n              <InputText\n                v-model=\"surveyData.industryOther\"\n                class=\"w-full\"\n                :placeholder=\"\n                  $t('cloudOnboarding.survey.options.industry.otherPlaceholder')\n                \"\n              />\n            </div>\n          </div>\n\n          <div class=\"flex gap-6 pt-4\">\n            <Button\n              variant=\"secondary\"\n              class=\"flex-1 text-white\"\n              @click=\"goTo(2, activateCallback)\"\n            >\n              {{ $t('g.back') }}\n            </Button>\n            <Button\n              :disabled=\"!validStep3\"\n              class=\"h-10 flex-1 border-none text-white\"\n              @click=\"goTo(4, activateCallback)\"\n            >\n              {{ $t('g.next') }}\n            </Button>\n          </div>\n        </StepPanel>\n\n        <StepPanel\n          v-slot=\"{ activateCallback }\"\n          value=\"4\"\n          class=\"flex min-h-full flex-1 flex-col justify-between bg-transparent\"\n        >\n          <div>\n            <label class=\"mb-8 block text-lg font-medium\">{{\n              t('cloudSurvey_steps_making')\n            }}</label>\n            <div class=\"flex flex-col gap-6\">\n              <div\n                v-for=\"opt in makingOptions\"\n                :key=\"opt.value\"\n                class=\"flex items-center gap-3\"\n              >\n                <Checkbox\n                  v-model=\"surveyData.making\"\n                  :input-id=\"`making-${opt.value}`\"\n                  :value=\"opt.value\"\n                />\n                <label\n                  :for=\"`making-${opt.value}`\"\n                  class=\"cursor-pointer text-sm\"\n                  >{{ opt.label }}</label\n                >\n              </div>\n            </div>\n          </div>\n\n          <div class=\"flex gap-6 pt-4\">\n            <Button\n              variant=\"secondary\"\n              class=\"flex-1 text-white\"\n              @click=\"goTo(3, activateCallback)\"\n            >\n              {{ $t('g.back') }}\n            </Button>\n            <Button\n              :disabled=\"!validStep4 || isSubmitting\"\n              :loading=\"isSubmitting\"\n              class=\"h-10 flex-1 border-none text-white\"\n              @click=\"onSubmitSurvey\"\n            >\n              {{ $t('g.submit') }}\n            </Button>\n          </div>\n        </StepPanel>\n      </StepPanels>\n    </Stepper>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport Checkbox from 'primevue/checkbox'\nimport InputText from 'primevue/inputtext'\nimport ProgressBar from 'primevue/progressbar'\nimport RadioButton from 'primevue/radiobutton'\nimport StepPanel from 'primevue/steppanel'\nimport StepPanels from 'primevue/steppanels'\nimport Stepper from 'primevue/stepper'\nimport { computed, onMounted, ref } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { useRouter } from 'vue-router'\n\nimport Button from '@/components/ui/button/Button.vue'\nimport { useFeatureFlags } from '@/composables/useFeatureFlags'\nimport {\n  getSurveyCompletedStatus,\n  submitSurvey\n} from '@/platform/cloud/onboarding/auth'\nimport { isCloud } from '@/platform/distribution/types'\nimport { useTelemetry } from '@/platform/telemetry'\n\nconst { t } = useI18n()\nconst router = useRouter()\nconst { flags } = useFeatureFlags()\nconst onboardingSurveyEnabled = computed(() => flags.onboardingSurveyEnabled)\n\n// Check if survey is already completed on mount\nonMounted(async () => {\n  if (!onboardingSurveyEnabled.value) {\n    await router.replace({ name: 'cloud-user-check' })\n    return\n  }\n  try {\n    const surveyCompleted = await getSurveyCompletedStatus()\n    if (surveyCompleted) {\n      // User already completed survey, return to onboarding flow\n      await router.replace({ name: 'cloud-user-check' })\n    } else {\n      // Track survey opened event\n      if (isCloud) {\n        useTelemetry()?.trackSurvey('opened')\n      }\n    }\n  } catch (error) {\n    console.error('Failed to check survey status:', error)\n  }\n})\n\nconst activeStep = ref(1)\nconst totalSteps = 4\nconst progressPercent = computed(() =>\n  Math.max(20, Math.min(100, ((activeStep.value - 1) / (totalSteps - 1)) * 100))\n)\n\nconst isSubmitting = ref(false)\n\nconst surveyData = ref({\n  familiarity: '',\n  useCase: '',\n  useCaseOther: '',\n  industry: '',\n  industryOther: '',\n  making: [] as string[]\n})\n\n// Options\nconst familiarityOptions = [\n  { label: 'New to ComfyUI (never used it before)', value: 'new' },\n  { label: 'Just getting started (following tutorials)', value: 'starting' },\n  { label: 'Comfortable with basics', value: 'basics' },\n  { label: 'Advanced user (custom workflows)', value: 'advanced' },\n  { label: 'Expert (help others)', value: 'expert' }\n]\n\nconst purposeOptions = [\n  { label: 'Personal projects/hobby', value: 'personal' },\n  {\n    label: 'Community contributions (nodes, workflows, etc.)',\n    value: 'community'\n  },\n  { label: 'Client work (freelance)', value: 'client' },\n  { label: 'My own workplace (in-house)', value: 'inhouse' },\n  { label: 'Academic research', value: 'research' },\n  { label: 'Other', value: 'other' }\n]\n\nconst industryOptions = [\n  { label: 'Film, TV, & animation', value: 'film_tv_animation' },\n  { label: 'Gaming', value: 'gaming' },\n  { label: 'Marketing & advertising', value: 'marketing' },\n  { label: 'Architecture', value: 'architecture' },\n  { label: 'Product & graphic design', value: 'product_design' },\n  { label: 'Fine art & illustration', value: 'fine_art' },\n  { label: 'Software & technology', value: 'software' },\n  { label: 'Education', value: 'education' },\n  { label: 'Other', value: 'other' }\n]\n\nconst makingOptions = [\n  { label: 'Images', value: 'images' },\n  { label: 'Video & animation', value: 'video' },\n  { label: '3D assets', value: '3d' },\n  { label: 'Audio/music', value: 'audio' },\n  { label: 'Custom nodes & workflows', value: 'custom_nodes' }\n]\n\n// Validation per step\nconst validStep1 = computed(() => !!surveyData.value.familiarity)\nconst validStep2 = computed(() => {\n  if (!surveyData.value.useCase) return false\n  if (surveyData.value.useCase === 'other') {\n    return !!surveyData.value.useCaseOther?.trim()\n  }\n  return true\n})\nconst validStep3 = computed(() => {\n  if (!surveyData.value.industry) return false\n  if (surveyData.value.industry === 'other') {\n    return !!surveyData.value.industryOther?.trim()\n  }\n  return true\n})\nconst validStep4 = computed(() => surveyData.value.making.length > 0)\n\nconst changeActiveStep = (step: number) => {\n  activeStep.value = step\n}\n\nconst goTo = (step: number, activate: (val: string | number) => void) => {\n  // keep Stepper panel and progress bar in sync; Stepper values are strings\n  changeActiveStep(step)\n  activate(String(step))\n}\n\n// Submit\nconst onSubmitSurvey = async () => {\n  try {\n    if (!onboardingSurveyEnabled.value) {\n      await router.replace({ name: 'cloud-user-check' })\n      return\n    }\n    isSubmitting.value = true\n    // prepare payload with consistent structure\n    const payload = {\n      familiarity: surveyData.value.familiarity,\n      useCase:\n        surveyData.value.useCase === 'other'\n          ? surveyData.value.useCaseOther?.trim() || 'other'\n          : surveyData.value.useCase,\n      industry:\n        surveyData.value.industry === 'other'\n          ? surveyData.value.industryOther?.trim() || 'other'\n          : surveyData.value.industry,\n      making: surveyData.value.making\n    }\n\n    await submitSurvey(payload)\n\n    // Track survey submitted event with responses\n    if (isCloud) {\n      useTelemetry()?.trackSurvey('submitted', {\n        industry: payload.industry,\n        useCase: payload.useCase,\n        familiarity: payload.familiarity,\n        making: payload.making\n      })\n    }\n\n    await router.push({ name: 'cloud-user-check' })\n  } finally {\n    isSubmitting.value = false\n  }\n}\n</script>\n\n<style scoped>\n:deep(.p-progressbar .p-progressbar-value) {\n  background-color: #f0ff41 !important;\n}\n:deep(.p-radiobutton-checked .p-radiobutton-box) {\n  background-color: #f0ff41 !important;\n  border-color: #f0ff41 !important;\n}\n:deep(.p-checkbox-checked .p-checkbox-box) {\n  background-color: #f0ff41 !important;\n  border-color: #f0ff41 !important;\n}\n</style>\n","<template>\n  <div>\n    <Stepper\n      value=\"1\"\n      class=\"flex h-[638px] max-h-[80vh] w-[320px] max-w-[90vw] flex-col\"\n    >\n      <ProgressBar\n        :value=\"progressPercent\"\n        :show-value=\"false\"\n        class=\"mb-8 h-2\"\n      />\n\n      <StepPanels class=\"flex flex-1 flex-col p-0\">\n        <StepPanel\n          v-slot=\"{ activateCallback }\"\n          value=\"1\"\n          class=\"flex min-h-full flex-1 flex-col justify-between bg-transparent\"\n        >\n          <div>\n            <label class=\"mb-8 block text-lg font-medium\">{{\n              t('cloudSurvey_steps_familiarity')\n            }}</label>\n            <div class=\"flex flex-col gap-6\">\n              <div\n                v-for=\"opt in familiarityOptions\"\n                :key=\"opt.value\"\n                class=\"flex items-center gap-3\"\n              >\n                <RadioButton\n                  v-model=\"surveyData.familiarity\"\n                  :input-id=\"`fam-${opt.value}`\"\n                  name=\"familiarity\"\n                  :value=\"opt.value\"\n                />\n                <label\n                  :for=\"`fam-${opt.value}`\"\n                  class=\"cursor-pointer text-sm\"\n                  >{{ opt.label }}</label\n                >\n              </div>\n            </div>\n          </div>\n\n          <div class=\"flex justify-between pt-4\">\n            <span />\n            <Button\n              :disabled=\"!validStep1\"\n              class=\"h-10 w-full border-none text-white\"\n              @click=\"goTo(2, activateCallback)\"\n            >\n              {{ $t('g.next') }}\n            </Button>\n          </div>\n        </StepPanel>\n\n        <StepPanel\n          v-slot=\"{ activateCallback }\"\n          value=\"2\"\n          class=\"flex min-h-full flex-1 flex-col justify-between bg-transparent\"\n        >\n          <div>\n            <label class=\"mb-8 block text-lg font-medium\">{{\n              t('cloudSurvey_steps_purpose')\n            }}</label>\n            <div class=\"flex flex-col gap-6\">\n              <div\n                v-for=\"opt in purposeOptions\"\n                :key=\"opt.value\"\n                class=\"flex items-center gap-3\"\n              >\n                <RadioButton\n                  v-model=\"surveyData.useCase\"\n                  :input-id=\"`purpose-${opt.value}`\"\n                  name=\"purpose\"\n                  :value=\"opt.value\"\n                />\n                <label\n                  :for=\"`purpose-${opt.value}`\"\n                  class=\"cursor-pointer text-sm\"\n                  >{{ opt.label }}</label\n                >\n              </div>\n            </div>\n            <div v-if=\"surveyData.useCase === 'other'\" class=\"mt-4 ml-8\">\n              <InputText\n                v-model=\"surveyData.useCaseOther\"\n                class=\"w-full\"\n                :placeholder=\"\n                  $t('cloudOnboarding.survey.options.industry.otherPlaceholder')\n                \"\n              />\n            </div>\n          </div>\n\n          <div class=\"flex gap-6 pt-4\">\n            <Button\n              variant=\"secondary\"\n              class=\"flex-1 text-white\"\n              @click=\"goTo(1, activateCallback)\"\n            >\n              {{ $t('g.back') }}\n            </Button>\n            <Button\n              :disabled=\"!validStep2\"\n              class=\"h-10 flex-1 text-white\"\n              @click=\"goTo(3, activateCallback)\"\n            >\n              {{ $t('g.next') }}\n            </Button>\n          </div>\n        </StepPanel>\n\n        <StepPanel\n          v-slot=\"{ activateCallback }\"\n          value=\"3\"\n          class=\"flex min-h-full flex-1 flex-col justify-between bg-transparent\"\n        >\n          <div>\n            <label class=\"mb-8 block text-lg font-medium\">{{\n              t('cloudSurvey_steps_industry')\n            }}</label>\n            <div class=\"flex flex-col gap-6\">\n              <div\n                v-for=\"opt in industryOptions\"\n                :key=\"opt.value\"\n                class=\"flex items-center gap-3\"\n              >\n                <RadioButton\n                  v-model=\"surveyData.industry\"\n                  :input-id=\"`industry-${opt.value}`\"\n                  name=\"industry\"\n                  :value=\"opt.value\"\n                />\n                <label\n                  :for=\"`industry-${opt.value}`\"\n                  class=\"cursor-pointer text-sm\"\n                  >{{ opt.label }}</label\n                >\n              </div>\n            </div>\n            <div v-if=\"surveyData.industry === 'other'\" class=\"mt-4 ml-8\">\n              <InputText\n                v-model=\"surveyData.industryOther\"\n                class=\"w-full\"\n                :placeholder=\"\n                  $t('cloudOnboarding.survey.options.industry.otherPlaceholder')\n                \"\n              />\n            </div>\n          </div>\n\n          <div class=\"flex gap-6 pt-4\">\n            <Button\n              variant=\"secondary\"\n              class=\"flex-1 text-white\"\n              @click=\"goTo(2, activateCallback)\"\n            >\n              {{ $t('g.back') }}\n            </Button>\n            <Button\n              :disabled=\"!validStep3\"\n              class=\"h-10 flex-1 border-none text-white\"\n              @click=\"goTo(4, activateCallback)\"\n            >\n              {{ $t('g.next') }}\n            </Button>\n          </div>\n        </StepPanel>\n\n        <StepPanel\n          v-slot=\"{ activateCallback }\"\n          value=\"4\"\n          class=\"flex min-h-full flex-1 flex-col justify-between bg-transparent\"\n        >\n          <div>\n            <label class=\"mb-8 block text-lg font-medium\">{{\n              t('cloudSurvey_steps_making')\n            }}</label>\n            <div class=\"flex flex-col gap-6\">\n              <div\n                v-for=\"opt in makingOptions\"\n                :key=\"opt.value\"\n                class=\"flex items-center gap-3\"\n              >\n                <Checkbox\n                  v-model=\"surveyData.making\"\n                  :input-id=\"`making-${opt.value}`\"\n                  :value=\"opt.value\"\n                />\n                <label\n                  :for=\"`making-${opt.value}`\"\n                  class=\"cursor-pointer text-sm\"\n                  >{{ opt.label }}</label\n                >\n              </div>\n            </div>\n          </div>\n\n          <div class=\"flex gap-6 pt-4\">\n            <Button\n              variant=\"secondary\"\n              class=\"flex-1 text-white\"\n              @click=\"goTo(3, activateCallback)\"\n            >\n              {{ $t('g.back') }}\n            </Button>\n            <Button\n              :disabled=\"!validStep4 || isSubmitting\"\n              :loading=\"isSubmitting\"\n              class=\"h-10 flex-1 border-none text-white\"\n              @click=\"onSubmitSurvey\"\n            >\n              {{ $t('g.submit') }}\n            </Button>\n          </div>\n        </StepPanel>\n      </StepPanels>\n    </Stepper>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport Checkbox from 'primevue/checkbox'\nimport InputText from 'primevue/inputtext'\nimport ProgressBar from 'primevue/progressbar'\nimport RadioButton from 'primevue/radiobutton'\nimport StepPanel from 'primevue/steppanel'\nimport StepPanels from 'primevue/steppanels'\nimport Stepper from 'primevue/stepper'\nimport { computed, onMounted, ref } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { useRouter } from 'vue-router'\n\nimport Button from '@/components/ui/button/Button.vue'\nimport { useFeatureFlags } from '@/composables/useFeatureFlags'\nimport {\n  getSurveyCompletedStatus,\n  submitSurvey\n} from '@/platform/cloud/onboarding/auth'\nimport { isCloud } from '@/platform/distribution/types'\nimport { useTelemetry } from '@/platform/telemetry'\n\nconst { t } = useI18n()\nconst router = useRouter()\nconst { flags } = useFeatureFlags()\nconst onboardingSurveyEnabled = computed(() => flags.onboardingSurveyEnabled)\n\n// Check if survey is already completed on mount\nonMounted(async () => {\n  if (!onboardingSurveyEnabled.value) {\n    await router.replace({ name: 'cloud-user-check' })\n    return\n  }\n  try {\n    const surveyCompleted = await getSurveyCompletedStatus()\n    if (surveyCompleted) {\n      // User already completed survey, return to onboarding flow\n      await router.replace({ name: 'cloud-user-check' })\n    } else {\n      // Track survey opened event\n      if (isCloud) {\n        useTelemetry()?.trackSurvey('opened')\n      }\n    }\n  } catch (error) {\n    console.error('Failed to check survey status:', error)\n  }\n})\n\nconst activeStep = ref(1)\nconst totalSteps = 4\nconst progressPercent = computed(() =>\n  Math.max(20, Math.min(100, ((activeStep.value - 1) / (totalSteps - 1)) * 100))\n)\n\nconst isSubmitting = ref(false)\n\nconst surveyData = ref({\n  familiarity: '',\n  useCase: '',\n  useCaseOther: '',\n  industry: '',\n  industryOther: '',\n  making: [] as string[]\n})\n\n// Options\nconst familiarityOptions = [\n  { label: 'New to ComfyUI (never used it before)', value: 'new' },\n  { label: 'Just getting started (following tutorials)', value: 'starting' },\n  { label: 'Comfortable with basics', value: 'basics' },\n  { label: 'Advanced user (custom workflows)', value: 'advanced' },\n  { label: 'Expert (help others)', value: 'expert' }\n]\n\nconst purposeOptions = [\n  { label: 'Personal projects/hobby', value: 'personal' },\n  {\n    label: 'Community contributions (nodes, workflows, etc.)',\n    value: 'community'\n  },\n  { label: 'Client work (freelance)', value: 'client' },\n  { label: 'My own workplace (in-house)', value: 'inhouse' },\n  { label: 'Academic research', value: 'research' },\n  { label: 'Other', value: 'other' }\n]\n\nconst industryOptions = [\n  { label: 'Film, TV, & animation', value: 'film_tv_animation' },\n  { label: 'Gaming', value: 'gaming' },\n  { label: 'Marketing & advertising', value: 'marketing' },\n  { label: 'Architecture', value: 'architecture' },\n  { label: 'Product & graphic design', value: 'product_design' },\n  { label: 'Fine art & illustration', value: 'fine_art' },\n  { label: 'Software & technology', value: 'software' },\n  { label: 'Education', value: 'education' },\n  { label: 'Other', value: 'other' }\n]\n\nconst makingOptions = [\n  { label: 'Images', value: 'images' },\n  { label: 'Video & animation', value: 'video' },\n  { label: '3D assets', value: '3d' },\n  { label: 'Audio/music', value: 'audio' },\n  { label: 'Custom nodes & workflows', value: 'custom_nodes' }\n]\n\n// Validation per step\nconst validStep1 = computed(() => !!surveyData.value.familiarity)\nconst validStep2 = computed(() => {\n  if (!surveyData.value.useCase) return false\n  if (surveyData.value.useCase === 'other') {\n    return !!surveyData.value.useCaseOther?.trim()\n  }\n  return true\n})\nconst validStep3 = computed(() => {\n  if (!surveyData.value.industry) return false\n  if (surveyData.value.industry === 'other') {\n    return !!surveyData.value.industryOther?.trim()\n  }\n  return true\n})\nconst validStep4 = computed(() => surveyData.value.making.length > 0)\n\nconst changeActiveStep = (step: number) => {\n  activeStep.value = step\n}\n\nconst goTo = (step: number, activate: (val: string | number) => void) => {\n  // keep Stepper panel and progress bar in sync; Stepper values are strings\n  changeActiveStep(step)\n  activate(String(step))\n}\n\n// Submit\nconst onSubmitSurvey = async () => {\n  try {\n    if (!onboardingSurveyEnabled.value) {\n      await router.replace({ name: 'cloud-user-check' })\n      return\n    }\n    isSubmitting.value = true\n    // prepare payload with consistent structure\n    const payload = {\n      familiarity: surveyData.value.familiarity,\n      useCase:\n        surveyData.value.useCase === 'other'\n          ? surveyData.value.useCaseOther?.trim() || 'other'\n          : surveyData.value.useCase,\n      industry:\n        surveyData.value.industry === 'other'\n          ? surveyData.value.industryOther?.trim() || 'other'\n          : surveyData.value.industry,\n      making: surveyData.value.making\n    }\n\n    await submitSurvey(payload)\n\n    // Track survey submitted event with responses\n    if (isCloud) {\n      useTelemetry()?.trackSurvey('submitted', {\n        industry: payload.industry,\n        useCase: payload.useCase,\n        familiarity: payload.familiarity,\n        making: payload.making\n      })\n    }\n\n    await router.push({ name: 'cloud-user-check' })\n  } finally {\n    isSubmitting.value = false\n  }\n}\n</script>\n\n<style scoped>\n:deep(.p-progressbar .p-progressbar-value) {\n  background-color: #f0ff41 !important;\n}\n:deep(.p-radiobutton-checked .p-radiobutton-box) {\n  background-color: #f0ff41 !important;\n  border-color: #f0ff41 !important;\n}\n:deep(.p-checkbox-checked .p-checkbox-box) {\n  background-color: #f0ff41 !important;\n  border-color: #f0ff41 !important;\n}\n</style>\n","<template>\n  <div>\n    <Stepper\n      value=\"1\"\n      class=\"flex h-[638px] max-h-[80vh] w-[320px] max-w-[90vw] flex-col\"\n    >\n      <ProgressBar\n        :value=\"progressPercent\"\n        :show-value=\"false\"\n        class=\"mb-8 h-2\"\n      />\n\n      <StepPanels class=\"flex flex-1 flex-col p-0\">\n        <StepPanel\n          v-slot=\"{ activateCallback }\"\n          value=\"1\"\n          class=\"flex min-h-full flex-1 flex-col justify-between bg-transparent\"\n        >\n          <div>\n            <label class=\"mb-8 block text-lg font-medium\">{{\n              t('cloudSurvey_steps_familiarity')\n            }}</label>\n            <div class=\"flex flex-col gap-6\">\n              <div\n                v-for=\"opt in familiarityOptions\"\n                :key=\"opt.value\"\n                class=\"flex items-center gap-3\"\n              >\n                <RadioButton\n                  v-model=\"surveyData.familiarity\"\n                  :input-id=\"`fam-${opt.value}`\"\n                  name=\"familiarity\"\n                  :value=\"opt.value\"\n                />\n                <label\n                  :for=\"`fam-${opt.value}`\"\n                  class=\"cursor-pointer text-sm\"\n                  >{{ opt.label }}</label\n                >\n              </div>\n            </div>\n          </div>\n\n          <div class=\"flex justify-between pt-4\">\n            <span />\n            <Button\n              :disabled=\"!validStep1\"\n              class=\"h-10 w-full border-none text-white\"\n              @click=\"goTo(2, activateCallback)\"\n            >\n              {{ $t('g.next') }}\n            </Button>\n          </div>\n        </StepPanel>\n\n        <StepPanel\n          v-slot=\"{ activateCallback }\"\n          value=\"2\"\n          class=\"flex min-h-full flex-1 flex-col justify-between bg-transparent\"\n        >\n          <div>\n            <label class=\"mb-8 block text-lg font-medium\">{{\n              t('cloudSurvey_steps_purpose')\n            }}</label>\n            <div class=\"flex flex-col gap-6\">\n              <div\n                v-for=\"opt in purposeOptions\"\n                :key=\"opt.value\"\n                class=\"flex items-center gap-3\"\n              >\n                <RadioButton\n                  v-model=\"surveyData.useCase\"\n                  :input-id=\"`purpose-${opt.value}`\"\n                  name=\"purpose\"\n                  :value=\"opt.value\"\n                />\n                <label\n                  :for=\"`purpose-${opt.value}`\"\n                  class=\"cursor-pointer text-sm\"\n                  >{{ opt.label }}</label\n                >\n              </div>\n            </div>\n            <div v-if=\"surveyData.useCase === 'other'\" class=\"mt-4 ml-8\">\n              <InputText\n                v-model=\"surveyData.useCaseOther\"\n                class=\"w-full\"\n                :placeholder=\"\n                  $t('cloudOnboarding.survey.options.industry.otherPlaceholder')\n                \"\n              />\n            </div>\n          </div>\n\n          <div class=\"flex gap-6 pt-4\">\n            <Button\n              variant=\"secondary\"\n              class=\"flex-1 text-white\"\n              @click=\"goTo(1, activateCallback)\"\n            >\n              {{ $t('g.back') }}\n            </Button>\n            <Button\n              :disabled=\"!validStep2\"\n              class=\"h-10 flex-1 text-white\"\n              @click=\"goTo(3, activateCallback)\"\n            >\n              {{ $t('g.next') }}\n            </Button>\n          </div>\n        </StepPanel>\n\n        <StepPanel\n          v-slot=\"{ activateCallback }\"\n          value=\"3\"\n          class=\"flex min-h-full flex-1 flex-col justify-between bg-transparent\"\n        >\n          <div>\n            <label class=\"mb-8 block text-lg font-medium\">{{\n              t('cloudSurvey_steps_industry')\n            }}</label>\n            <div class=\"flex flex-col gap-6\">\n              <div\n                v-for=\"opt in industryOptions\"\n                :key=\"opt.value\"\n                class=\"flex items-center gap-3\"\n              >\n                <RadioButton\n                  v-model=\"surveyData.industry\"\n                  :input-id=\"`industry-${opt.value}`\"\n                  name=\"industry\"\n                  :value=\"opt.value\"\n                />\n                <label\n                  :for=\"`industry-${opt.value}`\"\n                  class=\"cursor-pointer text-sm\"\n                  >{{ opt.label }}</label\n                >\n              </div>\n            </div>\n            <div v-if=\"surveyData.industry === 'other'\" class=\"mt-4 ml-8\">\n              <InputText\n                v-model=\"surveyData.industryOther\"\n                class=\"w-full\"\n                :placeholder=\"\n                  $t('cloudOnboarding.survey.options.industry.otherPlaceholder')\n                \"\n              />\n            </div>\n          </div>\n\n          <div class=\"flex gap-6 pt-4\">\n            <Button\n              variant=\"secondary\"\n              class=\"flex-1 text-white\"\n              @click=\"goTo(2, activateCallback)\"\n            >\n              {{ $t('g.back') }}\n            </Button>\n            <Button\n              :disabled=\"!validStep3\"\n              class=\"h-10 flex-1 border-none text-white\"\n              @click=\"goTo(4, activateCallback)\"\n            >\n              {{ $t('g.next') }}\n            </Button>\n          </div>\n        </StepPanel>\n\n        <StepPanel\n          v-slot=\"{ activateCallback }\"\n          value=\"4\"\n          class=\"flex min-h-full flex-1 flex-col justify-between bg-transparent\"\n        >\n          <div>\n            <label class=\"mb-8 block text-lg font-medium\">{{\n              t('cloudSurvey_steps_making')\n            }}</label>\n            <div class=\"flex flex-col gap-6\">\n              <div\n                v-for=\"opt in makingOptions\"\n                :key=\"opt.value\"\n                class=\"flex items-center gap-3\"\n              >\n                <Checkbox\n                  v-model=\"surveyData.making\"\n                  :input-id=\"`making-${opt.value}`\"\n                  :value=\"opt.value\"\n                />\n                <label\n                  :for=\"`making-${opt.value}`\"\n                  class=\"cursor-pointer text-sm\"\n                  >{{ opt.label }}</label\n                >\n              </div>\n            </div>\n          </div>\n\n          <div class=\"flex gap-6 pt-4\">\n            <Button\n              variant=\"secondary\"\n              class=\"flex-1 text-white\"\n              @click=\"goTo(3, activateCallback)\"\n            >\n              {{ $t('g.back') }}\n            </Button>\n            <Button\n              :disabled=\"!validStep4 || isSubmitting\"\n              :loading=\"isSubmitting\"\n              class=\"h-10 flex-1 border-none text-white\"\n              @click=\"onSubmitSurvey\"\n            >\n              {{ $t('g.submit') }}\n            </Button>\n          </div>\n        </StepPanel>\n      </StepPanels>\n    </Stepper>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport Checkbox from 'primevue/checkbox'\nimport InputText from 'primevue/inputtext'\nimport ProgressBar from 'primevue/progressbar'\nimport RadioButton from 'primevue/radiobutton'\nimport StepPanel from 'primevue/steppanel'\nimport StepPanels from 'primevue/steppanels'\nimport Stepper from 'primevue/stepper'\nimport { computed, onMounted, ref } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { useRouter } from 'vue-router'\n\nimport Button from '@/components/ui/button/Button.vue'\nimport { useFeatureFlags } from '@/composables/useFeatureFlags'\nimport {\n  getSurveyCompletedStatus,\n  submitSurvey\n} from '@/platform/cloud/onboarding/auth'\nimport { isCloud } from '@/platform/distribution/types'\nimport { useTelemetry } from '@/platform/telemetry'\n\nconst { t } = useI18n()\nconst router = useRouter()\nconst { flags } = useFeatureFlags()\nconst onboardingSurveyEnabled = computed(() => flags.onboardingSurveyEnabled)\n\n// Check if survey is already completed on mount\nonMounted(async () => {\n  if (!onboardingSurveyEnabled.value) {\n    await router.replace({ name: 'cloud-user-check' })\n    return\n  }\n  try {\n    const surveyCompleted = await getSurveyCompletedStatus()\n    if (surveyCompleted) {\n      // User already completed survey, return to onboarding flow\n      await router.replace({ name: 'cloud-user-check' })\n    } else {\n      // Track survey opened event\n      if (isCloud) {\n        useTelemetry()?.trackSurvey('opened')\n      }\n    }\n  } catch (error) {\n    console.error('Failed to check survey status:', error)\n  }\n})\n\nconst activeStep = ref(1)\nconst totalSteps = 4\nconst progressPercent = computed(() =>\n  Math.max(20, Math.min(100, ((activeStep.value - 1) / (totalSteps - 1)) * 100))\n)\n\nconst isSubmitting = ref(false)\n\nconst surveyData = ref({\n  familiarity: '',\n  useCase: '',\n  useCaseOther: '',\n  industry: '',\n  industryOther: '',\n  making: [] as string[]\n})\n\n// Options\nconst familiarityOptions = [\n  { label: 'New to ComfyUI (never used it before)', value: 'new' },\n  { label: 'Just getting started (following tutorials)', value: 'starting' },\n  { label: 'Comfortable with basics', value: 'basics' },\n  { label: 'Advanced user (custom workflows)', value: 'advanced' },\n  { label: 'Expert (help others)', value: 'expert' }\n]\n\nconst purposeOptions = [\n  { label: 'Personal projects/hobby', value: 'personal' },\n  {\n    label: 'Community contributions (nodes, workflows, etc.)',\n    value: 'community'\n  },\n  { label: 'Client work (freelance)', value: 'client' },\n  { label: 'My own workplace (in-house)', value: 'inhouse' },\n  { label: 'Academic research', value: 'research' },\n  { label: 'Other', value: 'other' }\n]\n\nconst industryOptions = [\n  { label: 'Film, TV, & animation', value: 'film_tv_animation' },\n  { label: 'Gaming', value: 'gaming' },\n  { label: 'Marketing & advertising', value: 'marketing' },\n  { label: 'Architecture', value: 'architecture' },\n  { label: 'Product & graphic design', value: 'product_design' },\n  { label: 'Fine art & illustration', value: 'fine_art' },\n  { label: 'Software & technology', value: 'software' },\n  { label: 'Education', value: 'education' },\n  { label: 'Other', value: 'other' }\n]\n\nconst makingOptions = [\n  { label: 'Images', value: 'images' },\n  { label: 'Video & animation', value: 'video' },\n  { label: '3D assets', value: '3d' },\n  { label: 'Audio/music', value: 'audio' },\n  { label: 'Custom nodes & workflows', value: 'custom_nodes' }\n]\n\n// Validation per step\nconst validStep1 = computed(() => !!surveyData.value.familiarity)\nconst validStep2 = computed(() => {\n  if (!surveyData.value.useCase) return false\n  if (surveyData.value.useCase === 'other') {\n    return !!surveyData.value.useCaseOther?.trim()\n  }\n  return true\n})\nconst validStep3 = computed(() => {\n  if (!surveyData.value.industry) return false\n  if (surveyData.value.industry === 'other') {\n    return !!surveyData.value.industryOther?.trim()\n  }\n  return true\n})\nconst validStep4 = computed(() => surveyData.value.making.length > 0)\n\nconst changeActiveStep = (step: number) => {\n  activeStep.value = step\n}\n\nconst goTo = (step: number, activate: (val: string | number) => void) => {\n  // keep Stepper panel and progress bar in sync; Stepper values are strings\n  changeActiveStep(step)\n  activate(String(step))\n}\n\n// Submit\nconst onSubmitSurvey = async () => {\n  try {\n    if (!onboardingSurveyEnabled.value) {\n      await router.replace({ name: 'cloud-user-check' })\n      return\n    }\n    isSubmitting.value = true\n    // prepare payload with consistent structure\n    const payload = {\n      familiarity: surveyData.value.familiarity,\n      useCase:\n        surveyData.value.useCase === 'other'\n          ? surveyData.value.useCaseOther?.trim() || 'other'\n          : surveyData.value.useCase,\n      industry:\n        surveyData.value.industry === 'other'\n          ? surveyData.value.industryOther?.trim() || 'other'\n          : surveyData.value.industry,\n      making: surveyData.value.making\n    }\n\n    await submitSurvey(payload)\n\n    // Track survey submitted event with responses\n    if (isCloud) {\n      useTelemetry()?.trackSurvey('submitted', {\n        industry: payload.industry,\n        useCase: payload.useCase,\n        familiarity: payload.familiarity,\n        making: payload.making\n      })\n    }\n\n    await router.push({ name: 'cloud-user-check' })\n  } finally {\n    isSubmitting.value = false\n  }\n}\n</script>\n\n<style scoped>\n:deep(.p-progressbar .p-progressbar-value) {\n  background-color: #f0ff41 !important;\n}\n:deep(.p-radiobutton-checked .p-radiobutton-box) {\n  background-color: #f0ff41 !important;\n  border-color: #f0ff41 !important;\n}\n:deep(.p-checkbox-checked .p-checkbox-box) {\n  background-color: #f0ff41 !important;\n  border-color: #f0ff41 !important;\n}\n</style>\n"],"mappings":"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"}