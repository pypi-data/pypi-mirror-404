# Issue 02: ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã®TDDä½“é¨“æ”¹å–„

## æ¦‚è¦

ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã®å¾ŒåŠï¼ˆStep 2ä»¥é™ï¼‰ã§TDDçš„ãªæµã‚Œã‚’å°å…¥ã—ã€ãƒ†ã‚¹ãƒˆæ›´æ–°ãŒè‡ªç„¶ãªé–‹ç™ºãƒ•ãƒ­ãƒ¼ã®ä¸€éƒ¨ã«ãªã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

## è¨­è¨ˆæ–¹é‡: æ®µéšçš„ãªå­¦ç¿’ä½“é¨“

### Step 1: ã¾ãšã€Œå‹•ãã€ã‚’ä½“é¨“
- ã‚·ãƒ³ãƒ—ãƒ«ãªHello Worldçš„ãªãƒãƒ¼ãƒ‰
- ãƒ†ã‚¹ãƒˆã¯ `pytest.skip()` ä»˜ãã§ç”Ÿæˆï¼ˆå£Šã‚Œãªã„ï¼‰
- **ç›®æ¨™**: ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ç°¡å˜ã•ã‚’å®Ÿæ„Ÿ

### Step 2ä»¥é™: TDDã‚¹ã‚¿ã‚¤ãƒ«ã‚’å°å…¥
- fetch_data, process_data ãªã©ã®å®Ÿè·µçš„ãªãƒãƒ¼ãƒ‰
- ãƒ†ã‚¹ãƒˆã‚’å…ˆã«æ›¸ã â†’ å®Ÿè£…ã™ã‚‹æµã‚Œã‚’å­¦ã¶
- **ç›®æ¨™**: æœ¬æ ¼çš„ãªé–‹ç™ºãƒ•ãƒ­ãƒ¼ã‚’ç¿’å¾—

## ç¾çŠ¶ã®å•é¡Œ

1. `railway new node` ã§æ±ç”¨çš„ãªãƒ†ã‚¹ãƒˆãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹
2. Step 2 ã§ãƒãƒ¼ãƒ‰ã®å®Ÿè£…ã‚’å¤‰æ›´ã™ã‚‹ãŒã€ãƒ†ã‚¹ãƒˆæ›´æ–°ã®æŒ‡ç¤ºãŒãªã„
3. çµæœã¨ã—ã¦ `pytest` ãŒå¤±æ•—ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ··ä¹±ã™ã‚‹

## æ”¹å–„å¾Œã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«æ§‹æˆ

```
Step 1: Hello Railwayï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰
  â””â”€ validate_name, create_greeting
  â””â”€ ãƒ†ã‚¹ãƒˆã¯ skip çŠ¶æ…‹ã§ç”Ÿæˆ
  â””â”€ ã€Œå‹•ã„ãŸï¼ã€ã¨ã„ã†æˆåŠŸä½“é¨“

Step 2: ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆTDDã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
  â””â”€ fetch_data, process_data
  â””â”€ ãƒ†ã‚¹ãƒˆã‚’å…ˆã«æ›¸ã â†’ å®Ÿè£…ã™ã‚‹
  â””â”€ Red â†’ Green â†’ Refactor ã‚’ä½“é¨“

Step 3: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
  â””â”€ TDDã§ç•°å¸¸ç³»ã‚‚å«ã‚ã¦å®Ÿè£…

Step 4: è¨­å®šã¨ãƒªãƒˆãƒ©ã‚¤
  â””â”€ å®Ÿè·µçš„ãªæ©Ÿèƒ½ã®è¿½åŠ 
```

## å®Ÿè£…ã‚¿ã‚¹ã‚¯

### 1. ãƒ†ã‚¹ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å¤‰æ›´

**æ”¹å–„å¾Œã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ:**
```python
import pytest
from src.nodes.{node_name} import {node_name}

def test_{node_name}_basic():
    """TODO: Define expected behavior and implement test.

    Example:
        result = {node_name}(your_input)
        assert result == expected_output
    """
    pytest.skip("Implement this test based on your node's specification")
```

### 2. ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã®æ”¹è¨‚

**Step 1ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãªæˆåŠŸä½“é¨“ï¼‰:**
```markdown
## Step 1: æœ€åˆã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

### 1.1 ãƒãƒ¼ãƒ‰ã‚’ä½œæˆ

```bash
railway new node validate_name
railway new node create_greeting
```

### 1.2 ãƒãƒ¼ãƒ‰ã‚’å®Ÿè£…

`src/nodes/validate_name.py`:
```python
@node
def validate_name(name: str) -> str:
    if not name or not name.strip():
        raise ValueError("Name cannot be empty")
    return name.strip()
```

### 1.3 å‹•ã‹ã—ã¦ã¿ã‚‹

```bash
uv run railway run greet -- --name "Railway"
# Hello, Railway!
```

> ğŸ’¡ ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ç”Ÿæˆã•ã‚Œã¦ã„ã¾ã™ãŒã€ã¾ãšã¯å‹•ãã“ã¨ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚
> ãƒ†ã‚¹ãƒˆã®æ›¸ãæ–¹ã¯ Step 2 ã§å­¦ã³ã¾ã™ã€‚
```

**Step 2ï¼ˆTDDã‚¹ã‚¿ã‚¤ãƒ«å°å…¥ï¼‰:**
```markdown
## Step 2: ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆTDDã‚¹ã‚¿ã‚¤ãƒ«ï¼‰

ã“ã“ã‹ã‚‰ã¯ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºï¼ˆTDDï¼‰ã®ã‚¹ã‚¿ã‚¤ãƒ«ã§é€²ã‚ã¾ã™ã€‚

### TDDã¨ã¯ï¼Ÿ
1. **Red**: ã¾ãšãƒ†ã‚¹ãƒˆã‚’æ›¸ãï¼ˆå¤±æ•—ã™ã‚‹ï¼‰
2. **Green**: ãƒ†ã‚¹ãƒˆãŒé€šã‚‹æœ€å°é™ã®å®Ÿè£…ã‚’ã™ã‚‹
3. **Refactor**: ã‚³ãƒ¼ãƒ‰ã‚’æ•´ç†ã™ã‚‹

### 2.1 ãƒãƒ¼ãƒ‰ã®ã‚¹ã‚±ãƒ«ãƒˆãƒ³ã‚’ç”Ÿæˆ

```bash
railway new node fetch_data
```

### 2.2 ãƒ†ã‚¹ãƒˆã‚’å…ˆã«æ›¸ãï¼ˆRedï¼‰

`tests/nodes/test_fetch_data.py` ã‚’é–‹ãã€æœŸå¾…ã™ã‚‹å‹•ä½œã‚’å®šç¾©ï¼š

```python
def test_fetch_data_returns_user_info():
    result = fetch_data(123)

    assert "user_id" in result
    assert result["user_id"] == 123
    assert "name" in result
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œï¼ˆã¾ã å¤±æ•—ã—ã¾ã™ï¼‰ï¼š
```bash
uv run pytest tests/nodes/test_fetch_data.py -v
# FAILED âœ— - ã“ã‚ŒãŒæ­£å¸¸ã§ã™ï¼
```

### 2.3 å®Ÿè£…ã™ã‚‹ï¼ˆGreenï¼‰

`src/nodes/fetch_data.py`:
```python
@node
def fetch_data(user_id: int) -> dict:
    return {
        "user_id": user_id,
        "name": f"User {user_id}",
    }
```

### 2.4 ãƒ†ã‚¹ãƒˆæˆåŠŸã‚’ç¢ºèª

```bash
uv run pytest tests/nodes/test_fetch_data.py -v
# PASSED âœ“
```
```

### 3. ç”Ÿæˆæ™‚ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```
âœ“ Created src/nodes/fetch_data.py
âœ“ Created tests/nodes/test_fetch_data.py (skeleton)

ğŸ’¡ TDD style workflow:
   1. Write tests in tests/nodes/test_fetch_data.py
   2. Run: uv run pytest tests/nodes/test_fetch_data.py (expect failure)
   3. Implement src/nodes/fetch_data.py
   4. Run tests again (expect success)
```

## æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ

1. **Step 1ã§æˆåŠŸä½“é¨“** â†’ ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¸ã®å¥½å°è±¡
2. **Step 2ã§TDDå°å…¥** â†’ å®Ÿè·µçš„ãªã‚¹ã‚­ãƒ«ç¿’å¾—
3. **ãƒ†ã‚¹ãƒˆå¤±æ•—ãŒã€Œãƒã‚°ã€ã§ã¯ãªãã€Œãƒ—ãƒ­ã‚»ã‚¹ã€ã¨ã—ã¦èªè­˜ã•ã‚Œã‚‹**
4. **ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«å®Œäº†æ™‚ã«ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚‹**

## é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- `src/railway/templates/test_node.py.jinja2`: ãƒ†ã‚¹ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- `src/railway/templates/TUTORIAL.md`: ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- `src/railway/cli/new.py`: ç”Ÿæˆã‚³ãƒãƒ³ãƒ‰

## å„ªå…ˆåº¦

**High** - ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ä½“é¨“ã«ç›´æ¥å½±éŸ¿ã—ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®å°è±¡ã‚’å·¦å³ã™ã‚‹
