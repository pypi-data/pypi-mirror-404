<p align="center">
  <img src="https://img.shields.io/badge/Ïƒ-SIGMA-blue?style=for-the-badge&labelColor=0a0a0f&color=3b82f6" alt="Sigma" height="60"/>
</p>

<h1 align="center">
  <code>Ïƒ</code> SIGMA
</h1>

<p align="center">
  <strong>The AI-Powered Finance Research Agent That Actually Gets It Done</strong>
</p>

<p align="center">
  <a href="#-quick-start">Quick Start</a> â€¢
  <a href="#-features">Features</a> â€¢
  <a href="#-commands">Commands</a> â€¢
  <a href="#-architecture">Architecture</a> â€¢
  <a href="#-roadmap">Roadmap</a>
</p>

<p align="center">
  <img src="https://img.shields.io/badge/version-3.3.0-blue.svg" alt="Version 3.3.0"/>
  <img src="https://img.shields.io/badge/python-3.11+-green.svg" alt="Python 3.11+"/>
  <img src="https://img.shields.io/badge/platform-macOS-lightgrey.svg" alt="macOS"/>
  <img src="https://img.shields.io/badge/AI-Multi--Provider-purple.svg" alt="Multi-Provider AI"/>
  <img src="https://img.shields.io/badge/license-Proprietary-red.svg" alt="License"/>
</p>

<br/>

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                               â•‘
â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—                                     â•‘
â•‘   â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—                                    â•‘
â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘     Finance Research Agent         â•‘
â•‘   â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘     v3.3.0 | Native macOS          â•‘
â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘                                    â•‘
â•‘   â•šâ•â•â•â•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•     â•šâ•â•â•šâ•â•  â•šâ•â•                                    â•‘
â•‘                                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ¯ What is Sigma?

**Sigma isn't just another finance app.** It's a conversational AI agent that thinks like a quant, analyzes like a hedge fund, and speaks like your smartest friend who happens to be a CFA.

```
You: "Should I buy NVDA?"

Ïƒ: Let me analyze that...
   â ‹ get_stock_quote executing...
   âœ“ get_stock_quote complete
   â ¹ technical_analysis executing...
   âœ“ technical_analysis complete
   â ¸ get_analyst_recommendations executing...
   âœ“ get_analyst_recommendations complete

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ïƒ Sigma                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ğŸ“Š NVDA Analysis | Current: $875.32 (+2.4%)                       â”‚
â”‚                                                                     â”‚
â”‚  TECHNICAL SIGNALS:                                                 â”‚
â”‚  â€¢ RSI: 67.2 (approaching overbought)                              â”‚
â”‚  â€¢ MACD: Bullish crossover 3 days ago                              â”‚
â”‚  â€¢ Above 20/50/200 SMA âœ“                                           â”‚
â”‚                                                                     â”‚
â”‚  FUNDAMENTALS:                                                      â”‚
â”‚  â€¢ P/E: 65.2 (premium to sector)                                   â”‚
â”‚  â€¢ Revenue Growth: +122% YoY                                        â”‚
â”‚  â€¢ AI/Data Center: 83% of revenue                                   â”‚
â”‚                                                                     â”‚
â”‚  ANALYST CONSENSUS: Strong Buy (45 analysts)                        â”‚
â”‚  Price Target: $950 (median) | Range: $620-$1,200                  â”‚
â”‚                                                                     â”‚
â”‚  âš¡ VERDICT: BUY on pullbacks to $820-850 support                   â”‚
â”‚  Risk: High volatility, valuation stretched                         â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš¡ Quick Start

### One Command Install

```bash
pip install sigma-terminal
```

### First Launch = Automatic Setup

```bash
sigma
```

**That's it.** Sigma detects it's your first time and walks you through:

1. **ğŸ¤– Choose AI Provider** â€” Google Gemini, OpenAI, Anthropic, Groq, xAI, or Ollama
2. **ğŸ”‘ Enter API Key** â€” Or use local Ollama (completely free, no key needed!)
3. **ğŸ” Auto-detect Integrations** â€” Finds Ollama, LEAN, and more
4. **ğŸš€ Launch Directly** â€” Straight into the beautiful terminal UI

Your config persists at `~/.sigma/` â€” **setup never asks again**.

---

## ğŸš€ Features

### ğŸ¤– Multi-Provider AI Engine

Switch between providers on the fly. Use free tiers or bring your own keys.

| Provider | Models | Speed | Cost | Tool Calls |
|----------|--------|-------|------|------------|
| **Google Gemini** | gemini-2.0-flash, 1.5-pro | âš¡âš¡âš¡ | Free tier | âœ“ Native |
| **OpenAI** | gpt-4o, o1-preview | âš¡âš¡ | Paid | âœ“ Native |
| **Anthropic** | claude-sonnet-4, opus | âš¡âš¡ | Paid | âœ“ Native |
| **Groq** | llama-3.3-70b | âš¡âš¡âš¡âš¡ | Free tier | âœ“ Native |
| **xAI** | grok-2 | âš¡âš¡ | Paid | âœ“ Native |
| **Ollama** | llama3.2, mistral, phi3 | âš¡ | **100% FREE** | âœ“ Native |

**ğŸ›¡ï¸ Built-in Rate Limiting** â€” No more API flooding or timeouts. Sigma intelligently manages request rates per provider.

### ğŸ“Š Real-Time Market Intelligence

Every tool is a function call. The AI decides what to use.

| Tool | What It Does |
|------|--------------|
| `get_stock_quote` | Live price, change, volume, market cap |
| `technical_analysis` | RSI, MACD, Bollinger, MAs, Support/Resistance |
| `get_financial_statements` | Income, balance sheet, cash flow |
| `get_analyst_recommendations` | Price targets, ratings, consensus |
| `get_insider_trades` | Who's buying, who's selling |
| `get_institutional_holders` | Track the smart money |
| `compare_stocks` | Multi-stock comparison with metrics |
| `get_market_overview` | Major indices at a glance |
| `get_sector_performance` | Sector rotation analysis |

### ğŸ“ˆ Backtesting Engine

Test strategies before risking capital:

| Strategy | Description | Use Case |
|----------|-------------|----------|
| `sma_crossover` | 20/50 MA crossover | Trend following |
| `rsi` | RSI oversold/overbought | Mean reversion |
| `macd` | MACD signal crossovers | Momentum |
| `bollinger` | Band breakout/bounce | Volatility |
| `momentum` | Price momentum | Trend continuation |
| `breakout` | S/R level breaks | Breakout trading |

```bash
# Via CLI
sigma backtest AAPL --strategy sma_crossover --period 2y

# Via chat
You: "Backtest RSI strategy on SPY for the last year"
```

### ğŸ”§ LEAN Integration (Auto-Detected!)

Sigma automatically finds your LEAN/QuantConnect installation:

```
âœ“ LEAN/QuantConnect detected!
  CLI: /usr/local/bin/lean
  Directory: /Users/you/Lean

Enable LEAN integration? [y/n] (y): y
Ïƒ LEAN integration enabled
```

**Don't have LEAN?** Sigma offers to install it for you:

```
! LEAN/QuantConnect not detected
Would you like to [install/manual/skip] (skip): install

Ïƒ Installing LEAN CLI via pip...
âœ“ LEAN CLI installed successfully!
```

### ğŸ¨ Beautiful Terminal UI

- **Animated Tool Calls** â€” Watch `â ‹ â ™ â ¹ â ¸ â ¼ â ´ â ¦ â § â ‡ â ` spin as tools execute
- **Live Ticker Detection** â€” Type `AAPL` and see `$AAPL` highlighted instantly
- **Smart Autocomplete** â€” Tab to complete commands and tickers
- **Pulsing Ïƒ Indicator** â€” Subtle animation shows Sigma is thinking
- **Rich Responses** â€” Markdown tables, formatting, structure

---

## ğŸ’» Commands

### In-App Commands

| Command | Description |
|---------|-------------|
| `/help` | Comprehensive help with examples |
| `/clear` | Clear chat history |
| `/keys` | Configure API keys |
| `/models` | Show available models |
| `/status` | Current configuration |
| `/provider <name>` | Switch AI provider |
| `/model <name>` | Switch model |
| `/backtest` | Show backtesting strategies |
| `/tickers` | Popular tickers by category |

### Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| `Tab` | Autocomplete suggestion |
| `Ctrl+L` | Clear chat |
| `Ctrl+M` | Show models |
| `Ctrl+H` | Toggle quick help |
| `Ctrl+P` | Command palette |
| `Esc` | Cancel operation |

### CLI Commands

```bash
# Launch interactive mode
sigma

# Quick queries (no UI)
sigma ask "analyze AAPL"
sigma quote AAPL MSFT NVDA
sigma compare AAPL MSFT GOOGL

# Backtesting
sigma backtest AAPL --strategy sma_crossover --period 2y

# Configuration
sigma --setup           # Re-run setup wizard
sigma --status          # Show current config
sigma --setkey google YOUR_API_KEY
sigma --provider ollama
sigma --model llama3.2
sigma --list-models     # Show all available models
```

---

## ğŸ§  Natural Language Examples

Sigma understands you. Just talk to it:

**Analysis**
```
"What's happening with AAPL today?"
"Give me a full breakdown of NVDA"
"Is TSLA overvalued right now?"
```

**Comparison**
```
"Compare NVDA, AMD, and INTC"
"Which is better: GOOGL or META?"
"Show me the Magnificent 7 stocks side by side"
```

**Technical**
```
"Technical analysis of QQQ"
"What are the support and resistance levels for SPY?"
"Is AAPL overbought?"
```

**Fundamentals**
```
"What's the P/E ratio of MSFT?"
"Show me AMZN's revenue growth"
"Income statement for GOOGL"
```

**Activity**
```
"Who are the biggest institutional holders of AAPL?"
"Any insider trading at TSLA?"
"What are analysts saying about META?"
```

**Market**
```
"How's the market doing?"
"Which sectors are hot right now?"
"Give me a market overview"
```

**Backtesting**
```
"Backtest SMA crossover on SPY"
"Run RSI strategy on AAPL for 2 years"
"Test momentum strategy on QQQ"
```

---

## ğŸ—ï¸ Architecture

```
sigma/
â”œâ”€â”€ app.py          # Textual TUI application
â”‚                   # - ToolCallDisplay (animated spinners)
â”‚                   # - SigmaIndicator (pulsing Ïƒ)
â”‚                   # - TickerHighlight (real-time detection)
â”‚                   # - ChatLog (rich formatting)
â”‚
â”œâ”€â”€ cli.py          # CLI entry point
â”‚                   # - First-run detection
â”‚                   # - Auto-launch setup â†’ interactive
â”‚                   # - Subcommands (ask, quote, backtest)
â”‚
â”œâ”€â”€ config.py       # Settings & persistence
â”‚                   # - detect_lean_installation()
â”‚                   # - detect_ollama()
â”‚                   # - install_lean_cli_sync()
â”‚                   # - ~/.sigma/config.env
â”‚
â”œâ”€â”€ setup.py        # First-run setup wizard
â”‚                   # - Provider selection
â”‚                   # - API key configuration
â”‚                   # - Integration auto-detection
â”‚                   # - LEAN download option
â”‚
â”œâ”€â”€ llm.py          # Multi-provider AI clients
â”‚                   # - RateLimiter (per-provider)
â”‚                   # - GoogleLLM, OpenAILLM, AnthropicLLM
â”‚                   # - GroqLLM, OllamaLLM (with tool calls!)
â”‚
â”œâ”€â”€ tools.py        # Financial data tools
â”‚                   # - 11 tool functions
â”‚                   # - OpenAI-compatible schema
â”‚                   # - yfinance data source
â”‚
â”œâ”€â”€ backtest.py     # Backtesting engine
â”‚                   # - 6 built-in strategies
â”‚                   # - Performance metrics
â”‚                   # - Risk analysis
â”‚
â””â”€â”€ analytics/      # Advanced analytics (v4.0)
```

### Key Design Decisions

| Decision | Why |
|----------|-----|
| **Provider Abstraction** | All LLMs implement `BaseLLM.generate()` â€” easy to add new providers |
| **Tool System** | OpenAI-compatible function calling works across all providers |
| **Rate Limiting** | Per-provider `RateLimiter` prevents API flooding automatically |
| **Config Persistence** | Simple env file at `~/.sigma/config.env` â€” human readable |
| **First-Run Detection** | Marker file `.first_run_complete` ensures smooth onboarding |
| **Textual TUI** | Modern Python TUI framework with async support |

---

## ğŸ”§ Configuration

### Config Location

```
~/.sigma/
â”œâ”€â”€ config.env           # API keys and settings
â””â”€â”€ .first_run_complete  # First-run marker
```

### Config File Format

```bash
# ~/.sigma/config.env

# API Keys
GOOGLE_API_KEY=AIzaSy...
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
GROQ_API_KEY=gsk_...
XAI_API_KEY=xai-...

# Defaults
DEFAULT_PROVIDER=google
DEFAULT_MODEL=gemini-2.0-flash

# Integrations
OLLAMA_HOST=http://localhost:11434
LEAN_ENABLED=true
LEAN_CLI_PATH=/usr/local/bin/lean
LEAN_DIRECTORY=/Users/you/Lean

# Data
OUTPUT_DIR=/Users/you/Documents/Sigma
CACHE_ENABLED=true
```

---

## ğŸ—ºï¸ Roadmap

### âœ… v3.3.0 (Current)
- [x] Auto-setup on first launch
- [x] LEAN auto-detection with install option
- [x] API rate limiting (no more timeouts!)
- [x] Ollama native tool call support
- [x] Enhanced ticker recognition
- [x] Animated tool call display
- [x] Pulsing Ïƒ indicator
- [x] Smart autocomplete
- [x] Comprehensive help system

### ğŸ”œ v3.4.0 (Next)
- [ ] Portfolio tracking & management
- [ ] Watchlists with price alerts
- [ ] Options flow analysis
- [ ] Earnings calendar integration
- [ ] Multi-ticker comparison charts
- [ ] Export to CSV/PDF

### ğŸ”® v4.0.0 (Future)
- [ ] Full LEAN backtesting integration
- [ ] Paper trading mode
- [ ] Custom strategy builder (visual)
- [ ] Discord/Slack notifications
- [ ] REST API for external integrations
- [ ] Multi-user support

---

## ğŸ› ï¸ Development

### Prerequisites

- Python 3.11+
- macOS (for native app bundle)

### Setup

```bash
# Clone
git clone https://github.com/yourusername/sigma.git
cd sigma

# Create virtual environment
python3 -m venv .venv
source .venv/bin/activate

# Install in development mode
pip install -e ".[dev]"

# Run
python -m sigma
```

### Build macOS App Bundle

```bash
./scripts/build.sh

# Outputs:
# - dist/sigma_terminal-3.3.0-py3-none-any.whl
# - dist/Sigma.app (drag to /Applications)
```

### Project Structure

```bash
sigma/
â”œâ”€â”€ pyproject.toml    # Package configuration
â”œâ”€â”€ README.md         # You are here
â”œâ”€â”€ LICENSE           # Proprietary license
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ build.sh      # Build script
â”‚   â””â”€â”€ create_app.py # macOS app bundle creator
â””â”€â”€ sigma/
    â”œâ”€â”€ __init__.py   # Package exports
    â”œâ”€â”€ __main__.py   # Entry point
    â””â”€â”€ ...           # Core modules
```

---

## ğŸ™ Acknowledgments

Built with:
- [Textual](https://textual.textualize.io/) â€” Beautiful TUIs in Python
- [Rich](https://rich.readthedocs.io/) â€” Rich text formatting
- [yfinance](https://github.com/ranaroussi/yfinance) â€” Yahoo Finance data
- [Plotly](https://plotly.com/python/) â€” Interactive charts
- [Pydantic](https://docs.pydantic.dev/) â€” Data validation

AI Providers:
- [Google Gemini](https://ai.google.dev/)
- [OpenAI](https://openai.com/)
- [Anthropic](https://anthropic.com/)
- [Groq](https://groq.com/)
- [xAI](https://x.ai/)
- [Ollama](https://ollama.ai/)

---

## ğŸ“œ License

Proprietary. All rights reserved.

---

<p align="center">
  <strong>Built with ğŸ§  by humans who got tired of slow, clunky finance tools.</strong>
</p>

<p align="center">
  <code>Ïƒ</code> â€” Because your portfolio deserves an AI that actually works.
</p>

<p align="center">
  <sub>Star â­ this repo if Sigma saved you time!</sub>
</p>
